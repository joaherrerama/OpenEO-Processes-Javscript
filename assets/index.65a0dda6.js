var Gk=Object.defineProperty;var Hk=(t,e,r)=>e in t?Gk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ir=(t,e,r)=>(Hk(t,typeof e!="symbol"?e+"":e,r),r),Wk=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var Fn=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)};var Bn=(t,e,r)=>(Wk(t,e,"access private method"),r);const Zk=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function r(s){const u={};return s.integrity&&(u.integrity=s.integrity),s.referrerpolicy&&(u.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?u.credentials="include":s.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(s){if(s.ep)return;s.ep=!0;const u=r(s);fetch(s.href,u)}};Zk();function Py(t,e){const r=Object.create(null),n=t.split(",");for(let s=0;s<n.length;s++)r[n[s]]=!0;return e?s=>!!r[s.toLowerCase()]:s=>!!r[s]}const qk="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",Kk=Py(qk);function zp(t){if(sr(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],s=Li(n)?Qk(n):zp(n);if(s)for(const u in s)e[u]=s[u]}return e}else{if(Li(t))return t;if(fi(t))return t}}const Xk=/;(?![^(]*\))/g,Yk=/:([^]+)/,Jk=/\/\*.*?\*\//gs;function Qk(t){const e={};return t.replace(Jk,"").split(Xk).forEach(r=>{if(r){const n=r.split(Yk);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function iu(t){let e="";if(Li(t))e=t;else if(sr(t))for(let r=0;r<t.length;r++){const n=iu(t[r]);n&&(e+=n+" ")}else if(fi(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function js(t){if(!t)return null;let{class:e,style:r}=t;return e&&!Li(e)&&(t.class=iu(e)),r&&(t.style=zp(r)),t}const ez="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",tz=Py(ez);function $P(t){return!!t||t===""}function rz(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=Ol(t[n],e[n]);return r}function Ol(t,e){if(t===e)return!0;let r=qT(t),n=qT(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=yp(t),n=yp(e),r||n)return t===e;if(r=sr(t),n=sr(e),r||n)return r&&n?rz(t,e):!1;if(r=fi(t),n=fi(e),r||n){if(!r||!n)return!1;const s=Object.keys(t).length,u=Object.keys(e).length;if(s!==u)return!1;for(const d in t){const o=t.hasOwnProperty(d),g=e.hasOwnProperty(d);if(o&&!g||!o&&g||!Ol(t[d],e[d]))return!1}}return String(t)===String(e)}function Cy(t,e){return t.findIndex(r=>Ol(r,e))}const bl=t=>Li(t)?t:t==null?"":sr(t)||fi(t)&&(t.toString===UP||!wr(t.toString))?JSON.stringify(t,VP,2):String(t),VP=(t,e)=>e&&e.__v_isRef?VP(t,e.value):Fh(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,s])=>(r[`${n} =>`]=s,r),{})}:du(e)?{[`Set(${e.size})`]:[...e.values()]}:fi(e)&&!sr(e)&&!GP(e)?String(e):e,ci={},zh=[],lo=()=>{},iz=()=>!1,nz=/^on[^a-z]/,Fp=t=>nz.test(t),Gb=t=>t.startsWith("onUpdate:"),$i=Object.assign,Hb=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},sz=Object.prototype.hasOwnProperty,qr=(t,e)=>sz.call(t,e),sr=Array.isArray,Fh=t=>Bp(t)==="[object Map]",du=t=>Bp(t)==="[object Set]",qT=t=>Bp(t)==="[object Date]",wr=t=>typeof t=="function",Li=t=>typeof t=="string",yp=t=>typeof t=="symbol",fi=t=>t!==null&&typeof t=="object",Wb=t=>fi(t)&&wr(t.then)&&wr(t.catch),UP=Object.prototype.toString,Bp=t=>UP.call(t),oz=t=>Bp(t).slice(8,-1),GP=t=>Bp(t)==="[object Object]",Zb=t=>Li(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ip=Py(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Iy=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},az=/-(\w)/g,cs=Iy(t=>t.replace(az,(e,r)=>r?r.toUpperCase():"")),lz=/\B([A-Z])/g,Us=Iy(t=>t.replace(lz,"-$1").toLowerCase()),Np=Iy(t=>t.charAt(0).toUpperCase()+t.slice(1)),np=Iy(t=>t?`on${Np(t)}`:""),Wh=(t,e)=>!Object.is(t,e),Bh=(t,e)=>{for(let r=0;r<t.length;r++)t[r](e)},j_=(t,e,r)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:r})},Ca=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let KT;const cz=()=>KT||(KT=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let bs;class qb{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=bs,!e&&bs&&(this.index=(bs.scopes||(bs.scopes=[])).push(this)-1)}run(e){if(this.active){const r=bs;try{return bs=this,e()}finally{bs=r}}}on(){bs=this}off(){bs=this.parent}stop(e){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this.active=!1}}}function HP(t){return new qb(t)}function WP(t,e=bs){e&&e.active&&e.effects.push(t)}function uz(){return bs}function hz(t){bs&&bs.cleanups.push(t)}const Kb=t=>{const e=new Set(t);return e.w=0,e.n=0,e},ZP=t=>(t.w&Dl)>0,qP=t=>(t.n&Dl)>0,dz=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Dl},fz=t=>{const{deps:e}=t;if(e.length){let r=0;for(let n=0;n<e.length;n++){const s=e[n];ZP(s)&&!qP(s)?s.delete(t):e[r++]=s,s.w&=~Dl,s.n&=~Dl}e.length=r}},Bx=new WeakMap;let Kf=0,Dl=1;const Nx=30;let oo;const Zc=Symbol(""),jx=Symbol("");class jp{constructor(e,r=null,n){this.fn=e,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,WP(this,n)}run(){if(!this.active)return this.fn();let e=oo,r=Pl;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=oo,oo=this,Pl=!0,Dl=1<<++Kf,Kf<=Nx?dz(this):XT(this),this.fn()}finally{Kf<=Nx&&fz(this),Dl=1<<--Kf,oo=this.parent,Pl=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){oo===this?this.deferStop=!0:this.active&&(XT(this),this.onStop&&this.onStop(),this.active=!1)}}function XT(t){const{deps:e}=t;if(e.length){for(let r=0;r<e.length;r++)e[r].delete(t);e.length=0}}function pz(t,e){t.effect&&(t=t.effect.fn);const r=new jp(t);e&&($i(r,e),e.scope&&WP(r,e.scope)),(!e||!e.lazy)&&r.run();const n=r.run.bind(r);return n.effect=r,n}function mz(t){t.effect.stop()}let Pl=!0;const KP=[];function ud(){KP.push(Pl),Pl=!1}function hd(){const t=KP.pop();Pl=t===void 0?!0:t}function As(t,e,r){if(Pl&&oo){let n=Bx.get(t);n||Bx.set(t,n=new Map);let s=n.get(r);s||n.set(r,s=Kb()),XP(s)}}function XP(t,e){let r=!1;Kf<=Nx?qP(t)||(t.n|=Dl,r=!ZP(t)):r=!t.has(oo),r&&(t.add(oo),oo.deps.push(t))}function Ia(t,e,r,n,s,u){const d=Bx.get(t);if(!d)return;let o=[];if(e==="clear")o=[...d.values()];else if(r==="length"&&sr(t)){const g=Ca(n);d.forEach((x,E)=>{(E==="length"||E>=g)&&o.push(x)})}else switch(r!==void 0&&o.push(d.get(r)),e){case"add":sr(t)?Zb(r)&&o.push(d.get("length")):(o.push(d.get(Zc)),Fh(t)&&o.push(d.get(jx)));break;case"delete":sr(t)||(o.push(d.get(Zc)),Fh(t)&&o.push(d.get(jx)));break;case"set":Fh(t)&&o.push(d.get(Zc));break}if(o.length===1)o[0]&&$x(o[0]);else{const g=[];for(const x of o)x&&g.push(...x);$x(Kb(g))}}function $x(t,e){const r=sr(t)?t:[...t];for(const n of r)n.computed&&YT(n);for(const n of r)n.computed||YT(n)}function YT(t,e){(t!==oo||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const gz=Py("__proto__,__v_isRef,__isVue"),YP=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(yp)),_z=My(),yz=My(!1,!0),vz=My(!0),xz=My(!0,!0),JT=bz();function bz(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...r){const n=Xr(this);for(let u=0,d=this.length;u<d;u++)As(n,"get",u+"");const s=n[e](...r);return s===-1||s===!1?n[e](...r.map(Xr)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...r){ud();const n=Xr(this)[e].apply(this,r);return hd(),n}}),t}function My(t=!1,e=!1){return function(n,s,u){if(s==="__v_isReactive")return!t;if(s==="__v_isReadonly")return t;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&u===(t?e?nC:iC:e?rC:tC).get(n))return n;const d=sr(n);if(!t&&d&&qr(JT,s))return Reflect.get(JT,s,u);const o=Reflect.get(n,s,u);return(yp(s)?YP.has(s):gz(s))||(t||As(n,"get",s),e)?o:cn(o)?d&&Zb(s)?o:o.value:fi(o)?t?Yb(o):Rl(o):o}}const wz=JP(),Ez=JP(!0);function JP(t=!1){return function(r,n,s,u){let d=r[n];if(nu(d)&&cn(d)&&!cn(s))return!1;if(!t&&(!vp(s)&&!nu(s)&&(d=Xr(d),s=Xr(s)),!sr(r)&&cn(d)&&!cn(s)))return d.value=s,!0;const o=sr(r)&&Zb(n)?Number(n)<r.length:qr(r,n),g=Reflect.set(r,n,s,u);return r===Xr(u)&&(o?Wh(s,d)&&Ia(r,"set",n,s):Ia(r,"add",n,s)),g}}function Tz(t,e){const r=qr(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&r&&Ia(t,"delete",e,void 0),n}function Sz(t,e){const r=Reflect.has(t,e);return(!yp(e)||!YP.has(e))&&As(t,"has",e),r}function Az(t){return As(t,"iterate",sr(t)?"length":Zc),Reflect.ownKeys(t)}const QP={get:_z,set:wz,deleteProperty:Tz,has:Sz,ownKeys:Az},eC={get:vz,set(t,e){return!0},deleteProperty(t,e){return!0}},Pz=$i({},QP,{get:yz,set:Ez}),Cz=$i({},eC,{get:xz}),Xb=t=>t,Oy=t=>Reflect.getPrototypeOf(t);function zg(t,e,r=!1,n=!1){t=t.__v_raw;const s=Xr(t),u=Xr(e);r||(e!==u&&As(s,"get",e),As(s,"get",u));const{has:d}=Oy(s),o=n?Xb:r?Qb:xp;if(d.call(s,e))return o(t.get(e));if(d.call(s,u))return o(t.get(u));t!==s&&t.get(e)}function Fg(t,e=!1){const r=this.__v_raw,n=Xr(r),s=Xr(t);return e||(t!==s&&As(n,"has",t),As(n,"has",s)),t===s?r.has(t):r.has(t)||r.has(s)}function Bg(t,e=!1){return t=t.__v_raw,!e&&As(Xr(t),"iterate",Zc),Reflect.get(t,"size",t)}function QT(t){t=Xr(t);const e=Xr(this);return Oy(e).has.call(e,t)||(e.add(t),Ia(e,"add",t,t)),this}function eS(t,e){e=Xr(e);const r=Xr(this),{has:n,get:s}=Oy(r);let u=n.call(r,t);u||(t=Xr(t),u=n.call(r,t));const d=s.call(r,t);return r.set(t,e),u?Wh(e,d)&&Ia(r,"set",t,e):Ia(r,"add",t,e),this}function tS(t){const e=Xr(this),{has:r,get:n}=Oy(e);let s=r.call(e,t);s||(t=Xr(t),s=r.call(e,t)),n&&n.call(e,t);const u=e.delete(t);return s&&Ia(e,"delete",t,void 0),u}function rS(){const t=Xr(this),e=t.size!==0,r=t.clear();return e&&Ia(t,"clear",void 0,void 0),r}function Ng(t,e){return function(n,s){const u=this,d=u.__v_raw,o=Xr(d),g=e?Xb:t?Qb:xp;return!t&&As(o,"iterate",Zc),d.forEach((x,E)=>n.call(s,g(x),g(E),u))}}function jg(t,e,r){return function(...n){const s=this.__v_raw,u=Xr(s),d=Fh(u),o=t==="entries"||t===Symbol.iterator&&d,g=t==="keys"&&d,x=s[t](...n),E=r?Xb:e?Qb:xp;return!e&&As(u,"iterate",g?jx:Zc),{next(){const{value:S,done:P}=x.next();return P?{value:S,done:P}:{value:o?[E(S[0]),E(S[1])]:E(S),done:P}},[Symbol.iterator](){return this}}}}function hl(t){return function(...e){return t==="delete"?!1:this}}function Iz(){const t={get(u){return zg(this,u)},get size(){return Bg(this)},has:Fg,add:QT,set:eS,delete:tS,clear:rS,forEach:Ng(!1,!1)},e={get(u){return zg(this,u,!1,!0)},get size(){return Bg(this)},has:Fg,add:QT,set:eS,delete:tS,clear:rS,forEach:Ng(!1,!0)},r={get(u){return zg(this,u,!0)},get size(){return Bg(this,!0)},has(u){return Fg.call(this,u,!0)},add:hl("add"),set:hl("set"),delete:hl("delete"),clear:hl("clear"),forEach:Ng(!0,!1)},n={get(u){return zg(this,u,!0,!0)},get size(){return Bg(this,!0)},has(u){return Fg.call(this,u,!0)},add:hl("add"),set:hl("set"),delete:hl("delete"),clear:hl("clear"),forEach:Ng(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(u=>{t[u]=jg(u,!1,!1),r[u]=jg(u,!0,!1),e[u]=jg(u,!1,!0),n[u]=jg(u,!0,!0)}),[t,r,e,n]}const[Mz,Oz,Dz,Rz]=Iz();function Dy(t,e){const r=e?t?Rz:Dz:t?Oz:Mz;return(n,s,u)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?n:Reflect.get(qr(r,s)&&s in n?r:n,s,u)}const Lz={get:Dy(!1,!1)},kz={get:Dy(!1,!0)},zz={get:Dy(!0,!1)},Fz={get:Dy(!0,!0)},tC=new WeakMap,rC=new WeakMap,iC=new WeakMap,nC=new WeakMap;function Bz(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Nz(t){return t.__v_skip||!Object.isExtensible(t)?0:Bz(oz(t))}function Rl(t){return nu(t)?t:Ry(t,!1,QP,Lz,tC)}function sC(t){return Ry(t,!1,Pz,kz,rC)}function Yb(t){return Ry(t,!0,eC,zz,iC)}function jz(t){return Ry(t,!0,Cz,Fz,nC)}function Ry(t,e,r,n,s){if(!fi(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const u=s.get(t);if(u)return u;const d=Nz(t);if(d===0)return t;const o=new Proxy(t,d===2?n:r);return s.set(t,o),o}function qc(t){return nu(t)?qc(t.__v_raw):!!(t&&t.__v_isReactive)}function nu(t){return!!(t&&t.__v_isReadonly)}function vp(t){return!!(t&&t.__v_isShallow)}function Jb(t){return qc(t)||nu(t)}function Xr(t){const e=t&&t.__v_raw;return e?Xr(e):t}function Ly(t){return j_(t,"__v_skip",!0),t}const xp=t=>fi(t)?Rl(t):t,Qb=t=>fi(t)?Yb(t):t;function e1(t){Pl&&oo&&(t=Xr(t),XP(t.dep||(t.dep=Kb())))}function ky(t,e){t=Xr(t),t.dep&&$x(t.dep)}function cn(t){return!!(t&&t.__v_isRef===!0)}function Nh(t){return aC(t,!1)}function oC(t){return aC(t,!0)}function aC(t,e){return cn(t)?t:new $z(t,e)}class $z{constructor(e,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?e:Xr(e),this._value=r?e:xp(e)}get value(){return e1(this),this._value}set value(e){const r=this.__v_isShallow||vp(e)||nu(e);e=r?e:Xr(e),Wh(e,this._rawValue)&&(this._rawValue=e,this._value=r?e:xp(e),ky(this))}}function Vz(t){ky(t)}function Kc(t){return cn(t)?t.value:t}const Uz={get:(t,e,r)=>Kc(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const s=t[e];return cn(s)&&!cn(r)?(s.value=r,!0):Reflect.set(t,e,r,n)}};function t1(t){return qc(t)?t:new Proxy(t,Uz)}class Gz{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:r,set:n}=e(()=>e1(this),()=>ky(this));this._get=r,this._set=n}get value(){return this._get()}set value(e){this._set(e)}}function Hz(t){return new Gz(t)}function Vx(t){const e=sr(t)?new Array(t.length):{};for(const r in t)e[r]=lC(t,r);return e}class Wz{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function lC(t,e,r){const n=t[e];return cn(n)?n:new Wz(t,e,r)}var cC;class Zz{constructor(e,r,n,s){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[cC]=!1,this._dirty=!0,this.effect=new jp(e,()=>{this._dirty||(this._dirty=!0,ky(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=n}get value(){const e=Xr(this);return e1(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}cC="__v_isReadonly";function qz(t,e,r=!1){let n,s;const u=wr(t);return u?(n=t,s=lo):(n=t.get,s=t.set),new Zz(n,s,u||!s,r)}function Kz(t,...e){}function Ta(t,e,r,n){let s;try{s=n?t(...n):t()}catch(u){fu(u,e,r)}return s}function Ss(t,e,r,n){if(wr(t)){const u=Ta(t,e,r,n);return u&&Wb(u)&&u.catch(d=>{fu(d,e,r)}),u}const s=[];for(let u=0;u<t.length;u++)s.push(Ss(t[u],e,r,n));return s}function fu(t,e,r,n=!0){const s=e?e.vnode:null;if(e){let u=e.parent;const d=e.proxy,o=r;for(;u;){const x=u.ec;if(x){for(let E=0;E<x.length;E++)if(x[E](t,d,o)===!1)return}u=u.parent}const g=e.appContext.config.errorHandler;if(g){Ta(g,null,10,[t,d,o]);return}}Xz(t,r,s,n)}function Xz(t,e,r,n=!0){console.error(t)}let bp=!1,Ux=!1;const Mn=[];let Bo=0;const jh=[];let ma=null,$c=0;const uC=Promise.resolve();let r1=null;function zy(t){const e=r1||uC;return t?e.then(this?t.bind(this):t):e}function Yz(t){let e=Bo+1,r=Mn.length;for(;e<r;){const n=e+r>>>1;wp(Mn[n])<t?e=n+1:r=n}return e}function Fy(t){(!Mn.length||!Mn.includes(t,bp&&t.allowRecurse?Bo+1:Bo))&&(t.id==null?Mn.push(t):Mn.splice(Yz(t.id),0,t),hC())}function hC(){!bp&&!Ux&&(Ux=!0,r1=uC.then(dC))}function Jz(t){const e=Mn.indexOf(t);e>Bo&&Mn.splice(e,1)}function i1(t){sr(t)?jh.push(...t):(!ma||!ma.includes(t,t.allowRecurse?$c+1:$c))&&jh.push(t),hC()}function iS(t,e=bp?Bo+1:0){for(;e<Mn.length;e++){const r=Mn[e];r&&r.pre&&(Mn.splice(e,1),e--,r())}}function $_(t){if(jh.length){const e=[...new Set(jh)];if(jh.length=0,ma){ma.push(...e);return}for(ma=e,ma.sort((r,n)=>wp(r)-wp(n)),$c=0;$c<ma.length;$c++)ma[$c]();ma=null,$c=0}}const wp=t=>t.id==null?1/0:t.id,Qz=(t,e)=>{const r=wp(t)-wp(e);if(r===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return r};function dC(t){Ux=!1,bp=!0,Mn.sort(Qz);const e=lo;try{for(Bo=0;Bo<Mn.length;Bo++){const r=Mn[Bo];r&&r.active!==!1&&Ta(r,null,14)}}finally{Bo=0,Mn.length=0,$_(),bp=!1,r1=null,(Mn.length||jh.length)&&dC()}}let Ph,$g=[];function fC(t,e){var r,n;Ph=t,Ph?(Ph.enabled=!0,$g.forEach(({event:s,args:u})=>Ph.emit(s,...u)),$g=[]):typeof window!="undefined"&&window.HTMLElement&&!(!((n=(r=window.navigator)===null||r===void 0?void 0:r.userAgent)===null||n===void 0)&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(u=>{fC(u,e)}),setTimeout(()=>{Ph||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,$g=[])},3e3)):$g=[]}function eF(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||ci;let s=r;const u=e.startsWith("update:"),d=u&&e.slice(7);if(d&&d in n){const E=`${d==="modelValue"?"model":d}Modifiers`,{number:S,trim:P}=n[E]||ci;P&&(s=r.map(I=>Li(I)?I.trim():I)),S&&(s=r.map(Ca))}let o,g=n[o=np(e)]||n[o=np(cs(e))];!g&&u&&(g=n[o=np(Us(e))]),g&&Ss(g,t,6,s);const x=n[o+"Once"];if(x){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,Ss(x,t,6,s)}}function pC(t,e,r=!1){const n=e.emitsCache,s=n.get(t);if(s!==void 0)return s;const u=t.emits;let d={},o=!1;if(!wr(t)){const g=x=>{const E=pC(x,e,!0);E&&(o=!0,$i(d,E))};!r&&e.mixins.length&&e.mixins.forEach(g),t.extends&&g(t.extends),t.mixins&&t.mixins.forEach(g)}return!u&&!o?(fi(t)&&n.set(t,null),null):(sr(u)?u.forEach(g=>d[g]=null):$i(d,u),fi(t)&&n.set(t,d),d)}function By(t,e){return!t||!Fp(e)?!1:(e=e.slice(2).replace(/Once$/,""),qr(t,e[0].toLowerCase()+e.slice(1))||qr(t,Us(e))||qr(t,e))}let _n=null,Ny=null;function Ep(t){const e=_n;return _n=t,Ny=t&&t.type.__scopeId||null,e}function tF(t){Ny=t}function rF(){Ny=null}const iF=t=>Fo;function Fo(t,e=_n,r){if(!e||t._n)return t;const n=(...s)=>{n._d&&Xx(-1);const u=Ep(e);let d;try{d=t(...s)}finally{Ep(u),n._d&&Xx(1)}return d};return n._n=!0,n._c=!0,n._d=!0,n}function x_(t){const{type:e,vnode:r,proxy:n,withProxy:s,props:u,propsOptions:[d],slots:o,attrs:g,emit:x,render:E,renderCache:S,data:P,setupState:I,ctx:R,inheritAttrs:z}=t;let B,$;const j=Ep(t);try{if(r.shapeFlag&4){const K=s||n;B=Es(E.call(K,K,S,u,I,P,R)),$=g}else{const K=e;B=Es(K.length>1?K(u,{attrs:g,slots:o,emit:x}):K(u,null)),$=e.props?g:sF(g)}}catch(K){lp.length=0,fu(K,t,1),B=ri(Dn)}let G=B;if($&&z!==!1){const K=Object.keys($),{shapeFlag:X}=G;K.length&&X&7&&(d&&K.some(Gb)&&($=oF($,d)),G=Uo(G,$))}return r.dirs&&(G=Uo(G),G.dirs=G.dirs?G.dirs.concat(r.dirs):r.dirs),r.transition&&(G.transition=r.transition),B=G,Ep(j),B}function nF(t){let e;for(let r=0;r<t.length;r++){const n=t[r];if(Ll(n)){if(n.type!==Dn||n.children==="v-if"){if(e)return;e=n}}else return}return e}const sF=t=>{let e;for(const r in t)(r==="class"||r==="style"||Fp(r))&&((e||(e={}))[r]=t[r]);return e},oF=(t,e)=>{const r={};for(const n in t)(!Gb(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function aF(t,e,r){const{props:n,children:s,component:u}=t,{props:d,children:o,patchFlag:g}=e,x=u.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&g>=0){if(g&1024)return!0;if(g&16)return n?nS(n,d,x):!!d;if(g&8){const E=e.dynamicProps;for(let S=0;S<E.length;S++){const P=E[S];if(d[P]!==n[P]&&!By(x,P))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:n===d?!1:n?d?nS(n,d,x):!0:!!d;return!1}function nS(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const u=n[s];if(e[u]!==t[u]&&!By(r,u))return!0}return!1}function n1({vnode:t,parent:e},r){for(;e&&e.subTree===t;)(t=e.vnode).el=r,e=e.parent}const mC=t=>t.__isSuspense,lF={name:"Suspense",__isSuspense:!0,process(t,e,r,n,s,u,d,o,g,x){t==null?uF(e,r,n,s,u,d,o,g,x):hF(t,e,r,n,s,d,o,g,x)},hydrate:dF,create:s1,normalize:fF},cF=lF;function Tp(t,e){const r=t.props&&t.props[e];wr(r)&&r()}function uF(t,e,r,n,s,u,d,o,g){const{p:x,o:{createElement:E}}=g,S=E("div"),P=t.suspense=s1(t,s,n,e,S,r,u,d,o,g);x(null,P.pendingBranch=t.ssContent,S,null,n,P,u,d),P.deps>0?(Tp(t,"onPending"),Tp(t,"onFallback"),x(null,t.ssFallback,e,r,n,null,u,d),$h(P,t.ssFallback)):P.resolve()}function hF(t,e,r,n,s,u,d,o,{p:g,um:x,o:{createElement:E}}){const S=e.suspense=t.suspense;S.vnode=e,e.el=t.el;const P=e.ssContent,I=e.ssFallback,{activeBranch:R,pendingBranch:z,isInFallback:B,isHydrating:$}=S;if(z)S.pendingBranch=P,No(P,z)?(g(z,P,S.hiddenContainer,null,s,S,u,d,o),S.deps<=0?S.resolve():B&&(g(R,I,r,n,s,null,u,d,o),$h(S,I))):(S.pendingId++,$?(S.isHydrating=!1,S.activeBranch=z):x(z,s,S),S.deps=0,S.effects.length=0,S.hiddenContainer=E("div"),B?(g(null,P,S.hiddenContainer,null,s,S,u,d,o),S.deps<=0?S.resolve():(g(R,I,r,n,s,null,u,d,o),$h(S,I))):R&&No(P,R)?(g(R,P,r,n,s,S,u,d,o),S.resolve(!0)):(g(null,P,S.hiddenContainer,null,s,S,u,d,o),S.deps<=0&&S.resolve()));else if(R&&No(P,R))g(R,P,r,n,s,S,u,d,o),$h(S,P);else if(Tp(e,"onPending"),S.pendingBranch=P,S.pendingId++,g(null,P,S.hiddenContainer,null,s,S,u,d,o),S.deps<=0)S.resolve();else{const{timeout:j,pendingId:G}=S;j>0?setTimeout(()=>{S.pendingId===G&&S.fallback(I)},j):j===0&&S.fallback(I)}}function s1(t,e,r,n,s,u,d,o,g,x,E=!1){const{p:S,m:P,um:I,n:R,o:{parentNode:z,remove:B}}=x,$=Ca(t.props&&t.props.timeout),j={vnode:t,parent:e,parentComponent:r,isSVG:d,container:n,hiddenContainer:s,anchor:u,deps:0,pendingId:0,timeout:typeof $=="number"?$:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:E,isUnmounted:!1,effects:[],resolve(G=!1){const{vnode:K,activeBranch:X,pendingBranch:re,pendingId:ue,effects:ne,parentComponent:we,container:xe}=j;if(j.isHydrating)j.isHydrating=!1;else if(!G){const Fe=X&&re.transition&&re.transition.mode==="out-in";Fe&&(X.transition.afterLeave=()=>{ue===j.pendingId&&P(re,xe,se,0)});let{anchor:se}=j;X&&(se=R(X),I(X,we,j,!0)),Fe||P(re,xe,se,0)}$h(j,re),j.pendingBranch=null,j.isInFallback=!1;let ke=j.parent,Ie=!1;for(;ke;){if(ke.pendingBranch){ke.effects.push(...ne),Ie=!0;break}ke=ke.parent}Ie||i1(ne),j.effects=[],Tp(K,"onResolve")},fallback(G){if(!j.pendingBranch)return;const{vnode:K,activeBranch:X,parentComponent:re,container:ue,isSVG:ne}=j;Tp(K,"onFallback");const we=R(X),xe=()=>{!j.isInFallback||(S(null,G,ue,we,re,null,ne,o,g),$h(j,G))},ke=G.transition&&G.transition.mode==="out-in";ke&&(X.transition.afterLeave=xe),j.isInFallback=!0,I(X,re,null,!0),ke||xe()},move(G,K,X){j.activeBranch&&P(j.activeBranch,G,K,X),j.container=G},next(){return j.activeBranch&&R(j.activeBranch)},registerDep(G,K){const X=!!j.pendingBranch;X&&j.deps++;const re=G.vnode.el;G.asyncDep.catch(ue=>{fu(ue,G,0)}).then(ue=>{if(G.isUnmounted||j.isUnmounted||j.pendingId!==G.suspenseId)return;G.asyncResolved=!0;const{vnode:ne}=G;Yx(G,ue,!1),re&&(ne.el=re);const we=!re&&G.subTree.el;K(G,ne,z(re||G.subTree.el),re?null:R(G.subTree),j,d,g),we&&B(we),n1(G,ne.el),X&&--j.deps===0&&j.resolve()})},unmount(G,K){j.isUnmounted=!0,j.activeBranch&&I(j.activeBranch,r,G,K),j.pendingBranch&&I(j.pendingBranch,r,G,K)}};return j}function dF(t,e,r,n,s,u,d,o,g){const x=e.suspense=s1(e,n,r,t.parentNode,document.createElement("div"),null,s,u,d,o,!0),E=g(t,x.pendingBranch=e.ssContent,r,x,u,d);return x.deps===0&&x.resolve(),E}function fF(t){const{shapeFlag:e,children:r}=t,n=e&32;t.ssContent=sS(n?r.default:r),t.ssFallback=n?sS(r.fallback):ri(Dn)}function sS(t){let e;if(wr(t)){const r=au&&t._c;r&&(t._d=!1,kr()),t=t(),r&&(t._d=!0,e=ls,GC())}return sr(t)&&(t=nF(t)),t=Es(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(r=>r!==t)),t}function gC(t,e){e&&e.pendingBranch?sr(t)?e.effects.push(...t):e.effects.push(t):i1(t)}function $h(t,e){t.activeBranch=e;const{vnode:r,parentComponent:n}=t,s=r.el=e.el;n&&n.subTree===r&&(n.vnode.el=s,n1(n,s))}function sp(t,e){if(en){let r=en.provides;const n=en.parent&&en.parent.provides;n===r&&(r=en.provides=Object.create(n)),r[t]=e}}function co(t,e,r=!1){const n=en||_n;if(n){const s=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(s&&t in s)return s[t];if(arguments.length>1)return r&&wr(e)?e.call(n.proxy):e}}function pF(t,e){return $p(t,null,e)}function _C(t,e){return $p(t,null,{flush:"post"})}function mF(t,e){return $p(t,null,{flush:"sync"})}const Vg={};function Vh(t,e,r){return $p(t,e,r)}function $p(t,e,{immediate:r,deep:n,flush:s,onTrack:u,onTrigger:d}=ci){const o=en;let g,x=!1,E=!1;if(cn(t)?(g=()=>t.value,x=vp(t)):qc(t)?(g=()=>t,n=!0):sr(t)?(E=!0,x=t.some(G=>qc(G)||vp(G)),g=()=>t.map(G=>{if(cn(G))return G.value;if(qc(G))return Uc(G);if(wr(G))return Ta(G,o,2)})):wr(t)?e?g=()=>Ta(t,o,2):g=()=>{if(!(o&&o.isUnmounted))return S&&S(),Ss(t,o,3,[P])}:g=lo,e&&n){const G=g;g=()=>Uc(G())}let S,P=G=>{S=$.onStop=()=>{Ta(G,o,4)}},I;if(Kh)if(P=lo,e?r&&Ss(e,o,3,[g(),E?[]:void 0,P]):g(),s==="sync"){const G=tI();I=G.__watcherHandles||(G.__watcherHandles=[])}else return lo;let R=E?new Array(t.length).fill(Vg):Vg;const z=()=>{if(!!$.active)if(e){const G=$.run();(n||x||(E?G.some((K,X)=>Wh(K,R[X])):Wh(G,R)))&&(S&&S(),Ss(e,o,3,[G,R===Vg?void 0:E&&R[0]===Vg?[]:R,P]),R=G)}else $.run()};z.allowRecurse=!!e;let B;s==="sync"?B=z:s==="post"?B=()=>gn(z,o&&o.suspense):(z.pre=!0,o&&(z.id=o.uid),B=()=>Fy(z));const $=new jp(g,B);e?r?z():R=$.run():s==="post"?gn($.run.bind($),o&&o.suspense):$.run();const j=()=>{$.stop(),o&&o.scope&&Hb(o.scope.effects,$)};return I&&I.push(j),j}function gF(t,e,r){const n=this.proxy,s=Li(t)?t.includes(".")?yC(n,t):()=>n[t]:t.bind(n,n);let u;wr(e)?u=e:(u=e.handler,r=e);const d=en;kl(this);const o=$p(s,u.bind(n),r);return d?kl(d):Cl(),o}function yC(t,e){const r=e.split(".");return()=>{let n=t;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}function Uc(t,e){if(!fi(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),cn(t))Uc(t.value,e);else if(sr(t))for(let r=0;r<t.length;r++)Uc(t[r],e);else if(du(t)||Fh(t))t.forEach(r=>{Uc(r,e)});else if(GP(t))for(const r in t)Uc(t[r],e);return t}function o1(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Gp(()=>{t.isMounted=!0}),Uy(()=>{t.isUnmounting=!0}),t}const Bs=[Function,Array],_F={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bs,onEnter:Bs,onAfterEnter:Bs,onEnterCancelled:Bs,onBeforeLeave:Bs,onLeave:Bs,onAfterLeave:Bs,onLeaveCancelled:Bs,onBeforeAppear:Bs,onAppear:Bs,onAfterAppear:Bs,onAppearCancelled:Bs},setup(t,{slots:e}){const r=Vl(),n=o1();let s;return()=>{const u=e.default&&jy(e.default(),!0);if(!u||!u.length)return;let d=u[0];if(u.length>1){for(const z of u)if(z.type!==Dn){d=z;break}}const o=Xr(t),{mode:g}=o;if(n.isLeaving)return G0(d);const x=oS(d);if(!x)return G0(d);const E=Zh(x,o,n,r);su(x,E);const S=r.subTree,P=S&&oS(S);let I=!1;const{getTransitionKey:R}=x.type;if(R){const z=R();s===void 0?s=z:z!==s&&(s=z,I=!0)}if(P&&P.type!==Dn&&(!No(x,P)||I)){const z=Zh(P,o,n,r);if(su(P,z),g==="out-in")return n.isLeaving=!0,z.afterLeave=()=>{n.isLeaving=!1,r.update.active!==!1&&r.update()},G0(d);g==="in-out"&&x.type!==Dn&&(z.delayLeave=(B,$,j)=>{const G=vC(n,P);G[String(P.key)]=P,B._leaveCb=()=>{$(),B._leaveCb=void 0,delete E.delayedLeave},E.delayedLeave=j})}return d}}},a1=_F;function vC(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function Zh(t,e,r,n){const{appear:s,mode:u,persisted:d=!1,onBeforeEnter:o,onEnter:g,onAfterEnter:x,onEnterCancelled:E,onBeforeLeave:S,onLeave:P,onAfterLeave:I,onLeaveCancelled:R,onBeforeAppear:z,onAppear:B,onAfterAppear:$,onAppearCancelled:j}=e,G=String(t.key),K=vC(r,t),X=(ne,we)=>{ne&&Ss(ne,n,9,we)},re=(ne,we)=>{const xe=we[1];X(ne,we),sr(ne)?ne.every(ke=>ke.length<=1)&&xe():ne.length<=1&&xe()},ue={mode:u,persisted:d,beforeEnter(ne){let we=o;if(!r.isMounted)if(s)we=z||o;else return;ne._leaveCb&&ne._leaveCb(!0);const xe=K[G];xe&&No(t,xe)&&xe.el._leaveCb&&xe.el._leaveCb(),X(we,[ne])},enter(ne){let we=g,xe=x,ke=E;if(!r.isMounted)if(s)we=B||g,xe=$||x,ke=j||E;else return;let Ie=!1;const Fe=ne._enterCb=se=>{Ie||(Ie=!0,se?X(ke,[ne]):X(xe,[ne]),ue.delayedLeave&&ue.delayedLeave(),ne._enterCb=void 0)};we?re(we,[ne,Fe]):Fe()},leave(ne,we){const xe=String(t.key);if(ne._enterCb&&ne._enterCb(!0),r.isUnmounting)return we();X(S,[ne]);let ke=!1;const Ie=ne._leaveCb=Fe=>{ke||(ke=!0,we(),Fe?X(R,[ne]):X(I,[ne]),ne._leaveCb=void 0,K[xe]===t&&delete K[xe])};K[xe]=t,P?re(P,[ne,Ie]):Ie()},clone(ne){return Zh(ne,e,r,n)}};return ue}function G0(t){if(Up(t))return t=Uo(t),t.children=null,t}function oS(t){return Up(t)?t.children?t.children[0]:void 0:t}function su(t,e){t.shapeFlag&6&&t.component?su(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function jy(t,e=!1,r){let n=[],s=0;for(let u=0;u<t.length;u++){let d=t[u];const o=r==null?d.key:String(r)+String(d.key!=null?d.key:u);d.type===Ri?(d.patchFlag&128&&s++,n=n.concat(jy(d.children,e,o))):(e||d.type!==Dn)&&n.push(o!=null?Uo(d,{key:o}):d)}if(s>1)for(let u=0;u<n.length;u++)n[u].patchFlag=-2;return n}function Vp(t){return wr(t)?{setup:t,name:t.name}:t}const Xc=t=>!!t.type.__asyncLoader;function yF(t){wr(t)&&(t={loader:t});const{loader:e,loadingComponent:r,errorComponent:n,delay:s=200,timeout:u,suspensible:d=!0,onError:o}=t;let g=null,x,E=0;const S=()=>(E++,g=null,P()),P=()=>{let I;return g||(I=g=e().catch(R=>{if(R=R instanceof Error?R:new Error(String(R)),o)return new Promise((z,B)=>{o(R,()=>z(S()),()=>B(R),E+1)});throw R}).then(R=>I!==g&&g?g:(R&&(R.__esModule||R[Symbol.toStringTag]==="Module")&&(R=R.default),x=R,R)))};return Vp({name:"AsyncComponentWrapper",__asyncLoader:P,get __asyncResolved(){return x},setup(){const I=en;if(x)return()=>H0(x,I);const R=j=>{g=null,fu(j,I,13,!n)};if(d&&I.suspense||Kh)return P().then(j=>()=>H0(j,I)).catch(j=>(R(j),()=>n?ri(n,{error:j}):null));const z=Nh(!1),B=Nh(),$=Nh(!!s);return s&&setTimeout(()=>{$.value=!1},s),u!=null&&setTimeout(()=>{if(!z.value&&!B.value){const j=new Error(`Async component timed out after ${u}ms.`);R(j),B.value=j}},u),P().then(()=>{z.value=!0,I.parent&&Up(I.parent.vnode)&&Fy(I.parent.update)}).catch(j=>{R(j),B.value=j}),()=>{if(z.value&&x)return H0(x,I);if(B.value&&n)return ri(n,{error:B.value});if(r&&!$.value)return ri(r)}}})}function H0(t,e){const{ref:r,props:n,children:s,ce:u}=e.vnode,d=ri(t,n,s);return d.ref=r,d.ce=u,delete e.vnode.ce,d}const Up=t=>t.type.__isKeepAlive,vF={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const r=Vl(),n=r.ctx;if(!n.renderer)return()=>{const j=e.default&&e.default();return j&&j.length===1?j[0]:j};const s=new Map,u=new Set;let d=null;const o=r.suspense,{renderer:{p:g,m:x,um:E,o:{createElement:S}}}=n,P=S("div");n.activate=(j,G,K,X,re)=>{const ue=j.component;x(j,G,K,0,o),g(ue.vnode,j,G,K,ue,o,X,j.slotScopeIds,re),gn(()=>{ue.isDeactivated=!1,ue.a&&Bh(ue.a);const ne=j.props&&j.props.onVnodeMounted;ne&&ss(ne,ue.parent,j)},o)},n.deactivate=j=>{const G=j.component;x(j,P,null,1,o),gn(()=>{G.da&&Bh(G.da);const K=j.props&&j.props.onVnodeUnmounted;K&&ss(K,G.parent,j),G.isDeactivated=!0},o)};function I(j){W0(j),E(j,r,o,!0)}function R(j){s.forEach((G,K)=>{const X=Qx(G.type);X&&(!j||!j(X))&&z(K)})}function z(j){const G=s.get(j);!d||G.type!==d.type?I(G):d&&W0(d),s.delete(j),u.delete(j)}Vh(()=>[t.include,t.exclude],([j,G])=>{j&&R(K=>Xf(j,K)),G&&R(K=>!Xf(G,K))},{flush:"post",deep:!0});let B=null;const $=()=>{B!=null&&s.set(B,Z0(r.subTree))};return Gp($),Vy($),Uy(()=>{s.forEach(j=>{const{subTree:G,suspense:K}=r,X=Z0(G);if(j.type===X.type){W0(X);const re=X.component.da;re&&gn(re,K);return}I(j)})}),()=>{if(B=null,!e.default)return null;const j=e.default(),G=j[0];if(j.length>1)return d=null,j;if(!Ll(G)||!(G.shapeFlag&4)&&!(G.shapeFlag&128))return d=null,G;let K=Z0(G);const X=K.type,re=Qx(Xc(K)?K.type.__asyncResolved||{}:X),{include:ue,exclude:ne,max:we}=t;if(ue&&(!re||!Xf(ue,re))||ne&&re&&Xf(ne,re))return d=K,G;const xe=K.key==null?X:K.key,ke=s.get(xe);return K.el&&(K=Uo(K),G.shapeFlag&128&&(G.ssContent=K)),B=xe,ke?(K.el=ke.el,K.component=ke.component,K.transition&&su(K,K.transition),K.shapeFlag|=512,u.delete(xe),u.add(xe)):(u.add(xe),we&&u.size>parseInt(we,10)&&z(u.values().next().value)),K.shapeFlag|=256,d=K,mC(G.type)?G:K}}},xF=vF;function Xf(t,e){return sr(t)?t.some(r=>Xf(r,e)):Li(t)?t.split(",").includes(e):t.test?t.test(e):!1}function xC(t,e){wC(t,"a",e)}function bC(t,e){wC(t,"da",e)}function wC(t,e,r=en){const n=t.__wdc||(t.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if($y(e,n,r),r){let s=r.parent;for(;s&&s.parent;)Up(s.parent.vnode)&&bF(n,e,r,s),s=s.parent}}function bF(t,e,r,n){const s=$y(e,t,n,!0);Gy(()=>{Hb(n[e],s)},r)}function W0(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Z0(t){return t.shapeFlag&128?t.ssContent:t}function $y(t,e,r=en,n=!1){if(r){const s=r[t]||(r[t]=[]),u=e.__weh||(e.__weh=(...d)=>{if(r.isUnmounted)return;ud(),kl(r);const o=Ss(e,r,t,d);return Cl(),hd(),o});return n?s.unshift(u):s.push(u),u}}const Oa=t=>(e,r=en)=>(!Kh||t==="sp")&&$y(t,(...n)=>e(...n),r),EC=Oa("bm"),Gp=Oa("m"),TC=Oa("bu"),Vy=Oa("u"),Uy=Oa("bum"),Gy=Oa("um"),SC=Oa("sp"),AC=Oa("rtg"),PC=Oa("rtc");function CC(t,e=en){$y("ec",t,e)}function b_(t,e){const r=_n;if(r===null)return t;const n=Wy(r)||r.proxy,s=t.dirs||(t.dirs=[]);for(let u=0;u<e.length;u++){let[d,o,g,x=ci]=e[u];d&&(wr(d)&&(d={mounted:d,updated:d}),d.deep&&Uc(o),s.push({dir:d,instance:n,value:o,oldValue:void 0,arg:g,modifiers:x}))}return t}function zo(t,e,r,n){const s=t.dirs,u=e&&e.dirs;for(let d=0;d<s.length;d++){const o=s[d];u&&(o.oldValue=u[d].value);let g=o.dir[n];g&&(ud(),Ss(g,r,8,[t.el,o,t,e]),hd())}}const l1="components",wF="directives";function ga(t,e){return c1(l1,t,!0,e)||t}const IC=Symbol();function w_(t){return Li(t)?c1(l1,t,!1)||t:t||IC}function MC(t){return c1(wF,t)}function c1(t,e,r=!0,n=!1){const s=_n||en;if(s){const u=s.type;if(t===l1){const o=Qx(u,!1);if(o&&(o===e||o===cs(e)||o===Np(cs(e))))return u}const d=aS(s[t]||u[t],e)||aS(s.appContext[t],e);return!d&&n?u:d}}function aS(t,e){return t&&(t[e]||t[cs(e)]||t[Np(cs(e))])}function Gc(t,e,r,n){let s;const u=r&&r[n];if(sr(t)||Li(t)){s=new Array(t.length);for(let d=0,o=t.length;d<o;d++)s[d]=e(t[d],d,void 0,u&&u[d])}else if(typeof t=="number"){s=new Array(t);for(let d=0;d<t;d++)s[d]=e(d+1,d,void 0,u&&u[d])}else if(fi(t))if(t[Symbol.iterator])s=Array.from(t,(d,o)=>e(d,o,void 0,u&&u[o]));else{const d=Object.keys(t);s=new Array(d.length);for(let o=0,g=d.length;o<g;o++){const x=d[o];s[o]=e(t[x],x,o,u&&u[o])}}else s=[];return r&&(r[n]=s),s}function EF(t,e){for(let r=0;r<e.length;r++){const n=e[r];if(sr(n))for(let s=0;s<n.length;s++)t[n[s].name]=n[s].fn;else n&&(t[n.name]=n.key?(...s)=>{const u=n.fn(...s);return u&&(u.key=n.key),u}:n.fn)}return t}function $s(t,e,r={},n,s){if(_n.isCE||_n.parent&&Xc(_n.parent)&&_n.parent.isCE)return e!=="default"&&(r.name=e),ri("slot",r,n&&n());let u=t[e];u&&u._c&&(u._d=!1),kr();const d=u&&OC(u(r)),o=os(Ri,{key:r.key||d&&d.key||`_${e}`},d||(n?n():[]),d&&t._===1?64:-2);return!s&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),u&&u._c&&(u._d=!0),o}function OC(t){return t.some(e=>Ll(e)?!(e.type===Dn||e.type===Ri&&!OC(e.children)):!0)?t:null}function DC(t,e){const r={};for(const n in t)r[e&&/[A-Z]/.test(n)?`on:${n}`:np(n)]=t[n];return r}const Gx=t=>t?KC(t)?Wy(t)||t.proxy:Gx(t.parent):null,op=$i(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Gx(t.parent),$root:t=>Gx(t.root),$emit:t=>t.emit,$options:t=>u1(t),$forceUpdate:t=>t.f||(t.f=()=>Fy(t.update)),$nextTick:t=>t.n||(t.n=zy.bind(t.proxy)),$watch:t=>gF.bind(t)}),q0=(t,e)=>t!==ci&&!t.__isScriptSetup&&qr(t,e),Hx={get({_:t},e){const{ctx:r,setupState:n,data:s,props:u,accessCache:d,type:o,appContext:g}=t;let x;if(e[0]!=="$"){const I=d[e];if(I!==void 0)switch(I){case 1:return n[e];case 2:return s[e];case 4:return r[e];case 3:return u[e]}else{if(q0(n,e))return d[e]=1,n[e];if(s!==ci&&qr(s,e))return d[e]=2,s[e];if((x=t.propsOptions[0])&&qr(x,e))return d[e]=3,u[e];if(r!==ci&&qr(r,e))return d[e]=4,r[e];Wx&&(d[e]=0)}}const E=op[e];let S,P;if(E)return e==="$attrs"&&As(t,"get",e),E(t);if((S=o.__cssModules)&&(S=S[e]))return S;if(r!==ci&&qr(r,e))return d[e]=4,r[e];if(P=g.config.globalProperties,qr(P,e))return P[e]},set({_:t},e,r){const{data:n,setupState:s,ctx:u}=t;return q0(s,e)?(s[e]=r,!0):n!==ci&&qr(n,e)?(n[e]=r,!0):qr(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(u[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:s,propsOptions:u}},d){let o;return!!r[d]||t!==ci&&qr(t,d)||q0(e,d)||(o=u[0])&&qr(o,d)||qr(n,d)||qr(op,d)||qr(s.config.globalProperties,d)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:qr(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}},TF=$i({},Hx,{get(t,e){if(e!==Symbol.unscopables)return Hx.get(t,e,t)},has(t,e){return e[0]!=="_"&&!Kk(e)}});let Wx=!0;function SF(t){const e=u1(t),r=t.proxy,n=t.ctx;Wx=!1,e.beforeCreate&&lS(e.beforeCreate,t,"bc");const{data:s,computed:u,methods:d,watch:o,provide:g,inject:x,created:E,beforeMount:S,mounted:P,beforeUpdate:I,updated:R,activated:z,deactivated:B,beforeDestroy:$,beforeUnmount:j,destroyed:G,unmounted:K,render:X,renderTracked:re,renderTriggered:ue,errorCaptured:ne,serverPrefetch:we,expose:xe,inheritAttrs:ke,components:Ie,directives:Fe,filters:se}=e;if(x&&AF(x,n,null,t.appContext.config.unwrapInjectedRef),d)for(const Je in d){const ut=d[Je];wr(ut)&&(n[Je]=ut.bind(r))}if(s){const Je=s.call(r,r);fi(Je)&&(t.data=Rl(Je))}if(Wx=!0,u)for(const Je in u){const ut=u[Je],ht=wr(ut)?ut.bind(r,r):wr(ut.get)?ut.get.bind(r,r):lo,Et=!wr(ut)&&wr(ut.set)?ut.set.bind(r):lo,Qt=Ts({get:ht,set:Et});Object.defineProperty(n,Je,{enumerable:!0,configurable:!0,get:()=>Qt.value,set:Nt=>Qt.value=Nt})}if(o)for(const Je in o)RC(o[Je],n,r,Je);if(g){const Je=wr(g)?g.call(r):g;Reflect.ownKeys(Je).forEach(ut=>{sp(ut,Je[ut])})}E&&lS(E,t,"c");function Ve(Je,ut){sr(ut)?ut.forEach(ht=>Je(ht.bind(r))):ut&&Je(ut.bind(r))}if(Ve(EC,S),Ve(Gp,P),Ve(TC,I),Ve(Vy,R),Ve(xC,z),Ve(bC,B),Ve(CC,ne),Ve(PC,re),Ve(AC,ue),Ve(Uy,j),Ve(Gy,K),Ve(SC,we),sr(xe))if(xe.length){const Je=t.exposed||(t.exposed={});xe.forEach(ut=>{Object.defineProperty(Je,ut,{get:()=>r[ut],set:ht=>r[ut]=ht})})}else t.exposed||(t.exposed={});X&&t.render===lo&&(t.render=X),ke!=null&&(t.inheritAttrs=ke),Ie&&(t.components=Ie),Fe&&(t.directives=Fe)}function AF(t,e,r=lo,n=!1){sr(t)&&(t=Zx(t));for(const s in t){const u=t[s];let d;fi(u)?"default"in u?d=co(u.from||s,u.default,!0):d=co(u.from||s):d=co(u),cn(d)&&n?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>d.value,set:o=>d.value=o}):e[s]=d}}function lS(t,e,r){Ss(sr(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function RC(t,e,r,n){const s=n.includes(".")?yC(r,n):()=>r[n];if(Li(t)){const u=e[t];wr(u)&&Vh(s,u)}else if(wr(t))Vh(s,t.bind(r));else if(fi(t))if(sr(t))t.forEach(u=>RC(u,e,r,n));else{const u=wr(t.handler)?t.handler.bind(r):e[t.handler];wr(u)&&Vh(s,u,t)}}function u1(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:s,optionsCache:u,config:{optionMergeStrategies:d}}=t.appContext,o=u.get(e);let g;return o?g=o:!s.length&&!r&&!n?g=e:(g={},s.length&&s.forEach(x=>V_(g,x,d,!0)),V_(g,e,d)),fi(e)&&u.set(e,g),g}function V_(t,e,r,n=!1){const{mixins:s,extends:u}=e;u&&V_(t,u,r,!0),s&&s.forEach(d=>V_(t,d,r,!0));for(const d in e)if(!(n&&d==="expose")){const o=PF[d]||r&&r[d];t[d]=o?o(t[d],e[d]):e[d]}return t}const PF={data:cS,props:Bc,emits:Bc,methods:Bc,computed:Bc,beforeCreate:Nn,created:Nn,beforeMount:Nn,mounted:Nn,beforeUpdate:Nn,updated:Nn,beforeDestroy:Nn,beforeUnmount:Nn,destroyed:Nn,unmounted:Nn,activated:Nn,deactivated:Nn,errorCaptured:Nn,serverPrefetch:Nn,components:Bc,directives:Bc,watch:IF,provide:cS,inject:CF};function cS(t,e){return e?t?function(){return $i(wr(t)?t.call(this,this):t,wr(e)?e.call(this,this):e)}:e:t}function CF(t,e){return Bc(Zx(t),Zx(e))}function Zx(t){if(sr(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function Nn(t,e){return t?[...new Set([].concat(t,e))]:e}function Bc(t,e){return t?$i($i(Object.create(null),t),e):e}function IF(t,e){if(!t)return e;if(!e)return t;const r=$i(Object.create(null),t);for(const n in e)r[n]=Nn(t[n],e[n]);return r}function MF(t,e,r,n=!1){const s={},u={};j_(u,Hy,1),t.propsDefaults=Object.create(null),LC(t,e,s,u);for(const d in t.propsOptions[0])d in s||(s[d]=void 0);r?t.props=n?s:sC(s):t.type.props?t.props=s:t.props=u,t.attrs=u}function OF(t,e,r,n){const{props:s,attrs:u,vnode:{patchFlag:d}}=t,o=Xr(s),[g]=t.propsOptions;let x=!1;if((n||d>0)&&!(d&16)){if(d&8){const E=t.vnode.dynamicProps;for(let S=0;S<E.length;S++){let P=E[S];if(By(t.emitsOptions,P))continue;const I=e[P];if(g)if(qr(u,P))I!==u[P]&&(u[P]=I,x=!0);else{const R=cs(P);s[R]=qx(g,o,R,I,t,!1)}else I!==u[P]&&(u[P]=I,x=!0)}}}else{LC(t,e,s,u)&&(x=!0);let E;for(const S in o)(!e||!qr(e,S)&&((E=Us(S))===S||!qr(e,E)))&&(g?r&&(r[S]!==void 0||r[E]!==void 0)&&(s[S]=qx(g,o,S,void 0,t,!0)):delete s[S]);if(u!==o)for(const S in u)(!e||!qr(e,S)&&!0)&&(delete u[S],x=!0)}x&&Ia(t,"set","$attrs")}function LC(t,e,r,n){const[s,u]=t.propsOptions;let d=!1,o;if(e)for(let g in e){if(ip(g))continue;const x=e[g];let E;s&&qr(s,E=cs(g))?!u||!u.includes(E)?r[E]=x:(o||(o={}))[E]=x:By(t.emitsOptions,g)||(!(g in n)||x!==n[g])&&(n[g]=x,d=!0)}if(u){const g=Xr(r),x=o||ci;for(let E=0;E<u.length;E++){const S=u[E];r[S]=qx(s,g,S,x[S],t,!qr(x,S))}}return d}function qx(t,e,r,n,s,u){const d=t[r];if(d!=null){const o=qr(d,"default");if(o&&n===void 0){const g=d.default;if(d.type!==Function&&wr(g)){const{propsDefaults:x}=s;r in x?n=x[r]:(kl(s),n=x[r]=g.call(null,e),Cl())}else n=g}d[0]&&(u&&!o?n=!1:d[1]&&(n===""||n===Us(r))&&(n=!0))}return n}function kC(t,e,r=!1){const n=e.propsCache,s=n.get(t);if(s)return s;const u=t.props,d={},o=[];let g=!1;if(!wr(t)){const E=S=>{g=!0;const[P,I]=kC(S,e,!0);$i(d,P),I&&o.push(...I)};!r&&e.mixins.length&&e.mixins.forEach(E),t.extends&&E(t.extends),t.mixins&&t.mixins.forEach(E)}if(!u&&!g)return fi(t)&&n.set(t,zh),zh;if(sr(u))for(let E=0;E<u.length;E++){const S=cs(u[E]);uS(S)&&(d[S]=ci)}else if(u)for(const E in u){const S=cs(E);if(uS(S)){const P=u[E],I=d[S]=sr(P)||wr(P)?{type:P}:Object.assign({},P);if(I){const R=fS(Boolean,I.type),z=fS(String,I.type);I[0]=R>-1,I[1]=z<0||R<z,(R>-1||qr(I,"default"))&&o.push(S)}}}const x=[d,o];return fi(t)&&n.set(t,x),x}function uS(t){return t[0]!=="$"}function hS(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function dS(t,e){return hS(t)===hS(e)}function fS(t,e){return sr(e)?e.findIndex(r=>dS(r,t)):wr(e)&&dS(e,t)?0:-1}const zC=t=>t[0]==="_"||t==="$stable",h1=t=>sr(t)?t.map(Es):[Es(t)],DF=(t,e,r)=>{if(e._n)return e;const n=Fo((...s)=>h1(e(...s)),r);return n._c=!1,n},FC=(t,e,r)=>{const n=t._ctx;for(const s in t){if(zC(s))continue;const u=t[s];if(wr(u))e[s]=DF(s,u,n);else if(u!=null){const d=h1(u);e[s]=()=>d}}},BC=(t,e)=>{const r=h1(e);t.slots.default=()=>r},RF=(t,e)=>{if(t.vnode.shapeFlag&32){const r=e._;r?(t.slots=Xr(e),j_(e,"_",r)):FC(e,t.slots={})}else t.slots={},e&&BC(t,e);j_(t.slots,Hy,1)},LF=(t,e,r)=>{const{vnode:n,slots:s}=t;let u=!0,d=ci;if(n.shapeFlag&32){const o=e._;o?r&&o===1?u=!1:($i(s,e),!r&&o===1&&delete s._):(u=!e.$stable,FC(e,s)),d=e}else e&&(BC(t,e),d={default:1});if(u)for(const o in s)!zC(o)&&!(o in d)&&delete s[o]};function NC(){return{app:null,config:{isNativeTag:iz,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let kF=0;function zF(t,e){return function(n,s=null){wr(n)||(n=Object.assign({},n)),s!=null&&!fi(s)&&(s=null);const u=NC(),d=new Set;let o=!1;const g=u.app={_uid:kF++,_component:n,_props:s,_container:null,_context:u,_instance:null,version:iI,get config(){return u.config},set config(x){},use(x,...E){return d.has(x)||(x&&wr(x.install)?(d.add(x),x.install(g,...E)):wr(x)&&(d.add(x),x(g,...E))),g},mixin(x){return u.mixins.includes(x)||u.mixins.push(x),g},component(x,E){return E?(u.components[x]=E,g):u.components[x]},directive(x,E){return E?(u.directives[x]=E,g):u.directives[x]},mount(x,E,S){if(!o){const P=ri(n,s);return P.appContext=u,E&&e?e(P,x):t(P,x,S),o=!0,g._container=x,x.__vue_app__=g,Wy(P.component)||P.component.proxy}},unmount(){o&&(t(null,g._container),delete g._container.__vue_app__)},provide(x,E){return u.provides[x]=E,g}};return g}}function U_(t,e,r,n,s=!1){if(sr(t)){t.forEach((P,I)=>U_(P,e&&(sr(e)?e[I]:e),r,n,s));return}if(Xc(n)&&!s)return;const u=n.shapeFlag&4?Wy(n.component)||n.component.proxy:n.el,d=s?null:u,{i:o,r:g}=t,x=e&&e.r,E=o.refs===ci?o.refs={}:o.refs,S=o.setupState;if(x!=null&&x!==g&&(Li(x)?(E[x]=null,qr(S,x)&&(S[x]=null)):cn(x)&&(x.value=null)),wr(g))Ta(g,o,12,[d,E]);else{const P=Li(g),I=cn(g);if(P||I){const R=()=>{if(t.f){const z=P?qr(S,g)?S[g]:E[g]:g.value;s?sr(z)&&Hb(z,u):sr(z)?z.includes(u)||z.push(u):P?(E[g]=[u],qr(S,g)&&(S[g]=E[g])):(g.value=[u],t.k&&(E[t.k]=g.value))}else P?(E[g]=d,qr(S,g)&&(S[g]=d)):I&&(g.value=d,t.k&&(E[t.k]=d))};d?(R.id=-1,gn(R,r)):R()}}}let dl=!1;const Ug=t=>/svg/.test(t.namespaceURI)&&t.tagName!=="foreignObject",Gg=t=>t.nodeType===8;function FF(t){const{mt:e,p:r,o:{patchProp:n,createText:s,nextSibling:u,parentNode:d,remove:o,insert:g,createComment:x}}=t,E=($,j)=>{if(!j.hasChildNodes()){r(null,$,j),$_(),j._vnode=$;return}dl=!1,S(j.firstChild,$,null,null,null),$_(),j._vnode=$,dl&&console.error("Hydration completed but contains mismatches.")},S=($,j,G,K,X,re=!1)=>{const ue=Gg($)&&$.data==="[",ne=()=>z($,j,G,K,X,ue),{type:we,ref:xe,shapeFlag:ke,patchFlag:Ie}=j;let Fe=$.nodeType;j.el=$,Ie===-2&&(re=!1,j.dynamicChildren=null);let se=null;switch(we){case ou:Fe!==3?j.children===""?(g(j.el=s(""),d($),$),se=$):se=ne():($.data!==j.children&&(dl=!0,$.data=j.children),se=u($));break;case Dn:Fe!==8||ue?se=ne():se=u($);break;case Yc:if(ue&&($=u($),Fe=$.nodeType),Fe===1||Fe===3){se=$;const Be=!j.children.length;for(let Ve=0;Ve<j.staticCount;Ve++)Be&&(j.children+=se.nodeType===1?se.outerHTML:se.data),Ve===j.staticCount-1&&(j.anchor=se),se=u(se);return ue?u(se):se}else ne();break;case Ri:ue?se=R($,j,G,K,X,re):se=ne();break;default:if(ke&1)Fe!==1||j.type.toLowerCase()!==$.tagName.toLowerCase()?se=ne():se=P($,j,G,K,X,re);else if(ke&6){j.slotScopeIds=X;const Be=d($);if(e(j,Be,null,G,K,Ug(Be),re),se=ue?B($):u($),se&&Gg(se)&&se.data==="teleport end"&&(se=u(se)),Xc(j)){let Ve;ue?(Ve=ri(Ri),Ve.anchor=se?se.previousSibling:Be.lastChild):Ve=$.nodeType===3?qh(""):ri("div"),Ve.el=$,j.component.subTree=Ve}}else ke&64?Fe!==8?se=ne():se=j.type.hydrate($,j,G,K,X,re,t,I):ke&128&&(se=j.type.hydrate($,j,G,K,Ug(d($)),X,re,t,S))}return xe!=null&&U_(xe,null,K,j),se},P=($,j,G,K,X,re)=>{re=re||!!j.dynamicChildren;const{type:ue,props:ne,patchFlag:we,shapeFlag:xe,dirs:ke}=j,Ie=ue==="input"&&ke||ue==="option";if(Ie||we!==-1){if(ke&&zo(j,null,G,"created"),ne)if(Ie||!re||we&48)for(const se in ne)(Ie&&se.endsWith("value")||Fp(se)&&!ip(se))&&n($,se,null,ne[se],!1,void 0,G);else ne.onClick&&n($,"onClick",null,ne.onClick,!1,void 0,G);let Fe;if((Fe=ne&&ne.onVnodeBeforeMount)&&ss(Fe,G,j),ke&&zo(j,null,G,"beforeMount"),((Fe=ne&&ne.onVnodeMounted)||ke)&&gC(()=>{Fe&&ss(Fe,G,j),ke&&zo(j,null,G,"mounted")},K),xe&16&&!(ne&&(ne.innerHTML||ne.textContent))){let se=I($.firstChild,j,$,G,K,X,re);for(;se;){dl=!0;const Be=se;se=se.nextSibling,o(Be)}}else xe&8&&$.textContent!==j.children&&(dl=!0,$.textContent=j.children)}return $.nextSibling},I=($,j,G,K,X,re,ue)=>{ue=ue||!!j.dynamicChildren;const ne=j.children,we=ne.length;for(let xe=0;xe<we;xe++){const ke=ue?ne[xe]:ne[xe]=Es(ne[xe]);if($)$=S($,ke,K,X,re,ue);else{if(ke.type===ou&&!ke.children)continue;dl=!0,r(null,ke,G,null,K,X,Ug(G),re)}}return $},R=($,j,G,K,X,re)=>{const{slotScopeIds:ue}=j;ue&&(X=X?X.concat(ue):ue);const ne=d($),we=I(u($),j,ne,G,K,X,re);return we&&Gg(we)&&we.data==="]"?u(j.anchor=we):(dl=!0,g(j.anchor=x("]"),ne,we),we)},z=($,j,G,K,X,re)=>{if(dl=!0,j.el=null,re){const we=B($);for(;;){const xe=u($);if(xe&&xe!==we)o(xe);else break}}const ue=u($),ne=d($);return o($),r(null,j,ne,ue,G,K,Ug(ne),X),ue},B=$=>{let j=0;for(;$;)if($=u($),$&&Gg($)&&($.data==="["&&j++,$.data==="]")){if(j===0)return u($);j--}return $};return[E,S]}const gn=gC;function jC(t){return VC(t)}function $C(t){return VC(t,FF)}function VC(t,e){const r=cz();r.__VUE__=!0;const{insert:n,remove:s,patchProp:u,createElement:d,createText:o,createComment:g,setText:x,setElementText:E,parentNode:S,nextSibling:P,setScopeId:I=lo,insertStaticContent:R}=t,z=(ye,Me,$e,it=null,ot=null,st=null,gt=!1,lt=null,Ye=!!Me.dynamicChildren)=>{if(ye===Me)return;ye&&!No(ye,Me)&&(it=ft(ye),Nt(ye,ot,st,!0),ye=null),Me.patchFlag===-2&&(Ye=!1,Me.dynamicChildren=null);const{type:pt,ref:Tt,shapeFlag:St}=Me;switch(pt){case ou:B(ye,Me,$e,it);break;case Dn:$(ye,Me,$e,it);break;case Yc:ye==null&&j(Me,$e,it,gt);break;case Ri:Ie(ye,Me,$e,it,ot,st,gt,lt,Ye);break;default:St&1?X(ye,Me,$e,it,ot,st,gt,lt,Ye):St&6?Fe(ye,Me,$e,it,ot,st,gt,lt,Ye):(St&64||St&128)&&pt.process(ye,Me,$e,it,ot,st,gt,lt,Ye,Ht)}Tt!=null&&ot&&U_(Tt,ye&&ye.ref,st,Me||ye,!Me)},B=(ye,Me,$e,it)=>{if(ye==null)n(Me.el=o(Me.children),$e,it);else{const ot=Me.el=ye.el;Me.children!==ye.children&&x(ot,Me.children)}},$=(ye,Me,$e,it)=>{ye==null?n(Me.el=g(Me.children||""),$e,it):Me.el=ye.el},j=(ye,Me,$e,it)=>{[ye.el,ye.anchor]=R(ye.children,Me,$e,it,ye.el,ye.anchor)},G=({el:ye,anchor:Me},$e,it)=>{let ot;for(;ye&&ye!==Me;)ot=P(ye),n(ye,$e,it),ye=ot;n(Me,$e,it)},K=({el:ye,anchor:Me})=>{let $e;for(;ye&&ye!==Me;)$e=P(ye),s(ye),ye=$e;s(Me)},X=(ye,Me,$e,it,ot,st,gt,lt,Ye)=>{gt=gt||Me.type==="svg",ye==null?re(Me,$e,it,ot,st,gt,lt,Ye):we(ye,Me,ot,st,gt,lt,Ye)},re=(ye,Me,$e,it,ot,st,gt,lt)=>{let Ye,pt;const{type:Tt,props:St,shapeFlag:zt,transition:Yt,dirs:ur}=ye;if(Ye=ye.el=d(ye.type,st,St&&St.is,St),zt&8?E(Ye,ye.children):zt&16&&ne(ye.children,Ye,null,it,ot,st&&Tt!=="foreignObject",gt,lt),ur&&zo(ye,null,it,"created"),St){for(const fr in St)fr!=="value"&&!ip(fr)&&u(Ye,fr,null,St[fr],st,ye.children,it,ot,tt);"value"in St&&u(Ye,"value",null,St.value),(pt=St.onVnodeBeforeMount)&&ss(pt,it,ye)}ue(Ye,ye,ye.scopeId,gt,it),ur&&zo(ye,null,it,"beforeMount");const xr=(!ot||ot&&!ot.pendingBranch)&&Yt&&!Yt.persisted;xr&&Yt.beforeEnter(Ye),n(Ye,Me,$e),((pt=St&&St.onVnodeMounted)||xr||ur)&&gn(()=>{pt&&ss(pt,it,ye),xr&&Yt.enter(Ye),ur&&zo(ye,null,it,"mounted")},ot)},ue=(ye,Me,$e,it,ot)=>{if($e&&I(ye,$e),it)for(let st=0;st<it.length;st++)I(ye,it[st]);if(ot){let st=ot.subTree;if(Me===st){const gt=ot.vnode;ue(ye,gt,gt.scopeId,gt.slotScopeIds,ot.parent)}}},ne=(ye,Me,$e,it,ot,st,gt,lt,Ye=0)=>{for(let pt=Ye;pt<ye.length;pt++){const Tt=ye[pt]=lt?yl(ye[pt]):Es(ye[pt]);z(null,Tt,Me,$e,it,ot,st,gt,lt)}},we=(ye,Me,$e,it,ot,st,gt)=>{const lt=Me.el=ye.el;let{patchFlag:Ye,dynamicChildren:pt,dirs:Tt}=Me;Ye|=ye.patchFlag&16;const St=ye.props||ci,zt=Me.props||ci;let Yt;$e&&Mc($e,!1),(Yt=zt.onVnodeBeforeUpdate)&&ss(Yt,$e,Me,ye),Tt&&zo(Me,ye,$e,"beforeUpdate"),$e&&Mc($e,!0);const ur=ot&&Me.type!=="foreignObject";if(pt?xe(ye.dynamicChildren,pt,lt,$e,it,ur,st):gt||ut(ye,Me,lt,null,$e,it,ur,st,!1),Ye>0){if(Ye&16)ke(lt,Me,St,zt,$e,it,ot);else if(Ye&2&&St.class!==zt.class&&u(lt,"class",null,zt.class,ot),Ye&4&&u(lt,"style",St.style,zt.style,ot),Ye&8){const xr=Me.dynamicProps;for(let fr=0;fr<xr.length;fr++){const br=xr[fr],Qr=St[br],Wi=zt[br];(Wi!==Qr||br==="value")&&u(lt,br,Qr,Wi,ot,ye.children,$e,it,tt)}}Ye&1&&ye.children!==Me.children&&E(lt,Me.children)}else!gt&&pt==null&&ke(lt,Me,St,zt,$e,it,ot);((Yt=zt.onVnodeUpdated)||Tt)&&gn(()=>{Yt&&ss(Yt,$e,Me,ye),Tt&&zo(Me,ye,$e,"updated")},it)},xe=(ye,Me,$e,it,ot,st,gt)=>{for(let lt=0;lt<Me.length;lt++){const Ye=ye[lt],pt=Me[lt],Tt=Ye.el&&(Ye.type===Ri||!No(Ye,pt)||Ye.shapeFlag&70)?S(Ye.el):$e;z(Ye,pt,Tt,null,it,ot,st,gt,!0)}},ke=(ye,Me,$e,it,ot,st,gt)=>{if($e!==it){if($e!==ci)for(const lt in $e)!ip(lt)&&!(lt in it)&&u(ye,lt,$e[lt],null,gt,Me.children,ot,st,tt);for(const lt in it){if(ip(lt))continue;const Ye=it[lt],pt=$e[lt];Ye!==pt&&lt!=="value"&&u(ye,lt,pt,Ye,gt,Me.children,ot,st,tt)}"value"in it&&u(ye,"value",$e.value,it.value)}},Ie=(ye,Me,$e,it,ot,st,gt,lt,Ye)=>{const pt=Me.el=ye?ye.el:o(""),Tt=Me.anchor=ye?ye.anchor:o("");let{patchFlag:St,dynamicChildren:zt,slotScopeIds:Yt}=Me;Yt&&(lt=lt?lt.concat(Yt):Yt),ye==null?(n(pt,$e,it),n(Tt,$e,it),ne(Me.children,$e,Tt,ot,st,gt,lt,Ye)):St>0&&St&64&&zt&&ye.dynamicChildren?(xe(ye.dynamicChildren,zt,$e,ot,st,gt,lt),(Me.key!=null||ot&&Me===ot.subTree)&&d1(ye,Me,!0)):ut(ye,Me,$e,Tt,ot,st,gt,lt,Ye)},Fe=(ye,Me,$e,it,ot,st,gt,lt,Ye)=>{Me.slotScopeIds=lt,ye==null?Me.shapeFlag&512?ot.ctx.activate(Me,$e,it,gt,Ye):se(Me,$e,it,ot,st,gt,Ye):Be(ye,Me,Ye)},se=(ye,Me,$e,it,ot,st,gt)=>{const lt=ye.component=qC(ye,it,ot);if(Up(ye)&&(lt.ctx.renderer=Ht),XC(lt),lt.asyncDep){if(ot&&ot.registerDep(lt,Ve),!ye.el){const Ye=lt.subTree=ri(Dn);$(null,Ye,Me,$e)}return}Ve(lt,ye,Me,$e,ot,st,gt)},Be=(ye,Me,$e)=>{const it=Me.component=ye.component;if(aF(ye,Me,$e))if(it.asyncDep&&!it.asyncResolved){Je(it,Me,$e);return}else it.next=Me,Jz(it.update),it.update();else Me.el=ye.el,it.vnode=Me},Ve=(ye,Me,$e,it,ot,st,gt)=>{const lt=()=>{if(ye.isMounted){let{next:Tt,bu:St,u:zt,parent:Yt,vnode:ur}=ye,xr=Tt,fr;Mc(ye,!1),Tt?(Tt.el=ur.el,Je(ye,Tt,gt)):Tt=ur,St&&Bh(St),(fr=Tt.props&&Tt.props.onVnodeBeforeUpdate)&&ss(fr,Yt,Tt,ur),Mc(ye,!0);const br=x_(ye),Qr=ye.subTree;ye.subTree=br,z(Qr,br,S(Qr.el),ft(Qr),ye,ot,st),Tt.el=br.el,xr===null&&n1(ye,br.el),zt&&gn(zt,ot),(fr=Tt.props&&Tt.props.onVnodeUpdated)&&gn(()=>ss(fr,Yt,Tt,ur),ot)}else{let Tt;const{el:St,props:zt}=Me,{bm:Yt,m:ur,parent:xr}=ye,fr=Xc(Me);if(Mc(ye,!1),Yt&&Bh(Yt),!fr&&(Tt=zt&&zt.onVnodeBeforeMount)&&ss(Tt,xr,Me),Mc(ye,!0),St&&Lt){const br=()=>{ye.subTree=x_(ye),Lt(St,ye.subTree,ye,ot,null)};fr?Me.type.__asyncLoader().then(()=>!ye.isUnmounted&&br()):br()}else{const br=ye.subTree=x_(ye);z(null,br,$e,it,ye,ot,st),Me.el=br.el}if(ur&&gn(ur,ot),!fr&&(Tt=zt&&zt.onVnodeMounted)){const br=Me;gn(()=>ss(Tt,xr,br),ot)}(Me.shapeFlag&256||xr&&Xc(xr.vnode)&&xr.vnode.shapeFlag&256)&&ye.a&&gn(ye.a,ot),ye.isMounted=!0,Me=$e=it=null}},Ye=ye.effect=new jp(lt,()=>Fy(pt),ye.scope),pt=ye.update=()=>Ye.run();pt.id=ye.uid,Mc(ye,!0),pt()},Je=(ye,Me,$e)=>{Me.component=ye;const it=ye.vnode.props;ye.vnode=Me,ye.next=null,OF(ye,Me.props,it,$e),LF(ye,Me.children,$e),ud(),iS(),hd()},ut=(ye,Me,$e,it,ot,st,gt,lt,Ye=!1)=>{const pt=ye&&ye.children,Tt=ye?ye.shapeFlag:0,St=Me.children,{patchFlag:zt,shapeFlag:Yt}=Me;if(zt>0){if(zt&128){Et(pt,St,$e,it,ot,st,gt,lt,Ye);return}else if(zt&256){ht(pt,St,$e,it,ot,st,gt,lt,Ye);return}}Yt&8?(Tt&16&&tt(pt,ot,st),St!==pt&&E($e,St)):Tt&16?Yt&16?Et(pt,St,$e,it,ot,st,gt,lt,Ye):tt(pt,ot,st,!0):(Tt&8&&E($e,""),Yt&16&&ne(St,$e,it,ot,st,gt,lt,Ye))},ht=(ye,Me,$e,it,ot,st,gt,lt,Ye)=>{ye=ye||zh,Me=Me||zh;const pt=ye.length,Tt=Me.length,St=Math.min(pt,Tt);let zt;for(zt=0;zt<St;zt++){const Yt=Me[zt]=Ye?yl(Me[zt]):Es(Me[zt]);z(ye[zt],Yt,$e,null,ot,st,gt,lt,Ye)}pt>Tt?tt(ye,ot,st,!0,!1,St):ne(Me,$e,it,ot,st,gt,lt,Ye,St)},Et=(ye,Me,$e,it,ot,st,gt,lt,Ye)=>{let pt=0;const Tt=Me.length;let St=ye.length-1,zt=Tt-1;for(;pt<=St&&pt<=zt;){const Yt=ye[pt],ur=Me[pt]=Ye?yl(Me[pt]):Es(Me[pt]);if(No(Yt,ur))z(Yt,ur,$e,null,ot,st,gt,lt,Ye);else break;pt++}for(;pt<=St&&pt<=zt;){const Yt=ye[St],ur=Me[zt]=Ye?yl(Me[zt]):Es(Me[zt]);if(No(Yt,ur))z(Yt,ur,$e,null,ot,st,gt,lt,Ye);else break;St--,zt--}if(pt>St){if(pt<=zt){const Yt=zt+1,ur=Yt<Tt?Me[Yt].el:it;for(;pt<=zt;)z(null,Me[pt]=Ye?yl(Me[pt]):Es(Me[pt]),$e,ur,ot,st,gt,lt,Ye),pt++}}else if(pt>zt)for(;pt<=St;)Nt(ye[pt],ot,st,!0),pt++;else{const Yt=pt,ur=pt,xr=new Map;for(pt=ur;pt<=zt;pt++){const or=Me[pt]=Ye?yl(Me[pt]):Es(Me[pt]);or.key!=null&&xr.set(or.key,pt)}let fr,br=0;const Qr=zt-ur+1;let Wi=!1,Ei=0;const ui=new Array(Qr);for(pt=0;pt<Qr;pt++)ui[pt]=0;for(pt=Yt;pt<=St;pt++){const or=ye[pt];if(br>=Qr){Nt(or,ot,st,!0);continue}let Gt;if(or.key!=null)Gt=xr.get(or.key);else for(fr=ur;fr<=zt;fr++)if(ui[fr-ur]===0&&No(or,Me[fr])){Gt=fr;break}Gt===void 0?Nt(or,ot,st,!0):(ui[Gt-ur]=pt+1,Gt>=Ei?Ei=Gt:Wi=!0,z(or,Me[Gt],$e,null,ot,st,gt,lt,Ye),br++)}const Un=Wi?BF(ui):zh;for(fr=Un.length-1,pt=Qr-1;pt>=0;pt--){const or=ur+pt,Gt=Me[or],rr=or+1<Tt?Me[or+1].el:it;ui[pt]===0?z(null,Gt,$e,rr,ot,st,gt,lt,Ye):Wi&&(fr<0||pt!==Un[fr]?Qt(Gt,$e,rr,2):fr--)}}},Qt=(ye,Me,$e,it,ot=null)=>{const{el:st,type:gt,transition:lt,children:Ye,shapeFlag:pt}=ye;if(pt&6){Qt(ye.component.subTree,Me,$e,it);return}if(pt&128){ye.suspense.move(Me,$e,it);return}if(pt&64){gt.move(ye,Me,$e,Ht);return}if(gt===Ri){n(st,Me,$e);for(let St=0;St<Ye.length;St++)Qt(Ye[St],Me,$e,it);n(ye.anchor,Me,$e);return}if(gt===Yc){G(ye,Me,$e);return}if(it!==2&&pt&1&&lt)if(it===0)lt.beforeEnter(st),n(st,Me,$e),gn(()=>lt.enter(st),ot);else{const{leave:St,delayLeave:zt,afterLeave:Yt}=lt,ur=()=>n(st,Me,$e),xr=()=>{St(st,()=>{ur(),Yt&&Yt()})};zt?zt(st,ur,xr):xr()}else n(st,Me,$e)},Nt=(ye,Me,$e,it=!1,ot=!1)=>{const{type:st,props:gt,ref:lt,children:Ye,dynamicChildren:pt,shapeFlag:Tt,patchFlag:St,dirs:zt}=ye;if(lt!=null&&U_(lt,null,$e,ye,!0),Tt&256){Me.ctx.deactivate(ye);return}const Yt=Tt&1&&zt,ur=!Xc(ye);let xr;if(ur&&(xr=gt&&gt.onVnodeBeforeUnmount)&&ss(xr,Me,ye),Tt&6)Ne(ye.component,$e,it);else{if(Tt&128){ye.suspense.unmount($e,it);return}Yt&&zo(ye,null,Me,"beforeUnmount"),Tt&64?ye.type.remove(ye,Me,$e,ot,Ht,it):pt&&(st!==Ri||St>0&&St&64)?tt(pt,Me,$e,!1,!0):(st===Ri&&St&384||!ot&&Tt&16)&&tt(Ye,Me,$e),it&&yt(ye)}(ur&&(xr=gt&&gt.onVnodeUnmounted)||Yt)&&gn(()=>{xr&&ss(xr,Me,ye),Yt&&zo(ye,null,Me,"unmounted")},$e)},yt=ye=>{const{type:Me,el:$e,anchor:it,transition:ot}=ye;if(Me===Ri){et($e,it);return}if(Me===Yc){K(ye);return}const st=()=>{s($e),ot&&!ot.persisted&&ot.afterLeave&&ot.afterLeave()};if(ye.shapeFlag&1&&ot&&!ot.persisted){const{leave:gt,delayLeave:lt}=ot,Ye=()=>gt($e,st);lt?lt(ye.el,st,Ye):Ye()}else st()},et=(ye,Me)=>{let $e;for(;ye!==Me;)$e=P(ye),s(ye),ye=$e;s(Me)},Ne=(ye,Me,$e)=>{const{bum:it,scope:ot,update:st,subTree:gt,um:lt}=ye;it&&Bh(it),ot.stop(),st&&(st.active=!1,Nt(gt,ye,Me,$e)),lt&&gn(lt,Me),gn(()=>{ye.isUnmounted=!0},Me),Me&&Me.pendingBranch&&!Me.isUnmounted&&ye.asyncDep&&!ye.asyncResolved&&ye.suspenseId===Me.pendingId&&(Me.deps--,Me.deps===0&&Me.resolve())},tt=(ye,Me,$e,it=!1,ot=!1,st=0)=>{for(let gt=st;gt<ye.length;gt++)Nt(ye[gt],Me,$e,it,ot)},ft=ye=>ye.shapeFlag&6?ft(ye.component.subTree):ye.shapeFlag&128?ye.suspense.next():P(ye.anchor||ye.el),mt=(ye,Me,$e)=>{ye==null?Me._vnode&&Nt(Me._vnode,null,null,!0):z(Me._vnode||null,ye,Me,null,null,null,$e),iS(),$_(),Me._vnode=ye},Ht={p:z,um:Nt,m:Qt,r:yt,mt:se,mc:ne,pc:ut,pbc:xe,n:ft,o:t};let Zt,Lt;return e&&([Zt,Lt]=e(Ht)),{render:mt,hydrate:Zt,createApp:zF(mt,Zt)}}function Mc({effect:t,update:e},r){t.allowRecurse=e.allowRecurse=r}function d1(t,e,r=!1){const n=t.children,s=e.children;if(sr(n)&&sr(s))for(let u=0;u<n.length;u++){const d=n[u];let o=s[u];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[u]=yl(s[u]),o.el=d.el),r||d1(d,o)),o.type===ou&&(o.el=d.el)}}function BF(t){const e=t.slice(),r=[0];let n,s,u,d,o;const g=t.length;for(n=0;n<g;n++){const x=t[n];if(x!==0){if(s=r[r.length-1],t[s]<x){e[n]=s,r.push(n);continue}for(u=0,d=r.length-1;u<d;)o=u+d>>1,t[r[o]]<x?u=o+1:d=o;x<t[r[u]]&&(u>0&&(e[n]=r[u-1]),r[u]=n)}}for(u=r.length,d=r[u-1];u-- >0;)r[u]=d,d=e[d];return r}const NF=t=>t.__isTeleport,ap=t=>t&&(t.disabled||t.disabled===""),pS=t=>typeof SVGElement!="undefined"&&t instanceof SVGElement,Kx=(t,e)=>{const r=t&&t.to;return Li(r)?e?e(r):null:r},jF={__isTeleport:!0,process(t,e,r,n,s,u,d,o,g,x){const{mc:E,pc:S,pbc:P,o:{insert:I,querySelector:R,createText:z,createComment:B}}=x,$=ap(e.props);let{shapeFlag:j,children:G,dynamicChildren:K}=e;if(t==null){const X=e.el=z(""),re=e.anchor=z("");I(X,r,n),I(re,r,n);const ue=e.target=Kx(e.props,R),ne=e.targetAnchor=z("");ue&&(I(ne,ue),d=d||pS(ue));const we=(xe,ke)=>{j&16&&E(G,xe,ke,s,u,d,o,g)};$?we(r,re):ue&&we(ue,ne)}else{e.el=t.el;const X=e.anchor=t.anchor,re=e.target=t.target,ue=e.targetAnchor=t.targetAnchor,ne=ap(t.props),we=ne?r:re,xe=ne?X:ue;if(d=d||pS(re),K?(P(t.dynamicChildren,K,we,s,u,d,o),d1(t,e,!0)):g||S(t,e,we,xe,s,u,d,o,!1),$)ne||Hg(e,r,X,x,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const ke=e.target=Kx(e.props,R);ke&&Hg(e,ke,null,x,0)}else ne&&Hg(e,re,ue,x,1)}UC(e)},remove(t,e,r,n,{um:s,o:{remove:u}},d){const{shapeFlag:o,children:g,anchor:x,targetAnchor:E,target:S,props:P}=t;if(S&&u(E),(d||!ap(P))&&(u(x),o&16))for(let I=0;I<g.length;I++){const R=g[I];s(R,e,r,!0,!!R.dynamicChildren)}},move:Hg,hydrate:$F};function Hg(t,e,r,{o:{insert:n},m:s},u=2){u===0&&n(t.targetAnchor,e,r);const{el:d,anchor:o,shapeFlag:g,children:x,props:E}=t,S=u===2;if(S&&n(d,e,r),(!S||ap(E))&&g&16)for(let P=0;P<x.length;P++)s(x[P],e,r,2);S&&n(o,e,r)}function $F(t,e,r,n,s,u,{o:{nextSibling:d,parentNode:o,querySelector:g}},x){const E=e.target=Kx(e.props,g);if(E){const S=E._lpa||E.firstChild;if(e.shapeFlag&16)if(ap(e.props))e.anchor=x(d(t),e,o(t),r,n,s,u),e.targetAnchor=S;else{e.anchor=d(t);let P=S;for(;P;)if(P=d(P),P&&P.nodeType===8&&P.data==="teleport anchor"){e.targetAnchor=P,E._lpa=e.targetAnchor&&d(e.targetAnchor);break}x(S,e,E,r,n,s,u)}UC(e)}return e.anchor&&d(e.anchor)}const VF=jF;function UC(t){const e=t.ctx;if(e&&e.ut){let r=t.children[0].el;for(;r!==t.targetAnchor;)r.nodeType===1&&r.setAttribute("data-v-owner",e.uid),r=r.nextSibling;e.ut()}}const Ri=Symbol(void 0),ou=Symbol(void 0),Dn=Symbol(void 0),Yc=Symbol(void 0),lp=[];let ls=null;function kr(t=!1){lp.push(ls=t?null:[])}function GC(){lp.pop(),ls=lp[lp.length-1]||null}let au=1;function Xx(t){au+=t}function HC(t){return t.dynamicChildren=au>0?ls||zh:null,GC(),au>0&&ls&&ls.push(t),t}function xi(t,e,r,n,s,u){return HC(Nr(t,e,r,n,s,u,!0))}function os(t,e,r,n,s){return HC(ri(t,e,r,n,s,!0))}function Ll(t){return t?t.__v_isVNode===!0:!1}function No(t,e){return t.type===e.type&&t.key===e.key}function UF(t){}const Hy="__vInternal",WC=({key:t})=>t!=null?t:null,E_=({ref:t,ref_key:e,ref_for:r})=>t!=null?Li(t)||cn(t)||wr(t)?{i:_n,r:t,k:e,f:!!r}:t:null;function Nr(t,e=null,r=null,n=0,s=null,u=t===Ri?0:1,d=!1,o=!1){const g={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&WC(e),ref:e&&E_(e),scopeId:Ny,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:_n};return o?(f1(g,r),u&128&&t.normalize(g)):r&&(g.shapeFlag|=Li(r)?8:16),au>0&&!d&&ls&&(g.patchFlag>0||u&6)&&g.patchFlag!==32&&ls.push(g),g}const ri=GF;function GF(t,e=null,r=null,n=0,s=null,u=!1){if((!t||t===IC)&&(t=Dn),Ll(t)){const o=Uo(t,e,!0);return r&&f1(o,r),au>0&&!u&&ls&&(o.shapeFlag&6?ls[ls.indexOf(t)]=o:ls.push(o)),o.patchFlag|=-2,o}if(YF(t)&&(t=t.__vccOpts),e){e=Vs(e);let{class:o,style:g}=e;o&&!Li(o)&&(e.class=iu(o)),fi(g)&&(Jb(g)&&!sr(g)&&(g=$i({},g)),e.style=zp(g))}const d=Li(t)?1:mC(t)?128:NF(t)?64:fi(t)?4:wr(t)?2:0;return Nr(t,e,r,n,s,d,u,!0)}function Vs(t){return t?Jb(t)||Hy in t?$i({},t):t:null}function Uo(t,e,r=!1){const{props:n,ref:s,patchFlag:u,children:d}=t,o=e?G_(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:o,key:o&&WC(o),ref:e&&e.ref?r&&s?sr(s)?s.concat(E_(e)):[s,E_(e)]:E_(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:d,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ri?u===-1?16:u|16:u,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Uo(t.ssContent),ssFallback:t.ssFallback&&Uo(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx}}function qh(t=" ",e=0){return ri(ou,null,t,e)}function ZC(t,e){const r=ri(Yc,null,t);return r.staticCount=e,r}function Jc(t="",e=!1){return e?(kr(),os(Dn,null,t)):ri(Dn,null,t)}function Es(t){return t==null||typeof t=="boolean"?ri(Dn):sr(t)?ri(Ri,null,t.slice()):typeof t=="object"?yl(t):ri(ou,null,String(t))}function yl(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Uo(t)}function f1(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(sr(e))r=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),f1(t,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!(Hy in e)?e._ctx=_n:s===3&&_n&&(_n.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else wr(e)?(e={default:e,_ctx:_n},r=32):(e=String(e),n&64?(r=16,e=[qh(e)]):r=8);t.children=e,t.shapeFlag|=r}function G_(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=iu([e.class,n.class]));else if(s==="style")e.style=zp([e.style,n.style]);else if(Fp(s)){const u=e[s],d=n[s];d&&u!==d&&!(sr(u)&&u.includes(d))&&(e[s]=u?[].concat(u,d):d)}else s!==""&&(e[s]=n[s])}return e}function ss(t,e,r,n=null){Ss(t,e,7,[r,n])}const HF=NC();let WF=0;function qC(t,e,r){const n=t.type,s=(e?e.appContext:t.appContext)||HF,u={uid:WF++,vnode:t,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new qb(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:kC(n,s),emitsOptions:pC(n,s),emit:null,emitted:null,propsDefaults:ci,inheritAttrs:n.inheritAttrs,ctx:ci,data:ci,props:ci,attrs:ci,slots:ci,refs:ci,setupState:ci,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=e?e.root:u,u.emit=eF.bind(null,u),t.ce&&t.ce(u),u}let en=null;const Vl=()=>en||_n,kl=t=>{en=t,t.scope.on()},Cl=()=>{en&&en.scope.off(),en=null};function KC(t){return t.vnode.shapeFlag&4}let Kh=!1;function XC(t,e=!1){Kh=e;const{props:r,children:n}=t.vnode,s=KC(t);MF(t,r,s,e),RF(t,n);const u=s?ZF(t,e):void 0;return Kh=!1,u}function ZF(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=Ly(new Proxy(t.ctx,Hx));const{setup:n}=r;if(n){const s=t.setupContext=n.length>1?JC(t):null;kl(t),ud();const u=Ta(n,t,0,[t.props,s]);if(hd(),Cl(),Wb(u)){if(u.then(Cl,Cl),e)return u.then(d=>{Yx(t,d,e)}).catch(d=>{fu(d,t,0)});t.asyncDep=u}else Yx(t,u,e)}else YC(t,e)}function Yx(t,e,r){wr(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:fi(e)&&(t.setupState=t1(e)),YC(t,r)}let H_,Jx;function qF(t){H_=t,Jx=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,TF))}}const KF=()=>!H_;function YC(t,e,r){const n=t.type;if(!t.render){if(!e&&H_&&!n.render){const s=n.template||u1(t).template;if(s){const{isCustomElement:u,compilerOptions:d}=t.appContext.config,{delimiters:o,compilerOptions:g}=n,x=$i($i({isCustomElement:u,delimiters:o},d),g);n.render=H_(s,x)}}t.render=n.render||lo,Jx&&Jx(t)}kl(t),ud(),SF(t),hd(),Cl()}function XF(t){return new Proxy(t.attrs,{get(e,r){return As(t,"get","$attrs"),e[r]}})}function JC(t){const e=n=>{t.exposed=n||{}};let r;return{get attrs(){return r||(r=XF(t))},slots:t.slots,emit:t.emit,expose:e}}function Wy(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(t1(Ly(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in op)return op[r](t)},has(e,r){return r in e||r in op}}))}function Qx(t,e=!0){return wr(t)?t.displayName||t.name:t.name||e&&t.__name}function YF(t){return wr(t)&&"__vccOpts"in t}const Ts=(t,e)=>qz(t,e,Kh);function JF(){return null}function QF(){return null}function e3(t){}function t3(t,e){return null}function r3(){return QC().slots}function i3(){return QC().attrs}function QC(){const t=Vl();return t.setupContext||(t.setupContext=JC(t))}function n3(t,e){const r=sr(t)?t.reduce((n,s)=>(n[s]={},n),{}):t;for(const n in e){const s=r[n];s?sr(s)||wr(s)?r[n]={type:s,default:e[n]}:s.default=e[n]:s===null&&(r[n]={default:e[n]})}return r}function s3(t,e){const r={};for(const n in t)e.includes(n)||Object.defineProperty(r,n,{enumerable:!0,get:()=>t[n]});return r}function o3(t){const e=Vl();let r=t();return Cl(),Wb(r)&&(r=r.catch(n=>{throw kl(e),n})),[r,()=>kl(e)]}function Zy(t,e,r){const n=arguments.length;return n===2?fi(e)&&!sr(e)?Ll(e)?ri(t,null,[e]):ri(t,e):ri(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Ll(r)&&(r=[r]),ri(t,e,r))}const eI=Symbol(""),tI=()=>co(eI);function a3(){}function l3(t,e,r,n){const s=r[n];if(s&&rI(s,t))return s;const u=e();return u.memo=t.slice(),r[n]=u}function rI(t,e){const r=t.memo;if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(Wh(r[n],e[n]))return!1;return au>0&&ls&&ls.push(t),!0}const iI="3.2.45",c3={createComponentInstance:qC,setupComponent:XC,renderComponentRoot:x_,setCurrentRenderingInstance:Ep,isVNode:Ll,normalizeVNode:Es},u3=c3,h3=null,d3=null,f3="http://www.w3.org/2000/svg",Vc=typeof document!="undefined"?document:null,mS=Vc&&Vc.createElement("template"),p3={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const s=e?Vc.createElementNS(f3,t):Vc.createElement(t,r?{is:r}:void 0);return t==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:t=>Vc.createTextNode(t),createComment:t=>Vc.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Vc.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,s,u){const d=r?r.previousSibling:e.lastChild;if(s&&(s===u||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===u||!(s=s.nextSibling)););else{mS.innerHTML=n?`<svg>${t}</svg>`:t;const o=mS.content;if(n){const g=o.firstChild;for(;g.firstChild;)o.appendChild(g.firstChild);o.removeChild(g)}e.insertBefore(o,r)}return[d?d.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}};function m3(t,e,r){const n=t._vtc;n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}function g3(t,e,r){const n=t.style,s=Li(r);if(r&&!s){for(const u in r)eb(n,u,r[u]);if(e&&!Li(e))for(const u in e)r[u]==null&&eb(n,u,"")}else{const u=n.display;s?e!==r&&(n.cssText=r):e&&t.removeAttribute("style"),"_vod"in t&&(n.display=u)}}const gS=/\s*!important$/;function eb(t,e,r){if(sr(r))r.forEach(n=>eb(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=_3(t,e);gS.test(r)?t.setProperty(Us(n),r.replace(gS,""),"important"):t[n]=r}}const _S=["Webkit","Moz","ms"],K0={};function _3(t,e){const r=K0[e];if(r)return r;let n=cs(e);if(n!=="filter"&&n in t)return K0[e]=n;n=Np(n);for(let s=0;s<_S.length;s++){const u=_S[s]+n;if(u in t)return K0[e]=u}return e}const yS="http://www.w3.org/1999/xlink";function y3(t,e,r,n,s){if(n&&e.startsWith("xlink:"))r==null?t.removeAttributeNS(yS,e.slice(6,e.length)):t.setAttributeNS(yS,e,r);else{const u=tz(e);r==null||u&&!$P(r)?t.removeAttribute(e):t.setAttribute(e,u?"":r)}}function v3(t,e,r,n,s,u,d){if(e==="innerHTML"||e==="textContent"){n&&d(n,s,u),t[e]=r==null?"":r;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=r;const g=r==null?"":r;(t.value!==g||t.tagName==="OPTION")&&(t.value=g),r==null&&t.removeAttribute(e);return}let o=!1;if(r===""||r==null){const g=typeof t[e];g==="boolean"?r=$P(r):r==null&&g==="string"?(r="",o=!0):g==="number"&&(r=0,o=!0)}try{t[e]=r}catch{}o&&t.removeAttribute(e)}function xa(t,e,r,n){t.addEventListener(e,r,n)}function x3(t,e,r,n){t.removeEventListener(e,r,n)}function b3(t,e,r,n,s=null){const u=t._vei||(t._vei={}),d=u[e];if(n&&d)d.value=n;else{const[o,g]=w3(e);if(n){const x=u[e]=S3(n,s);xa(t,o,x,g)}else d&&(x3(t,o,d,g),u[e]=void 0)}}const vS=/(?:Once|Passive|Capture)$/;function w3(t){let e;if(vS.test(t)){e={};let n;for(;n=t.match(vS);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Us(t.slice(2)),e]}let X0=0;const E3=Promise.resolve(),T3=()=>X0||(E3.then(()=>X0=0),X0=Date.now());function S3(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Ss(A3(n,r.value),e,5,[n])};return r.value=t,r.attached=T3(),r}function A3(t,e){if(sr(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const xS=/^on[a-z]/,P3=(t,e,r,n,s=!1,u,d,o,g)=>{e==="class"?m3(t,n,s):e==="style"?g3(t,r,n):Fp(e)?Gb(e)||b3(t,e,r,n,d):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):C3(t,e,n,s))?v3(t,e,n,u,d,o,g):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),y3(t,e,n,s))};function C3(t,e,r,n){return n?!!(e==="innerHTML"||e==="textContent"||e in t&&xS.test(e)&&wr(r)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||xS.test(e)&&Li(r)?!1:e in t}function nI(t,e){const r=Vp(t);class n extends qy{constructor(u){super(r,u,e)}}return n.def=r,n}const I3=t=>nI(t,yI),M3=typeof HTMLElement!="undefined"?HTMLElement:class{};class qy extends M3{constructor(e,r={},n){super(),this._def=e,this._props=r,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&n?n(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,zy(()=>{this._connected||(nb(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);new MutationObserver(n=>{for(const s of n)this._setAttr(s.attributeName)}).observe(this,{attributes:!0});const e=(n,s=!1)=>{const{props:u,styles:d}=n;let o;if(u&&!sr(u))for(const g in u){const x=u[g];(x===Number||x&&x.type===Number)&&(g in this._props&&(this._props[g]=Ca(this._props[g])),(o||(o=Object.create(null)))[cs(g)]=!0)}this._numberProps=o,s&&this._resolveProps(n),this._applyStyles(d),this._update()},r=this._def.__asyncLoader;r?r().then(n=>e(n,!0)):e(this._def)}_resolveProps(e){const{props:r}=e,n=sr(r)?r:Object.keys(r||{});for(const s of Object.keys(this))s[0]!=="_"&&n.includes(s)&&this._setProp(s,this[s],!0,!1);for(const s of n.map(cs))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(u){this._setProp(s,u)}})}_setAttr(e){let r=this.getAttribute(e);const n=cs(e);this._numberProps&&this._numberProps[n]&&(r=Ca(r)),this._setProp(n,r,!1)}_getProp(e){return this._props[e]}_setProp(e,r,n=!0,s=!0){r!==this._props[e]&&(this._props[e]=r,s&&this._instance&&this._update(),n&&(r===!0?this.setAttribute(Us(e),""):typeof r=="string"||typeof r=="number"?this.setAttribute(Us(e),r+""):r||this.removeAttribute(Us(e))))}_update(){nb(this._createVNode(),this.shadowRoot)}_createVNode(){const e=ri(this._def,$i({},this._props));return this._instance||(e.ce=r=>{this._instance=r,r.isCE=!0;const n=(u,d)=>{this.dispatchEvent(new CustomEvent(u,{detail:d}))};r.emit=(u,...d)=>{n(u,d),Us(u)!==u&&n(Us(u),d)};let s=this;for(;s=s&&(s.parentNode||s.host);)if(s instanceof qy){r.parent=s._instance,r.provides=s._instance.provides;break}}),e}_applyStyles(e){e&&e.forEach(r=>{const n=document.createElement("style");n.textContent=r,this.shadowRoot.appendChild(n)})}}function O3(t="$style"){{const e=Vl();if(!e)return ci;const r=e.type.__cssModules;if(!r)return ci;const n=r[t];return n||ci}}function D3(t){const e=Vl();if(!e)return;const r=e.ut=(s=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(u=>rb(u,s))},n=()=>{const s=t(e.proxy);tb(e.subTree,s),r(s)};_C(n),Gp(()=>{const s=new MutationObserver(n);s.observe(e.subTree.el.parentNode,{childList:!0}),Gy(()=>s.disconnect())})}function tb(t,e){if(t.shapeFlag&128){const r=t.suspense;t=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{tb(r.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)rb(t.el,e);else if(t.type===Ri)t.children.forEach(r=>tb(r,e));else if(t.type===Yc){let{el:r,anchor:n}=t;for(;r&&(rb(r,e),r!==n);)r=r.nextSibling}}function rb(t,e){if(t.nodeType===1){const r=t.style;for(const n in e)r.setProperty(`--${n}`,e[n])}}const fl="transition",Ff="animation",Ky=(t,{slots:e})=>Zy(a1,oI(t),e);Ky.displayName="Transition";const sI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},R3=Ky.props=$i({},a1.props,sI),Oc=(t,e=[])=>{sr(t)?t.forEach(r=>r(...e)):t&&t(...e)},bS=t=>t?sr(t)?t.some(e=>e.length>1):t.length>1:!1;function oI(t){const e={};for(const Ie in t)Ie in sI||(e[Ie]=t[Ie]);if(t.css===!1)return e;const{name:r="v",type:n,duration:s,enterFromClass:u=`${r}-enter-from`,enterActiveClass:d=`${r}-enter-active`,enterToClass:o=`${r}-enter-to`,appearFromClass:g=u,appearActiveClass:x=d,appearToClass:E=o,leaveFromClass:S=`${r}-leave-from`,leaveActiveClass:P=`${r}-leave-active`,leaveToClass:I=`${r}-leave-to`}=t,R=L3(s),z=R&&R[0],B=R&&R[1],{onBeforeEnter:$,onEnter:j,onEnterCancelled:G,onLeave:K,onLeaveCancelled:X,onBeforeAppear:re=$,onAppear:ue=j,onAppearCancelled:ne=G}=e,we=(Ie,Fe,se)=>{_l(Ie,Fe?E:o),_l(Ie,Fe?x:d),se&&se()},xe=(Ie,Fe)=>{Ie._isLeaving=!1,_l(Ie,S),_l(Ie,I),_l(Ie,P),Fe&&Fe()},ke=Ie=>(Fe,se)=>{const Be=Ie?ue:j,Ve=()=>we(Fe,Ie,se);Oc(Be,[Fe,Ve]),wS(()=>{_l(Fe,Ie?g:u),da(Fe,Ie?E:o),bS(Be)||ES(Fe,n,z,Ve)})};return $i(e,{onBeforeEnter(Ie){Oc($,[Ie]),da(Ie,u),da(Ie,d)},onBeforeAppear(Ie){Oc(re,[Ie]),da(Ie,g),da(Ie,x)},onEnter:ke(!1),onAppear:ke(!0),onLeave(Ie,Fe){Ie._isLeaving=!0;const se=()=>xe(Ie,Fe);da(Ie,S),lI(),da(Ie,P),wS(()=>{!Ie._isLeaving||(_l(Ie,S),da(Ie,I),bS(K)||ES(Ie,n,B,se))}),Oc(K,[Ie,se])},onEnterCancelled(Ie){we(Ie,!1),Oc(G,[Ie])},onAppearCancelled(Ie){we(Ie,!0),Oc(ne,[Ie])},onLeaveCancelled(Ie){xe(Ie),Oc(X,[Ie])}})}function L3(t){if(t==null)return null;if(fi(t))return[Y0(t.enter),Y0(t.leave)];{const e=Y0(t);return[e,e]}}function Y0(t){return Ca(t)}function da(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t._vtc||(t._vtc=new Set)).add(e)}function _l(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const{_vtc:r}=t;r&&(r.delete(e),r.size||(t._vtc=void 0))}function wS(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let k3=0;function ES(t,e,r,n){const s=t._endId=++k3,u=()=>{s===t._endId&&n()};if(r)return setTimeout(u,r);const{type:d,timeout:o,propCount:g}=aI(t,e);if(!d)return n();const x=d+"end";let E=0;const S=()=>{t.removeEventListener(x,P),u()},P=I=>{I.target===t&&++E>=g&&S()};setTimeout(()=>{E<g&&S()},o+1),t.addEventListener(x,P)}function aI(t,e){const r=window.getComputedStyle(t),n=R=>(r[R]||"").split(", "),s=n(`${fl}Delay`),u=n(`${fl}Duration`),d=TS(s,u),o=n(`${Ff}Delay`),g=n(`${Ff}Duration`),x=TS(o,g);let E=null,S=0,P=0;e===fl?d>0&&(E=fl,S=d,P=u.length):e===Ff?x>0&&(E=Ff,S=x,P=g.length):(S=Math.max(d,x),E=S>0?d>x?fl:Ff:null,P=E?E===fl?u.length:g.length:0);const I=E===fl&&/\b(transform|all)(,|$)/.test(n(`${fl}Property`).toString());return{type:E,timeout:S,propCount:P,hasTransform:I}}function TS(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>SS(r)+SS(t[n])))}function SS(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function lI(){return document.body.offsetHeight}const cI=new WeakMap,uI=new WeakMap,z3={name:"TransitionGroup",props:$i({},R3,{tag:String,moveClass:String}),setup(t,{slots:e}){const r=Vl(),n=o1();let s,u;return Vy(()=>{if(!s.length)return;const d=t.moveClass||`${t.name||"v"}-move`;if(!$3(s[0].el,r.vnode.el,d))return;s.forEach(B3),s.forEach(N3);const o=s.filter(j3);lI(),o.forEach(g=>{const x=g.el,E=x.style;da(x,d),E.transform=E.webkitTransform=E.transitionDuration="";const S=x._moveCb=P=>{P&&P.target!==x||(!P||/transform$/.test(P.propertyName))&&(x.removeEventListener("transitionend",S),x._moveCb=null,_l(x,d))};x.addEventListener("transitionend",S)})}),()=>{const d=Xr(t),o=oI(d);let g=d.tag||Ri;s=u,u=e.default?jy(e.default()):[];for(let x=0;x<u.length;x++){const E=u[x];E.key!=null&&su(E,Zh(E,o,n,r))}if(s)for(let x=0;x<s.length;x++){const E=s[x];su(E,Zh(E,o,n,r)),cI.set(E,E.el.getBoundingClientRect())}return ri(g,null,u)}}},F3=z3;function B3(t){const e=t.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function N3(t){uI.set(t,t.el.getBoundingClientRect())}function j3(t){const e=cI.get(t),r=uI.get(t),n=e.left-r.left,s=e.top-r.top;if(n||s){const u=t.el.style;return u.transform=u.webkitTransform=`translate(${n}px,${s}px)`,u.transitionDuration="0s",t}}function $3(t,e,r){const n=t.cloneNode();t._vtc&&t._vtc.forEach(d=>{d.split(/\s+/).forEach(o=>o&&n.classList.remove(o))}),r.split(/\s+/).forEach(d=>d&&n.classList.add(d)),n.style.display="none";const s=e.nodeType===1?e:e.parentNode;s.appendChild(n);const{hasTransform:u}=aI(n);return s.removeChild(n),u}const zl=t=>{const e=t.props["onUpdate:modelValue"]||!1;return sr(e)?r=>Bh(e,r):e};function V3(t){t.target.composing=!0}function AS(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const W_={created(t,{modifiers:{lazy:e,trim:r,number:n}},s){t._assign=zl(s);const u=n||s.props&&s.props.type==="number";xa(t,e?"change":"input",d=>{if(d.target.composing)return;let o=t.value;r&&(o=o.trim()),u&&(o=Ca(o)),t._assign(o)}),r&&xa(t,"change",()=>{t.value=t.value.trim()}),e||(xa(t,"compositionstart",V3),xa(t,"compositionend",AS),xa(t,"change",AS))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:r,trim:n,number:s}},u){if(t._assign=zl(u),t.composing||document.activeElement===t&&t.type!=="range"&&(r||n&&t.value.trim()===e||(s||t.type==="number")&&Ca(t.value)===e))return;const d=e==null?"":e;t.value!==d&&(t.value=d)}},p1={deep:!0,created(t,e,r){t._assign=zl(r),xa(t,"change",()=>{const n=t._modelValue,s=Xh(t),u=t.checked,d=t._assign;if(sr(n)){const o=Cy(n,s),g=o!==-1;if(u&&!g)d(n.concat(s));else if(!u&&g){const x=[...n];x.splice(o,1),d(x)}}else if(du(n)){const o=new Set(n);u?o.add(s):o.delete(s),d(o)}else d(dI(t,u))})},mounted:PS,beforeUpdate(t,e,r){t._assign=zl(r),PS(t,e,r)}};function PS(t,{value:e,oldValue:r},n){t._modelValue=e,sr(e)?t.checked=Cy(e,n.props.value)>-1:du(e)?t.checked=e.has(n.props.value):e!==r&&(t.checked=Ol(e,dI(t,!0)))}const m1={created(t,{value:e},r){t.checked=Ol(e,r.props.value),t._assign=zl(r),xa(t,"change",()=>{t._assign(Xh(t))})},beforeUpdate(t,{value:e,oldValue:r},n){t._assign=zl(n),e!==r&&(t.checked=Ol(e,n.props.value))}},hI={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const s=du(e);xa(t,"change",()=>{const u=Array.prototype.filter.call(t.options,d=>d.selected).map(d=>r?Ca(Xh(d)):Xh(d));t._assign(t.multiple?s?new Set(u):u:u[0])}),t._assign=zl(n)},mounted(t,{value:e}){CS(t,e)},beforeUpdate(t,e,r){t._assign=zl(r)},updated(t,{value:e}){CS(t,e)}};function CS(t,e){const r=t.multiple;if(!(r&&!sr(e)&&!du(e))){for(let n=0,s=t.options.length;n<s;n++){const u=t.options[n],d=Xh(u);if(r)sr(e)?u.selected=Cy(e,d)>-1:u.selected=e.has(d);else if(Ol(Xh(u),e)){t.selectedIndex!==n&&(t.selectedIndex=n);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Xh(t){return"_value"in t?t._value:t.value}function dI(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const fI={created(t,e,r){Wg(t,e,r,null,"created")},mounted(t,e,r){Wg(t,e,r,null,"mounted")},beforeUpdate(t,e,r,n){Wg(t,e,r,n,"beforeUpdate")},updated(t,e,r,n){Wg(t,e,r,n,"updated")}};function pI(t,e){switch(t){case"SELECT":return hI;case"TEXTAREA":return W_;default:switch(e){case"checkbox":return p1;case"radio":return m1;default:return W_}}}function Wg(t,e,r,n,s){const d=pI(t.tagName,r.props&&r.props.type)[s];d&&d(t,e,r,n)}function U3(){W_.getSSRProps=({value:t})=>({value:t}),m1.getSSRProps=({value:t},e)=>{if(e.props&&Ol(e.props.value,t))return{checked:!0}},p1.getSSRProps=({value:t},e)=>{if(sr(t)){if(e.props&&Cy(t,e.props.value)>-1)return{checked:!0}}else if(du(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},fI.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const r=pI(e.type.toUpperCase(),e.props&&e.props.type);if(r.getSSRProps)return r.getSSRProps(t,e)}}const G3=["ctrl","shift","alt","meta"],H3={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>G3.some(r=>t[`${r}Key`]&&!e.includes(r))},ib=(t,e)=>(r,...n)=>{for(let s=0;s<e.length;s++){const u=H3[e[s]];if(u&&u(r,e))return}return t(r,...n)},W3={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Z3=(t,e)=>r=>{if(!("key"in r))return;const n=Us(r.key);if(e.some(s=>s===n||W3[s]===n))return t(r)},Z_={beforeMount(t,{value:e},{transition:r}){t._vod=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):Bf(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:n}){!e!=!r&&(n?e?(n.beforeEnter(t),Bf(t,!0),n.enter(t)):n.leave(t,()=>{Bf(t,!1)}):Bf(t,e))},beforeUnmount(t,{value:e}){Bf(t,e)}};function Bf(t,e){t.style.display=e?t._vod:"none"}function q3(){Z_.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const mI=$i({patchProp:P3},p3);let cp,IS=!1;function gI(){return cp||(cp=jC(mI))}function _I(){return cp=IS?cp:$C(mI),IS=!0,cp}const nb=(...t)=>{gI().render(...t)},yI=(...t)=>{_I().hydrate(...t)},vI=(...t)=>{const e=gI().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=xI(n);if(!s)return;const u=e._component;!wr(u)&&!u.render&&!u.template&&(u.template=s.innerHTML),s.innerHTML="";const d=r(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),d},e},K3=(...t)=>{const e=_I().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=xI(n);if(s)return r(s,!0,s instanceof SVGElement)},e};function xI(t){return Li(t)?document.querySelector(t):t}let MS=!1;const X3=()=>{MS||(MS=!0,U3(),q3())},Y3=()=>{};var J3=Object.freeze(Object.defineProperty({__proto__:null,compile:Y3,EffectScope:qb,ReactiveEffect:jp,customRef:Hz,effect:pz,effectScope:HP,getCurrentScope:uz,isProxy:Jb,isReactive:qc,isReadonly:nu,isRef:cn,isShallow:vp,markRaw:Ly,onScopeDispose:hz,proxyRefs:t1,reactive:Rl,readonly:Yb,ref:Nh,shallowReactive:sC,shallowReadonly:jz,shallowRef:oC,stop:mz,toRaw:Xr,toRef:lC,toRefs:Vx,triggerRef:Vz,unref:Kc,camelize:cs,capitalize:Np,normalizeClass:iu,normalizeProps:js,normalizeStyle:zp,toDisplayString:bl,toHandlerKey:np,BaseTransition:a1,Comment:Dn,Fragment:Ri,KeepAlive:xF,Static:Yc,Suspense:cF,Teleport:VF,Text:ou,callWithAsyncErrorHandling:Ss,callWithErrorHandling:Ta,cloneVNode:Uo,compatUtils:d3,computed:Ts,createBlock:os,createCommentVNode:Jc,createElementBlock:xi,createElementVNode:Nr,createHydrationRenderer:$C,createPropsRestProxy:s3,createRenderer:jC,createSlots:EF,createStaticVNode:ZC,createTextVNode:qh,createVNode:ri,defineAsyncComponent:yF,defineComponent:Vp,defineEmits:QF,defineExpose:e3,defineProps:JF,get devtools(){return Ph},getCurrentInstance:Vl,getTransitionRawChildren:jy,guardReactiveProps:Vs,h:Zy,handleError:fu,initCustomFormatter:a3,inject:co,isMemoSame:rI,isRuntimeOnly:KF,isVNode:Ll,mergeDefaults:n3,mergeProps:G_,nextTick:zy,onActivated:xC,onBeforeMount:EC,onBeforeUnmount:Uy,onBeforeUpdate:TC,onDeactivated:bC,onErrorCaptured:CC,onMounted:Gp,onRenderTracked:PC,onRenderTriggered:AC,onServerPrefetch:SC,onUnmounted:Gy,onUpdated:Vy,openBlock:kr,popScopeId:rF,provide:sp,pushScopeId:tF,queuePostFlushCb:i1,registerRuntimeCompiler:qF,renderList:Gc,renderSlot:$s,resolveComponent:ga,resolveDirective:MC,resolveDynamicComponent:w_,resolveFilter:h3,resolveTransitionHooks:Zh,setBlockTracking:Xx,setDevtoolsHook:fC,setTransitionHooks:su,ssrContextKey:eI,ssrUtils:u3,toHandlers:DC,transformVNodeArgs:UF,useAttrs:i3,useSSRContext:tI,useSlots:r3,useTransitionState:o1,version:iI,warn:Kz,watch:Vh,watchEffect:pF,watchPostEffect:_C,watchSyncEffect:mF,withAsyncContext:o3,withCtx:Fo,withDefaults:t3,withDirectives:b_,withMemo:l3,withScopeId:iF,Transition:Ky,TransitionGroup:F3,VueElement:qy,createApp:vI,createSSRApp:K3,defineCustomElement:nI,defineSSRCustomElement:I3,hydrate:yI,initDirectivesForSSR:X3,render:nb,useCssModule:O3,useCssVars:D3,vModelCheckbox:p1,vModelDynamic:fI,vModelRadio:m1,vModelSelect:hI,vModelText:W_,vShow:Z_,withKeys:Z3,withModifiers:ib},Symbol.toStringTag,{value:"Module"})),Q3=!1;/*!
  * pinia v2.0.28
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const eB=Symbol();var OS;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(OS||(OS={}));function tB(){const t=HP(!0),e=t.run(()=>Nh({}));let r=[],n=[];const s=Ly({install(u){s._a=u,u.provide(eB,s),u.config.globalProperties.$pinia=s,n.forEach(d=>r.push(d)),n=[]},use(u){return!this._a&&!Q3?n.push(u):r.push(u),this},_p:r,_a:null,_e:t,_s:new Map,state:e});return s}/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Ch=typeof window!="undefined";function rB(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const si=Object.assign;function J0(t,e){const r={};for(const n in e){const s=e[n];r[n]=ho(s)?s.map(t):t(s)}return r}const up=()=>{},ho=Array.isArray,iB=/\/$/,nB=t=>t.replace(iB,"");function Q0(t,e,r="/"){let n,s={},u="",d="";const o=e.indexOf("#");let g=e.indexOf("?");return o<g&&o>=0&&(g=-1),g>-1&&(n=e.slice(0,g),u=e.slice(g+1,o>-1?o:e.length),s=t(u)),o>-1&&(n=n||e.slice(0,o),d=e.slice(o,e.length)),n=lB(n!=null?n:e,r),{fullPath:n+(u&&"?")+u+d,path:n,query:s,hash:d}}function sB(t,e){const r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function DS(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function oB(t,e,r){const n=e.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&Yh(e.matched[n],r.matched[s])&&bI(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function Yh(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function bI(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!aB(t[r],e[r]))return!1;return!0}function aB(t,e){return ho(t)?RS(t,e):ho(e)?RS(e,t):t===e}function RS(t,e){return ho(e)?t.length===e.length&&t.every((r,n)=>r===e[n]):t.length===1&&t[0]===e}function lB(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),n=t.split("/");let s=r.length-1,u,d;for(u=0;u<n.length;u++)if(d=n[u],d!==".")if(d==="..")s>1&&s--;else break;return r.slice(0,s).join("/")+"/"+n.slice(u-(u===n.length?1:0)).join("/")}var Sp;(function(t){t.pop="pop",t.push="push"})(Sp||(Sp={}));var hp;(function(t){t.back="back",t.forward="forward",t.unknown=""})(hp||(hp={}));function cB(t){if(!t)if(Ch){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),nB(t)}const uB=/^[^#]+#/;function hB(t,e){return t.replace(uB,"#")+e}function dB(t,e){const r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-r.left-(e.left||0),top:n.top-r.top-(e.top||0)}}const Xy=()=>({left:window.pageXOffset,top:window.pageYOffset});function fB(t){let e;if("el"in t){const r=t.el,n=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=dB(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function LS(t,e){return(history.state?history.state.position-e:-1)+t}const sb=new Map;function pB(t,e){sb.set(t,e)}function mB(t){const e=sb.get(t);return sb.delete(t),e}let gB=()=>location.protocol+"//"+location.host;function wI(t,e){const{pathname:r,search:n,hash:s}=e,u=t.indexOf("#");if(u>-1){let o=s.includes(t.slice(u))?t.slice(u).length:1,g=s.slice(o);return g[0]!=="/"&&(g="/"+g),DS(g,"")}return DS(r,t)+n+s}function _B(t,e,r,n){let s=[],u=[],d=null;const o=({state:P})=>{const I=wI(t,location),R=r.value,z=e.value;let B=0;if(P){if(r.value=I,e.value=P,d&&d===R){d=null;return}B=z?P.position-z.position:0}else n(I);s.forEach($=>{$(r.value,R,{delta:B,type:Sp.pop,direction:B?B>0?hp.forward:hp.back:hp.unknown})})};function g(){d=r.value}function x(P){s.push(P);const I=()=>{const R=s.indexOf(P);R>-1&&s.splice(R,1)};return u.push(I),I}function E(){const{history:P}=window;!P.state||P.replaceState(si({},P.state,{scroll:Xy()}),"")}function S(){for(const P of u)P();u=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",E)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",E),{pauseListeners:g,listen:x,destroy:S}}function kS(t,e,r,n=!1,s=!1){return{back:t,current:e,forward:r,replaced:n,position:window.history.length,scroll:s?Xy():null}}function yB(t){const{history:e,location:r}=window,n={value:wI(t,r)},s={value:e.state};s.value||u(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function u(g,x,E){const S=t.indexOf("#"),P=S>-1?(r.host&&document.querySelector("base")?t:t.slice(S))+g:gB()+t+g;try{e[E?"replaceState":"pushState"](x,"",P),s.value=x}catch(I){console.error(I),r[E?"replace":"assign"](P)}}function d(g,x){const E=si({},e.state,kS(s.value.back,g,s.value.forward,!0),x,{position:s.value.position});u(g,E,!0),n.value=g}function o(g,x){const E=si({},s.value,e.state,{forward:g,scroll:Xy()});u(E.current,E,!0);const S=si({},kS(n.value,g,null),{position:E.position+1},x);u(g,S,!1),n.value=g}return{location:n,state:s,push:o,replace:d}}function vB(t){t=cB(t);const e=yB(t),r=_B(t,e.state,e.location,e.replace);function n(u,d=!0){d||r.pauseListeners(),history.go(u)}const s=si({location:"",base:t,go:n,createHref:hB.bind(null,t)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function xB(t){return typeof t=="string"||t&&typeof t=="object"}function EI(t){return typeof t=="string"||typeof t=="symbol"}const pl={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},TI=Symbol("");var zS;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(zS||(zS={}));function Jh(t,e){return si(new Error,{type:t,[TI]:!0},e)}function ua(t,e){return t instanceof Error&&TI in t&&(e==null||!!(t.type&e))}const FS="[^/]+?",bB={sensitive:!1,strict:!1,start:!0,end:!0},wB=/[.+*?^${}()[\]/\\]/g;function EB(t,e){const r=si({},bB,e),n=[];let s=r.start?"^":"";const u=[];for(const x of t){const E=x.length?[]:[90];r.strict&&!x.length&&(s+="/");for(let S=0;S<x.length;S++){const P=x[S];let I=40+(r.sensitive?.25:0);if(P.type===0)S||(s+="/"),s+=P.value.replace(wB,"\\$&"),I+=40;else if(P.type===1){const{value:R,repeatable:z,optional:B,regexp:$}=P;u.push({name:R,repeatable:z,optional:B});const j=$||FS;if(j!==FS){I+=10;try{new RegExp(`(${j})`)}catch(K){throw new Error(`Invalid custom RegExp for param "${R}" (${j}): `+K.message)}}let G=z?`((?:${j})(?:/(?:${j}))*)`:`(${j})`;S||(G=B&&x.length<2?`(?:/${G})`:"/"+G),B&&(G+="?"),s+=G,I+=20,B&&(I+=-8),z&&(I+=-20),j===".*"&&(I+=-50)}E.push(I)}n.push(E)}if(r.strict&&r.end){const x=n.length-1;n[x][n[x].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const d=new RegExp(s,r.sensitive?"":"i");function o(x){const E=x.match(d),S={};if(!E)return null;for(let P=1;P<E.length;P++){const I=E[P]||"",R=u[P-1];S[R.name]=I&&R.repeatable?I.split("/"):I}return S}function g(x){let E="",S=!1;for(const P of t){(!S||!E.endsWith("/"))&&(E+="/"),S=!1;for(const I of P)if(I.type===0)E+=I.value;else if(I.type===1){const{value:R,repeatable:z,optional:B}=I,$=R in x?x[R]:"";if(ho($)&&!z)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const j=ho($)?$.join("/"):$;if(!j)if(B)P.length<2&&(E.endsWith("/")?E=E.slice(0,-1):S=!0);else throw new Error(`Missing required param "${R}"`);E+=j}}return E||"/"}return{re:d,score:n,keys:u,parse:o,stringify:g}}function TB(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=e[r]-t[r];if(n)return n;r++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function SB(t,e){let r=0;const n=t.score,s=e.score;for(;r<n.length&&r<s.length;){const u=TB(n[r],s[r]);if(u)return u;r++}if(Math.abs(s.length-n.length)===1){if(BS(n))return 1;if(BS(s))return-1}return s.length-n.length}function BS(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const AB={type:0,value:""},PB=/[a-zA-Z0-9_]/;function CB(t){if(!t)return[[]];if(t==="/")return[[AB]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(I){throw new Error(`ERR (${r})/"${x}": ${I}`)}let r=0,n=r;const s=[];let u;function d(){u&&s.push(u),u=[]}let o=0,g,x="",E="";function S(){!x||(r===0?u.push({type:0,value:x}):r===1||r===2||r===3?(u.length>1&&(g==="*"||g==="+")&&e(`A repeatable param (${x}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:x,regexp:E,repeatable:g==="*"||g==="+",optional:g==="*"||g==="?"})):e("Invalid state to consume buffer"),x="")}function P(){x+=g}for(;o<t.length;){if(g=t[o++],g==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:g==="/"?(x&&S(),d()):g===":"?(S(),r=1):P();break;case 4:P(),r=n;break;case 1:g==="("?r=2:PB.test(g)?P():(S(),r=0,g!=="*"&&g!=="?"&&g!=="+"&&o--);break;case 2:g===")"?E[E.length-1]=="\\"?E=E.slice(0,-1)+g:r=3:E+=g;break;case 3:S(),r=0,g!=="*"&&g!=="?"&&g!=="+"&&o--,E="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${x}"`),S(),d(),s}function IB(t,e,r){const n=EB(CB(t.path),r),s=si(n,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function MB(t,e){const r=[],n=new Map;e=$S({strict:!1,end:!0,sensitive:!1},e);function s(E){return n.get(E)}function u(E,S,P){const I=!P,R=OB(E);R.aliasOf=P&&P.record;const z=$S(e,E),B=[R];if("alias"in E){const G=typeof E.alias=="string"?[E.alias]:E.alias;for(const K of G)B.push(si({},R,{components:P?P.record.components:R.components,path:K,aliasOf:P?P.record:R}))}let $,j;for(const G of B){const{path:K}=G;if(S&&K[0]!=="/"){const X=S.record.path,re=X[X.length-1]==="/"?"":"/";G.path=S.record.path+(K&&re+K)}if($=IB(G,S,z),P?P.alias.push($):(j=j||$,j!==$&&j.alias.push($),I&&E.name&&!jS($)&&d(E.name)),R.children){const X=R.children;for(let re=0;re<X.length;re++)u(X[re],$,P&&P.children[re])}P=P||$,($.record.components&&Object.keys($.record.components).length||$.record.name||$.record.redirect)&&g($)}return j?()=>{d(j)}:up}function d(E){if(EI(E)){const S=n.get(E);S&&(n.delete(E),r.splice(r.indexOf(S),1),S.children.forEach(d),S.alias.forEach(d))}else{const S=r.indexOf(E);S>-1&&(r.splice(S,1),E.record.name&&n.delete(E.record.name),E.children.forEach(d),E.alias.forEach(d))}}function o(){return r}function g(E){let S=0;for(;S<r.length&&SB(E,r[S])>=0&&(E.record.path!==r[S].record.path||!SI(E,r[S]));)S++;r.splice(S,0,E),E.record.name&&!jS(E)&&n.set(E.record.name,E)}function x(E,S){let P,I={},R,z;if("name"in E&&E.name){if(P=n.get(E.name),!P)throw Jh(1,{location:E});z=P.record.name,I=si(NS(S.params,P.keys.filter(j=>!j.optional).map(j=>j.name)),E.params&&NS(E.params,P.keys.map(j=>j.name))),R=P.stringify(I)}else if("path"in E)R=E.path,P=r.find(j=>j.re.test(R)),P&&(I=P.parse(R),z=P.record.name);else{if(P=S.name?n.get(S.name):r.find(j=>j.re.test(S.path)),!P)throw Jh(1,{location:E,currentLocation:S});z=P.record.name,I=si({},S.params,E.params),R=P.stringify(I)}const B=[];let $=P;for(;$;)B.unshift($.record),$=$.parent;return{name:z,path:R,params:I,matched:B,meta:RB(B)}}return t.forEach(E=>u(E)),{addRoute:u,resolve:x,removeRoute:d,getRoutes:o,getRecordMatcher:s}}function NS(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function OB(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:DB(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function DB(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(const n in t.components)e[n]=typeof r=="boolean"?r:r[n];return e}function jS(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function RB(t){return t.reduce((e,r)=>si(e,r.meta),{})}function $S(t,e){const r={};for(const n in t)r[n]=n in e?e[n]:t[n];return r}function SI(t,e){return e.children.some(r=>r===t||SI(t,r))}const AI=/#/g,LB=/&/g,kB=/\//g,zB=/=/g,FB=/\?/g,PI=/\+/g,BB=/%5B/g,NB=/%5D/g,CI=/%5E/g,jB=/%60/g,II=/%7B/g,$B=/%7C/g,MI=/%7D/g,VB=/%20/g;function g1(t){return encodeURI(""+t).replace($B,"|").replace(BB,"[").replace(NB,"]")}function UB(t){return g1(t).replace(II,"{").replace(MI,"}").replace(CI,"^")}function ob(t){return g1(t).replace(PI,"%2B").replace(VB,"+").replace(AI,"%23").replace(LB,"%26").replace(jB,"`").replace(II,"{").replace(MI,"}").replace(CI,"^")}function GB(t){return ob(t).replace(zB,"%3D")}function HB(t){return g1(t).replace(AI,"%23").replace(FB,"%3F")}function WB(t){return t==null?"":HB(t).replace(kB,"%2F")}function q_(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function ZB(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const u=n[s].replace(PI," "),d=u.indexOf("="),o=q_(d<0?u:u.slice(0,d)),g=d<0?null:q_(u.slice(d+1));if(o in e){let x=e[o];ho(x)||(x=e[o]=[x]),x.push(g)}else e[o]=g}return e}function VS(t){let e="";for(let r in t){const n=t[r];if(r=GB(r),n==null){n!==void 0&&(e+=(e.length?"&":"")+r);continue}(ho(n)?n.map(u=>u&&ob(u)):[n&&ob(n)]).forEach(u=>{u!==void 0&&(e+=(e.length?"&":"")+r,u!=null&&(e+="="+u))})}return e}function qB(t){const e={};for(const r in t){const n=t[r];n!==void 0&&(e[r]=ho(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return e}const KB=Symbol(""),US=Symbol(""),Yy=Symbol(""),OI=Symbol(""),ab=Symbol("");function Nf(){let t=[];function e(n){return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}function r(){t=[]}return{add:e,list:()=>t,reset:r}}function vl(t,e,r,n,s){const u=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((d,o)=>{const g=S=>{S===!1?o(Jh(4,{from:r,to:e})):S instanceof Error?o(S):xB(S)?o(Jh(2,{from:e,to:S})):(u&&n.enterCallbacks[s]===u&&typeof S=="function"&&u.push(S),d())},x=t.call(n&&n.instances[s],e,r,g);let E=Promise.resolve(x);t.length<3&&(E=E.then(g)),E.catch(S=>o(S))})}function ex(t,e,r,n){const s=[];for(const u of t)for(const d in u.components){let o=u.components[d];if(!(e!=="beforeRouteEnter"&&!u.instances[d]))if(XB(o)){const x=(o.__vccOpts||o)[e];x&&s.push(vl(x,r,n,u,d))}else{let g=o();s.push(()=>g.then(x=>{if(!x)return Promise.reject(new Error(`Couldn't resolve component "${d}" at "${u.path}"`));const E=rB(x)?x.default:x;u.components[d]=E;const P=(E.__vccOpts||E)[e];return P&&vl(P,r,n,u,d)()}))}}return s}function XB(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function GS(t){const e=co(Yy),r=co(OI),n=Ts(()=>e.resolve(Kc(t.to))),s=Ts(()=>{const{matched:g}=n.value,{length:x}=g,E=g[x-1],S=r.matched;if(!E||!S.length)return-1;const P=S.findIndex(Yh.bind(null,E));if(P>-1)return P;const I=HS(g[x-2]);return x>1&&HS(E)===I&&S[S.length-1].path!==I?S.findIndex(Yh.bind(null,g[x-2])):P}),u=Ts(()=>s.value>-1&&QB(r.params,n.value.params)),d=Ts(()=>s.value>-1&&s.value===r.matched.length-1&&bI(r.params,n.value.params));function o(g={}){return JB(g)?e[Kc(t.replace)?"replace":"push"](Kc(t.to)).catch(up):Promise.resolve()}return{route:n,href:Ts(()=>n.value.href),isActive:u,isExactActive:d,navigate:o}}const YB=Vp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:GS,setup(t,{slots:e}){const r=Rl(GS(t)),{options:n}=co(Yy),s=Ts(()=>({[WS(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[WS(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const u=e.default&&e.default(r);return t.custom?u:Zy("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},u)}}}),DI=YB;function JB(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function QB(t,e){for(const r in e){const n=e[r],s=t[r];if(typeof n=="string"){if(n!==s)return!1}else if(!ho(s)||s.length!==n.length||n.some((u,d)=>u!==s[d]))return!1}return!0}function HS(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const WS=(t,e,r)=>t!=null?t:e!=null?e:r,e4=Vp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:r}){const n=co(ab),s=Ts(()=>t.route||n.value),u=co(US,0),d=Ts(()=>{let x=Kc(u);const{matched:E}=s.value;let S;for(;(S=E[x])&&!S.components;)x++;return x}),o=Ts(()=>s.value.matched[d.value]);sp(US,Ts(()=>d.value+1)),sp(KB,o),sp(ab,s);const g=Nh();return Vh(()=>[g.value,o.value,t.name],([x,E,S],[P,I,R])=>{E&&(E.instances[S]=x,I&&I!==E&&x&&x===P&&(E.leaveGuards.size||(E.leaveGuards=I.leaveGuards),E.updateGuards.size||(E.updateGuards=I.updateGuards))),x&&E&&(!I||!Yh(E,I)||!P)&&(E.enterCallbacks[S]||[]).forEach(z=>z(x))},{flush:"post"}),()=>{const x=s.value,E=t.name,S=o.value,P=S&&S.components[E];if(!P)return ZS(r.default,{Component:P,route:x});const I=S.props[E],R=I?I===!0?x.params:typeof I=="function"?I(x):I:null,B=Zy(P,si({},R,e,{onVnodeUnmounted:$=>{$.component.isUnmounted&&(S.instances[E]=null)},ref:g}));return ZS(r.default,{Component:B,route:x})||B}}});function ZS(t,e){if(!t)return null;const r=t(e);return r.length===1?r[0]:r}const RI=e4;function t4(t){const e=MB(t.routes,t),r=t.parseQuery||ZB,n=t.stringifyQuery||VS,s=t.history,u=Nf(),d=Nf(),o=Nf(),g=oC(pl);let x=pl;Ch&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const E=J0.bind(null,Ne=>""+Ne),S=J0.bind(null,WB),P=J0.bind(null,q_);function I(Ne,tt){let ft,mt;return EI(Ne)?(ft=e.getRecordMatcher(Ne),mt=tt):mt=Ne,e.addRoute(mt,ft)}function R(Ne){const tt=e.getRecordMatcher(Ne);tt&&e.removeRoute(tt)}function z(){return e.getRoutes().map(Ne=>Ne.record)}function B(Ne){return!!e.getRecordMatcher(Ne)}function $(Ne,tt){if(tt=si({},tt||g.value),typeof Ne=="string"){const ye=Q0(r,Ne,tt.path),Me=e.resolve({path:ye.path},tt),$e=s.createHref(ye.fullPath);return si(ye,Me,{params:P(Me.params),hash:q_(ye.hash),redirectedFrom:void 0,href:$e})}let ft;if("path"in Ne)ft=si({},Ne,{path:Q0(r,Ne.path,tt.path).path});else{const ye=si({},Ne.params);for(const Me in ye)ye[Me]==null&&delete ye[Me];ft=si({},Ne,{params:S(Ne.params)}),tt.params=S(tt.params)}const mt=e.resolve(ft,tt),Ht=Ne.hash||"";mt.params=E(P(mt.params));const Zt=sB(n,si({},Ne,{hash:UB(Ht),path:mt.path})),Lt=s.createHref(Zt);return si({fullPath:Zt,hash:Ht,query:n===VS?qB(Ne.query):Ne.query||{}},mt,{redirectedFrom:void 0,href:Lt})}function j(Ne){return typeof Ne=="string"?Q0(r,Ne,g.value.path):si({},Ne)}function G(Ne,tt){if(x!==Ne)return Jh(8,{from:tt,to:Ne})}function K(Ne){return ue(Ne)}function X(Ne){return K(si(j(Ne),{replace:!0}))}function re(Ne){const tt=Ne.matched[Ne.matched.length-1];if(tt&&tt.redirect){const{redirect:ft}=tt;let mt=typeof ft=="function"?ft(Ne):ft;return typeof mt=="string"&&(mt=mt.includes("?")||mt.includes("#")?mt=j(mt):{path:mt},mt.params={}),si({query:Ne.query,hash:Ne.hash,params:"path"in mt?{}:Ne.params},mt)}}function ue(Ne,tt){const ft=x=$(Ne),mt=g.value,Ht=Ne.state,Zt=Ne.force,Lt=Ne.replace===!0,ye=re(ft);if(ye)return ue(si(j(ye),{state:typeof ye=="object"?si({},Ht,ye.state):Ht,force:Zt,replace:Lt}),tt||ft);const Me=ft;Me.redirectedFrom=tt;let $e;return!Zt&&oB(n,mt,ft)&&($e=Jh(16,{to:Me,from:mt}),Et(mt,mt,!0,!1)),($e?Promise.resolve($e):we(Me,mt)).catch(it=>ua(it)?ua(it,2)?it:ht(it):Je(it,Me,mt)).then(it=>{if(it){if(ua(it,2))return ue(si({replace:Lt},j(it.to),{state:typeof it.to=="object"?si({},Ht,it.to.state):Ht,force:Zt}),tt||Me)}else it=ke(Me,mt,!0,Lt,Ht);return xe(Me,mt,it),it})}function ne(Ne,tt){const ft=G(Ne,tt);return ft?Promise.reject(ft):Promise.resolve()}function we(Ne,tt){let ft;const[mt,Ht,Zt]=r4(Ne,tt);ft=ex(mt.reverse(),"beforeRouteLeave",Ne,tt);for(const ye of mt)ye.leaveGuards.forEach(Me=>{ft.push(vl(Me,Ne,tt))});const Lt=ne.bind(null,Ne,tt);return ft.push(Lt),xh(ft).then(()=>{ft=[];for(const ye of u.list())ft.push(vl(ye,Ne,tt));return ft.push(Lt),xh(ft)}).then(()=>{ft=ex(Ht,"beforeRouteUpdate",Ne,tt);for(const ye of Ht)ye.updateGuards.forEach(Me=>{ft.push(vl(Me,Ne,tt))});return ft.push(Lt),xh(ft)}).then(()=>{ft=[];for(const ye of Ne.matched)if(ye.beforeEnter&&!tt.matched.includes(ye))if(ho(ye.beforeEnter))for(const Me of ye.beforeEnter)ft.push(vl(Me,Ne,tt));else ft.push(vl(ye.beforeEnter,Ne,tt));return ft.push(Lt),xh(ft)}).then(()=>(Ne.matched.forEach(ye=>ye.enterCallbacks={}),ft=ex(Zt,"beforeRouteEnter",Ne,tt),ft.push(Lt),xh(ft))).then(()=>{ft=[];for(const ye of d.list())ft.push(vl(ye,Ne,tt));return ft.push(Lt),xh(ft)}).catch(ye=>ua(ye,8)?ye:Promise.reject(ye))}function xe(Ne,tt,ft){for(const mt of o.list())mt(Ne,tt,ft)}function ke(Ne,tt,ft,mt,Ht){const Zt=G(Ne,tt);if(Zt)return Zt;const Lt=tt===pl,ye=Ch?history.state:{};ft&&(mt||Lt?s.replace(Ne.fullPath,si({scroll:Lt&&ye&&ye.scroll},Ht)):s.push(Ne.fullPath,Ht)),g.value=Ne,Et(Ne,tt,ft,Lt),ht()}let Ie;function Fe(){Ie||(Ie=s.listen((Ne,tt,ft)=>{if(!et.listening)return;const mt=$(Ne),Ht=re(mt);if(Ht){ue(si(Ht,{replace:!0}),mt).catch(up);return}x=mt;const Zt=g.value;Ch&&pB(LS(Zt.fullPath,ft.delta),Xy()),we(mt,Zt).catch(Lt=>ua(Lt,12)?Lt:ua(Lt,2)?(ue(Lt.to,mt).then(ye=>{ua(ye,20)&&!ft.delta&&ft.type===Sp.pop&&s.go(-1,!1)}).catch(up),Promise.reject()):(ft.delta&&s.go(-ft.delta,!1),Je(Lt,mt,Zt))).then(Lt=>{Lt=Lt||ke(mt,Zt,!1),Lt&&(ft.delta&&!ua(Lt,8)?s.go(-ft.delta,!1):ft.type===Sp.pop&&ua(Lt,20)&&s.go(-1,!1)),xe(mt,Zt,Lt)}).catch(up)}))}let se=Nf(),Be=Nf(),Ve;function Je(Ne,tt,ft){ht(Ne);const mt=Be.list();return mt.length?mt.forEach(Ht=>Ht(Ne,tt,ft)):console.error(Ne),Promise.reject(Ne)}function ut(){return Ve&&g.value!==pl?Promise.resolve():new Promise((Ne,tt)=>{se.add([Ne,tt])})}function ht(Ne){return Ve||(Ve=!Ne,Fe(),se.list().forEach(([tt,ft])=>Ne?ft(Ne):tt()),se.reset()),Ne}function Et(Ne,tt,ft,mt){const{scrollBehavior:Ht}=t;if(!Ch||!Ht)return Promise.resolve();const Zt=!ft&&mB(LS(Ne.fullPath,0))||(mt||!ft)&&history.state&&history.state.scroll||null;return zy().then(()=>Ht(Ne,tt,Zt)).then(Lt=>Lt&&fB(Lt)).catch(Lt=>Je(Lt,Ne,tt))}const Qt=Ne=>s.go(Ne);let Nt;const yt=new Set,et={currentRoute:g,listening:!0,addRoute:I,removeRoute:R,hasRoute:B,getRoutes:z,resolve:$,options:t,push:K,replace:X,go:Qt,back:()=>Qt(-1),forward:()=>Qt(1),beforeEach:u.add,beforeResolve:d.add,afterEach:o.add,onError:Be.add,isReady:ut,install(Ne){const tt=this;Ne.component("RouterLink",DI),Ne.component("RouterView",RI),Ne.config.globalProperties.$router=tt,Object.defineProperty(Ne.config.globalProperties,"$route",{enumerable:!0,get:()=>Kc(g)}),Ch&&!Nt&&g.value===pl&&(Nt=!0,K(s.location).catch(Ht=>{}));const ft={};for(const Ht in pl)ft[Ht]=Ts(()=>g.value[Ht]);Ne.provide(Yy,tt),Ne.provide(OI,Rl(ft)),Ne.provide(ab,g);const mt=Ne.unmount;yt.add(Ne),Ne.unmount=function(){yt.delete(Ne),yt.size<1&&(x=pl,Ie&&Ie(),Ie=null,g.value=pl,Nt=!1,Ve=!1),mt()}}};return et}function xh(t){return t.reduce((e,r)=>e.then(()=>r()),Promise.resolve())}function r4(t,e){const r=[],n=[],s=[],u=Math.max(e.matched.length,t.matched.length);for(let d=0;d<u;d++){const o=e.matched[d];o&&(t.matched.find(x=>Yh(x,o))?n.push(o):r.push(o));const g=t.matched[d];g&&(e.matched.find(x=>Yh(x,g))||s.push(g))}return[r,n,s]}function i4(){return co(Yy)}var Hp=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r};const n4={components:{RouterLink:DI,RouterView:RI},data(){return{}},async created(){const t=i4();console.log("waiting on router"),await t.isReady(),console.log("created")}};function s4(t,e,r,n,s,u){const d=ga("RouterView");return kr(),os(d)}var o4=Hp(n4,[["render",s4]]),a4="/OpenEO-processes-js/assets/logo-pages.2d384328.svg";const l4={},c4={class:"navbar navbar-expand-lg bg-dark"},u4=ZC('<div class="container-fluid"><div class="collapse navbar-collapse" id="navbarSupportedContent"><div style="height:5vh;margin-left:50px;margin-right:50px;"><img style="height:100%;" src="'+a4+'"></div><h4 style="color:#fff;">Demo performance openeo js - Browser</h4></div></div>',1),h4=[u4];function d4(t,e,r,n,s,u){return kr(),xi("nav",c4,h4)}var f4=Hp(l4,[["render",d4]]),Jy=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function p4(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function m4(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}),e}var LI={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(Jy,function(){var r,n,s;function u(o,g){if(!r)r=g;else if(!n)n=g;else{var x="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",E={};r(E),s=g(E),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([x],{type:"text/javascript"})))}}u(["exports"],function(o){var g=typeof self!="undefined"?self:{},x=E;function E(l,i,c,h){this.cx=3*l,this.bx=3*(c-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(h-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=c,this.p2y=h}E.prototype.sampleCurveX=function(l){return((this.ax*l+this.bx)*l+this.cx)*l},E.prototype.sampleCurveY=function(l){return((this.ay*l+this.by)*l+this.cy)*l},E.prototype.sampleCurveDerivativeX=function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},E.prototype.solveCurveX=function(l,i){var c,h,p,_,v;for(i===void 0&&(i=1e-6),p=l,v=0;v<8;v++){if(_=this.sampleCurveX(p)-l,Math.abs(_)<i)return p;var w=this.sampleCurveDerivativeX(p);if(Math.abs(w)<1e-6)break;p-=_/w}if((p=l)<(c=0))return c;if(p>(h=1))return h;for(;c<h;){if(_=this.sampleCurveX(p),Math.abs(_-l)<i)return p;l>_?c=p:h=p,p=.5*(h-c)+c}return p},E.prototype.solve=function(l,i){return this.sampleCurveY(this.solveCurveX(l,i))};var S=P;function P(l,i){this.x=l,this.y=i}P.prototype={clone:function(){return new P(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,i){return this.clone()._rotateAround(l,i)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var i=l.x-this.x,c=l.y-this.y;return i*i+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,i){return Math.atan2(this.x*i-this.y*l,this.x*l+this.y*i)},_matMult:function(l){var i=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=i,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var i=Math.cos(l),c=Math.sin(l),h=c*this.x+i*this.y;return this.x=i*this.x-c*this.y,this.y=h,this},_rotateAround:function(l,i){var c=Math.cos(l),h=Math.sin(l),p=i.y+h*(this.x-i.x)+c*(this.y-i.y);return this.x=i.x+c*(this.x-i.x)-h*(this.y-i.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},P.convert=function(l){return l instanceof P?l:Array.isArray(l)?new P(l[0],l[1]):l};const I=Math.PI/180,R=180/Math.PI;function z(l){return l*I}function B(l){return l*R}const $=[[0,0],[1,0],[1,1],[0,1]];function j(l){if(l<=0)return 0;if(l>=1)return 1;const i=l*l,c=i*l;return 4*(l<.5?c:3*(l-i)+c-.75)}function G(l,i,c,h){const p=new x(l,i,c,h);return function(_){return p.solve(_)}}const K=G(.25,.1,.25,1);function X(l,i,c){return Math.min(c,Math.max(i,l))}function re(l,i,c){return(c=X((c-l)/(i-l),0,1))*c*(3-2*c)}function ue(l,i,c){const h=c-i,p=((l-i)%h+h)%h+i;return p===i?c:p}function ne(l,i,c){if(!l.length)return c(null,[]);let h=l.length;const p=new Array(l.length);let _=null;l.forEach((v,w)=>{i(v,(A,C)=>{A&&(_=A),p[w]=C,--h==0&&c(_,p)})})}function we(l){const i=[];for(const c in l)i.push(l[c]);return i}function xe(l,...i){for(const c of i)for(const h in c)l[h]=c[h];return l}let ke=1;function Ie(){return ke++}function Fe(){return function l(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()}function se(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Be(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)}function Ve(l,i){l.forEach(c=>{i[c]&&(i[c]=i[c].bind(i))})}function Je(l,i){return l.indexOf(i,l.length-i.length)!==-1}function ut(l,i,c){const h={};for(const p in l)h[p]=i.call(c||this,l[p],p,l);return h}function ht(l,i,c){const h={};for(const p in l)i.call(c||this,l[p],p,l)&&(h[p]=l[p]);return h}function Et(l){return Array.isArray(l)?l.map(Et):typeof l=="object"&&l?ut(l,Et):l}const Qt={};function Nt(l){Qt[l]||(typeof console!="undefined"&&console.warn(l),Qt[l]=!0)}function yt(l,i,c){return(c.y-l.y)*(i.x-l.x)>(i.y-l.y)*(c.x-l.x)}function et(l){let i=0;for(let c,h,p=0,_=l.length,v=_-1;p<_;v=p++)c=l[p],h=l[v],i+=(h.x-c.x)*(c.y+h.y);return i}function Ne(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function tt(l){const i={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,h,p,_)=>{const v=p||_;return i[h]=!v||v.toLowerCase(),""}),i["max-age"]){const c=parseInt(i["max-age"],10);isNaN(c)?delete i["max-age"]:i["max-age"]=c}return i}let ft=null;function mt(l){if(ft==null){const i=l.navigator?l.navigator.userAgent:null;ft=!!l.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return ft}function Ht(l){try{const i=g[l];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}}function Zt(l,i){return[l[4*i],l[4*i+1],l[4*i+2],l[4*i+3]]}const Lt=g.performance;function ye(l){const i=l?l.url.toString():void 0;return Lt.getEntriesByName(i)}var Me="2.9.2";let $e,it,ot,st;const gt={now:()=>ot!==void 0?ot:g.performance.now(),setNow(l){ot=l},restoreNow(){ot=void 0},frame(l){const i=g.requestAnimationFrame(l);return{cancel:()=>g.cancelAnimationFrame(i)}},getImageData(l,i=0){const{width:c,height:h}=l;st||(st=g.document.createElement("canvas"));const p=st.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return(c>st.width||h>st.height)&&(st.width=c,st.height=h),p.clearRect(-i,-i,c+2*i,h+2*i),p.drawImage(l,0,0,c,h),p.getImageData(-i,-i,c+2*i,h+2*i)},resolveURL:l=>($e||($e=g.document.createElement("a")),$e.href=l,$e.href),get devicePixelRatio(){return g.devicePixelRatio},get prefersReducedMotion(){return!!g.matchMedia&&(it==null&&(it=g.matchMedia("(prefers-reduced-motion: reduce)")),it.matches)}};let lt;const Ye={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(lt==null){const l=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{lt={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):l}catch{lt=l}}return lt},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},pt={supported:!1,testSupport:function(l){!zt&&St&&(Yt?ur(l):Tt=l)}};let Tt,St,zt=!1,Yt=!1;function ur(l){const i=l.createTexture();l.bindTexture(l.TEXTURE_2D,i);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,St),l.isContextLost())return;pt.supported=!0}catch{}l.deleteTexture(i),zt=!0}g.document&&(St=g.document.createElement("img"),St.onload=function(){Tt&&ur(Tt),Tt=null,Yt=!0},St.onerror=function(){zt=!0,Tt=null},St.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const xr="01",fr="NO_ACCESS_TOKEN";function br(l){return l.indexOf("mapbox:")===0}function Qr(l){return Ye.API_URL_REGEX.test(l)}const Wi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ei(l){const i=l.match(Wi);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function ui(l){const i=l.params.length?`?${l.params.join("&")}`:"";return`${l.protocol}://${l.authority}${l.path}${i}`}function Un(l){if(!l)return null;const i=l.split(".");if(!i||i.length!==3)return null;try{return JSON.parse(decodeURIComponent(g.atob(i[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class or{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const c=Un(Ye.ACCESS_TOKEN);let h="";return h=c&&c.u?g.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(p,_)=>String.fromCharCode(Number("0x"+_)))):Ye.ACCESS_TOKEN||"",i?`mapbox.eventData.${i}:${h}`:`mapbox.eventData:${h}`}fetchEventData(){const i=Ht("localStorage"),c=this.getStorageKey(),h=this.getStorageKey("uuid");if(i)try{const p=g.localStorage.getItem(c);p&&(this.eventData=JSON.parse(p));const _=g.localStorage.getItem(h);_&&(this.anonId=_)}catch{Nt("Unable to read from LocalStorage")}}saveEventData(){const i=Ht("localStorage"),c=this.getStorageKey(),h=this.getStorageKey("uuid");if(i)try{g.localStorage.setItem(h,this.anonId),Object.keys(this.eventData).length>=1&&g.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{Nt("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,c,h,p){if(!Ye.EVENTS_URL)return;const _=Ei(Ye.EVENTS_URL);_.params.push(`access_token=${p||Ye.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(i).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:Me,skuId:xr,userId:this.anonId},w=c?xe(v,c):v,A={url:ui(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};this.pendingRequest=fe(A,C=>{this.pendingRequest=null,h(C),this.saveEventData(),this.processRequests(p)})}queueRequest(i,c){this.queue.push(i),this.processRequests(c)}}const Gt=new class extends or{constructor(l){super("appUserTurnstile"),this._customAccessToken=l}postTurnstileEvent(l,i){Ye.EVENTS_URL&&Ye.ACCESS_TOKEN&&Array.isArray(l)&&l.some(c=>br(c)||Qr(c))&&this.queueRequest(Date.now(),i)}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Un(Ye.ACCESS_TOKEN),c=i?i.u:Ye.ACCESS_TOKEN;let h=c!==this.eventData.tokenU;Be(this.anonId)||(this.anonId=Fe(),h=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),v=new Date(p),w=(p-this.eventData.lastSuccess)/864e5;h=h||w>=1||w<-1||_.getDate()!==v.getDate()}else h=!0;h?this.postEvent(p,{"enabled.telemetry":!1},_=>{_||(this.eventData.lastSuccess=p,this.eventData.tokenU=c)},l):this.processRequests()}},rr=Gt.postTurnstileEvent.bind(Gt),Sr=new class extends or{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(l,i,c,h){this.skuToken=i,this.errorCb=h,Ye.EVENTS_URL&&(c||Ye.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(fr)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:c}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),Be(this.anonId)||(this.anonId=Fe()),this.postEvent(c,{skuToken:this.skuToken},h=>{h?this.errorCb(h):i&&(this.success[i]=!0)},l))}},zr=Sr.postMapLoadEvent.bind(Sr),Ii=new class extends or{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(l,i,c,h){if(!Ye.API_URL||!Ye.SESSION_PATH)return;const p=Ei(Ye.API_URL+Ye.SESSION_PATH);p.params.push(`sku=${i||""}`),p.params.push(`access_token=${h||Ye.ACCESS_TOKEN||""}`);const _={url:ui(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Te(_,v=>{this.pendingRequest=null,c(v),this.saveEventData(),this.processRequests(h)})}getSessionAPI(l,i,c,h){this.skuToken=i,this.errorCb=h,Ye.SESSION_PATH&&Ye.API_URL&&(c||Ye.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(fr)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:c}=this.queue.shift();i&&this.success[i]||this.getSession(c,this.skuToken,h=>{h?this.errorCb(h):i&&(this.success[i]=!0)},l)}},Ks=Ii.getSessionAPI.bind(Ii),Gn=new Set;let rn,Ln=500,Ra=50,Zi={};function Wo(l){const i=W(l);let c,h;i&&i.forEach(_=>{const v=_.split("=");v[0]==="language"?c=v[1]:v[0]==="worldview"&&(h=v[1])});let p="mapbox-tiles";return c&&(p+=`-${c}`),h&&(p+=`-${h}`),p}function me(l){g.caches&&!Zi[l]&&(Zi[l]=g.caches.open(l))}function W(l){const i=l.indexOf("?");return i>0?l.slice(i+1).split("&"):[]}function J(l){const i=l.indexOf("?");if(i<0)return l;const c=W(l).filter(h=>{const p=h.split("=");return p[0]==="language"||p[0]==="worldview"});return c.length?`${l.slice(0,i)}?${c.join("&")}`:l.slice(0,i)}let pe=1/0;const Ee={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ee);class Oe extends Error{constructor(i,c,h){c===401&&Qr(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(i),this.status=c,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ee=Ne()?()=>self.worker&&self.worker.referrer:()=>(g.location.protocol==="blob:"?g.parent:g).location.href,q=function(l,i){if(!(/^file:/.test(c=l.url)||/^file:/.test(ee())&&!/^\w+:/.test(c))){if(g.fetch&&g.Request&&g.AbortController&&g.Request.prototype.hasOwnProperty("signal"))return function(h,p){const _=new g.AbortController,v=new g.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:ee(),signal:_.signal});let w=!1,A=!1;const C=(D=v.url).indexOf("sku=")>0&&Qr(D);var D;h.type==="json"&&v.headers.set("Accept","application/json");const k=(V,H,Q)=>{if(A)return;if(V&&V.message!=="SecurityError"&&Nt(V),H&&Q)return F(H);const ce=Date.now();g.fetch(v).then(ge=>{if(ge.ok){const Ce=C?ge.clone():null;return F(ge,Ce,ce)}return p(new Oe(ge.statusText,ge.status,h.url))}).catch(ge=>{ge.code!==20&&p(new Error(ge.message))})},F=(V,H,Q)=>{(h.type==="arrayBuffer"?V.arrayBuffer():h.type==="json"?V.json():V.text()).then(ce=>{A||(H&&Q&&function(ge,Ce,Pe){const De=Wo(ge.url);if(me(De),!Zi[De])return;const Le={status:Ce.status,statusText:Ce.statusText,headers:new g.Headers};Ce.headers.forEach((Xe,at)=>Le.headers.set(at,Xe));const je=tt(Ce.headers.get("Cache-Control")||"");if(je["no-store"])return;je["max-age"]&&Le.headers.set("Expires",new Date(Pe+1e3*je["max-age"]).toUTCString());const qe=Le.headers.get("Expires");qe&&(new Date(qe).getTime()-Pe<42e4||function(Xe,at){if(rn===void 0)try{new Response(new ReadableStream),rn=!0}catch{rn=!1}rn?at(Xe.body):Xe.blob().then(at)}(Ce,Xe=>{const at=new g.Response(Xe,Le);me(De),Zi[De]&&Zi[De].then(vt=>vt.put(J(ge.url),at)).catch(vt=>Nt(vt.message))}))}(v,H,Q),w=!0,p(null,ce,V.headers.get("Cache-Control"),V.headers.get("Expires")))}).catch(ce=>{A||p(new Error(ce.message))})};return C?function(V,H){const Q=Wo(V.url);if(me(Q),!Zi[Q])return H(null);const ce=J(V.url);Zi[Q].then(ge=>{ge.match(ce).then(Ce=>{const Pe=function(De){if(!De)return!1;const Le=new Date(De.headers.get("Expires")||0),je=tt(De.headers.get("Cache-Control")||"");return Le>Date.now()&&!je["no-cache"]}(Ce);ge.delete(ce),Pe&&ge.put(ce,Ce.clone()),H(null,Ce,Pe)}).catch(H)}).catch(H)}(v,k):k(null,null),{cancel:()=>{A=!0,w||_.abort()}}}(l,i);if(Ne()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,i,void 0,!0)}var c;return function(h,p){const _=new g.XMLHttpRequest;_.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const v in h.headers)_.setRequestHeader(v,h.headers[v]);return h.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=h.credentials==="include",_.onerror=()=>{p(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let v=_.response;if(h.type==="json")try{v=JSON.parse(_.response)}catch(w){return p(w)}p(null,v,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else p(new Oe(_.statusText,_.status,h.url))},_.send(h.body),{cancel:()=>_.abort()}}(l,i)},Y=function(l,i){return q(xe(l,{type:"arrayBuffer"}),i)},fe=function(l,i){return q(xe(l,{method:"POST"}),i)},Te=function(l,i){return q(xe(l,{method:"GET"}),i)};function rt(l){const i=g.document.createElement("a");return i.href=l,i.protocol===g.document.location.protocol&&i.host===g.document.location.host}const He="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let At,Ft;At=[],Ft=0;const jt=function(l,i){if(pt.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),Ft>=Ye.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:l,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return At.push(_),_}Ft++;let c=!1;const h=()=>{if(!c)for(c=!0,Ft--;At.length&&Ft<Ye.MAX_PARALLEL_IMAGE_REQUESTS;){const _=At.shift(),{requestParameters:v,callback:w,cancelled:A}=_;A||(_.cancel=jt(v,w).cancel)}},p=Y(l,(_,v,w,A)=>{h(),_?i(_):v&&(g.createImageBitmap?function(C,D){const k=new g.Blob([new Uint8Array(C)],{type:"image/png"});g.createImageBitmap(k).then(F=>{D(null,F)}).catch(F=>{D(new Error(`Could not load image because of ${F.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(C,D)=>i(C,D,w,A)):function(C,D){const k=new g.Image,F=g.URL;k.onload=()=>{D(null,k),F.revokeObjectURL(k.src),k.onload=null,g.requestAnimationFrame(()=>{k.src=He})},k.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new g.Blob([new Uint8Array(C)],{type:"image/png"});k.src=C.byteLength?F.createObjectURL(V):He}(v,(C,D)=>i(C,D,w,A)))});return{cancel:()=>{p.cancel(),h()}}};function Ot(l,i,c){c[l]&&c[l].indexOf(i)!==-1||(c[l]=c[l]||[],c[l].push(i))}function qt(l,i,c){if(c&&c[l]){const h=c[l].indexOf(i);h!==-1&&c[l].splice(h,1)}}class lr{constructor(i,c={}){xe(this,c),this.type=i}}class Wt extends lr{constructor(i,c={}){super("error",xe({error:i},c))}}class ar{on(i,c){return this._listeners=this._listeners||{},Ot(i,c,this._listeners),this}off(i,c){return qt(i,c,this._listeners),qt(i,c,this._oneTimeListeners),this}once(i,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Ot(i,c,this._oneTimeListeners),this):new Promise(h=>this.once(i,h))}fire(i,c){typeof i=="string"&&(i=new lr(i,c||{}));const h=i.type;if(this.listens(h)){i.target=this;const p=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const w of p)w.call(this,i);const _=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const w of _)qt(h,w,this._oneTimeListeners),w.call(this,i);const v=this._eventedParent;v&&(xe(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(i))}else i instanceof Wt&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,c){return this._eventedParent=i,this._eventedParentData=c,this}}var ze=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ir(l,...i){for(const c of i)for(const h in c)l[h]=c[h];return l}function jr(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function gi(l){if(Array.isArray(l))return l.map(gi);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const i={};for(const c in l)i[c]=gi(l[c]);return i}return jr(l)}class Hn extends Error{constructor(i,c){super(c),this.message=c,this.key=i}}var ki=Hn;class Wn{constructor(i,c=[]){this.parent=i,this.bindings={};for(const[h,p]of c)this.bindings[h]=p}concat(i){return new Wn(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var hn=Wn;const nn={kind:"null"},Dt={kind:"number"},pr={kind:"string"},dr={kind:"boolean"},vn={kind:"color"},Is={kind:"object"},hr={kind:"value"},xn={kind:"collator"},us={kind:"formatted"},_o={kind:"resolvedImage"};function dn(l,i){return{kind:"array",itemType:l,N:i}}function Hr(l){if(l.kind==="array"){const i=Hr(l.itemType);return typeof l.N=="number"?`array<${i}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${i}>`}return l.kind}const nm=[nn,Dt,pr,dr,vn,us,Is,dn(hr),_o];function La(l,i){if(i.kind==="error")return null;if(l.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!La(l.itemType,i.itemType))&&(typeof l.N!="number"||l.N===i.N))return null}else{if(l.kind===i.kind)return null;if(l.kind==="value"){for(const c of nm)if(!La(c,i))return null}}return`Expected ${Hr(l)} but found ${Hr(i)} instead.`}function yu(l,i){return i.some(c=>c.kind===l.kind)}function ka(l,i){return i.some(c=>c==="null"?l===null:c==="array"?Array.isArray(l):c==="object"?l&&!Array.isArray(l)&&typeof l=="object":c===typeof l)}function za(l){var i={exports:{}};return l(i,i.exports),i.exports}var sm=za(function(l,i){var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function h(w){return(w=Math.round(w))<0?0:w>255?255:w}function p(w){return h(w[w.length-1]==="%"?parseFloat(w)/100*255:parseInt(w))}function _(w){return(A=w[w.length-1]==="%"?parseFloat(w)/100:parseFloat(w))<0?0:A>1?1:A;var A}function v(w,A,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?w+(A-w)*C*6:2*C<1?A:3*C<2?w+(A-w)*(2/3-C)*6:w}try{i.parseCSSColor=function(w){var A,C=w.replace(/ /g,"").toLowerCase();if(C in c)return c[C].slice();if(C[0]==="#")return C.length===4?(A=parseInt(C.substr(1),16))>=0&&A<=4095?[(3840&A)>>4|(3840&A)>>8,240&A|(240&A)>>4,15&A|(15&A)<<4,1]:null:C.length===7&&(A=parseInt(C.substr(1),16))>=0&&A<=16777215?[(16711680&A)>>16,(65280&A)>>8,255&A,1]:null;var D=C.indexOf("("),k=C.indexOf(")");if(D!==-1&&k+1===C.length){var F=C.substr(0,D),V=C.substr(D+1,k-(D+1)).split(","),H=1;switch(F){case"rgba":if(V.length!==4)return null;H=_(V.pop());case"rgb":return V.length!==3?null:[p(V[0]),p(V[1]),p(V[2]),H];case"hsla":if(V.length!==4)return null;H=_(V.pop());case"hsl":if(V.length!==3)return null;var Q=(parseFloat(V[0])%360+360)%360/360,ce=_(V[1]),ge=_(V[2]),Ce=ge<=.5?ge*(ce+1):ge+ce-ge*ce,Pe=2*ge-Ce;return[h(255*v(Pe,Ce,Q+1/3)),h(255*v(Pe,Ce,Q)),h(255*v(Pe,Ce,Q-1/3)),H];default:return null}}return null}}catch{}});class zi{constructor(i,c,h,p=1){this.r=i,this.g=c,this.b=h,this.a=p}static parse(i){if(!i)return;if(i instanceof zi)return i;if(typeof i!="string")return;const c=sm.parseCSSColor(i);return c?new zi(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[i,c,h,p]=this.toArray();return`rgba(${Math.round(i)},${Math.round(c)},${Math.round(h)},${p})`}toArray(){const{r:i,g:c,b:h,a:p}=this;return p===0?[0,0,0,0]:[255*i/p,255*c/p,255*h/p,p]}toArray01(){const{r:i,g:c,b:h,a:p}=this;return p===0?[0,0,0,0]:[i/p,c/p,h/p,p]}toArray01PremultipliedAlpha(){const{r:i,g:c,b:h,a:p}=this;return[i,c,h,p]}}zi.black=new zi(0,0,0,1),zi.white=new zi(1,1,1,1),zi.transparent=new zi(0,0,0,0),zi.red=new zi(1,0,0,1),zi.blue=new zi(0,0,1,1);var _i=zi;class Zn{constructor(i,c,h){this.sensitivity=i?c?"variant":"case":c?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,c){return this.collator.compare(i,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class wd{constructor(i,c,h,p,_){this.text=i.normalize?i.normalize():i,this.image=c,this.scale=h,this.fontStack=p,this.textColor=_}}class sn{constructor(i){this.sections=i}static fromString(i){return new sn([new wd(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof sn?i:sn.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const c of this.sections){if(c.image){i.push(["image",c.image.name]);continue}i.push(c.text);const h={};c.fontStack&&(h["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(h["font-scale"]=c.scale),c.textColor&&(h["text-color"]=["rgba"].concat(c.textColor.toArray())),i.push(h)}return i}}class qn{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new qn({name:i,available:!1}):null}serialize(){return["image",this.name]}}function vu(l,i,c,h){return typeof l=="number"&&l>=0&&l<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof c=="number"&&c>=0&&c<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[l,i,c,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[l,i,c,h]:[l,i,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ql(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof _i||l instanceof Zn||l instanceof sn||l instanceof qn)return!0;if(Array.isArray(l)){for(const i of l)if(!ql(i))return!1;return!0}if(typeof l=="object"){for(const i in l)if(!ql(l[i]))return!1;return!0}return!1}function pi(l){if(l===null)return nn;if(typeof l=="string")return pr;if(typeof l=="boolean")return dr;if(typeof l=="number")return Dt;if(l instanceof _i)return vn;if(l instanceof Zn)return xn;if(l instanceof sn)return us;if(l instanceof qn)return _o;if(Array.isArray(l)){const i=l.length;let c;for(const h of l){const p=pi(h);if(c){if(c===p)continue;c=hr;break}c=p}return dn(c||hr,i)}return Is}function Zo(l){const i=typeof l;return l===null?"":i==="string"||i==="number"||i==="boolean"?String(l):l instanceof _i||l instanceof sn||l instanceof qn?l.toString():JSON.stringify(l)}class Ed{constructor(i,c){this.type=i,this.value=c}static parse(i,c){if(i.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!ql(i[1]))return c.error("invalid value");const h=i[1];let p=pi(h);const _=c.expectedType;return p.kind!=="array"||p.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(p=_),new Ed(p,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _i?["rgba"].concat(this.value.toArray()):this.value instanceof sn?this.value.serialize():this.value}}var Kl=Ed,qi=class{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}};const xu={string:pr,number:Dt,boolean:dr,object:Is};class Xl{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");let h,p=1;const _=i[0];if(_==="array"){let w,A;if(i.length>2){const C=i[1];if(typeof C!="string"||!(C in xu)||C==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);w=xu[C],p++}else w=hr;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return c.error('The length argument to "array" must be a positive integer literal',2);A=i[2],p++}h=dn(w,A)}else h=xu[_];const v=[];for(;p<i.length;p++){const w=c.parse(i[p],p,hr);if(!w)return null;v.push(w)}return new Xl(h,v)}evaluate(i){for(let c=0;c<this.args.length;c++){const h=this.args[c].evaluate(i);if(!La(this.type,pi(h)))return h;if(c===this.args.length-1)throw new qi(`Expected value to be of type ${Hr(this.type)}, but found ${Hr(pi(h))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,c=[i.kind];if(i.kind==="array"){const h=i.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){c.push(h.kind);const p=i.N;(typeof p=="number"||this.args.length>1)&&c.push(p)}}return c.concat(this.args.map(h=>h.serialize()))}}var Xs=Xl;class yo{constructor(i){this.type=us,this.sections=i}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&typeof h=="object")return c.error("First argument must be an image or text section.");const p=[];let _=!1;for(let v=1;v<=i.length-1;++v){const w=i[v];if(_&&typeof w=="object"&&!Array.isArray(w)){_=!1;let A=null;if(w["font-scale"]&&(A=c.parse(w["font-scale"],1,Dt),!A))return null;let C=null;if(w["text-font"]&&(C=c.parse(w["text-font"],1,dn(pr)),!C))return null;let D=null;if(w["text-color"]&&(D=c.parse(w["text-color"],1,vn),!D))return null;const k=p[p.length-1];k.scale=A,k.font=C,k.textColor=D}else{const A=c.parse(i[v],1,hr);if(!A)return null;const C=A.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:A,scale:null,font:null,textColor:null})}}return new yo(p)}evaluate(i){return new sn(this.sections.map(c=>{const h=c.content.evaluate(i);return pi(h)===_o?new wd("",h,null,null,null):new wd(Zo(h),null,c.scale?c.scale.evaluate(i):null,c.font?c.font.evaluate(i).join(","):null,c.textColor?c.textColor.evaluate(i):null)}))}eachChild(i){for(const c of this.sections)i(c.content),c.scale&&i(c.scale),c.font&&i(c.font),c.textColor&&i(c.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const c of this.sections){i.push(c.content.serialize());const h={};c.scale&&(h["font-scale"]=c.scale.serialize()),c.font&&(h["text-font"]=c.font.serialize()),c.textColor&&(h["text-color"]=c.textColor.serialize()),i.push(h)}return i}}class bu{constructor(i){this.type=_o,this.input=i}static parse(i,c){if(i.length!==2)return c.error("Expected two arguments.");const h=c.parse(i[1],1,pr);return h?new bu(h):c.error("No image name provided.")}evaluate(i){const c=this.input.evaluate(i),h=qn.fromString(c);return h&&i.availableImages&&(h.available=i.availableImages.indexOf(c)>-1),h}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const wv={"to-boolean":dr,"to-color":vn,"to-number":Dt,"to-string":pr};class Td{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const h=i[0];if((h==="to-boolean"||h==="to-string")&&i.length!==2)return c.error("Expected one argument.");const p=wv[h],_=[];for(let v=1;v<i.length;v++){const w=c.parse(i[v],v,hr);if(!w)return null;_.push(w)}return new Td(p,_)}evaluate(i){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(i));if(this.type.kind==="color"){let c,h;for(const p of this.args){if(c=p.evaluate(i),h=null,c instanceof _i)return c;if(typeof c=="string"){const _=i.parseColor(c);if(_)return _}else if(Array.isArray(c)&&(h=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:vu(c[0],c[1],c[2],c[3]),!h))return new _i(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new qi(h||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const h of this.args){if(c=h.evaluate(i),c===null)return 0;const p=Number(c);if(!isNaN(p))return p}throw new qi(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?sn.fromString(Zo(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?qn.fromString(Zo(this.args[0].evaluate(i))):Zo(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new yo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new bu(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(c=>{i.push(c.serialize())}),i}}var Fa=Td;const Ev=["Unknown","Point","LineString","Polygon"];var om=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ev[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const l=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:c,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*i-l[0])+this.featureDistanceData.bearing[1]*(h*i-l[1])}return 0}parseColor(l){let i=this._parseColorCache[l];return i||(i=this._parseColorCache[l]=_i.parse(l)),i}};class Ba{constructor(i,c,h,p){this.name=i,this.type=c,this._evaluate=h,this.args=p}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,c){const h=i[0],p=Ba.definitions[h];if(!p)return c.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=v.filter(([C])=>!Array.isArray(C)||C.length===i.length-1);let A=null;for(const[C,D]of w){A=new um(c.registry,c.path,null,c.scope);const k=[];let F=!1;for(let V=1;V<i.length;V++){const H=i[V],Q=Array.isArray(C)?C[V-1]:C.type,ce=A.parse(H,1+k.length,Q);if(!ce){F=!0;break}k.push(ce)}if(!F)if(Array.isArray(C)&&C.length!==k.length)A.error(`Expected ${C.length} arguments, but found ${k.length} instead.`);else{for(let V=0;V<k.length;V++){const H=Array.isArray(C)?C[V]:C.type,Q=k[V];A.concat(V+1).checkSubtype(H,Q.type)}if(A.errors.length===0)return new Ba(h,_,D,k)}}if(w.length===1)c.errors.push(...A.errors);else{const C=(w.length?w:v).map(([k])=>{return F=k,Array.isArray(F)?`(${F.map(Hr).join(", ")})`:`(${Hr(F.type)}...)`;var F}).join(" | "),D=[];for(let k=1;k<i.length;k++){const F=c.parse(i[k],1+D.length);if(!F)return null;D.push(Hr(F.type))}c.error(`Expected arguments of type ${C}, but found (${D.join(", ")}) instead.`)}return null}static register(i,c){Ba.definitions=c;for(const h in c)i[h]=Ba}}var Ys=Ba;class qo{constructor(i,c,h){this.type=xn,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=c}static parse(i,c){if(i.length!==2)return c.error("Expected one argument.");const h=i[1];if(typeof h!="object"||Array.isArray(h))return c.error("Collator options argument must be an object.");const p=c.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,dr);if(!p)return null;const _=c.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,dr);if(!_)return null;let v=null;return h.locale&&(v=c.parse(h.locale,1,pr),!v)?null:new qo(p,_,v)}evaluate(i){return new Zn(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const vo=8192;function Sd(l,i){l[0]=Math.min(l[0],i[0]),l[1]=Math.min(l[1],i[1]),l[2]=Math.max(l[2],i[0]),l[3]=Math.max(l[3],i[1])}function wu(l,i){return!(l[0]<=i[0]||l[2]>=i[2]||l[1]<=i[1]||l[3]>=i[3])}function Tv(l,i){const c=(180+l[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,p=Math.pow(2,i.z);return[Math.round(c*p*vo),Math.round(h*p*vo)]}function Sv(l,i,c){const h=l[0]-i[0],p=l[1]-i[1],_=l[0]-c[0],v=l[1]-c[1];return h*v-_*p==0&&h*_<=0&&p*v<=0}function Ad(l,i){let c=!1;for(let v=0,w=i.length;v<w;v++){const A=i[v];for(let C=0,D=A.length;C<D-1;C++){if(Sv(l,A[C],A[C+1]))return!1;(p=A[C])[1]>(h=l)[1]!=(_=A[C+1])[1]>h[1]&&h[0]<(_[0]-p[0])*(h[1]-p[1])/(_[1]-p[1])+p[0]&&(c=!c)}}var h,p,_;return c}function am(l,i){for(let c=0;c<i.length;c++)if(Ad(l,i[c]))return!0;return!1}function Yl(l,i,c,h){const p=h[0]-c[0],_=h[1]-c[1],v=(l[0]-c[0])*_-p*(l[1]-c[1]),w=(i[0]-c[0])*_-p*(i[1]-c[1]);return v>0&&w<0||v<0&&w>0}function Av(l,i,c){for(const C of c)for(let D=0;D<C.length-1;++D)if((w=[(v=C[D+1])[0]-(_=C[D])[0],v[1]-_[1]])[0]*(A=[(p=i)[0]-(h=l)[0],p[1]-h[1]])[1]-w[1]*A[0]!=0&&Yl(h,p,_,v)&&Yl(_,v,h,p))return!0;var h,p,_,v,w,A;return!1}function lm(l,i){for(let c=0;c<l.length;++c)if(!Ad(l[c],i))return!1;for(let c=0;c<l.length-1;++c)if(Av(l[c],l[c+1],i))return!1;return!0}function Pv(l,i){for(let c=0;c<i.length;c++)if(lm(l,i[c]))return!0;return!1}function Pd(l,i,c){const h=[];for(let p=0;p<l.length;p++){const _=[];for(let v=0;v<l[p].length;v++){const w=Tv(l[p][v],c);Sd(i,w),_.push(w)}h.push(_)}return h}function hs(l,i,c){const h=[];for(let p=0;p<l.length;p++){const _=Pd(l[p],i,c);h.push(_)}return h}function Cd(l,i,c,h){if(l[0]<c[0]||l[0]>c[2]){const p=.5*h;let _=l[0]-c[0]>p?-h:c[0]-l[0]>p?h:0;_===0&&(_=l[0]-c[2]>p?-h:c[2]-l[0]>p?h:0),l[0]+=_}Sd(i,l)}function Id(l,i,c,h){const p=Math.pow(2,h.z)*vo,_=[h.x*vo,h.y*vo],v=[];if(!l)return v;for(const w of l)for(const A of w){const C=[A.x+_[0],A.y+_[1]];Cd(C,i,c,p),v.push(C)}return v}function Jl(l,i,c,h){const p=Math.pow(2,h.z)*vo,_=[h.x*vo,h.y*vo],v=[];if(!l)return v;for(const A of l){const C=[];for(const D of A){const k=[D.x+_[0],D.y+_[1]];Sd(i,k),C.push(k)}v.push(C)}if(i[2]-i[0]<=p/2){(w=i)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const A of v)for(const C of A)Cd(C,i,c,p)}var w;return v}class Js{constructor(i,c){this.type=dr,this.geojson=i,this.geometries=c}static parse(i,c){if(i.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(ql(i[1])){const h=i[1];if(h.type==="FeatureCollection")for(let p=0;p<h.features.length;++p){const _=h.features[p].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Js(h,h.features[p].geometry)}else if(h.type==="Feature"){const p=h.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Js(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Js(h,h)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(c,h){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=c.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const w=Pd(h.coordinates,_,v),A=Id(c.geometry(),p,_,v);if(!wu(p,_))return!1;for(const C of A)if(!Ad(C,w))return!1}if(h.type==="MultiPolygon"){const w=hs(h.coordinates,_,v),A=Id(c.geometry(),p,_,v);if(!wu(p,_))return!1;for(const C of A)if(!am(C,w))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(c,h){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=c.canonicalID();if(!v)return!1;if(h.type==="Polygon"){const w=Pd(h.coordinates,_,v),A=Jl(c.geometry(),p,_,v);if(!wu(p,_))return!1;for(const C of A)if(!lm(C,w))return!1}if(h.type==="MultiPolygon"){const w=hs(h.coordinates,_,v),A=Jl(c.geometry(),p,_,v);if(!wu(p,_))return!1;for(const C of A)if(!Pv(C,w))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Eu=Js;function Na(l){if(l instanceof Ys&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Eu)return!1;let i=!0;return l.eachChild(c=>{i&&!Na(c)&&(i=!1)}),i}function ja(l){if(l instanceof Ys&&l.name==="feature-state")return!1;let i=!0;return l.eachChild(c=>{i&&!ja(c)&&(i=!1)}),i}function Tu(l,i){if(l instanceof Ys&&i.indexOf(l.name)>=0)return!1;let c=!0;return l.eachChild(h=>{c&&!Tu(h,i)&&(c=!1)}),c}class Fr{constructor(i,c){this.type=c.type,this.name=i,this.boundExpression=c}static parse(i,c){if(i.length!==2||typeof i[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const h=i[1];return c.scope.has(h)?new Fr(h,c.scope.get(h)):c.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var cm=Fr;class Md{constructor(i,c=[],h,p=new hn,_=[]){this.registry=i,this.path=c,this.key=c.map(v=>`[${v}]`).join(""),this.scope=p,this.errors=_,this.expectedType=h}parse(i,c,h,p,_={}){return c?this.concat(c,h,p)._parse(i,_):this._parse(i,_)}_parse(i,c){function h(p,_,v){return v==="assert"?new Xs(_,[p]):v==="coerce"?new Fa(_,[p]):p}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=i[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[p];if(_){let v=_.parse(i,this);if(!v)return null;if(this.expectedType){const w=this.expectedType,A=v.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||A.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string"){if(this.checkSubtype(w,A))return null}else v=h(v,w,c.typeAnnotation||"coerce");else v=h(v,w,c.typeAnnotation||"assert")}if(!(v instanceof Kl)&&v.type.kind!=="resolvedImage"&&Su(v)){const w=new om;try{v=new Kl(v.type,v.evaluate(w))}catch(A){return this.error(A.message),null}}return v}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,c,h){const p=typeof i=="number"?this.path.concat(i):this.path,_=h?this.scope.concat(h):this.scope;return new Md(this.registry,p,c||null,_,this.errors)}error(i,...c){const h=`${this.key}${c.map(p=>`[${p}]`).join("")}`;this.errors.push(new ki(h,i))}checkSubtype(i,c){const h=La(i,c);return h&&this.error(h),h}}var um=Md;function Su(l){if(l instanceof cm)return Su(l.boundExpression);if(l instanceof Ys&&l.name==="error"||l instanceof qo||l instanceof Eu)return!1;const i=l instanceof Fa||l instanceof Xs;let c=!0;return l.eachChild(h=>{c=i?c&&Su(h):c&&h instanceof Kl}),!!c&&Na(l)&&Tu(l,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Au(l,i){const c=l.length-1;let h,p,_=0,v=c,w=0;for(;_<=v;)if(w=Math.floor((_+v)/2),h=l[w],p=l[w+1],h<=i){if(w===c||i<p)return w;_=w+1}else{if(!(h>i))throw new qi("Input is not a number.");v=w-1}return 0}class Pu{constructor(i,c,h){this.type=i,this.input=c,this.labels=[],this.outputs=[];for(const[p,_]of h)this.labels.push(p),this.outputs.push(_)}static parse(i,c){if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");const h=c.parse(i[1],1,Dt);if(!h)return null;const p=[];let _=null;c.expectedType&&c.expectedType.kind!=="value"&&(_=c.expectedType);for(let v=1;v<i.length;v+=2){const w=v===1?-1/0:i[v],A=i[v+1],C=v,D=v+1;if(typeof w!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(p.length&&p[p.length-1][0]>=w)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const k=c.parse(A,D,_);if(!k)return null;_=_||k.type,p.push([w,k])}return new Pu(_,h,p)}evaluate(i){const c=this.labels,h=this.outputs;if(c.length===1)return h[0].evaluate(i);const p=this.input.evaluate(i);if(p<=c[0])return h[0].evaluate(i);const _=c.length;return p>=c[_-1]?h[_-1].evaluate(i):h[Au(c,p)].evaluate(i)}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&i.push(this.labels[c]),i.push(this.outputs[c].serialize());return i}}var Cu=Pu;function Dr(l,i,c){return l*(1-c)+i*c}var Ql=Object.freeze({__proto__:null,number:Dr,color:function(l,i,c){return new _i(Dr(l.r,i.r,c),Dr(l.g,i.g,c),Dr(l.b,i.b,c),Dr(l.a,i.a,c))},array:function(l,i,c){return l.map((h,p)=>Dr(h,i[p],c))}});const Ko=.95047,ec=1.08883,hm=4/29,tc=6/29,Od=3*tc*tc,Cv=Math.PI/180,Iv=180/Math.PI;function Iu(l){return l>.008856451679035631?Math.pow(l,1/3):l/Od+hm}function Dd(l){return l>tc?l*l*l:Od*(l-hm)}function Mu(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Ou(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Rd(l){const i=Ou(l.r),c=Ou(l.g),h=Ou(l.b),p=Iu((.4124564*i+.3575761*c+.1804375*h)/Ko),_=Iu((.2126729*i+.7151522*c+.072175*h)/1);return{l:116*_-16,a:500*(p-_),b:200*(_-Iu((.0193339*i+.119192*c+.9503041*h)/ec)),alpha:l.a}}function dm(l){let i=(l.l+16)/116,c=isNaN(l.a)?i:i+l.a/500,h=isNaN(l.b)?i:i-l.b/200;return i=1*Dd(i),c=Ko*Dd(c),h=ec*Dd(h),new _i(Mu(3.2404542*c-1.5371385*i-.4985314*h),Mu(-.969266*c+1.8760108*i+.041556*h),Mu(.0556434*c-.2040259*i+1.0572252*h),l.alpha)}function fm(l,i,c){const h=i-l;return l+c*(h>180||h<-180?h-360*Math.round(h/360):h)}const rc={forward:Rd,reverse:dm,interpolate:function(l,i,c){return{l:Dr(l.l,i.l,c),a:Dr(l.a,i.a,c),b:Dr(l.b,i.b,c),alpha:Dr(l.alpha,i.alpha,c)}}},$a={forward:function(l){const{l:i,a:c,b:h}=Rd(l),p=Math.atan2(h,c)*Iv;return{h:p<0?p+360:p,c:Math.sqrt(c*c+h*h),l:i,alpha:l.a}},reverse:function(l){const i=l.h*Cv,c=l.c;return dm({l:l.l,a:Math.cos(i)*c,b:Math.sin(i)*c,alpha:l.alpha})},interpolate:function(l,i,c){return{h:fm(l.h,i.h,c),c:Dr(l.c,i.c,c),l:Dr(l.l,i.l,c),alpha:Dr(l.alpha,i.alpha,c)}}};var Ld=Object.freeze({__proto__:null,lab:rc,hcl:$a});class Du{constructor(i,c,h,p,_){this.type=i,this.operator=c,this.interpolation=h,this.input=p,this.labels=[],this.outputs=[];for(const[v,w]of _)this.labels.push(v),this.outputs.push(w)}static interpolationFactor(i,c,h,p){let _=0;if(i.name==="exponential")_=kd(c,i.base,h,p);else if(i.name==="linear")_=kd(c,1,h,p);else if(i.name==="cubic-bezier"){const v=i.controlPoints;_=new x(v[0],v[1],v[2],v[3]).solve(kd(c,1,h,p))}return _}static parse(i,c){let[h,p,_,...v]=i;if(!Array.isArray(p)||p.length===0)return c.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const C=p[1];if(typeof C!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:C}}else{if(p[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const C=p.slice(1);if(C.length!==4||C.some(D=>typeof D!="number"||D<0||D>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:C}}}if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(_=c.parse(_,2,Dt),!_)return null;const w=[];let A=null;h==="interpolate-hcl"||h==="interpolate-lab"?A=vn:c.expectedType&&c.expectedType.kind!=="value"&&(A=c.expectedType);for(let C=0;C<v.length;C+=2){const D=v[C],k=v[C+1],F=C+3,V=C+4;if(typeof D!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(w.length&&w[w.length-1][0]>=D)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const H=c.parse(k,V,A);if(!H)return null;A=A||H.type,w.push([D,H])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Du(A,h,p,_,w):c.error(`Type ${Hr(A)} is not interpolatable.`)}evaluate(i){const c=this.labels,h=this.outputs;if(c.length===1)return h[0].evaluate(i);const p=this.input.evaluate(i);if(p<=c[0])return h[0].evaluate(i);const _=c.length;if(p>=c[_-1])return h[_-1].evaluate(i);const v=Au(c,p),w=Du.interpolationFactor(this.interpolation,p,c[v],c[v+1]),A=h[v].evaluate(i),C=h[v+1].evaluate(i);return this.operator==="interpolate"?Ql[this.type.kind.toLowerCase()](A,C,w):this.operator==="interpolate-hcl"?$a.reverse($a.interpolate($a.forward(A),$a.forward(C),w)):rc.reverse(rc.interpolate(rc.forward(A),rc.forward(C),w))}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,i,this.input.serialize()];for(let h=0;h<this.labels.length;h++)c.push(this.labels[h],this.outputs[h].serialize());return c}}function kd(l,i,c,h){const p=h-c,_=l-c;return p===0?0:i===1?_/p:(Math.pow(i,_)-1)/(Math.pow(i,p)-1)}var Ms=Du;class zd{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expectected at least one argument.");let h=null;const p=c.expectedType;p&&p.kind!=="value"&&(h=p);const _=[];for(const w of i.slice(1)){const A=c.parse(w,1+_.length,h,void 0,{typeAnnotation:"omit"});if(!A)return null;h=h||A.type,_.push(A)}const v=p&&_.some(w=>La(p,w.type));return new zd(v?hr:h,_)}evaluate(i){let c,h=null,p=0;for(const _ of this.args){if(p++,h=_.evaluate(i),h&&h instanceof qn&&!h.available&&(c||(c=h),h=null,p===this.args.length))return c;if(h!==null)break}return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(c=>{i.push(c.serialize())}),i}}var pm=zd;class Fd{constructor(i,c){this.type=c.type,this.bindings=[].concat(i),this.result=c}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const c of this.bindings)i(c[1]);i(this.result)}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let _=1;_<i.length-1;_+=2){const v=i[_];if(typeof v!="string")return c.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return c.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=c.parse(i[_+1],_+1);if(!w)return null;h.push([v,w])}const p=c.parse(i[i.length-1],i.length-1,c.expectedType,h);return p?new Fd(h,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[c,h]of this.bindings)i.push(c,h.serialize());return i.push(this.result.serialize()),i}}var Bd=Fd;class Nd{constructor(i,c,h){this.type=i,this.index=c,this.input=h}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=c.parse(i[1],1,Dt),p=c.parse(i[2],2,dn(c.expectedType||hr));return h&&p?new Nd(p.type.itemType,h,p):null}evaluate(i){const c=this.index.evaluate(i),h=this.input.evaluate(i);if(c<0)throw new qi(`Array index out of bounds: ${c} < 0.`);if(c>=h.length)throw new qi(`Array index out of bounds: ${c} > ${h.length-1}.`);if(c!==Math.floor(c))throw new qi(`Array index must be an integer, but found ${c} instead.`);return h[c]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Mv=Nd;class jd{constructor(i,c){this.type=dr,this.needle=i,this.haystack=c}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=c.parse(i[1],1,hr),p=c.parse(i[2],2,hr);return h&&p?yu(h.type,[dr,pr,Dt,nn,hr])?new jd(h,p):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(h.type)} instead`):null}evaluate(i){const c=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(h==null)return!1;if(!ka(c,["boolean","string","number","null"]))throw new qi(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(pi(c))} instead.`);if(!ka(h,["string","array"]))throw new qi(`Expected second argument to be of type array or string, but found ${Hr(pi(h))} instead.`);return h.indexOf(c)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ov=jd;class ic{constructor(i,c,h){this.type=Dt,this.needle=i,this.haystack=c,this.fromIndex=h}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=c.parse(i[1],1,hr),p=c.parse(i[2],2,hr);if(!h||!p)return null;if(!yu(h.type,[dr,pr,Dt,nn,hr]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(h.type)} instead`);if(i.length===4){const _=c.parse(i[3],3,Dt);return _?new ic(h,p,_):null}return new ic(h,p)}evaluate(i){const c=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!ka(c,["boolean","string","number","null"]))throw new qi(`Expected first argument to be of type boolean, string, number or null, but found ${Hr(pi(c))} instead.`);if(!ka(h,["string","array"]))throw new qi(`Expected second argument to be of type array or string, but found ${Hr(pi(h))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(i);return h.indexOf(c,p)}return h.indexOf(c)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var mm=ic;class Ru{constructor(i,c,h,p,_,v){this.inputType=i,this.type=c,this.input=h,this.cases=p,this.outputs=_,this.otherwise=v}static parse(i,c){if(i.length<5)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return c.error("Expected an even number of arguments.");let h,p;c.expectedType&&c.expectedType.kind!=="value"&&(p=c.expectedType);const _={},v=[];for(let C=2;C<i.length-1;C+=2){let D=i[C];const k=i[C+1];Array.isArray(D)||(D=[D]);const F=c.concat(C);if(D.length===0)return F.error("Expected at least one branch label.");for(const H of D){if(typeof H!="number"&&typeof H!="string")return F.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return F.error("Numeric branch labels must be integer values.");if(h){if(F.checkSubtype(h,pi(H)))return null}else h=pi(H);if(_[String(H)]!==void 0)return F.error("Branch labels must be unique.");_[String(H)]=v.length}const V=c.parse(k,C,p);if(!V)return null;p=p||V.type,v.push(V)}const w=c.parse(i[1],1,hr);if(!w)return null;const A=c.parse(i[i.length-1],i.length-1,p);return A?w.type.kind!=="value"&&c.concat(1).checkSubtype(h,w.type)?null:new Ru(h,p,w,_,v,A):null}evaluate(i){const c=this.input.evaluate(i);return(pi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),h=[],p={};for(const v of c){const w=p[this.cases[v]];w===void 0?(p[this.cases[v]]=h.length,h.push([this.cases[v],[v]])):h[w][1].push(v)}const _=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,w]of h)i.push(w.length===1?_(w[0]):w.map(_)),i.push(this.outputs[v].serialize());return i.push(this.otherwise.serialize()),i}}var Dv=Ru;class $d{constructor(i,c,h){this.type=i,this.branches=c,this.otherwise=h}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return c.error("Expected an odd number of arguments.");let h;c.expectedType&&c.expectedType.kind!=="value"&&(h=c.expectedType);const p=[];for(let v=1;v<i.length-1;v+=2){const w=c.parse(i[v],v,dr);if(!w)return null;const A=c.parse(i[v+1],v+1,h);if(!A)return null;p.push([w,A]),h=h||A.type}const _=c.parse(i[i.length-1],i.length-1,h);return _?new $d(h,p,_):null}evaluate(i){for(const[c,h]of this.branches)if(c.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[c,h]of this.branches)i(c),i(h);i(this.otherwise)}outputDefined(){return this.branches.every(([i,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(c=>{i.push(c.serialize())}),i}}var gm=$d;class nc{constructor(i,c,h,p){this.type=i,this.input=c,this.beginIndex=h,this.endIndex=p}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=c.parse(i[1],1,hr),p=c.parse(i[2],2,Dt);if(!h||!p)return null;if(!yu(h.type,[dn(hr),pr,hr]))return c.error(`Expected first argument to be of type array or string, but found ${Hr(h.type)} instead`);if(i.length===4){const _=c.parse(i[3],3,Dt);return _?new nc(h.type,h,p,_):null}return new nc(h.type,h,p)}evaluate(i){const c=this.input.evaluate(i),h=this.beginIndex.evaluate(i);if(!ka(c,["string","array"]))throw new qi(`Expected first argument to be of type array or string, but found ${Hr(pi(c))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(i);return c.slice(h,p)}return c.slice(h)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var _m=nc;function ym(l,i){return l==="=="||l==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function vm(l,i,c,h){return h.compare(i,c)===0}function Va(l,i,c){const h=l!=="=="&&l!=="!=";return class kI{constructor(_,v,w){this.type=dr,this.lhs=_,this.rhs=v,this.collator=w,this.hasUntypedArgument=_.type.kind==="value"||v.type.kind==="value"}static parse(_,v){if(_.length!==3&&_.length!==4)return v.error("Expected two or three arguments.");const w=_[0];let A=v.parse(_[1],1,hr);if(!A)return null;if(!ym(w,A.type))return v.concat(1).error(`"${w}" comparisons are not supported for type '${Hr(A.type)}'.`);let C=v.parse(_[2],2,hr);if(!C)return null;if(!ym(w,C.type))return v.concat(2).error(`"${w}" comparisons are not supported for type '${Hr(C.type)}'.`);if(A.type.kind!==C.type.kind&&A.type.kind!=="value"&&C.type.kind!=="value")return v.error(`Cannot compare types '${Hr(A.type)}' and '${Hr(C.type)}'.`);h&&(A.type.kind==="value"&&C.type.kind!=="value"?A=new Xs(C.type,[A]):A.type.kind!=="value"&&C.type.kind==="value"&&(C=new Xs(A.type,[C])));let D=null;if(_.length===4){if(A.type.kind!=="string"&&C.type.kind!=="string"&&A.type.kind!=="value"&&C.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(D=v.parse(_[3],3,xn),!D)return null}return new kI(A,C,D)}evaluate(_){const v=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(h&&this.hasUntypedArgument){const A=pi(v),C=pi(w);if(A.kind!==C.kind||A.kind!=="string"&&A.kind!=="number")throw new qi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${A.kind}, ${C.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const A=pi(v),C=pi(w);if(A.kind!=="string"||C.kind!=="string")return i(_,v,w)}return this.collator?c(_,v,w,this.collator.evaluate(_)):i(_,v,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[l];return this.eachChild(v=>{_.push(v.serialize())}),_}}}const Rv=Va("==",function(l,i,c){return i===c},vm),Lu=Va("!=",function(l,i,c){return i!==c},function(l,i,c,h){return!vm(0,i,c,h)}),xm=Va("<",function(l,i,c){return i<c},function(l,i,c,h){return h.compare(i,c)<0}),bm=Va(">",function(l,i,c){return i>c},function(l,i,c,h){return h.compare(i,c)>0}),Lv=Va("<=",function(l,i,c){return i<=c},function(l,i,c,h){return h.compare(i,c)<=0}),kv=Va(">=",function(l,i,c){return i>=c},function(l,i,c,h){return h.compare(i,c)>=0});class Vd{constructor(i,c,h,p,_){this.type=pr,this.number=i,this.locale=c,this.currency=h,this.minFractionDigits=p,this.maxFractionDigits=_}static parse(i,c){if(i.length!==3)return c.error("Expected two arguments.");const h=c.parse(i[1],1,Dt);if(!h)return null;const p=i[2];if(typeof p!="object"||Array.isArray(p))return c.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=c.parse(p.locale,1,pr),!_))return null;let v=null;if(p.currency&&(v=c.parse(p.currency,1,pr),!v))return null;let w=null;if(p["min-fraction-digits"]&&(w=c.parse(p["min-fraction-digits"],1,Dt),!w))return null;let A=null;return p["max-fraction-digits"]&&(A=c.parse(p["max-fraction-digits"],1,Dt),!A)?null:new Vd(h,_,v,w,A)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class ku{constructor(i){this.type=Dt,this.input=i}static parse(i,c){if(i.length!==2)return c.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=c.parse(i[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Hr(h.type)} instead.`):new ku(h):null}evaluate(i){const c=this.input.evaluate(i);if(typeof c=="string"||Array.isArray(c))return c.length;throw new qi(`Expected value to be of type string or array, but found ${Hr(pi(c))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(c=>{i.push(c.serialize())}),i}}const Ud={"==":Rv,"!=":Lu,">":bm,"<":xm,">=":kv,"<=":Lv,array:Xs,at:Mv,boolean:Xs,case:gm,coalesce:pm,collator:qo,format:yo,image:bu,in:Ov,"index-of":mm,interpolate:Ms,"interpolate-hcl":Ms,"interpolate-lab":Ms,length:ku,let:Bd,literal:Kl,match:Dv,number:Xs,"number-format":Vd,object:Xs,slice:_m,step:Cu,string:Xs,"to-boolean":Fa,"to-color":Fa,"to-number":Fa,"to-string":Fa,var:cm,within:Eu};function Gd(l,[i,c,h,p]){i=i.evaluate(l),c=c.evaluate(l),h=h.evaluate(l);const _=p?p.evaluate(l):1,v=vu(i,c,h,_);if(v)throw new qi(v);return new _i(i/255*_,c/255*_,h/255*_,_)}function zu(l,i){return l in i}function Hd(l,i){const c=i[l];return c===void 0?null:c}function Xo(l){return{type:l}}Ys.register(Ud,{error:[{kind:"error"},[pr],(l,[i])=>{throw new qi(i.evaluate(l))}],typeof:[pr,[hr],(l,[i])=>Hr(pi(i.evaluate(l)))],"to-rgba":[dn(Dt,4),[vn],(l,[i])=>i.evaluate(l).toArray()],rgb:[vn,[Dt,Dt,Dt],Gd],rgba:[vn,[Dt,Dt,Dt,Dt],Gd],has:{type:dr,overloads:[[[pr],(l,[i])=>zu(i.evaluate(l),l.properties())],[[pr,Is],(l,[i,c])=>zu(i.evaluate(l),c.evaluate(l))]]},get:{type:hr,overloads:[[[pr],(l,[i])=>Hd(i.evaluate(l),l.properties())],[[pr,Is],(l,[i,c])=>Hd(i.evaluate(l),c.evaluate(l))]]},"feature-state":[hr,[pr],(l,[i])=>Hd(i.evaluate(l),l.featureState||{})],properties:[Is,[],l=>l.properties()],"geometry-type":[pr,[],l=>l.geometryType()],id:[hr,[],l=>l.id()],zoom:[Dt,[],l=>l.globals.zoom],pitch:[Dt,[],l=>l.globals.pitch||0],"distance-from-center":[Dt,[],l=>l.distanceFromCenter()],"heatmap-density":[Dt,[],l=>l.globals.heatmapDensity||0],"line-progress":[Dt,[],l=>l.globals.lineProgress||0],"sky-radial-progress":[Dt,[],l=>l.globals.skyRadialProgress||0],accumulated:[hr,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[Dt,Xo(Dt),(l,i)=>{let c=0;for(const h of i)c+=h.evaluate(l);return c}],"*":[Dt,Xo(Dt),(l,i)=>{let c=1;for(const h of i)c*=h.evaluate(l);return c}],"-":{type:Dt,overloads:[[[Dt,Dt],(l,[i,c])=>i.evaluate(l)-c.evaluate(l)],[[Dt],(l,[i])=>-i.evaluate(l)]]},"/":[Dt,[Dt,Dt],(l,[i,c])=>i.evaluate(l)/c.evaluate(l)],"%":[Dt,[Dt,Dt],(l,[i,c])=>i.evaluate(l)%c.evaluate(l)],ln2:[Dt,[],()=>Math.LN2],pi:[Dt,[],()=>Math.PI],e:[Dt,[],()=>Math.E],"^":[Dt,[Dt,Dt],(l,[i,c])=>Math.pow(i.evaluate(l),c.evaluate(l))],sqrt:[Dt,[Dt],(l,[i])=>Math.sqrt(i.evaluate(l))],log10:[Dt,[Dt],(l,[i])=>Math.log(i.evaluate(l))/Math.LN10],ln:[Dt,[Dt],(l,[i])=>Math.log(i.evaluate(l))],log2:[Dt,[Dt],(l,[i])=>Math.log(i.evaluate(l))/Math.LN2],sin:[Dt,[Dt],(l,[i])=>Math.sin(i.evaluate(l))],cos:[Dt,[Dt],(l,[i])=>Math.cos(i.evaluate(l))],tan:[Dt,[Dt],(l,[i])=>Math.tan(i.evaluate(l))],asin:[Dt,[Dt],(l,[i])=>Math.asin(i.evaluate(l))],acos:[Dt,[Dt],(l,[i])=>Math.acos(i.evaluate(l))],atan:[Dt,[Dt],(l,[i])=>Math.atan(i.evaluate(l))],min:[Dt,Xo(Dt),(l,i)=>Math.min(...i.map(c=>c.evaluate(l)))],max:[Dt,Xo(Dt),(l,i)=>Math.max(...i.map(c=>c.evaluate(l)))],abs:[Dt,[Dt],(l,[i])=>Math.abs(i.evaluate(l))],round:[Dt,[Dt],(l,[i])=>{const c=i.evaluate(l);return c<0?-Math.round(-c):Math.round(c)}],floor:[Dt,[Dt],(l,[i])=>Math.floor(i.evaluate(l))],ceil:[Dt,[Dt],(l,[i])=>Math.ceil(i.evaluate(l))],"filter-==":[dr,[pr,hr],(l,[i,c])=>l.properties()[i.value]===c.value],"filter-id-==":[dr,[hr],(l,[i])=>l.id()===i.value],"filter-type-==":[dr,[pr],(l,[i])=>l.geometryType()===i.value],"filter-<":[dr,[pr,hr],(l,[i,c])=>{const h=l.properties()[i.value],p=c.value;return typeof h==typeof p&&h<p}],"filter-id-<":[dr,[hr],(l,[i])=>{const c=l.id(),h=i.value;return typeof c==typeof h&&c<h}],"filter->":[dr,[pr,hr],(l,[i,c])=>{const h=l.properties()[i.value],p=c.value;return typeof h==typeof p&&h>p}],"filter-id->":[dr,[hr],(l,[i])=>{const c=l.id(),h=i.value;return typeof c==typeof h&&c>h}],"filter-<=":[dr,[pr,hr],(l,[i,c])=>{const h=l.properties()[i.value],p=c.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[dr,[hr],(l,[i])=>{const c=l.id(),h=i.value;return typeof c==typeof h&&c<=h}],"filter->=":[dr,[pr,hr],(l,[i,c])=>{const h=l.properties()[i.value],p=c.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[dr,[hr],(l,[i])=>{const c=l.id(),h=i.value;return typeof c==typeof h&&c>=h}],"filter-has":[dr,[hr],(l,[i])=>i.value in l.properties()],"filter-has-id":[dr,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[dr,[dn(pr)],(l,[i])=>i.value.indexOf(l.geometryType())>=0],"filter-id-in":[dr,[dn(hr)],(l,[i])=>i.value.indexOf(l.id())>=0],"filter-in-small":[dr,[pr,dn(hr)],(l,[i,c])=>c.value.indexOf(l.properties()[i.value])>=0],"filter-in-large":[dr,[pr,dn(hr)],(l,[i,c])=>function(h,p,_,v){for(;_<=v;){const w=_+v>>1;if(p[w]===h)return!0;p[w]>h?v=w-1:_=w+1}return!1}(l.properties()[i.value],c.value,0,c.value.length-1)],all:{type:dr,overloads:[[[dr,dr],(l,[i,c])=>i.evaluate(l)&&c.evaluate(l)],[Xo(dr),(l,i)=>{for(const c of i)if(!c.evaluate(l))return!1;return!0}]]},any:{type:dr,overloads:[[[dr,dr],(l,[i,c])=>i.evaluate(l)||c.evaluate(l)],[Xo(dr),(l,i)=>{for(const c of i)if(c.evaluate(l))return!0;return!1}]]},"!":[dr,[dr],(l,[i])=>!i.evaluate(l)],"is-supported-script":[dr,[pr],(l,[i])=>{const c=l.globals&&l.globals.isSupportedScript;return!c||c(i.evaluate(l))}],upcase:[pr,[pr],(l,[i])=>i.evaluate(l).toUpperCase()],downcase:[pr,[pr],(l,[i])=>i.evaluate(l).toLowerCase()],concat:[pr,Xo(hr),(l,i)=>i.map(c=>Zo(c.evaluate(l))).join("")],"resolved-locale":[pr,[xn],(l,[i])=>i.evaluate(l).resolvedLocale()]});var sc=Ud;function wm(l){return{result:"success",value:l}}function Ua(l){return{result:"error",value:l}}function Ga(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function Wd(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Fu(l){return!!l.expression&&l.expression.interpolated}function Rr(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function Bu(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function zv(l){return l}function Em(l,i){const c=i.type==="color",h=l.stops&&typeof l.stops[0][0]=="object",p=h||!(h||l.property!==void 0),_=l.type||(Fu(i)?"exponential":"interval");if(c&&((l=Ir({},l)).stops&&(l.stops=l.stops.map(C=>[C[0],_i.parse(C[1])])),l.default=_i.parse(l.default?l.default:i.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!Ld[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let v,w,A;if(_==="exponential")v=Sm;else if(_==="interval")v=Ha;else if(_==="categorical"){v=Tm,w=Object.create(null);for(const C of l.stops)w[C[0]]=C[1];A=typeof l.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);v=Fv}if(h){const C={},D=[];for(let V=0;V<l.stops.length;V++){const H=l.stops[V],Q=H[0].zoom;C[Q]===void 0&&(C[Q]={zoom:Q,type:l.type,property:l.property,default:l.default,stops:[]},D.push(Q)),C[Q].stops.push([H[0].value,H[1]])}const k=[];for(const V of D)k.push([C[V].zoom,Em(C[V],i)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Ms.interpolationFactor.bind(void 0,F),zoomStops:k.map(V=>V[0]),evaluate:({zoom:V},H)=>Sm({stops:k,base:l.base},i,V).evaluate(V,H)}}if(p){const C=_==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:Ms.interpolationFactor.bind(void 0,C),zoomStops:l.stops.map(D=>D[0]),evaluate:({zoom:D})=>v(l,i,D,w,A)}}return{kind:"source",evaluate(C,D){const k=D&&D.properties?D.properties[l.property]:void 0;return k===void 0?Kn(l.default,i.default):v(l,i,k,w,A)}}}function Kn(l,i,c){return l!==void 0?l:i!==void 0?i:c!==void 0?c:void 0}function Tm(l,i,c,h,p){return Kn(typeof c===p?h[c]:void 0,l.default,i.default)}function Ha(l,i,c){if(Rr(c)!=="number")return Kn(l.default,i.default);const h=l.stops.length;if(h===1||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[h-1][0])return l.stops[h-1][1];const p=Au(l.stops.map(_=>_[0]),c);return l.stops[p][1]}function Sm(l,i,c){const h=l.base!==void 0?l.base:1;if(Rr(c)!=="number")return Kn(l.default,i.default);const p=l.stops.length;if(p===1||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[p-1][0])return l.stops[p-1][1];const _=Au(l.stops.map(D=>D[0]),c),v=function(D,k,F,V){const H=V-F,Q=D-F;return H===0?0:k===1?Q/H:(Math.pow(k,Q)-1)/(Math.pow(k,H)-1)}(c,h,l.stops[_][0],l.stops[_+1][0]),w=l.stops[_][1],A=l.stops[_+1][1];let C=Ql[i.type]||zv;if(l.colorSpace&&l.colorSpace!=="rgb"){const D=Ld[l.colorSpace];C=(k,F)=>D.reverse(D.interpolate(D.forward(k),D.forward(F),v))}return typeof w.evaluate=="function"?{evaluate(...D){const k=w.evaluate.apply(void 0,D),F=A.evaluate.apply(void 0,D);if(k!==void 0&&F!==void 0)return C(k,F,v)}}:C(w,A,v)}function Fv(l,i,c){return i.type==="color"?c=_i.parse(c):i.type==="formatted"?c=sn.fromString(c.toString()):i.type==="resolvedImage"?c=qn.fromString(c.toString()):Rr(c)===i.type||i.type==="enum"&&i.values[c]||(c=void 0),Kn(c,l.default,i.default)}class Nu{constructor(i,c){this.expression=i,this._warningHistory={},this._evaluator=new om,this._defaultValue=c?function(h){return h.type==="color"&&(Bu(h.default)||Array.isArray(h.default))?new _i(0,0,0,0):h.type==="color"?_i.parse(h.default)||null:h.default===void 0?null:h.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(i,c,h,p,_,v,w,A){return this._evaluator.globals=i,this._evaluator.feature=c,this._evaluator.featureState=h,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(i,c,h,p,_,v,w,A){this._evaluator.globals=i,this._evaluator.feature=c||null,this._evaluator.featureState=h||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=A||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new qi(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console!="undefined"&&console.warn(C.message)),this._defaultValue}}}function ju(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in sc}function Yo(l,i){const c=new um(sc,[],i?function(p){const _={color:vn,string:pr,number:Dt,enum:pr,boolean:dr,formatted:us,resolvedImage:_o};return p.type==="array"?dn(_[p.value]||hr,p.length):_[p.type]}(i):void 0),h=c.parse(l,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?wm(new Nu(h,i)):Ua(c.errors)}class $u{constructor(i,c){this.kind=i,this._styleExpression=c,this.isStateDependent=i!=="constant"&&!ja(c.expression)}evaluateWithoutErrorHandling(i,c,h,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(i,c,h,p,_,v)}evaluate(i,c,h,p,_,v){return this._styleExpression.evaluate(i,c,h,p,_,v)}}class oc{constructor(i,c,h,p){this.kind=i,this.zoomStops=h,this._styleExpression=c,this.isStateDependent=i!=="camera"&&!ja(c.expression),this.interpolationType=p}evaluateWithoutErrorHandling(i,c,h,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(i,c,h,p,_,v)}evaluate(i,c,h,p,_,v){return this._styleExpression.evaluate(i,c,h,p,_,v)}interpolationFactor(i,c,h){return this.interpolationType?Ms.interpolationFactor(this.interpolationType,i,c,h):0}}function Vu(l,i){if((l=Yo(l,i)).result==="error")return l;const c=l.value.expression,h=Na(c);if(!h&&!Ga(i))return Ua([new ki("","data expressions not supported")]);const p=Tu(c,["zoom","pitch","distance-from-center"]);if(!p&&!Wd(i))return Ua([new ki("","zoom expressions not supported")]);const _=Wa(c);return _||p?_ instanceof ki?Ua([_]):_ instanceof Ms&&!Fu(i)?Ua([new ki("",'"interpolate" expressions cannot be used with this property')]):wm(_?new oc(h?"camera":"composite",l.value,_.labels,_ instanceof Ms?_.interpolation:void 0):new $u(h?"constant":"source",l.value)):Ua([new ki("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ac{constructor(i,c){this._parameters=i,this._specification=c,Ir(this,Em(this._parameters,this._specification))}static deserialize(i){return new ac(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Wa(l){let i=null;if(l instanceof Bd)i=Wa(l.result);else if(l instanceof pm){for(const c of l.args)if(i=Wa(c),i)break}else(l instanceof Cu||l instanceof Ms)&&l.input instanceof Ys&&l.input.name==="zoom"&&(i=l);return i instanceof ki||l.eachChild(c=>{const h=Wa(c);h instanceof ki?i=h:!i&&h?i=new ki("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&h&&i!==h&&(i=new ki("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}class $t{constructor(i,c,h,p){this.message=(i?`${i}: `:"")+h,p&&(this.identifier=p),c!=null&&c.__line__&&(this.line=c.__line__)}}function Xn(l){const i=l.key,c=l.value,h=l.valueSpec||{},p=l.objectElementValidators||{},_=l.style,v=l.styleSpec;let w=[];const A=Rr(c);if(A!=="object")return[new $t(i,c,`object expected, ${A} found`)];for(const C in c){const D=C.split(".")[0],k=h[D]||h["*"];let F;p[D]?F=p[D]:h[D]?F=Ui:p["*"]?F=p["*"]:h["*"]&&(F=Ui),F?w=w.concat(F({key:(i&&`${i}.`)+C,value:c[C],valueSpec:k,style:_,styleSpec:v,object:c,objectKey:C},c)):w.push(new $t(i,c[C],`unknown property "${C}"`))}for(const C in h)p[C]||h[C].required&&h[C].default===void 0&&c[C]===void 0&&w.push(new $t(i,c,`missing required property "${C}"`));return w}function lc(l){const i=l.value,c=l.valueSpec,h=l.style,p=l.styleSpec,_=l.key,v=l.arrayElementValidator||Ui;if(Rr(i)!=="array")return[new $t(_,i,`array expected, ${Rr(i)} found`)];if(c.length&&i.length!==c.length)return[new $t(_,i,`array length ${c.length} expected, length ${i.length} found`)];if(c["min-length"]&&i.length<c["min-length"])return[new $t(_,i,`array length at least ${c["min-length"]} expected, length ${i.length} found`)];let w={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};p.$version<7&&(w.function=c.function),Rr(c.value)==="object"&&(w=c.value);let A=[];for(let C=0;C<i.length;C++)A=A.concat(v({array:i,arrayIndex:C,value:i[C],valueSpec:w,style:h,styleSpec:p,key:`${_}[${C}]`}));return A}function Jo(l){const i=l.key,c=l.value,h=l.valueSpec;let p=Rr(c);if(p==="number"&&c!=c&&(p="NaN"),p!=="number")return[new $t(i,c,`number expected, ${p} found`)];if("minimum"in h){let _=h.minimum;if(Rr(h.minimum)==="array"&&(_=h.minimum[l.arrayIndex]),c<_)return[new $t(i,c,`${c} is less than the minimum value ${_}`)]}if("maximum"in h){let _=h.maximum;if(Rr(h.maximum)==="array"&&(_=h.maximum[l.arrayIndex]),c>_)return[new $t(i,c,`${c} is greater than the maximum value ${_}`)]}return[]}function Zd(l){const i=l.valueSpec,c=jr(l.value.type);let h,p,_,v={};const w=c!=="categorical"&&l.value.property===void 0,A=!w,C=Rr(l.value.stops)==="array"&&Rr(l.value.stops[0])==="array"&&Rr(l.value.stops[0][0])==="object",D=Xn({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(V){if(c==="identity")return[new $t(V.key,V.value,'identity function may not have a "stops" property')];let H=[];const Q=V.value;return H=H.concat(lc({key:V.key,value:Q,valueSpec:V.valueSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:k})),Rr(Q)==="array"&&Q.length===0&&H.push(new $t(V.key,Q,"array must have at least one stop")),H},default:function(V){return Ui({key:V.key,value:V.value,valueSpec:i,style:V.style,styleSpec:V.styleSpec})}}});return c==="identity"&&w&&D.push(new $t(l.key,l.value,'missing required property "property"')),c==="identity"||l.value.stops||D.push(new $t(l.key,l.value,'missing required property "stops"')),c==="exponential"&&l.valueSpec.expression&&!Fu(l.valueSpec)&&D.push(new $t(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(A&&!Ga(l.valueSpec)?D.push(new $t(l.key,l.value,"property functions not supported")):w&&!Wd(l.valueSpec)&&D.push(new $t(l.key,l.value,"zoom functions not supported"))),c!=="categorical"&&!C||l.value.property!==void 0||D.push(new $t(l.key,l.value,'"property" property is required')),D;function k(V){let H=[];const Q=V.value,ce=V.key;if(Rr(Q)!=="array")return[new $t(ce,Q,`array expected, ${Rr(Q)} found`)];if(Q.length!==2)return[new $t(ce,Q,`array length 2 expected, length ${Q.length} found`)];if(C){if(Rr(Q[0])!=="object")return[new $t(ce,Q,`object expected, ${Rr(Q[0])} found`)];if(Q[0].zoom===void 0)return[new $t(ce,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new $t(ce,Q,"object stop key must have value")];const ge=jr(Q[0].zoom);if(typeof ge!="number")return[new $t(ce,Q[0].zoom,"stop zoom values must be numbers")];if(_&&_>ge)return[new $t(ce,Q[0].zoom,"stop zoom values must appear in ascending order")];ge!==_&&(_=ge,p=void 0,v={}),H=H.concat(Xn({key:`${ce}[0]`,value:Q[0],valueSpec:{zoom:{}},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:Jo,value:F}}))}else H=H.concat(F({key:`${ce}[0]`,value:Q[0],valueSpec:{},style:V.style,styleSpec:V.styleSpec},Q));return ju(gi(Q[1]))?H.concat([new $t(`${ce}[1]`,Q[1],"expressions are not allowed in function stops.")]):H.concat(Ui({key:`${ce}[1]`,value:Q[1],valueSpec:i,style:V.style,styleSpec:V.styleSpec}))}function F(V,H){const Q=Rr(V.value),ce=jr(V.value),ge=V.value!==null?V.value:H;if(h){if(Q!==h)return[new $t(V.key,ge,`${Q} stop domain type must match previous stop domain type ${h}`)]}else h=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean"&&typeof ce!="number"&&typeof ce!="string"&&typeof ce!="boolean")return[new $t(V.key,ge,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&c!=="categorical"){let Ce=`number expected, ${Q} found`;return Ga(i)&&c===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $t(V.key,ge,Ce)]}return c!=="categorical"||Q!=="number"||typeof ce=="number"&&isFinite(ce)&&Math.floor(ce)===ce?c!=="categorical"&&Q==="number"&&typeof ce=="number"&&typeof p=="number"&&p!==void 0&&ce<p?[new $t(V.key,ge,"stop domain values must appear in ascending order")]:(p=ce,c==="categorical"&&ce in v?[new $t(V.key,ge,"stop domain values must be unique")]:(v[ce]=!0,[])):[new $t(V.key,ge,`integer expected, found ${String(ce)}`)]}}function Qo(l){const i=(l.expressionContext==="property"?Vu:Yo)(gi(l.value),l.valueSpec);if(i.result==="error")return i.value.map(h=>new $t(`${l.key}${h.key}`,l.value,h.message));const c=i.value.expression||i.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!c.outputDefined())return[new $t(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!ja(c))return[new $t(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter")return Uu(c,l);if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Tu(c,["zoom","feature-state"]))return[new $t(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!Na(c))return[new $t(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Uu(l,i){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const p of i.valueSpec.expression.parameters)c.delete(p);if(c.size===0)return[];const h=[];return l instanceof Ys&&c.has(l.name)?[new $t(i.key,i.value,`["${l.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(l.eachChild(p=>{h.push(...Uu(p,i))}),h)}function cc(l){const i=l.key,c=l.value,h=l.valueSpec,p=[];return Array.isArray(h.values)?h.values.indexOf(jr(c))===-1&&p.push(new $t(i,c,`expected one of [${h.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(h.values).indexOf(jr(c))===-1&&p.push(new $t(i,c,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(c)} found`)),p}function qd(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const i of l.slice(1))if(!qd(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function ea(l,i="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};qd(l)||(l=ta(l));const c=l;let h=!0;try{h=function(C){if(!Za(C))return C;let D=gi(C);return Pm(D),D=Am(D),D}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}const p=ze[`filter_${i}`],_=Yo(h,p);let v=null;if(_.result==="error")throw new Error(_.value.map(C=>`${C.key}: ${C.message}`).join(", "));v=(C,D,k)=>_.value.evaluate(C,D,{},k);let w=null,A=null;if(h!==c){const C=Yo(c,p);if(C.result==="error")throw new Error(C.value.map(D=>`${D.key}: ${D.message}`).join(", "));w=(D,k,F,V,H)=>C.value.evaluate(D,k,{},F,void 0,void 0,V,H),A=!Na(C.value.expression)}return v=v,{filter:v,dynamicFilter:w||void 0,needGeometry:uc(h),needFeature:!!A}}function Am(l){if(!Array.isArray(l))return l;const i=function(c){if(Bv.has(c[0])){for(let h=1;h<c.length;h++)if(Za(c[h]))return!0}return c}(l);return i===!0?i:i.map(c=>Am(c))}function Pm(l){let i=!1;const c=[];if(l[0]==="case"){for(let h=1;h<l.length-1;h+=2)i=i||Za(l[h]),c.push(l[h+1]);c.push(l[l.length-1])}else if(l[0]==="match"){i=i||Za(l[1]);for(let h=2;h<l.length-1;h+=2)c.push(l[h+1]);c.push(l[l.length-1])}else if(l[0]==="step"){i=i||Za(l[1]);for(let h=1;h<l.length-1;h+=2)c.push(l[h+1])}i&&(l.length=0,l.push("any",...c));for(let h=1;h<l.length;h++)Pm(l[h])}function Za(l){if(!Array.isArray(l))return!1;if((i=l[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let c=1;c<l.length;c++)if(Za(l[c]))return!0;return!1}const Bv=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Nv(l,i){return l<i?-1:l>i?1:0}function uc(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(let i=1;i<l.length;i++)if(uc(l[i]))return!0;return!1}function ta(l){if(!l)return!0;const i=l[0];return l.length<=1?i!=="any":i==="=="?fn(l[1],l[2],"=="):i==="!="?Gu(fn(l[1],l[2],"==")):i==="<"||i===">"||i==="<="||i===">="?fn(l[1],l[2],i):i==="any"?(c=l.slice(1),["any"].concat(c.map(ta))):i==="all"?["all"].concat(l.slice(1).map(ta)):i==="none"?["all"].concat(l.slice(1).map(ta).map(Gu)):i==="in"?hc(l[1],l.slice(2)):i==="!in"?Gu(hc(l[1],l.slice(2))):i==="has"?Cm(l[1]):i==="!has"?Gu(Cm(l[1])):i!=="within"||l;var c}function fn(l,i,c){switch(l){case"$type":return[`filter-type-${c}`,i];case"$id":return[`filter-id-${c}`,i];default:return[`filter-${c}`,l,i]}}function hc(l,i){if(i.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(c=>typeof c!=typeof i[0])?["filter-in-large",l,["literal",i.sort(Nv)]]:["filter-in-small",l,["literal",i]]}}function Cm(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Gu(l){return["!",l]}function Kd(l){return qd(gi(l.value))?Qo(Ir({},l,{expressionContext:"filter",valueSpec:l.styleSpec[`filter_${l.layerType||"fill"}`]})):Im(l)}function Im(l){const i=l.value,c=l.key;if(Rr(i)!=="array")return[new $t(c,i,`array expected, ${Rr(i)} found`)];const h=l.styleSpec;let p,_=[];if(i.length<1)return[new $t(c,i,"filter array must have at least 1 element")];switch(_=_.concat(cc({key:`${c}[0]`,value:i[0],valueSpec:h.filter_operator,style:l.style,styleSpec:l.styleSpec})),jr(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&jr(i[1])==="$type"&&_.push(new $t(c,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&_.push(new $t(c,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(p=Rr(i[1]),p!=="string"&&_.push(new $t(`${c}[1]`,i[1],`string expected, ${p} found`)));for(let v=2;v<i.length;v++)p=Rr(i[v]),jr(i[1])==="$type"?_=_.concat(cc({key:`${c}[${v}]`,value:i[v],valueSpec:h.geometry_type,style:l.style,styleSpec:l.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&_.push(new $t(`${c}[${v}]`,i[v],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let v=1;v<i.length;v++)_=_.concat(Im({key:`${c}[${v}]`,value:i[v],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":p=Rr(i[1]),i.length!==2?_.push(new $t(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):p!=="string"&&_.push(new $t(`${c}[1]`,i[1],`string expected, ${p} found`));break;case"within":p=Rr(i[1]),i.length!==2?_.push(new $t(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):p!=="object"&&_.push(new $t(`${c}[1]`,i[1],`object expected, ${p} found`))}return _}function Hu(l,i){const c=l.key,h=l.style,p=l.styleSpec,_=l.value,v=l.objectKey,w=p[`${i}_${l.layerType}`];if(!w)return[];const A=v.match(/^(.*)-transition$/);if(i==="paint"&&A&&w[A[1]]&&w[A[1]].transition)return Ui({key:c,value:_,valueSpec:p.transition,style:h,styleSpec:p});const C=l.valueSpec||w[v];if(!C)return[new $t(c,_,`unknown property "${v}"`)];let D;if(Rr(_)==="string"&&Ga(C)&&!C.tokens&&(D=/^{([^}]+)}$/.exec(_)))return[new $t(c,_,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const k=[];return l.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&k.push(new $t(c,_,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Bu(gi(_))&&jr(_.type)==="identity"&&k.push(new $t(c,_,'"text-font" does not support identity functions'))),k.concat(Ui({key:l.key,value:_,valueSpec:C,style:h,styleSpec:p,expressionContext:"property",propertyType:i,propertyKey:v}))}function Mm(l){return Hu(l,"paint")}function Wu(l){return Hu(l,"layout")}function Om(l){let i=[];const c=l.value,h=l.key,p=l.style,_=l.styleSpec;c.type||c.ref||i.push(new $t(h,c,'either "type" or "ref" is required'));let v=jr(c.type);const w=jr(c.ref);if(c.id){const A=jr(c.id);for(let C=0;C<l.arrayIndex;C++){const D=p.layers[C];jr(D.id)===A&&i.push(new $t(h,c.id,`duplicate layer id "${c.id}", previously used at line ${D.id.__line__}`))}}if("ref"in c){let A;["type","source","source-layer","filter","layout"].forEach(C=>{C in c&&i.push(new $t(h,c[C],`"${C}" is prohibited for ref layers`))}),p.layers.forEach(C=>{jr(C.id)===w&&(A=C)}),A?A.ref?i.push(new $t(h,c.ref,"ref cannot reference another ref layer")):v=jr(A.type):typeof w=="string"&&i.push(new $t(h,c.ref,`ref layer "${w}" not found`))}else if(v!=="background"&&v!=="sky")if(c.source){const A=p.sources&&p.sources[c.source],C=A&&jr(A.type);A?C==="vector"&&v==="raster"?i.push(new $t(h,c.source,`layer "${c.id}" requires a raster source`)):C==="raster"&&v!=="raster"?i.push(new $t(h,c.source,`layer "${c.id}" requires a vector source`)):C!=="vector"||c["source-layer"]?C==="raster-dem"&&v!=="hillshade"?i.push(new $t(h,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||C==="geojson"&&A.lineMetrics||i.push(new $t(h,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new $t(h,c,`layer "${c.id}" must specify a "source-layer"`)):i.push(new $t(h,c.source,`source "${c.source}" not found`))}else i.push(new $t(h,c,'missing required property "source"'));return i=i.concat(Xn({key:h,value:c,valueSpec:_.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ui({key:`${h}.type`,value:c.type,valueSpec:_.layer.type,style:l.style,styleSpec:l.styleSpec,object:c,objectKey:"type"}),filter:A=>Kd(Ir({layerType:v},A)),layout:A=>Xn({layer:c,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":C=>Wu(Ir({layerType:v},C))}}),paint:A=>Xn({layer:c,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":C=>Mm(Ir({layerType:v},C))}})}})),i}function qa(l){const i=l.value,c=l.key,h=Rr(i);return h!=="string"?[new $t(c,i,`string expected, ${h} found`)]:[]}const Zu={promoteId:function({key:l,value:i}){if(Rr(i)==="string")return qa({key:l,value:i});{const c=[];for(const h in i)c.push(...qa({key:`${l}.${h}`,value:i[h]}));return c}}};function Dm(l){const i=l.value,c=l.key,h=l.styleSpec,p=l.style;if(!i.type)return[new $t(c,i,'"type" is required')];const _=jr(i.type);let v;switch(_){case"vector":case"raster":case"raster-dem":return v=Xn({key:c,value:i,valueSpec:h[`source_${_.replace("-","_")}`],style:l.style,styleSpec:h,objectElementValidators:Zu}),v;case"geojson":if(v=Xn({key:c,value:i,valueSpec:h.source_geojson,style:p,styleSpec:h,objectElementValidators:Zu}),i.cluster)for(const w in i.clusterProperties){const[A,C]=i.clusterProperties[w],D=typeof A=="string"?[A,["accumulated"],["get",w]]:A;v.push(...Qo({key:`${c}.${w}.map`,value:C,expressionContext:"cluster-map"})),v.push(...Qo({key:`${c}.${w}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return v;case"video":return Xn({key:c,value:i,valueSpec:h.source_video,style:p,styleSpec:h});case"image":return Xn({key:c,value:i,valueSpec:h.source_image,style:p,styleSpec:h});case"canvas":return[new $t(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cc({key:`${c}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:h})}}function Xd(l){const i=l.value,c=l.styleSpec,h=c.light,p=l.style;let _=[];const v=Rr(i);if(i===void 0)return _;if(v!=="object")return _=_.concat([new $t("light",i,`object expected, ${v} found`)]),_;for(const w in i){const A=w.match(/^(.*)-transition$/);_=_.concat(A&&h[A[1]]&&h[A[1]].transition?Ui({key:w,value:i[w],valueSpec:c.transition,style:p,styleSpec:c}):h[w]?Ui({key:w,value:i[w],valueSpec:h[w],style:p,styleSpec:c}):[new $t(w,i[w],`unknown property "${w}"`)])}return _}function Yd(l){const i=l.value,c=l.key,h=l.style,p=l.styleSpec,_=p.terrain;let v=[];const w=Rr(i);if(i===void 0)return v;if(w!=="object")return v=v.concat([new $t("terrain",i,`object expected, ${w} found`)]),v;for(const A in i){const C=A.match(/^(.*)-transition$/);v=v.concat(C&&_[C[1]]&&_[C[1]].transition?Ui({key:A,value:i[A],valueSpec:p.transition,style:h,styleSpec:p}):_[A]?Ui({key:A,value:i[A],valueSpec:_[A],style:h,styleSpec:p}):[new $t(A,i[A],`unknown property "${A}"`)])}if(i.source){const A=h.sources&&h.sources[i.source],C=A&&jr(A.type);A?C!=="raster-dem"&&v.push(new $t(c,i.source,`terrain cannot be used with a source of type ${String(C)}, it only be used with a "raster-dem" source type`)):v.push(new $t(c,i.source,`source "${i.source}" not found`))}else v.push(new $t(c,i,'terrain is missing required property "source"'));return v}function Rm(l){const i=l.value,c=l.style,h=l.styleSpec,p=h.fog;let _=[];const v=Rr(i);if(i===void 0)return _;if(v!=="object")return _=_.concat([new $t("fog",i,`object expected, ${v} found`)]),_;for(const w in i){const A=w.match(/^(.*)-transition$/);_=_.concat(A&&p[A[1]]&&p[A[1]].transition?Ui({key:w,value:i[w],valueSpec:h.transition,style:c,styleSpec:h}):p[w]?Ui({key:w,value:i[w],valueSpec:p[w],style:c,styleSpec:h}):[new $t(w,i[w],`unknown property "${w}"`)])}return _}const qu={"*":()=>[],array:lc,boolean:function(l){const i=l.value,c=l.key,h=Rr(i);return h!=="boolean"?[new $t(c,i,`boolean expected, ${h} found`)]:[]},number:Jo,color:function(l){const i=l.key,c=l.value,h=Rr(c);return h!=="string"?[new $t(i,c,`color expected, ${h} found`)]:sm.parseCSSColor(c)===null?[new $t(i,c,`color expected, "${c}" found`)]:[]},enum:cc,filter:Kd,function:Zd,layer:Om,object:Xn,source:Dm,light:Xd,terrain:Yd,fog:Rm,string:qa,formatted:function(l){return qa(l).length===0?[]:Qo(l)},resolvedImage:function(l){return qa(l).length===0?[]:Qo(l)},projection:function(l){const i=l.value,c=l.styleSpec,h=c.projection,p=l.style;let _=[];const v=Rr(i);if(v==="object")for(const w in i)_=_.concat(Ui({key:w,value:i[w],valueSpec:h[w],style:p,styleSpec:c}));else v!=="string"&&(_=_.concat([new $t("projection",i,`object or string expected, ${v} found`)]));return _}};function Ui(l){const i=l.value,c=l.valueSpec,h=l.styleSpec;return c.expression&&Bu(jr(i))?Zd(l):c.expression&&ju(gi(i))?Qo(l):c.type&&qu[c.type]?qu[c.type](l):Xn(Ir({},l,{valueSpec:c.type?h[c.type]:c}))}function Lm(l){const i=l.value,c=l.key,h=qa(l);return h.length||(i.indexOf("{fontstack}")===-1&&h.push(new $t(c,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&h.push(new $t(c,i,'"glyphs" url must include a "{range}" token'))),h}function km(l,i=ze){return ds(Ui({key:"",value:l,valueSpec:i.$root,styleSpec:i,style:l,objectElementValidators:{glyphs:Lm,"*":()=>[]}}))}const zm=l=>ds(Mm(l)),jv=l=>ds(Wu(l));function ds(l){return l.slice().sort((i,c)=>i.line&&c.line?i.line-c.line:0)}function Fm(l,i){let c=!1;if(i&&i.length)for(const h of i)l.fire(new Wt(new Error(h.message))),c=!0;return c}var Ka=Os;function Os(l,i,c){var h=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var p=new Int32Array(this.arrayBuffer);l=p[0],this.d=(i=p[1])+2*(c=p[2]);for(var _=0;_<this.d*this.d;_++){var v=p[3+_],w=p[3+_+1];h.push(v===w?null:p.subarray(v,w))}var A=p[3+h.length+1];this.keys=p.subarray(p[3+h.length],A),this.bboxes=p.subarray(A),this.insert=this._insertReadonly}else{this.d=i+2*c;for(var C=0;C<this.d*this.d;C++)h.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=l,this.padding=c,this.scale=i/l,this.uid=0;var D=c/i*l;this.min=-D,this.max=l+D}Os.prototype.insert=function(l,i,c,h,p){this._forEachCell(i,c,h,p,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(i),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(p)},Os.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Os.prototype._insertCell=function(l,i,c,h,p,_){this.cells[p].push(_)},Os.prototype.query=function(l,i,c,h,p){var _=this.min,v=this.max;if(l<=_&&i<=_&&v<=c&&v<=h&&!p)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(l,i,c,h,this._queryCell,w,{},p),w},Os.prototype._queryCell=function(l,i,c,h,p,_,v,w){var A=this.cells[p];if(A!==null)for(var C=this.keys,D=this.bboxes,k=0;k<A.length;k++){var F=A[k];if(v[F]===void 0){var V=4*F;(w?w(D[V+0],D[V+1],D[V+2],D[V+3]):l<=D[V+2]&&i<=D[V+3]&&c>=D[V+0]&&h>=D[V+1])?(v[F]=!0,_.push(C[F])):v[F]=!1}}},Os.prototype._forEachCell=function(l,i,c,h,p,_,v,w){for(var A=this._convertToCellCoord(l),C=this._convertToCellCoord(i),D=this._convertToCellCoord(c),k=this._convertToCellCoord(h),F=A;F<=D;F++)for(var V=C;V<=k;V++){var H=this.d*V+F;if((!w||w(this._convertFromCellCoord(F),this._convertFromCellCoord(V),this._convertFromCellCoord(F+1),this._convertFromCellCoord(V+1)))&&p.call(this,l,i,c,h,H,_,v,w))return}},Os.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},Os.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},Os.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,i=3+this.cells.length+1+1,c=0,h=0;h<this.cells.length;h++)c+=this.cells[h].length;var p=new Int32Array(i+c+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var _=i,v=0;v<l.length;v++){var w=l[v];p[3+v]=_,p.set(w,_),_+=w.length}return p[3+l.length]=_,p.set(this.keys,_),p[3+l.length+1]=_+=this.keys.length,p.set(this.bboxes,_),_+=this.bboxes.length,p.buffer};const Ku={};function Vt(l,i,c={}){Object.defineProperty(l,"_classRegistryKey",{value:i,writeable:!1}),Ku[i]={klass:l,omit:c.omit||[]}}Vt(Object,"Object"),Ka.serialize=function(l,i){const c=l.toArrayBuffer();return i&&i.push(c),{buffer:c}},Ka.deserialize=function(l){return new Ka(l.buffer)},Object.defineProperty(Ka,"name",{value:"Grid"}),Vt(Ka,"Grid"),Vt(_i,"Color"),Vt(Error,"Error"),Vt(Oe,"AJAXError"),Vt(qn,"ResolvedImage"),Vt(ac,"StylePropertyFunction"),Vt(Nu,"StyleExpression",{omit:["_evaluator"]}),Vt(oc,"ZoomDependentExpression"),Vt($u,"ZoomConstantExpression"),Vt(Ys,"CompoundExpression",{omit:["_evaluate"]});for(const l in sc)Ku[sc[l]._classRegistryKey]||Vt(sc[l],`Expression${l}`);function Bm(l){return l&&typeof ArrayBuffer!="undefined"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Nm(l){return g.ImageBitmap&&l instanceof g.ImageBitmap}function dc(l,i){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(Bm(l)||Nm(l))return i&&i.push(l),l;if(ArrayBuffer.isView(l)){const c=l;return i&&i.push(c.buffer),c}if(l instanceof g.ImageData)return i&&i.push(l.data.buffer),l;if(Array.isArray(l)){const c=[];for(const h of l)c.push(dc(h,i));return c}if(typeof l=="object"){const c=l.constructor,h=c._classRegistryKey;if(!h)throw new Error(`can't serialize object of unregistered class ${h}`);const p=c.serialize?c.serialize(l,i):{};if(!c.serialize){for(const _ in l)l.hasOwnProperty(_)&&(Ku[h].omit.indexOf(_)>=0||(p[_]=dc(l[_],i)));l instanceof Error&&(p.message=l.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(p.$name=h),p}throw new Error("can't serialize object of type "+typeof l)}function fc(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||Bm(l)||Nm(l)||ArrayBuffer.isView(l)||l instanceof g.ImageData)return l;if(Array.isArray(l))return l.map(fc);if(typeof l=="object"){const i=l.$name||"Object",{klass:c}=Ku[i];if(!c)throw new Error(`can't deserialize unregistered class ${i}`);if(c.deserialize)return c.deserialize(l);const h=Object.create(c.prototype);for(const p of Object.keys(l))p!=="$name"&&(h[p]=fc(l[p]));return h}throw new Error("can't deserialize object of type "+typeof l)}class jm{constructor(){this.first=!0}update(i,c){const h=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=c),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=h,!0))}}const $m=l=>l>=1536&&l<=1791,Vm=l=>l>=1872&&l<=1919,pc=l=>l>=2208&&l<=2303,Um=l=>l>=11904&&l<=12031,Gm=l=>l>=12032&&l<=12255,mc=l=>l>=12272&&l<=12287,Xu=l=>l>=12288&&l<=12351,Yu=l=>l>=12352&&l<=12447,Ju=l=>l>=12448&&l<=12543,Jd=l=>l>=12544&&l<=12591,Qd=l=>l>=12704&&l<=12735,ef=l=>l>=12736&&l<=12783,tf=l=>l>=12784&&l<=12799,Qu=l=>l>=12800&&l<=13055,eh=l=>l>=13056&&l<=13311,Hm=l=>l>=13312&&l<=19903,rf=l=>l>=19968&&l<=40959,Wm=l=>l>=40960&&l<=42127,th=l=>l>=42128&&l<=42191,Zm=l=>l>=44032&&l<=55215,qm=l=>l>=63744&&l<=64255,nf=l=>l>=64336&&l<=65023,Km=l=>l>=65040&&l<=65055,sf=l=>l>=65072&&l<=65103,of=l=>l>=65104&&l<=65135,af=l=>l>=65136&&l<=65279,lf=l=>l>=65280&&l<=65519;function rh(l){for(const i of l)if(a(i.charCodeAt(0)))return!0;return!1}function ih(l){for(const i of l)if(!m(i.charCodeAt(0)))return!1;return!0}function m(l){return!($m(l)||Vm(l)||pc(l)||nf(l)||af(l))}function a(l){return!(l!==746&&l!==747&&(l<4352||!(Qd(l)||Jd(l)||sf(l)&&!(l>=65097&&l<=65103)||qm(l)||eh(l)||Um(l)||ef(l)||!(!Xu(l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Hm(l)||rf(l)||Qu(l)||(i=>i>=12592&&i<=12687)(l)||(i=>i>=43360&&i<=43391)(l)||(i=>i>=55216&&i<=55295)(l)||(i=>i>=4352&&i<=4607)(l)||Zm(l)||Yu(l)||mc(l)||(i=>i>=12688&&i<=12703)(l)||Gm(l)||tf(l)||Ju(l)&&l!==12540||!(!lf(l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!of(l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||(i=>i>=5120&&i<=5759)(l)||(i=>i>=6320&&i<=6399)(l)||Km(l)||(i=>i>=19904&&i<=19967)(l)||Wm(l)||th(l))))}function f(l){return!(a(l)||function(i){return!!((c=>c>=128&&c<=255)(i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||(c=>c>=8192&&c<=8303)(i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||(c=>c>=8448&&c<=8527)(i)||(c=>c>=8528&&c<=8591)(i)||(c=>c>=8960&&c<=9215)(i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||(c=>c>=9216&&c<=9279)(i)&&i!==9251||(c=>c>=9280&&c<=9311)(i)||(c=>c>=9312&&c<=9471)(i)||(c=>c>=9632&&c<=9727)(i)||(c=>c>=9728&&c<=9983)(i)&&!(i>=9754&&i<=9759)||(c=>c>=11008&&c<=11263)(i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Xu(i)||Ju(i)||(c=>c>=57344&&c<=63743)(i)||sf(i)||of(i)||lf(i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(l))}function y(l){return l>=1424&&l<=2303||nf(l)||af(l)}function b(l,i){return!(!i&&y(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||(c=>c>=6016&&c<=6143)(l))}function T(l){for(const i of l)if(y(i.charCodeAt(0)))return!0;return!1}const M="deferred",O="loading",L="loaded";let N=null,U="unavailable",Z=null;const te=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(U="error"),N&&N(l)};function ae(){le.fire(new lr("pluginStateChange",{pluginStatus:U,pluginURL:Z}))}const le=new ar,ie=function(){return U},ve=function(){if(U!==M||!Z)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");U=O,ae(),Z&&Y({url:Z},l=>{l?te(l):(U=L,ae())})},oe={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>U===L||oe.applyArabicShaping!=null,isLoading:()=>U===O,setState(l){U=l.pluginStatus,Z=l.pluginURL},isParsed:()=>oe.applyArabicShaping!=null&&oe.processBidirectionalText!=null&&oe.processStyledBidirectionalText!=null,getPluginURL:()=>Z};class he{constructor(i,c){this.zoom=i,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new jm,this.transition={},this.pitch=0)}isSupportedScript(i){return function(c,h){for(const p of c)if(!b(p.charCodeAt(0),h))return!1;return!0}(i,oe.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,c=i-Math.floor(i),h=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*c}}}class de{constructor(i,c){this.property=i,this.value=c,this.expression=function(h,p){if(Bu(h))return new ac(h,p);if(ju(h)){const _=Vu(h,p);if(_.result==="error")throw new Error(_.value.map(v=>`${v.key}: ${v.message}`).join(", "));return _.value}{let _=h;return typeof h=="string"&&p.type==="color"&&(_=_i.parse(h)),{kind:"constant",evaluate:()=>_}}}(c===void 0?i.specification.default:c,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,c,h){return this.property.possiblyEvaluate(this,i,c,h)}}class Ae{constructor(i){this.property=i,this.value=new de(i,void 0)}transitioned(i,c){return new be(this.property,this.value,c,xe({},i.transition,this.transition),i.now)}untransitioned(){return new be(this.property,this.value,null,{},0)}}class _e{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Et(this._values[i].value.value)}setValue(i,c){this._values.hasOwnProperty(i)||(this._values[i]=new Ae(this._values[i].property)),this._values[i].value=new de(this._values[i].property,c===null?void 0:Et(c))}getTransition(i){return Et(this._values[i].transition)}setTransition(i,c){this._values.hasOwnProperty(i)||(this._values[i]=new Ae(this._values[i].property)),this._values[i].transition=Et(c)||void 0}serialize(){const i={};for(const c of Object.keys(this._values)){const h=this.getValue(c);h!==void 0&&(i[c]=h);const p=this.getTransition(c);p!==void 0&&(i[`${c}-transition`]=p)}return i}transitioned(i,c){const h=new Re(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].transitioned(i,c._values[p]);return h}untransitioned(){const i=new Re(this._properties);for(const c of Object.keys(this._values))i._values[c]=this._values[c].untransitioned();return i}}class be{constructor(i,c,h,p,_){const v=p.delay||0,w=p.duration||0;_=_||0,this.property=i,this.value=c,this.begin=_+v,this.end=this.begin+w,i.specification.transition&&(p.delay||p.duration)&&(this.prior=h)}possiblyEvaluate(i,c,h){const p=i.now||0,_=this.value.possiblyEvaluate(i,c,h),v=this.prior;if(v){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return v.possiblyEvaluate(i,c,h);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(i,c,h),_,j(w))}}return _}}class Re{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,c,h){const p=new Ze(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(i,c,h);return p}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class We{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return Et(this._values[i].value)}setValue(i,c){this._values[i]=new de(this._values[i].property,c===null?void 0:Et(c))}serialize(){const i={};for(const c of Object.keys(this._values)){const h=this.getValue(c);h!==void 0&&(i[c]=h)}return i}possiblyEvaluate(i,c,h){const p=new Ze(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(i,c,h);return p}}class Ke{constructor(i,c,h){this.property=i,this.value=c,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,c,h,p){return this.property.evaluate(this.value,this.parameters,i,c,h,p)}}class Ze{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Ge{constructor(i){this.specification=i}possiblyEvaluate(i,c){return i.expression.evaluate(c)}interpolate(i,c,h){const p=Ql[this.specification.type];return p?p(i,c,h):i}}class Se{constructor(i,c){this.specification=i,this.overrides=c}possiblyEvaluate(i,c,h,p){return new Ke(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(c,null,{},h,p)}:i.expression,c)}interpolate(i,c,h){if(i.value.kind!=="constant"||c.value.kind!=="constant")return i;if(i.value.value===void 0||c.value.value===void 0)return new Ke(this,{kind:"constant",value:void 0},i.parameters);const p=Ql[this.specification.type];return p?new Ke(this,{kind:"constant",value:p(i.value.value,c.value.value,h)},i.parameters):i}evaluate(i,c,h,p,_,v){return i.kind==="constant"?i.value:i.evaluate(c,h,p,_,v)}}class dt extends Se{possiblyEvaluate(i,c,h,p){if(i.value===void 0)return new Ke(this,{kind:"constant",value:void 0},c);if(i.expression.kind==="constant"){const _=i.expression.evaluate(c,null,{},h,p),v=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,w=this._calculate(v,v,v,c);return new Ke(this,{kind:"constant",value:w},c)}if(i.expression.kind==="camera"){const _=this._calculate(i.expression.evaluate({zoom:c.zoom-1}),i.expression.evaluate({zoom:c.zoom}),i.expression.evaluate({zoom:c.zoom+1}),c);return new Ke(this,{kind:"constant",value:_},c)}return new Ke(this,i.expression,c)}evaluate(i,c,h,p,_,v){if(i.kind==="source"){const w=i.evaluate(c,h,p,_,v);return this._calculate(w,w,w,c)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(c.zoom)-1},h,p),i.evaluate({zoom:Math.floor(c.zoom)},h,p),i.evaluate({zoom:Math.floor(c.zoom)+1},h,p),c):i.value}_calculate(i,c,h,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:c,other:h}:{from:h,to:c,other:i}}interpolate(i){return i}}class ct{constructor(i){this.specification=i}possiblyEvaluate(i,c,h,p){if(i.value!==void 0){if(i.expression.kind==="constant"){const _=i.expression.evaluate(c,null,{},h,p);return this._calculate(_,_,_,c)}return this._calculate(i.expression.evaluate(new he(Math.floor(c.zoom-1),c)),i.expression.evaluate(new he(Math.floor(c.zoom),c)),i.expression.evaluate(new he(Math.floor(c.zoom+1),c)),c)}}_calculate(i,c,h,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:c}:{from:h,to:c}}interpolate(i){return i}}class Rt{constructor(i){this.specification=i}possiblyEvaluate(i,c,h,p){return!!i.expression.evaluate(c,null,{},h,p)}interpolate(){return!1}}class Qe{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new he(0,{});for(const h in i){const p=i[h];p.specification.overridable&&this.overridableProperties.push(h);const _=this.defaultPropertyValues[h]=new de(p,void 0),v=this.defaultTransitionablePropertyValues[h]=new Ae(p);this.defaultTransitioningPropertyValues[h]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=_.possiblyEvaluate(c)}}}function Jt(l,i){return 256*(l=X(Math.floor(l),0,255))+X(Math.floor(i),0,255)}Vt(Se,"DataDrivenProperty"),Vt(Ge,"DataConstantProperty"),Vt(dt,"CrossFadedDataDrivenProperty"),Vt(ct,"CrossFadedProperty"),Vt(Rt,"ColorRampProperty");const Mt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class It{constructor(i,c){this._structArray=i,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,c){return i._trim(),c&&(i.isTransferred=!0,c.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const c=Object.create(this.prototype);return c.arrayBuffer=i.arrayBuffer,c.length=i.length,c.capacity=i.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Pt(l,i=1){let c=0,h=0;return{members:l.map(p=>{const _=Mt[p.type].BYTES_PER_ELEMENT,v=c=cr(c,Math.max(i,_)),w=p.components||1;return h=Math.max(h,_),c+=_*w,{name:p.name,type:p.type,components:w,offset:v}}),size:cr(c,Math.max(h,i)),alignment:i}}function cr(l,i){return Math.ceil(l/i)*i}class tr extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c){const h=this.length;return this.resize(h+1),this.emplace(h,i,c)}emplace(i,c,h){const p=2*i;return this.int16[p+0]=c,this.int16[p+1]=h,i}}tr.prototype.bytesPerElement=4,Vt(tr,"StructArrayLayout2i4");class _r extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,i,c,h)}emplace(i,c,h,p){const _=3*i;return this.int16[_+0]=c,this.int16[_+1]=h,this.int16[_+2]=p,i}}_r.prototype.bytesPerElement=6,Vt(_r,"StructArrayLayout3i6");class Xt extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,i,c,h,p)}emplace(i,c,h,p,_){const v=4*i;return this.int16[v+0]=c,this.int16[v+1]=h,this.int16[v+2]=p,this.int16[v+3]=_,i}}Xt.prototype.bytesPerElement=8,Vt(Xt,"StructArrayLayout4i8");class mr extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,i,c,h,p,_,v,w)}emplace(i,c,h,p,_,v,w,A){const C=6*i,D=12*i,k=3*i;return this.int16[C+0]=c,this.int16[C+1]=h,this.uint8[D+4]=p,this.uint8[D+5]=_,this.uint8[D+6]=v,this.uint8[D+7]=w,this.float32[k+2]=A,i}}mr.prototype.bytesPerElement=12,Vt(mr,"StructArrayLayout2i4ub1f12");class Br extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,i,c,h,p)}emplace(i,c,h,p,_){const v=4*i;return this.float32[v+0]=c,this.float32[v+1]=h,this.float32[v+2]=p,this.float32[v+3]=_,i}}Br.prototype.bytesPerElement=16,Vt(Br,"StructArrayLayout4f16");class Gr extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w,A,C,D){const k=this.length;return this.resize(k+1),this.emplace(k,i,c,h,p,_,v,w,A,C,D)}emplace(i,c,h,p,_,v,w,A,C,D,k){const F=10*i;return this.uint16[F+0]=c,this.uint16[F+1]=h,this.uint16[F+2]=p,this.uint16[F+3]=_,this.uint16[F+4]=v,this.uint16[F+5]=w,this.uint16[F+6]=A,this.uint16[F+7]=C,this.uint16[F+8]=D,this.uint16[F+9]=k,i}}Gr.prototype.bytesPerElement=20,Vt(Gr,"StructArrayLayout10ui20");class Ti extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w,A){const C=this.length;return this.resize(C+1),this.emplace(C,i,c,h,p,_,v,w,A)}emplace(i,c,h,p,_,v,w,A,C){const D=8*i;return this.uint16[D+0]=c,this.uint16[D+1]=h,this.uint16[D+2]=p,this.uint16[D+3]=_,this.uint16[D+4]=v,this.uint16[D+5]=w,this.uint16[D+6]=A,this.uint16[D+7]=C,i}}Ti.prototype.bytesPerElement=16,Vt(Ti,"StructArrayLayout8ui16");class Yr extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,i,c,h,p,_,v)}emplace(i,c,h,p,_,v,w){const A=6*i;return this.int16[A+0]=c,this.int16[A+1]=h,this.int16[A+2]=p,this.int16[A+3]=_,this.int16[A+4]=v,this.int16[A+5]=w,i}}Yr.prototype.bytesPerElement=12,Vt(Yr,"StructArrayLayout6i12");class kn extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w,A,C,D,k,F){const V=this.length;return this.resize(V+1),this.emplace(V,i,c,h,p,_,v,w,A,C,D,k,F)}emplace(i,c,h,p,_,v,w,A,C,D,k,F,V){const H=12*i;return this.int16[H+0]=c,this.int16[H+1]=h,this.int16[H+2]=p,this.int16[H+3]=_,this.uint16[H+4]=v,this.uint16[H+5]=w,this.uint16[H+6]=A,this.uint16[H+7]=C,this.int16[H+8]=D,this.int16[H+9]=k,this.int16[H+10]=F,this.int16[H+11]=V,i}}kn.prototype.bytesPerElement=24,Vt(kn,"StructArrayLayout4i4ui4i24");class Ds extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,i,c,h,p,_,v)}emplace(i,c,h,p,_,v,w){const A=10*i,C=5*i;return this.int16[A+0]=c,this.int16[A+1]=h,this.int16[A+2]=p,this.float32[C+2]=_,this.float32[C+3]=v,this.float32[C+4]=w,i}}Ds.prototype.bytesPerElement=20,Vt(Ds,"StructArrayLayout3i3f20");class Qs extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint32[1*i+0]=c,i}}Qs.prototype.bytesPerElement=4,Vt(Qs,"StructArrayLayout1ul4");class ii extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w,A,C,D,k,F,V){const H=this.length;return this.resize(H+1),this.emplace(H,i,c,h,p,_,v,w,A,C,D,k,F,V)}emplace(i,c,h,p,_,v,w,A,C,D,k,F,V,H){const Q=20*i,ce=10*i;return this.int16[Q+0]=c,this.int16[Q+1]=h,this.int16[Q+2]=p,this.int16[Q+3]=_,this.int16[Q+4]=v,this.float32[ce+3]=w,this.float32[ce+4]=A,this.float32[ce+5]=C,this.float32[ce+6]=D,this.int16[Q+14]=k,this.uint32[ce+8]=F,this.uint16[Q+18]=V,this.uint16[Q+19]=H,i}}ii.prototype.bytesPerElement=40,Vt(ii,"StructArrayLayout5i4f1i1ul2ui40");class ai extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,i,c,h,p,_,v,w)}emplace(i,c,h,p,_,v,w,A){const C=8*i;return this.int16[C+0]=c,this.int16[C+1]=h,this.int16[C+2]=p,this.int16[C+4]=_,this.int16[C+5]=v,this.int16[C+6]=w,this.int16[C+7]=A,i}}ai.prototype.bytesPerElement=16,Vt(ai,"StructArrayLayout3i2i2i16");class $r extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,h,p,_)}emplace(i,c,h,p,_,v){const w=4*i,A=8*i;return this.float32[w+0]=c,this.float32[w+1]=h,this.float32[w+2]=p,this.int16[A+6]=_,this.int16[A+7]=v,i}}$r.prototype.bytesPerElement=16,Vt($r,"StructArrayLayout2f1f2i16");class Mi extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,i,c,h,p)}emplace(i,c,h,p,_){const v=12*i,w=3*i;return this.uint8[v+0]=c,this.uint8[v+1]=h,this.float32[w+1]=p,this.float32[w+2]=_,i}}Mi.prototype.bytesPerElement=12,Vt(Mi,"StructArrayLayout2ub2f12");class Ki extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,i,c,h)}emplace(i,c,h,p){const _=3*i;return this.float32[_+0]=c,this.float32[_+1]=h,this.float32[_+2]=p,i}}Ki.prototype.bytesPerElement=12,Vt(Ki,"StructArrayLayout3f12");class Mr extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,i,c,h)}emplace(i,c,h,p){const _=3*i;return this.uint16[_+0]=c,this.uint16[_+1]=h,this.uint16[_+2]=p,i}}Mr.prototype.bytesPerElement=6,Vt(Mr,"StructArrayLayout3ui6");class bn extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q,ce,ge,Ce,Pe,De,Le){const je=this.length;return this.resize(je+1),this.emplace(je,i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q,ce,ge,Ce,Pe,De,Le)}emplace(i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q,ce,ge,Ce,Pe,De,Le,je){const qe=30*i,Xe=15*i,at=60*i;return this.int16[qe+0]=c,this.int16[qe+1]=h,this.int16[qe+2]=p,this.float32[Xe+2]=_,this.float32[Xe+3]=v,this.uint16[qe+8]=w,this.uint16[qe+9]=A,this.uint32[Xe+5]=C,this.uint32[Xe+6]=D,this.uint32[Xe+7]=k,this.uint16[qe+16]=F,this.uint16[qe+17]=V,this.uint16[qe+18]=H,this.float32[Xe+10]=Q,this.float32[Xe+11]=ce,this.uint8[at+48]=ge,this.uint8[at+49]=Ce,this.uint8[at+50]=Pe,this.uint32[Xe+13]=De,this.int16[qe+28]=Le,this.uint8[at+58]=je,i}}bn.prototype.bytesPerElement=60,Vt(bn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ra extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q,ce,ge,Ce,Pe,De,Le,je,qe,Xe,at,vt,Ue,nt,xt,bt){const Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q,ce,ge,Ce,Pe,De,Le,je,qe,Xe,at,vt,Ue,nt,xt,bt)}emplace(i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q,ce,ge,Ce,Pe,De,Le,je,qe,Xe,at,vt,Ue,nt,xt,bt,Bt){const _t=38*i,kt=19*i;return this.int16[_t+0]=c,this.int16[_t+1]=h,this.int16[_t+2]=p,this.float32[kt+2]=_,this.float32[kt+3]=v,this.int16[_t+8]=w,this.int16[_t+9]=A,this.int16[_t+10]=C,this.int16[_t+11]=D,this.int16[_t+12]=k,this.int16[_t+13]=F,this.uint16[_t+14]=V,this.uint16[_t+15]=H,this.uint16[_t+16]=Q,this.uint16[_t+17]=ce,this.uint16[_t+18]=ge,this.uint16[_t+19]=Ce,this.uint16[_t+20]=Pe,this.uint16[_t+21]=De,this.uint16[_t+22]=Le,this.uint16[_t+23]=je,this.uint16[_t+24]=qe,this.uint16[_t+25]=Xe,this.uint16[_t+26]=at,this.uint16[_t+27]=vt,this.uint16[_t+28]=Ue,this.uint32[kt+15]=nt,this.float32[kt+16]=xt,this.float32[kt+17]=bt,this.float32[kt+18]=Bt,i}}ra.prototype.bytesPerElement=76,Vt(ra,"StructArrayLayout3i2f6i15ui1ul3f76");class fs extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.float32[1*i+0]=c,i}}fs.prototype.bytesPerElement=4,Vt(fs,"StructArrayLayout1f4");class Xa extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,i,c,h,p,_,v,w)}emplace(i,c,h,p,_,v,w,A){const C=7*i;return this.float32[C+0]=c,this.float32[C+1]=h,this.float32[C+2]=p,this.float32[C+3]=_,this.float32[C+4]=v,this.float32[C+5]=w,this.float32[C+6]=A,i}}Xa.prototype.bytesPerElement=28,Vt(Xa,"StructArrayLayout7f28");class Ya extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,h,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,h,p,_)}emplace(i,c,h,p,_,v){const w=5*i;return this.float32[w+0]=c,this.float32[w+1]=h,this.float32[w+2]=p,this.float32[w+3]=_,this.float32[w+4]=v,i}}Ya.prototype.bytesPerElement=20,Vt(Ya,"StructArrayLayout5f20");class xo extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,i,c,h,p)}emplace(i,c,h,p,_){const v=6*i;return this.uint32[3*i+0]=c,this.uint16[v+2]=h,this.uint16[v+3]=p,this.uint16[v+4]=_,i}}xo.prototype.bytesPerElement=12,Vt(xo,"StructArrayLayout1ul3ui12");class Oi extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c){const h=this.length;return this.resize(h+1),this.emplace(h,i,c)}emplace(i,c,h){const p=2*i;return this.uint16[p+0]=c,this.uint16[p+1]=h,i}}Oi.prototype.bytesPerElement=4,Vt(Oi,"StructArrayLayout2ui4");class Rs extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint16[1*i+0]=c,i}}Rs.prototype.bytesPerElement=2,Vt(Rs,"StructArrayLayout1ui2");class eo extends wt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c){const h=this.length;return this.resize(h+1),this.emplace(h,i,c)}emplace(i,c,h){const p=2*i;return this.float32[p+0]=c,this.float32[p+1]=h,i}}eo.prototype.bytesPerElement=8,Vt(eo,"StructArrayLayout2f8");class gc extends It{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}gc.prototype.size=12;class Sw extends Yr{get(i){return new gc(this,i)}}Vt(Sw,"FillExtrusionExtArray");class Aw extends It{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Aw.prototype.size=40;class $v extends ii{get(i){return new Aw(this,i)}}Vt($v,"CollisionBoxArray");class Pw extends It{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Pw.prototype.size=60;class Cw extends bn{get(i){return new Pw(this,i)}}Vt(Cw,"PlacedSymbolArray");class Iw extends It{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Iw.prototype.size=76;class Mw extends ra{get(i){return new Iw(this,i)}}Vt(Mw,"SymbolInstanceArray");class Ow extends fs{getoffsetX(i){return this.float32[1*i+0]}}Vt(Ow,"GlyphOffsetArray");class Dw extends _r{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Vt(Dw,"SymbolLineVertexArray");class Rw extends It{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Rw.prototype.size=12;class Lw extends xo{get(i){return new Rw(this,i)}}Vt(Lw,"FeatureIndexArray");class kw extends It{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}kw.prototype.size=4;class zw extends Oi{get(i){return new kw(this,i)}}Vt(zw,"FillExtrusionCentroidArray");class Fw extends It{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Fw.prototype.size=12;class Bw extends Yr{get(i){return new Fw(this,i)}}Vt(Bw,"CircleGlobeExtArray");const xR=Pt([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),bR=Pt([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Nw=za(function(l){l.exports=function(i,c){var h,p,_,v,w,A,C,D;for(p=i.length-(h=3&i.length),_=c,w=3432918353,A=461845907,D=0;D<p;)C=255&i.charCodeAt(D)|(255&i.charCodeAt(++D))<<8|(255&i.charCodeAt(++D))<<16|(255&i.charCodeAt(++D))<<24,++D,_=27492+(65535&(v=5*(65535&(_=(_^=C=(65535&(C=(C=(65535&C)*w+(((C>>>16)*w&65535)<<16)&4294967295)<<15|C>>>17))*A+(((C>>>16)*A&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(C=0,h){case 3:C^=(255&i.charCodeAt(D+2))<<16;case 2:C^=(255&i.charCodeAt(D+1))<<8;case 1:_^=C=(65535&(C=(C=(65535&(C^=255&i.charCodeAt(D)))*w+(((C>>>16)*w&65535)<<16)&4294967295)<<15|C>>>17))*A+(((C>>>16)*A&65535)<<16)&4294967295}return _^=i.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}}),wR=za(function(l){l.exports=function(i,c){for(var h,p=i.length,_=c^p,v=0;p>=4;)h=1540483477*(65535&(h=255&i.charCodeAt(v)|(255&i.charCodeAt(++v))<<8|(255&i.charCodeAt(++v))<<16|(255&i.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),p-=4,++v;switch(p){case 3:_^=(255&i.charCodeAt(v+2))<<16;case 2:_^=(255&i.charCodeAt(v+1))<<8;case 1:_=1540483477*(65535&(_^=255&i.charCodeAt(v)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}}),cf=Nw,ER=wR;cf.murmur3=Nw,cf.murmur2=ER;class Xm{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,c,h,p){this.ids.push(jw(i)),this.positions.push(c,h,p)}getPositions(i){const c=jw(i);let h=0,p=this.ids.length-1;for(;h<p;){const v=h+p>>1;this.ids[v]>=c?p=v:h=v+1}const _=[];for(;this.ids[h]===c;)_.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return _}static serialize(i,c){const h=new Float64Array(i.ids),p=new Uint32Array(i.positions);return Vv(h,p,0,h.length-1),c&&c.push(h.buffer,p.buffer),{ids:h,positions:p}}static deserialize(i){const c=new Xm;return c.ids=i.ids,c.positions=i.positions,c.indexed=!0,c}}function jw(l){const i=+l;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:cf(String(l))}function Vv(l,i,c,h){for(;c<h;){const p=l[c+h>>1];let _=c-1,v=h+1;for(;;){do _++;while(l[_]<p);do v--;while(l[v]>p);if(_>=v)break;Ym(l,_,v),Ym(i,3*_,3*v),Ym(i,3*_+1,3*v+1),Ym(i,3*_+2,3*v+2)}v-c<h-v?(Vv(l,i,c,v),c=v+1):(Vv(l,i,v+1,h),h=v)}}function Ym(l,i,c){const h=l[i];l[i]=l[c],l[c]=h}Vt(Xm,"FeaturePositionMap");class ia{constructor(i,c){this.gl=i.gl,this.location=c}}class Jm extends ia{constructor(i,c){super(i,c),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class $w extends ia{constructor(i,c){super(i,c),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Vw extends ia{constructor(i,c){super(i,c),this.current=_i.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const TR=new Float32Array(16),SR=new Float32Array(9),AR=new Float32Array(4);function Uv(l){return[Jt(255*l.r,255*l.g),Jt(255*l.b,255*l.a)]}class uf{constructor(i,c,h){this.value=i,this.uniformNames=c.map(p=>`u_${p}`),this.type=h}setUniform(i,c,h){i.set(h.constantOr(this.value))}getBinding(i,c,h){return this.type==="color"?new Vw(i,c):new Jm(i,c)}}class nh{constructor(i,c){this.uniformNames=c.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,c){this.pixelRatioFrom=c.pixelRatio||1,this.pixelRatioTo=i.pixelRatio||1,this.patternFrom=c.tl.concat(c.br),this.patternTo=i.tl.concat(i.br)}setUniform(i,c,h,p){const _=p==="u_pattern_to"||p==="u_dash_to"?this.patternTo:p==="u_pattern_from"||p==="u_dash_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&i.set(_)}getBinding(i,c,h){return h==="u_pattern_from"||h==="u_pattern_to"||h==="u_dash_from"||h==="u_dash_to"?new $w(i,c):new Jm(i,c)}}class na{constructor(i,c,h,p){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=c.map(_=>({name:`a_${_}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(i,c,h,p,_,v){const w=this.paintVertexArray.length,A=this.expression.evaluate(new he(0),c,{},_,p,v);this.paintVertexArray.resize(i),this._setPaintValue(w,i,A)}updatePaintArray(i,c,h,p,_){const v=this.expression.evaluate({zoom:0},h,p,void 0,_);this._setPaintValue(i,c,v)}_setPaintValue(i,c,h){if(this.type==="color"){const p=Uv(h);for(let _=i;_<c;_++)this.paintVertexArray.emplace(_,p[0],p[1])}else{for(let p=i;p<c;p++)this.paintVertexArray.emplace(p,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class to{constructor(i,c,h,p,_,v){this.expression=i,this.uniformNames=c.map(w=>`u_${w}_t`),this.type=h,this.useIntegerZoom=p,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=c.map(w=>({name:`a_${w}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(i,c,h,p,_,v){const w=this.expression.evaluate(new he(this.zoom),c,{},_,p,v),A=this.expression.evaluate(new he(this.zoom+1),c,{},_,p,v),C=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(C,i,w,A)}updatePaintArray(i,c,h,p,_){const v=this.expression.evaluate({zoom:this.zoom},h,p,void 0,_),w=this.expression.evaluate({zoom:this.zoom+1},h,p,void 0,_);this._setPaintValue(i,c,v,w)}_setPaintValue(i,c,h,p){if(this.type==="color"){const _=Uv(h),v=Uv(p);for(let w=i;w<c;w++)this.paintVertexArray.emplace(w,_[0],_[1],v[0],v[1])}else{for(let _=i;_<c;_++)this.paintVertexArray.emplace(_,h,p);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,c){const h=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,p=X(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);i.set(p)}getBinding(i,c,h){return new Jm(i,c)}}class Ja{constructor(i,c,h,p,_,v,w){this.expression=i,this.type=h,this.useIntegerZoom=p,this.zoom=_,this.layerId=w,this.paintVertexAttributes=(h==="array"?bR:xR).members;for(let A=0;A<c.length;++A);this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(i,c,h){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(p,i,c.patterns&&c.patterns[this.layerId],h)}updatePaintArray(i,c,h,p,_,v){this._setPaintValues(i,c,h.patterns&&h.patterns[this.layerId],v)}_setPaintValues(i,c,h,p){if(!p||!h)return;const{min:_,mid:v,max:w}=h,A=p[_],C=p[v],D=p[w];if(A&&C&&D)for(let k=i;k<c;k++)this._setPaintValue(this.zoomInPaintVertexArray,k,C,A),this._setPaintValue(this.zoomOutPaintVertexArray,k,C,D)}_setPaintValue(i,c,h,p){i.emplace(c,h.tl[0],h.tl[1],h.br[0],h.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],h.pixelRatio,p.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Qa{constructor(i,c,h=()=>!0){this.binders={},this._buffers=[];const p=[];for(const _ in i.paint._values){if(!h(_))continue;const v=i.paint.get(_);if(!(v instanceof Ke&&Ga(v.property.specification)))continue;const w=CR(_,i.type),A=v.value,C=v.property.specification.type,D=v.property.useIntegerZoom,k=v.property.specification["property-type"],F=k==="cross-faded"||k==="cross-faded-data-driven",V=String(_)==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant";if(A.kind!=="constant"||V)if(A.kind==="source"||V||F){const H=Uw(_,C,"source");this.binders[_]=F?new Ja(A,w,C,D,c,H,i.id):new na(A,w,C,H),p.push(`/a_${_}`)}else{const H=Uw(_,C,"composite");this.binders[_]=new to(A,w,C,D,c,H),p.push(`/z_${_}`)}else this.binders[_]=F?new nh(A.value,w):new uf(A.value,w,C),p.push(`/u_${_}`)}this.cacheKey=p.sort().join("")}getMaxValue(i){const c=this.binders[i];return c instanceof na||c instanceof to?c.maxValue:0}populatePaintArrays(i,c,h,p,_,v){for(const w in this.binders){const A=this.binders[w];(A instanceof na||A instanceof to||A instanceof Ja)&&A.populatePaintArray(i,c,h,p,_,v)}}setConstantPatternPositions(i,c){for(const h in this.binders){const p=this.binders[h];p instanceof nh&&p.setConstantPatternPositions(i,c)}}updatePaintArrays(i,c,h,p,_,v){let w=!1;for(const A in i){const C=c.getPositions(A);for(const D of C){const k=h.feature(D.index);for(const F in this.binders){const V=this.binders[F];if((V instanceof na||V instanceof to||V instanceof Ja)&&V.expression.isStateDependent===!0){const H=p.paint.get(F);V.expression=H.value,V.updatePaintArray(D.start,D.end,k,i[A],_,v),w=!0}}}}return w}defines(){const i=[];for(const c in this.binders){const h=this.binders[c];(h instanceof uf||h instanceof nh)&&i.push(...h.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return i}getBinderAttributes(){const i=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof na||h instanceof to||h instanceof Ja)for(let p=0;p<h.paintVertexAttributes.length;p++)i.push(h.paintVertexAttributes[p].name)}return i}getBinderUniforms(){const i=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof uf||h instanceof nh||h instanceof to)for(const p of h.uniformNames)i.push(p)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,c){const h=[];for(const p in this.binders){const _=this.binders[p];if(_ instanceof uf||_ instanceof nh||_ instanceof to){for(const v of _.uniformNames)if(c[v]){const w=_.getBinding(i,c[v],v);h.push({name:v,property:p,binding:w})}}}return h}setUniforms(i,c,h,p){for(const{name:_,property:v,binding:w}of c)this.binders[v].setUniform(w,p,h.get(v),_)}updatePaintBuffers(i){this._buffers=[];for(const c in this.binders){const h=this.binders[c];if(i&&h instanceof Ja){const p=i.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(h instanceof na||h instanceof to)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(i){for(const c in this.binders){const h=this.binders[c];(h instanceof na||h instanceof to||h instanceof Ja)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const c=this.binders[i];(c instanceof na||c instanceof to||c instanceof Ja)&&c.destroy()}}}class _c{constructor(i,c,h=()=>!0){this.programConfigurations={};for(const p of i)this.programConfigurations[p.id]=new Qa(p,c,h);this.needsUpload=!1,this._featureMap=new Xm,this._bufferOffset=0}populatePaintArrays(i,c,h,p,_,v,w){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(i,c,p,_,v,w);c.id!==void 0&&this._featureMap.add(c.id,h,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,c,h,p,_){for(const v of h)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(i,this._featureMap,c,v,p,_)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const PR={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function CR(l,i){return PR[l]||[l.replace(`${i}-`,"").replace(/-/g,"_")]}const IR={"line-pattern":{source:Gr,composite:Gr},"fill-pattern":{source:Gr,composite:Gr},"fill-extrusion-pattern":{source:Gr,composite:Gr},"line-dasharray":{source:Ti,composite:Ti}},MR={color:{source:eo,composite:Br},number:{source:fs,composite:eo}};function Uw(l,i,c){const h=IR[l];return h&&h[c]||MR[i][c]}Vt(uf,"ConstantBinder"),Vt(nh,"CrossFadedConstantBinder"),Vt(na,"SourceExpressionBinder"),Vt(Ja,"CrossFadedCompositeBinder"),Vt(to,"CompositeExpressionBinder"),Vt(Qa,"ProgramConfiguration",{omit:["_buffers"]}),Vt(_c,"ProgramConfigurationSet");const Qm="-transition";class ro extends ar{constructor(i,c){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&i.type!=="sky"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),c.layout&&(this._unevaluatedLayout=new We(c.layout)),c.paint)){this._transitionablePaint=new _e(c.paint);for(const h in i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(const h in i.layout)this.setLayoutProperty(h,i.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ze(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,c,h={}){c!=null&&this._validate(jv,`layers.${this.id}.layout.${i}`,i,c,h)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,c):this.visibility=c)}getPaintProperty(i){return Je(i,Qm)?this._transitionablePaint.getTransition(i.slice(0,-Qm.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,c,h={}){if(c!=null&&this._validate(zm,`layers.${this.id}.paint.${i}`,i,c,h))return!1;if(Je(i,Qm))return this._transitionablePaint.setTransition(i.slice(0,-Qm.length),c||void 0),!1;{const p=this._transitionablePaint._values[i],_=p.property.specification["property-type"]==="cross-faded-data-driven",v=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(i,c),this._handleSpecialPaintPropertyUpdate(i);const A=this._transitionablePaint._values[i].value;return A.isDataDriven()||v||_||this._handleOverridablePaintPropertyUpdate(i,w,A)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,c,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,c){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,c)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),ht(i,(c,h)=>!(c===void 0||h==="layout"&&!Object.keys(c).length||h==="paint"&&!Object.keys(c).length))}_validate(i,c,h,p,_={}){return(!_||_.validate!==!1)&&Fm(this,i.call(km,{key:c,layerType:this.type,objectKey:h,value:p,styleSpec:ze,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const c=this.paint.get(i);if(c instanceof Ke&&Ga(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ea(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const OR=Pt([{name:"a_pos",components:2,type:"Int16"}],4),DR=Pt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Si{constructor(i=[]){this.segments=i}prepareSegment(i,c,h,p){let _=this.segments[this.segments.length-1];return i>Si.MAX_VERTEX_ARRAY_LENGTH&&Nt(`Max vertices per segment is ${Si.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!_||_.vertexLength+i>Si.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:c.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},p!==void 0&&(_.sortKey=p),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const i of this.segments)for(const c in i.vaos)i.vaos[c].destroy()}static simpleSegment(i,c,h,p){return new Si([{vertexOffset:i,primitiveOffset:c,vertexLength:h,primitiveLength:p,vaos:{},sortKey:0}])}}Si.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vt(Si,"SegmentVector");var nr=8192;class el{constructor(i,c){i&&(c?this.setSouthWest(i).setNorthEast(c):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof Wr?new Wr(i.lng,i.lat):Wr.convert(i),this}setSouthWest(i){return this._sw=i instanceof Wr?new Wr(i.lng,i.lat):Wr.convert(i),this}extend(i){const c=this._sw,h=this._ne;let p,_;if(i instanceof Wr)p=i,_=i;else{if(!(i instanceof el))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(el.convert(i)):this.extend(Wr.convert(i)):this;if(p=i._sw,_=i._ne,!p||!_)return this}return c||h?(c.lng=Math.min(p.lng,c.lng),c.lat=Math.min(p.lat,c.lat),h.lng=Math.max(_.lng,h.lng),h.lat=Math.max(_.lat,h.lat)):(this._sw=new Wr(p.lng,p.lat),this._ne=new Wr(_.lng,_.lat)),this}getCenter(){return new Wr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Wr(this.getWest(),this.getNorth())}getSouthEast(){return new Wr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:c,lat:h}=Wr.convert(i);let p=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&p}static convert(i){return!i||i instanceof el?i:new el(i)}}const Gv=63710088e-1;class Wr{constructor(i,c){if(isNaN(i)||isNaN(c))throw new Error(`Invalid LngLat object: (${i}, ${c})`);if(this.lng=+i,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Wr(ue(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const c=Math.PI/180,h=this.lat*c,p=i.lat*c,_=Math.sin(h)*Math.sin(p)+Math.cos(h)*Math.cos(p)*Math.cos((i.lng-this.lng)*c);return Gv*Math.acos(Math.min(_,1))}toBounds(i=0){const c=360*i/40075017,h=c/Math.cos(Math.PI/180*this.lat);return new el(new Wr(this.lng-h,this.lat-c),new Wr(this.lng+h,this.lat+c))}static convert(i){if(i instanceof Wr)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Wr(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Wr(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Gw=2*Math.PI*Gv;function Hv(l){return Gw*Math.cos(l*Math.PI/180)}function yc(l){return(180+l)/360}function vc(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Ls(l,i){return l/Hv(i)}function wn(l){return 360*l-180}function Fi(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Hw(l,i){return l*Hv(Fi(i))}const bo=85.051129;class sh{constructor(i,c,h=0){this.x=+i,this.y=+c,this.z=+h}static fromLngLat(i,c=0){const h=Wr.convert(i);return new sh(yc(h.lng),vc(h.lat),Ls(c,h.lat))}toLngLat(){return new Wr(wn(this.x),Fi(this.y))}toAltitude(){return Hw(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Gw*(i=Fi(this.y),1/Math.cos(i*Math.PI/180));var i}}function Wv(l,i,c,h,p,_,v,w,A){const C=(i+h)/2,D=(c+p)/2,k=new S(C,D);w(k),function(F,V,H,Q,ce,ge){const Ce=H-ce,Pe=Q-ge;return Math.abs((Q-V)*Ce-(H-F)*Pe)/Math.hypot(Ce,Pe)}(k.x,k.y,_.x,_.y,v.x,v.y)>=A?(Wv(l,i,c,C,D,_,k,w,A),Wv(l,C,D,h,p,k,v,w,A)):l.push(v)}function Ww(l,i,c){let h=l[0],p=h.x,_=h.y;i(h);const v=[h];for(let w=1;w<l.length;w++){const A=l[w],{x:C,y:D}=A;i(A),Wv(v,p,_,C,D,h,A,i,c),p=C,_=D,h=A}return v}function Zv(l,i,c,h,p){if(p(i,c)){const _=i.add(c).mult(.5);h(_),Zv(l,i,_,h,p),Zv(l,_,c,h,p)}else l.push(c)}function RR(l,i,c){let h=l[0];i(h);const p=[h];for(let _=1;_<l.length;_++){const v=l[_];i(v),Zv(p,h,v,i,c),h=v}return p}const qv=Math.pow(2,14)-1,Zw=-qv-1;function LR(l,i){const c=Math.round(l.x*i),h=Math.round(l.y*i);return l.x=X(c,Zw,qv),l.y=X(h,Zw,qv),(c<l.x||c>l.x+1||h<l.y||h>l.y+1)&&Nt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function sa(l,i,c){const h=l.loadGeometry(),p=l.extent,_=nr/p;if(i&&c&&c.projection.isReprojectedInTileSpace){const v=1<<i.z,{scale:w,x:A,y:C,projection:D}=c,k=F=>{const V=wn((i.x+F.x/p)/v),H=Fi((i.y+F.y/p)/v),Q=D.project(V,H);F.x=(Q.x*w-A)*p,F.y=(Q.y*w-C)*p};for(let F=0;F<h.length;F++)if(l.type!==1)h[F]=Ww(h[F],k,1);else{const V=[];for(const H of h[F])H.x<0||H.x>=p||H.y<0||H.y>=p||(k(H),V.push(H));h[F]=V}}for(const v of h)for(const w of v)LR(w,_);return h}function xc(l,i){return{type:l.type,id:l.id,properties:l.properties,geometry:i?sa(l):[]}}function eg(l,i,c,h,p){l.emplaceBack(2*i+(h+1)/2,2*c+(p+1)/2)}function tg(l,i,c){l.emplaceBack(i.x,i.y,i.z,c[0]*16384,c[1]*16384,c[2]*16384)}class Kv{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new tr,this.indexArray=new Mr,this.segments=new Si,this.programConfigurations=new _c(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,h,p){const _=this.layers[0],v=[];let w=null;_.type==="circle"&&(w=_.layout.get("circle-sort-key"));for(const{feature:C,id:D,index:k,sourceLayerIndex:F}of i){const V=this.layers[0]._featureFilter.needGeometry,H=xc(C,V);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),H,h))continue;const Q=w?w.evaluate(H,{},h):void 0,ce={id:D,properties:C.properties,type:C.type,sourceLayerIndex:F,index:k,geometry:V?H.geometry:sa(C,h,p),patterns:{},sortKey:Q};v.push(ce)}w&&v.sort((C,D)=>C.sortKey-D.sortKey);let A=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Bw,A=p.projection);for(const C of v){const{geometry:D,index:k,sourceLayerIndex:F}=C,V=i[k].feature;this.addFeature(C,D,k,c.availableImages,h,A),c.featureIndex.insert(V,D,k,F,this.index)}}update(i,c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,OR.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,DR.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,c,h,p,_,v){for(const w of c)for(const A of w){const C=A.x,D=A.y;if(C<0||C>=nr||D<0||D>=nr)continue;if(v){const V=v.projectTilePoint(C,D,_),H=v.upVector(_,C,D),Q=this.globeExtVertexArray;tg(Q,V,H),tg(Q,V,H),tg(Q,V,H),tg(Q,V,H)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),F=k.vertexLength;eg(this.layoutVertexArray,C,D,-1,-1),eg(this.layoutVertexArray,C,D,1,-1),eg(this.layoutVertexArray,C,D,1,1),eg(this.layoutVertexArray,C,D,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+2,F+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},p,_)}}function qw(l,i){for(let c=0;c<l.length;c++)if(bc(i,l[c]))return!0;for(let c=0;c<i.length;c++)if(bc(l,i[c]))return!0;return!!Xv(l,i)}function kR(l,i,c){return!!bc(l,i)||!!Yv(i,l,c)}function Kw(l,i){if(l.length===1)return Yw(i,l[0]);for(let c=0;c<i.length;c++){const h=i[c];for(let p=0;p<h.length;p++)if(bc(l,h[p]))return!0}for(let c=0;c<l.length;c++)if(Yw(i,l[c]))return!0;for(let c=0;c<i.length;c++)if(Xv(l,i[c]))return!0;return!1}function zR(l,i,c){if(l.length>1){if(Xv(l,i))return!0;for(let h=0;h<i.length;h++)if(Yv(i[h],l,c))return!0}for(let h=0;h<l.length;h++)if(Yv(l[h],i,c))return!0;return!1}function Xv(l,i){if(l.length===0||i.length===0)return!1;for(let c=0;c<l.length-1;c++){const h=l[c],p=l[c+1];for(let _=0;_<i.length-1;_++)if(FR(h,p,i[_],i[_+1]))return!0}return!1}function FR(l,i,c,h){return yt(l,c,h)!==yt(i,c,h)&&yt(l,i,c)!==yt(l,i,h)}function Yv(l,i,c){const h=c*c;if(i.length===1)return l.distSqr(i[0])<h;for(let p=1;p<i.length;p++)if(Xw(l,i[p-1],i[p])<h)return!0;return!1}function Xw(l,i,c){const h=i.distSqr(c);if(h===0)return l.distSqr(i);const p=((l.x-i.x)*(c.x-i.x)+(l.y-i.y)*(c.y-i.y))/h;return l.distSqr(p<0?i:p>1?c:c.sub(i)._mult(p)._add(i))}function Yw(l,i){let c,h,p,_=!1;for(let v=0;v<l.length;v++){c=l[v];for(let w=0,A=c.length-1;w<c.length;A=w++)h=c[w],p=c[A],h.y>i.y!=p.y>i.y&&i.x<(p.x-h.x)*(i.y-h.y)/(p.y-h.y)+h.x&&(_=!_)}return _}function bc(l,i){let c=!1;for(let h=0,p=l.length-1;h<l.length;p=h++){const _=l[h],v=l[p];_.y>i.y!=v.y>i.y&&i.x<(v.x-_.x)*(i.y-_.y)/(v.y-_.y)+_.x&&(c=!c)}return c}function Jw(l,i,c,h,p){for(const v of l)if(i<=v.x&&c<=v.y&&h>=v.x&&p>=v.y)return!0;const _=[new S(i,c),new S(i,p),new S(h,p),new S(h,c)];if(l.length>2){for(const v of _)if(bc(l,v))return!0}for(let v=0;v<l.length-1;v++)if(BR(l[v],l[v+1],_))return!0;return!1}function BR(l,i,c){const h=c[0],p=c[2];if(l.x<h.x&&i.x<h.x||l.x>p.x&&i.x>p.x||l.y<h.y&&i.y<h.y||l.y>p.y&&i.y>p.y)return!1;const _=yt(l,i,c[0]);return _!==yt(l,i,c[1])||_!==yt(l,i,c[2])||_!==yt(l,i,c[3])}function oh(l,i,c){const h=i.paint.get(l).value;return h.kind==="constant"?h.value:c.programConfigurations.get(i.id).getMaxValue(l)}function rg(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Qw(l,i,c,h,p){if(!i[0]&&!i[1])return l;const _=S.convert(i)._mult(p);c==="viewport"&&_._rotate(-h);const v=[];for(let w=0;w<l.length;w++)v.push(l[w].sub(_));return v}function eE(l,i,c,h){const p=S.convert(l)._mult(h);return i==="viewport"&&p._rotate(-c),p}Vt(Kv,"CircleBucket",{omit:["layers"]});const NR=new Qe({"circle-sort-key":new Se(ze.layout_circle["circle-sort-key"])});var jR={paint:new Qe({"circle-radius":new Se(ze.paint_circle["circle-radius"]),"circle-color":new Se(ze.paint_circle["circle-color"]),"circle-blur":new Se(ze.paint_circle["circle-blur"]),"circle-opacity":new Se(ze.paint_circle["circle-opacity"]),"circle-translate":new Ge(ze.paint_circle["circle-translate"]),"circle-translate-anchor":new Ge(ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ge(ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ge(ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Se(ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Se(ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Se(ze.paint_circle["circle-stroke-opacity"])}),layout:NR},ig=1e-6,Yn=typeof Float32Array!="undefined"?Float32Array:Array;function tE(){var l=new Yn(9);return Yn!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function Jn(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function tl(l,i,c){var h=i[0],p=i[1],_=i[2],v=i[3],w=i[4],A=i[5],C=i[6],D=i[7],k=i[8],F=i[9],V=i[10],H=i[11],Q=i[12],ce=i[13],ge=i[14],Ce=i[15],Pe=c[0],De=c[1],Le=c[2],je=c[3];return l[0]=Pe*h+De*w+Le*k+je*Q,l[1]=Pe*p+De*A+Le*F+je*ce,l[2]=Pe*_+De*C+Le*V+je*ge,l[3]=Pe*v+De*D+Le*H+je*Ce,l[4]=(Pe=c[4])*h+(De=c[5])*w+(Le=c[6])*k+(je=c[7])*Q,l[5]=Pe*p+De*A+Le*F+je*ce,l[6]=Pe*_+De*C+Le*V+je*ge,l[7]=Pe*v+De*D+Le*H+je*Ce,l[8]=(Pe=c[8])*h+(De=c[9])*w+(Le=c[10])*k+(je=c[11])*Q,l[9]=Pe*p+De*A+Le*F+je*ce,l[10]=Pe*_+De*C+Le*V+je*ge,l[11]=Pe*v+De*D+Le*H+je*Ce,l[12]=(Pe=c[12])*h+(De=c[13])*w+(Le=c[14])*k+(je=c[15])*Q,l[13]=Pe*p+De*A+Le*F+je*ce,l[14]=Pe*_+De*C+Le*V+je*ge,l[15]=Pe*v+De*D+Le*H+je*Ce,l}function wc(l,i,c){var h,p,_,v,w,A,C,D,k,F,V,H,Q=c[0],ce=c[1],ge=c[2];return i===l?(l[12]=i[0]*Q+i[4]*ce+i[8]*ge+i[12],l[13]=i[1]*Q+i[5]*ce+i[9]*ge+i[13],l[14]=i[2]*Q+i[6]*ce+i[10]*ge+i[14],l[15]=i[3]*Q+i[7]*ce+i[11]*ge+i[15]):(p=i[1],_=i[2],v=i[3],w=i[4],A=i[5],C=i[6],D=i[7],k=i[8],F=i[9],V=i[10],H=i[11],l[0]=h=i[0],l[1]=p,l[2]=_,l[3]=v,l[4]=w,l[5]=A,l[6]=C,l[7]=D,l[8]=k,l[9]=F,l[10]=V,l[11]=H,l[12]=h*Q+w*ce+k*ge+i[12],l[13]=p*Q+A*ce+F*ge+i[13],l[14]=_*Q+C*ce+V*ge+i[14],l[15]=v*Q+D*ce+H*ge+i[15]),l}function wo(l,i,c){var h=c[0],p=c[1],_=c[2];return l[0]=i[0]*h,l[1]=i[1]*h,l[2]=i[2]*h,l[3]=i[3]*h,l[4]=i[4]*p,l[5]=i[5]*p,l[6]=i[6]*p,l[7]=i[7]*p,l[8]=i[8]*_,l[9]=i[9]*_,l[10]=i[10]*_,l[11]=i[11]*_,l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15],l}function ng(l,i,c){var h=Math.sin(c),p=Math.cos(c),_=i[4],v=i[5],w=i[6],A=i[7],C=i[8],D=i[9],k=i[10],F=i[11];return i!==l&&(l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[3],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[4]=_*p+C*h,l[5]=v*p+D*h,l[6]=w*p+k*h,l[7]=A*p+F*h,l[8]=C*p-_*h,l[9]=D*p-v*h,l[10]=k*p-w*h,l[11]=F*p-A*h,l}function sg(l,i,c){var h=Math.sin(c),p=Math.cos(c),_=i[0],v=i[1],w=i[2],A=i[3],C=i[8],D=i[9],k=i[10],F=i[11];return i!==l&&(l[4]=i[4],l[5]=i[5],l[6]=i[6],l[7]=i[7],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[0]=_*p-C*h,l[1]=v*p-D*h,l[2]=w*p-k*h,l[3]=A*p-F*h,l[8]=_*h+C*p,l[9]=v*h+D*p,l[10]=w*h+k*p,l[11]=A*h+F*p,l}function rE(l,i,c){var h,p,_,v=c[0],w=c[1],A=c[2],C=Math.hypot(v,w,A);return C<ig?null:(v*=C=1/C,w*=C,A*=C,h=Math.sin(i),p=Math.cos(i),l[0]=v*v*(_=1-p)+p,l[1]=w*v*_+A*h,l[2]=A*v*_-w*h,l[3]=0,l[4]=v*w*_-A*h,l[5]=w*w*_+p,l[6]=A*w*_+v*h,l[7]=0,l[8]=v*A*_+w*h,l[9]=w*A*_-v*h,l[10]=A*A*_+p,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}Math.hypot||(Math.hypot=function(){for(var l=0,i=arguments.length;i--;)l+=arguments[i]*arguments[i];return Math.sqrt(l)});var $R=tl;function Jv(){var l=new Yn(3);return Yn!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function iE(l){var i=new Yn(3);return i[0]=l[0],i[1]=l[1],i[2]=l[2],i}function hf(l){return Math.hypot(l[0],l[1],l[2])}function ah(l,i,c){var h=new Yn(3);return h[0]=l,h[1]=i,h[2]=c,h}function rl(l,i,c){return l[0]=i[0]+c[0],l[1]=i[1]+c[1],l[2]=i[2]+c[2],l}function Qv(l,i,c){return l[0]=i[0]-c[0],l[1]=i[1]-c[1],l[2]=i[2]-c[2],l}function nE(l,i,c){return l[0]=i[0]*c[0],l[1]=i[1]*c[1],l[2]=i[2]*c[2],l}function og(l,i,c){return l[0]=Math.min(i[0],c[0]),l[1]=Math.min(i[1],c[1]),l[2]=Math.min(i[2],c[2]),l}function ag(l,i,c){return l[0]=Math.max(i[0],c[0]),l[1]=Math.max(i[1],c[1]),l[2]=Math.max(i[2],c[2]),l}function Eo(l,i,c){return l[0]=i[0]*c,l[1]=i[1]*c,l[2]=i[2]*c,l}function lg(l,i,c,h){return l[0]=i[0]+c[0]*h,l[1]=i[1]+c[1]*h,l[2]=i[2]+c[2]*h,l}function En(l,i){var c=i[0],h=i[1],p=i[2],_=c*c+h*h+p*p;return _>0&&(_=1/Math.sqrt(_)),l[0]=i[0]*_,l[1]=i[1]*_,l[2]=i[2]*_,l}function ks(l,i){return l[0]*i[0]+l[1]*i[1]+l[2]*i[2]}function e0(l,i,c){var h=i[0],p=i[1],_=i[2],v=c[0],w=c[1],A=c[2];return l[0]=p*A-_*w,l[1]=_*v-h*A,l[2]=h*w-p*v,l}function on(l,i,c){var h=i[0],p=i[1],_=i[2],v=c[3]*h+c[7]*p+c[11]*_+c[15];return l[0]=(c[0]*h+c[4]*p+c[8]*_+c[12])/(v=v||1),l[1]=(c[1]*h+c[5]*p+c[9]*_+c[13])/v,l[2]=(c[2]*h+c[6]*p+c[10]*_+c[14])/v,l}function sE(l,i,c){var h=c[0],p=c[1],_=c[2],v=i[0],w=i[1],A=i[2],C=p*A-_*w,D=_*v-h*A,k=h*w-p*v,F=p*k-_*D,V=_*C-h*k,H=h*D-p*C,Q=2*c[3];return D*=Q,k*=Q,V*=2,H*=2,l[0]=v+(C*=Q)+(F*=2),l[1]=w+D+V,l[2]=A+k+H,l}var df,zs=Qv,VR=nE,UR=hf;function oE(l,i,c){return l[0]=i[0]*c,l[1]=i[1]*c,l[2]=i[2]*c,l[3]=i[3]*c,l}function Ec(l,i,c){var h=i[0],p=i[1],_=i[2],v=i[3];return l[0]=c[0]*h+c[4]*p+c[8]*_+c[12]*v,l[1]=c[1]*h+c[5]*p+c[9]*_+c[13]*v,l[2]=c[2]*h+c[6]*p+c[10]*_+c[14]*v,l[3]=c[3]*h+c[7]*p+c[11]*_+c[15]*v,l}function aE(){var l=new Yn(4);return Yn!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function lE(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function cE(l,i,c){c*=.5;var h=i[0],p=i[1],_=i[2],v=i[3],w=Math.sin(c),A=Math.cos(c);return l[0]=h*A+v*w,l[1]=p*A+_*w,l[2]=_*A-p*w,l[3]=v*A-h*w,l}function uE(l,i,c){c*=.5;var h=i[0],p=i[1],_=i[2],v=i[3],w=Math.sin(c),A=Math.cos(c);return l[0]=h*A-_*w,l[1]=p*A+v*w,l[2]=_*A+h*w,l[3]=v*A-p*w,l}Jv(),df=new Yn(4),Yn!=Float32Array&&(df[0]=0,df[1]=0,df[2]=0,df[3]=0),Jv(),ah(1,0,0),ah(0,1,0),aE(),aE(),tE();class t0{constructor(i,c){this.pos=i,this.dir=c}intersectsPlane(i,c,h){const p=ks(c,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((i[0]-this.pos[0])*c[0]+(i[1]-this.pos[1])*c[1]+(i[2]-this.pos[2])*c[2])/p;return h[0]=this.pos[0]+this.dir[0]*_,h[1]=this.pos[1]+this.dir[1]*_,h[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(i,c,h){if(function(V,H){var Q=V[0],ce=V[1],ge=V[2],Ce=H[0],Pe=H[1],De=H[2];return Math.abs(Q-Ce)<=ig*Math.max(1,Math.abs(Q),Math.abs(Ce))&&Math.abs(ce-Pe)<=ig*Math.max(1,Math.abs(ce),Math.abs(Pe))&&Math.abs(ge-De)<=ig*Math.max(1,Math.abs(ge),Math.abs(De))}(this.pos,i)||c===0)return h[0]=h[1]=h[2]=0,!1;const[p,_,v]=this.dir,w=this.pos[0]-i[0],A=this.pos[1]-i[1],C=this.pos[2]-i[2],D=p*p+_*_+v*v,k=2*(w*p+A*_+C*v),F=k*k-4*D*(w*w+A*A+C*C-c*c);if(F<0){const V=Math.max(-k/2,0),H=w+p*V,Q=A+_*V,ce=C+v*V,ge=Math.hypot(H,Q,ce);return h[0]=H*c/ge,h[1]=Q*c/ge,h[2]=ce*c/ge,!1}{const V=(-k-Math.sqrt(F))/(2*D);if(V<0){const H=Math.hypot(w,A,C);return h[0]=w*c/H,h[1]=A*c/H,h[2]=C*c/H,!1}return h[0]=w+p*V,h[1]=A+_*V,h[2]=C+v*V,!0}}}class r0{constructor(i,c,h,p,_){this.TL=i,this.TR=c,this.BR=h,this.BL=p,this.horizon=_}static fromInvProjectionMatrix(i,c,h){const p=[-1,1,1],_=[1,1,1],v=[1,-1,1],w=[-1,-1,1],A=on(p,p,i),C=on(_,_,i),D=on(v,v,i),k=on(w,w,i);return new r0(A,C,D,k,c/h)}}class i0{constructor(i,c){this.points=i,this.planes=c}static fromInvProjectionMatrix(i,c,h,p){const _=Math.pow(2,h),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const C=Ec([],A,i),D=1/C[3]/c*_;return function(k,F,V){return k[0]=F[0]*V[0],k[1]=F[1]*V[1],k[2]=F[2]*V[2],k[3]=F[3]*V[3],k}(C,C,[D,D,p?1/C[3]:D,D])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const C=En([],e0([],zs([],v[A[0]],v[A[1]]),zs([],v[A[2]],v[A[1]]))),D=-ks(C,v[A[1]]);return C.concat(D)});return new i0(v,w)}}class ps{constructor(i,c){this.min=i,this.max=c,this.center=Eo([],rl([],this.min,this.max),.5)}quadrant(i){const c=[i%2==0,i<2],h=iE(this.min),p=iE(this.max);for(let _=0;_<c.length;_++)h[_]=c[_]?this.min[_]:this.center[_],p[_]=c[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new ps(h,p)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,c=this.max;return[[i[0],i[1],i[2]],[c[0],i[1],i[2]],[c[0],c[1],i[2]],[i[0],c[1],i[2]],[i[0],i[1],c[2]],[c[0],i[1],c[2]],[c[0],c[1],c[2]],[i[0],c[1],c[2]]]}intersects(i){const c=this.getCorners();let h=!0;for(let p=0;p<i.planes.length;p++){const _=i.planes[p];let v=0;for(let w=0;w<c.length;w++)v+=ks(_,c[w])+_[3]>=0;if(v===0)return 0;v!==c.length&&(h=!1)}if(h)return 2;for(let p=0;p<3;p++){let _=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let w=0;w<i.points.length;w++){const A=i.points[w][p]-this.min[p];_=Math.min(_,A),v=Math.max(v,A)}if(v<0||_>this.max[p]-this.min[p])return 0}return 1}}function hE(l,i,c,h,p,_,v,w,A){if(_&&l.queryGeometry.isAboveHorizon)return!1;_&&(A*=l.pixelToTileUnitsFactor);const C=l.tileID.canonical,D=c.projection.upVectorScale(C,c.center.lat,c.worldSize).metersToTile;for(const k of i)for(const F of k){const V=F.add(w),H=p&&c.elevation?c.elevation.exaggeration()*p.getElevationAt(V.x,V.y,!0):0,Q=c.projection.projectTilePoint(V.x,V.y,C);if(H>0){const Pe=c.projection.upVector(C,V.x,V.y);Q.x+=Pe[0]*D*H,Q.y+=Pe[1]*D*H,Q.z+=Pe[2]*D*H}const ce=_?V:GR(Q.x,Q.y,Q.z,h),ge=_?l.tilespaceRays.map(Pe=>WR(Pe,H)):l.queryGeometry.screenGeometry,Ce=Ec([],[Q.x,Q.y,Q.z,1],h);if(!v&&_?A*=Ce[3]/c.cameraToCenterDistance:v&&!_&&(A*=c.cameraToCenterDistance/Ce[3]),_){const Pe=Fi((F.y/nr+C.y)/(1<<C.z));A/=c.projection.pixelsPerMeter(Pe,1)/Ls(1,Pe)}if(kR(ge,ce,A))return!0}return!1}function GR(l,i,c,h){const p=Ec([],[l,i,c,1],h);return new S(p[0]/p[3],p[1]/p[3])}const dE=ah(0,0,0),HR=ah(0,0,1);function WR(l,i){const c=Jv();return dE[2]=i,l.intersectsPlane(dE,HR,c),new S(c[0],c[1])}class fE extends Kv{}function pE(l,{width:i,height:c},h,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==i*c*h)throw new RangeError("mismatched image size")}else p=new Uint8Array(i*c*h);return l.width=i,l.height=c,l.data=p,l}function mE(l,i,c){const{width:h,height:p}=i;h===l.width&&p===l.height||(n0(l,i,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,h),height:Math.min(l.height,p)},c),l.width=h,l.height=p,l.data=i.data)}function n0(l,i,c,h,p,_){if(p.width===0||p.height===0)return i;if(p.width>l.width||p.height>l.height||c.x>l.width-p.width||c.y>l.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>i.width||p.height>i.height||h.x>i.width-p.width||h.y>i.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const v=l.data,w=i.data;for(let A=0;A<p.height;A++){const C=((c.y+A)*l.width+c.x)*_,D=((h.y+A)*i.width+h.x)*_;for(let k=0;k<p.width*_;k++)w[D+k]=v[C+k]}return i}Vt(fE,"HeatmapBucket",{omit:["layers"]});class oa{constructor(i,c){pE(this,i,1,c)}resize(i){mE(this,new oa(i),1)}clone(){return new oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,h,p,_){n0(i,c,h,p,_,1)}}class Qn{constructor(i,c){pE(this,i,4,c)}resize(i){mE(this,new Qn(i),4)}replace(i,c){c?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Qn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,h,p,_){n0(i,c,h,p,_,4)}}Vt(oa,"AlphaImage"),Vt(Qn,"RGBAImage");var ZR={paint:new Qe({"heatmap-radius":new Se(ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Se(ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ge(ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Rt(ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ge(ze.paint_heatmap["heatmap-opacity"])})};function s0(l){const i={},c=l.resolution||256,h=l.clips?l.clips.length:1,p=l.image||new Qn({width:c,height:h}),_=(v,w,A)=>{i[l.evaluationKey]=A;const C=l.expression.evaluate(i);p.data[v+w+0]=Math.floor(255*C.r/C.a),p.data[v+w+1]=Math.floor(255*C.g/C.a),p.data[v+w+2]=Math.floor(255*C.b/C.a),p.data[v+w+3]=Math.floor(255*C.a)};if(l.clips)for(let v=0,w=0;v<h;++v,w+=4*c)for(let A=0,C=0;A<c;A++,C+=4){const D=A/(c-1),{start:k,end:F}=l.clips[v];_(w,C,k*(1-D)+F*D)}else for(let v=0,w=0;v<c;v++,w+=4)_(0,w,v/(c-1));return p}var qR={paint:new Qe({"hillshade-illumination-direction":new Ge(ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ge(ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ge(ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ge(ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ge(ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ge(ze.paint_hillshade["hillshade-accent-color"])})};const KR=Pt([{name:"a_pos",components:2,type:"Int16"}],4),{members:XR}=KR;var cg=ug,YR=ug;function ug(l,i,c){c=c||2;var h,p,_,v,w,A,C,D=i&&i.length,k=D?i[0]*c:l.length,F=gE(l,0,k,c,!0),V=[];if(!F||F.next===F.prev)return V;if(D&&(F=function(Q,ce,ge,Ce){var Pe,De,Le,je=[];for(Pe=0,De=ce.length;Pe<De;Pe++)(Le=gE(Q,ce[Pe]*Ce,Pe<De-1?ce[Pe+1]*Ce:Q.length,Ce,!1))===Le.next&&(Le.steiner=!0),je.push(sL(Le));for(je.sort(rL),Pe=0;Pe<je.length;Pe++)ge=il(ge=iL(je[Pe],ge),ge.next);return ge}(l,i,F,c)),l.length>80*c){h=_=l[0],p=v=l[1];for(var H=c;H<k;H+=c)(w=l[H])<h&&(h=w),(A=l[H+1])<p&&(p=A),w>_&&(_=w),A>v&&(v=A);C=(C=Math.max(_-h,v-p))!==0?1/C:0}return ff(F,V,c,h,p,C),V}function gE(l,i,c,h,p){var _,v;if(p===l0(l,i,c,h)>0)for(_=i;_<c;_+=h)v=vE(_,l[_],l[_+1],v);else for(_=c-h;_>=i;_-=h)v=vE(_,l[_],l[_+1],v);return v&&hg(v,v.next)&&(mf(v),v=v.next),v}function il(l,i){if(!l)return l;i||(i=l);var c,h=l;do if(c=!1,h.steiner||!hg(h,h.next)&&Di(h.prev,h,h.next)!==0)h=h.next;else{if(mf(h),(h=i=h.prev)===h.next)break;c=!0}while(c||h!==i);return i}function ff(l,i,c,h,p,_,v){if(l){!v&&_&&function(D,k,F,V){var H=D;do H.z===null&&(H.z=o0(H.x,H.y,k,F,V)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==D);H.prevZ.nextZ=null,H.prevZ=null,function(Q){var ce,ge,Ce,Pe,De,Le,je,qe,Xe=1;do{for(ge=Q,Q=null,De=null,Le=0;ge;){for(Le++,Ce=ge,je=0,ce=0;ce<Xe&&(je++,Ce=Ce.nextZ);ce++);for(qe=Xe;je>0||qe>0&&Ce;)je!==0&&(qe===0||!Ce||ge.z<=Ce.z)?(Pe=ge,ge=ge.nextZ,je--):(Pe=Ce,Ce=Ce.nextZ,qe--),De?De.nextZ=Pe:Q=Pe,Pe.prevZ=De,De=Pe;ge=Ce}De.nextZ=null,Xe*=2}while(Le>1)}(H)}(l,h,p,_);for(var w,A,C=l;l.prev!==l.next;)if(w=l.prev,A=l.next,_?QR(l,h,p,_):JR(l))i.push(w.i/c),i.push(l.i/c),i.push(A.i/c),mf(l),l=A.next,C=A.next;else if((l=A)===C){v?v===1?ff(l=eL(il(l),i,c),i,c,h,p,_,2):v===2&&tL(l,i,c,h,p,_):ff(il(l),i,c,h,p,_,1);break}}}function JR(l){var i=l.prev,c=l,h=l.next;if(Di(i,c,h)>=0)return!1;for(var p=l.next.next;p!==l.prev;){if(lh(i.x,i.y,c.x,c.y,h.x,h.y,p.x,p.y)&&Di(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function QR(l,i,c,h){var p=l.prev,_=l,v=l.next;if(Di(p,_,v)>=0)return!1;for(var w=p.x>_.x?p.x>v.x?p.x:v.x:_.x>v.x?_.x:v.x,A=p.y>_.y?p.y>v.y?p.y:v.y:_.y>v.y?_.y:v.y,C=o0(p.x<_.x?p.x<v.x?p.x:v.x:_.x<v.x?_.x:v.x,p.y<_.y?p.y<v.y?p.y:v.y:_.y<v.y?_.y:v.y,i,c,h),D=o0(w,A,i,c,h),k=l.prevZ,F=l.nextZ;k&&k.z>=C&&F&&F.z<=D;){if(k!==l.prev&&k!==l.next&&lh(p.x,p.y,_.x,_.y,v.x,v.y,k.x,k.y)&&Di(k.prev,k,k.next)>=0||(k=k.prevZ,F!==l.prev&&F!==l.next&&lh(p.x,p.y,_.x,_.y,v.x,v.y,F.x,F.y)&&Di(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;k&&k.z>=C;){if(k!==l.prev&&k!==l.next&&lh(p.x,p.y,_.x,_.y,v.x,v.y,k.x,k.y)&&Di(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;F&&F.z<=D;){if(F!==l.prev&&F!==l.next&&lh(p.x,p.y,_.x,_.y,v.x,v.y,F.x,F.y)&&Di(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function eL(l,i,c){var h=l;do{var p=h.prev,_=h.next.next;!hg(p,_)&&_E(p,h,h.next,_)&&pf(p,_)&&pf(_,p)&&(i.push(p.i/c),i.push(h.i/c),i.push(_.i/c),mf(h),mf(h.next),h=l=_),h=h.next}while(h!==l);return il(h)}function tL(l,i,c,h,p,_){var v=l;do{for(var w=v.next.next;w!==v.prev;){if(v.i!==w.i&&oL(v,w)){var A=yE(v,w);return v=il(v,v.next),A=il(A,A.next),ff(v,i,c,h,p,_),void ff(A,i,c,h,p,_)}w=w.next}v=v.next}while(v!==l)}function rL(l,i){return l.x-i.x}function iL(l,i){var c=function(_,v){var w,A=v,C=_.x,D=_.y,k=-1/0;do{if(D<=A.y&&D>=A.next.y&&A.next.y!==A.y){var F=A.x+(D-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(F<=C&&F>k){if(k=F,F===C){if(D===A.y)return A;if(D===A.next.y)return A.next}w=A.x<A.next.x?A:A.next}}A=A.next}while(A!==v);if(!w)return null;if(C===k)return w;var V,H=w,Q=w.x,ce=w.y,ge=1/0;A=w;do C>=A.x&&A.x>=Q&&C!==A.x&&lh(D<ce?C:k,D,Q,ce,D<ce?k:C,D,A.x,A.y)&&(V=Math.abs(D-A.y)/(C-A.x),pf(A,_)&&(V<ge||V===ge&&(A.x>w.x||A.x===w.x&&nL(w,A)))&&(w=A,ge=V)),A=A.next;while(A!==H);return w}(l,i);if(!c)return i;var h=yE(c,l),p=il(c,c.next);return il(h,h.next),i===c?p:i}function nL(l,i){return Di(l.prev,l,i.prev)<0&&Di(i.next,l,l.next)<0}function o0(l,i,c,h,p){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-c)*p)|l<<8))|l<<4))|l<<2))|l<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-h)*p)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function sL(l){var i=l,c=l;do(i.x<c.x||i.x===c.x&&i.y<c.y)&&(c=i),i=i.next;while(i!==l);return c}function lh(l,i,c,h,p,_,v,w){return(p-v)*(i-w)-(l-v)*(_-w)>=0&&(l-v)*(h-w)-(c-v)*(i-w)>=0&&(c-v)*(_-w)-(p-v)*(h-w)>=0}function oL(l,i){return l.next.i!==i.i&&l.prev.i!==i.i&&!function(c,h){var p=c;do{if(p.i!==c.i&&p.next.i!==c.i&&p.i!==h.i&&p.next.i!==h.i&&_E(p,p.next,c,h))return!0;p=p.next}while(p!==c);return!1}(l,i)&&(pf(l,i)&&pf(i,l)&&function(c,h){var p=c,_=!1,v=(c.x+h.x)/2,w=(c.y+h.y)/2;do p.y>w!=p.next.y>w&&p.next.y!==p.y&&v<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next;while(p!==c);return _}(l,i)&&(Di(l.prev,l,i.prev)||Di(l,i.prev,i))||hg(l,i)&&Di(l.prev,l,l.next)>0&&Di(i.prev,i,i.next)>0)}function Di(l,i,c){return(i.y-l.y)*(c.x-i.x)-(i.x-l.x)*(c.y-i.y)}function hg(l,i){return l.x===i.x&&l.y===i.y}function _E(l,i,c,h){var p=fg(Di(l,i,c)),_=fg(Di(l,i,h)),v=fg(Di(c,h,l)),w=fg(Di(c,h,i));return p!==_&&v!==w||!(p!==0||!dg(l,c,i))||!(_!==0||!dg(l,h,i))||!(v!==0||!dg(c,l,h))||!(w!==0||!dg(c,i,h))}function dg(l,i,c){return i.x<=Math.max(l.x,c.x)&&i.x>=Math.min(l.x,c.x)&&i.y<=Math.max(l.y,c.y)&&i.y>=Math.min(l.y,c.y)}function fg(l){return l>0?1:l<0?-1:0}function pf(l,i){return Di(l.prev,l,l.next)<0?Di(l,i,l.next)>=0&&Di(l,l.prev,i)>=0:Di(l,i,l.prev)<0||Di(l,l.next,i)<0}function yE(l,i){var c=new a0(l.i,l.x,l.y),h=new a0(i.i,i.x,i.y),p=l.next,_=i.prev;return l.next=i,i.prev=l,c.next=p,p.prev=c,h.next=c,c.prev=h,_.next=h,h.prev=_,h}function vE(l,i,c,h){var p=new a0(l,i,c);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function mf(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function a0(l,i,c){this.i=l,this.x=i,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function l0(l,i,c,h){for(var p=0,_=i,v=c-h;_<c;_+=h)p+=(l[v]-l[_])*(l[_+1]+l[v+1]),v=_;return p}function aL(l,i,c,h,p){xE(l,i,c||0,h||l.length-1,p||lL)}function xE(l,i,c,h,p){for(;h>c;){if(h-c>600){var _=h-c+1,v=i-c+1,w=Math.log(_),A=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*A*(_-A)/_)*(v-_/2<0?-1:1);xE(l,i,Math.max(c,Math.floor(i-v*A/_+C)),Math.min(h,Math.floor(i+(_-v)*A/_+C)),p)}var D=l[i],k=c,F=h;for(gf(l,c,i),p(l[h],D)>0&&gf(l,c,h);k<F;){for(gf(l,k,F),k++,F--;p(l[k],D)<0;)k++;for(;p(l[F],D)>0;)F--}p(l[c],D)===0?gf(l,c,F):gf(l,++F,h),F<=i&&(c=F+1),i<=F&&(h=F-1)}}function gf(l,i,c){var h=l[i];l[i]=l[c],l[c]=h}function lL(l,i){return l<i?-1:l>i?1:0}function c0(l,i){const c=l.length;if(c<=1)return[l];const h=[];let p,_;for(let v=0;v<c;v++){const w=et(l[v]);w!==0&&(l[v].area=Math.abs(w),_===void 0&&(_=w<0),_===w<0?(p&&h.push(p),p=[l[v]]):p.push(l[v]))}if(p&&h.push(p),i>1)for(let v=0;v<h.length;v++)h[v].length<=i||(aL(h[v],i,1,h[v].length-1,cL),h[v]=h[v].slice(0,i));return h}function cL(l,i){return i.area-l.area}function u0(l,i,c){const h=c.patternDependencies;let p=!1;for(const _ of i){const v=_.paint.get(`${l}-pattern`);v.isConstant()||(p=!0);const w=v.constantOr(null);w&&(p=!0,h[w.to]=!0,h[w.from]=!0)}return p}function h0(l,i,c,h,p){const _=p.patternDependencies;for(const v of i){const w=v.paint.get(`${l}-pattern`).value;if(w.kind!=="constant"){let A=w.evaluate({zoom:h-1},c,{},p.availableImages),C=w.evaluate({zoom:h},c,{},p.availableImages),D=w.evaluate({zoom:h+1},c,{},p.availableImages);A=A&&A.name?A.name:A,C=C&&C.name?C.name:C,D=D&&D.name?D.name:D,_[A]=!0,_[C]=!0,_[D]=!0,c.patterns[v.id]={min:A,mid:C,max:D}}}return c}ug.deviation=function(l,i,c,h){var p=i&&i.length,_=Math.abs(l0(l,0,p?i[0]*c:l.length,c));if(p)for(var v=0,w=i.length;v<w;v++)_-=Math.abs(l0(l,i[v]*c,v<w-1?i[v+1]*c:l.length,c));var A=0;for(v=0;v<h.length;v+=3){var C=h[v]*c,D=h[v+1]*c,k=h[v+2]*c;A+=Math.abs((l[C]-l[k])*(l[D+1]-l[C+1])-(l[C]-l[D])*(l[k+1]-l[C+1]))}return _===0&&A===0?0:Math.abs((A-_)/_)},ug.flatten=function(l){for(var i=l[0][0].length,c={vertices:[],holes:[],dimensions:i},h=0,p=0;p<l.length;p++){for(var _=0;_<l[p].length;_++)for(var v=0;v<i;v++)c.vertices.push(l[p][_][v]);p>0&&c.holes.push(h+=l[p-1].length)}return c},cg.default=YR;class pg{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new tr,this.indexArray=new Mr,this.indexArray2=new Oi,this.programConfigurations=new _c(i.layers,i.zoom),this.segments=new Si,this.segments2=new Si,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=i.projection}populate(i,c,h,p){this.hasPattern=u0("fill",this.layers,c);const _=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:w,id:A,index:C,sourceLayerIndex:D}of i){const k=this.layers[0]._featureFilter.needGeometry,F=xc(w,k);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),F,h))continue;const V=_?_.evaluate(F,{},h,c.availableImages):void 0,H={id:A,properties:w.properties,type:w.type,sourceLayerIndex:D,index:C,geometry:k?F.geometry:sa(w,h,p),patterns:{},sortKey:V};v.push(H)}_&&v.sort((w,A)=>w.sortKey-A.sortKey);for(const w of v){const{geometry:A,index:C,sourceLayerIndex:D}=w;if(this.hasPattern){const k=h0("fill",this.layers,w,this.zoom,c);this.patternFeatures.push(k)}else this.addFeature(w,A,C,h,{},c.availableImages);c.featureIndex.insert(i[C].feature,A,C,D,this.index)}}update(i,c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,h,p)}addFeatures(i,c,h,p,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,c,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,XR),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,c,h,p,_,v=[]){for(const w of c0(c,500)){let A=0;for(const H of w)A+=H.length;const C=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),D=C.vertexLength,k=[],F=[];for(const H of w){if(H.length===0)continue;H!==w[0]&&F.push(k.length/2);const Q=this.segments2.prepareSegment(H.length,this.layoutVertexArray,this.indexArray2),ce=Q.vertexLength;this.layoutVertexArray.emplaceBack(H[0].x,H[0].y),this.indexArray2.emplaceBack(ce+H.length-1,ce),k.push(H[0].x),k.push(H[0].y);for(let ge=1;ge<H.length;ge++)this.layoutVertexArray.emplaceBack(H[ge].x,H[ge].y),this.indexArray2.emplaceBack(ce+ge-1,ce+ge),k.push(H[ge].x),k.push(H[ge].y);Q.vertexLength+=H.length,Q.primitiveLength+=H.length}const V=cg(k,F);for(let H=0;H<V.length;H+=3)this.indexArray.emplaceBack(D+V[H],D+V[H+1],D+V[H+2]);C.vertexLength+=A,C.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,_,v,p)}}Vt(pg,"FillBucket",{omit:["layers","patternFeatures"]});const uL=new Qe({"fill-sort-key":new Se(ze.layout_fill["fill-sort-key"])});var hL={paint:new Qe({"fill-antialias":new Ge(ze.paint_fill["fill-antialias"]),"fill-opacity":new Se(ze.paint_fill["fill-opacity"]),"fill-color":new Se(ze.paint_fill["fill-color"]),"fill-outline-color":new Se(ze.paint_fill["fill-outline-color"]),"fill-translate":new Ge(ze.paint_fill["fill-translate"]),"fill-translate-anchor":new Ge(ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new dt(ze.paint_fill["fill-pattern"])}),layout:uL};const dL=Pt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),fL=Pt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),pL=Pt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:mL}=dL;var bE=ch;function ch(l,i,c,h,p){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=h,this._values=p,l.readFields(gL,this,i)}function gL(l,i,c){l==1?i.id=c.readVarint():l==2?function(h,p){for(var _=h.readVarint()+h.pos;h.pos<_;){var v=p._keys[h.readVarint()],w=p._values[h.readVarint()];p.properties[v]=w}}(c,i):l==3?i.type=c.readVarint():l==4&&(i._geometry=c.pos)}function _L(l){for(var i,c,h=0,p=0,_=l.length,v=_-1;p<_;v=p++)h+=((c=l[v]).x-(i=l[p]).x)*(i.y+c.y);return h}ch.types=["Unknown","Point","LineString","Polygon"],ch.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var i,c=l.readVarint()+l.pos,h=1,p=0,_=0,v=0,w=[];l.pos<c;){if(p<=0){var A=l.readVarint();h=7&A,p=A>>3}if(p--,h===1||h===2)_+=l.readSVarint(),v+=l.readSVarint(),h===1&&(i&&w.push(i),i=[]),i.push(new S(_,v));else{if(h!==7)throw new Error("unknown command "+h);i&&i.push(i[0].clone())}}return i&&w.push(i),w},ch.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var i=l.readVarint()+l.pos,c=1,h=0,p=0,_=0,v=1/0,w=-1/0,A=1/0,C=-1/0;l.pos<i;){if(h<=0){var D=l.readVarint();c=7&D,h=D>>3}if(h--,c===1||c===2)(p+=l.readSVarint())<v&&(v=p),p>w&&(w=p),(_+=l.readSVarint())<A&&(A=_),_>C&&(C=_);else if(c!==7)throw new Error("unknown command "+c)}return[v,A,w,C]},ch.prototype.toGeoJSON=function(l,i,c){var h,p,_=this.extent*Math.pow(2,c),v=this.extent*l,w=this.extent*i,A=this.loadGeometry(),C=ch.types[this.type];function D(V){for(var H=0;H<V.length;H++){var Q=V[H];V[H]=[360*(Q.x+v)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+w)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(h=0;h<A.length;h++)k[h]=A[h][0];D(A=k);break;case 2:for(h=0;h<A.length;h++)D(A[h]);break;case 3:for(A=function(V){var H=V.length;if(H<=1)return[V];for(var Q,ce,ge=[],Ce=0;Ce<H;Ce++){var Pe=_L(V[Ce]);Pe!==0&&(ce===void 0&&(ce=Pe<0),ce===Pe<0?(Q&&ge.push(Q),Q=[V[Ce]]):Q.push(V[Ce]))}return Q&&ge.push(Q),ge}(A),h=0;h<A.length;h++)for(p=0;p<A[h].length;p++)D(A[h][p])}A.length===1?A=A[0]:C="Multi"+C;var F={type:"Feature",geometry:{type:C,coordinates:A},properties:this.properties};return"id"in this&&(F.id=this.id),F};var wE=EE;function EE(l,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(yL,this,i),this.length=this._features.length}function yL(l,i,c){l===15?i.version=c.readVarint():l===1?i.name=c.readString():l===5?i.extent=c.readVarint():l===2?i._features.push(c.pos):l===3?i._keys.push(c.readString()):l===4&&i._values.push(function(h){for(var p=null,_=h.readVarint()+h.pos;h.pos<_;){var v=h.readVarint()>>3;p=v===1?h.readString():v===2?h.readFloat():v===3?h.readDouble():v===4?h.readVarint64():v===5?h.readVarint():v===6?h.readSVarint():v===7?h.readBoolean():null}return p}(c))}function vL(l,i,c){if(l===3){var h=new wE(c,c.readVarint()+c.pos);h.length&&(i[h.name]=h)}}EE.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var i=this._pbf.readVarint()+this._pbf.pos;return new bE(this._pbf,i,this.extent,this._keys,this._values)};var Tc={VectorTile:function(l,i){this.layers=l.readFields(vL,{},i)},VectorTileFeature:bE,VectorTileLayer:wE};function mg(l,i,c,h){const p=[],_=h===0?(v,w,A,C,D,k)=>{v.push(new S(k,A+(k-w)/(C-w)*(D-A)))}:(v,w,A,C,D,k)=>{v.push(new S(w+(k-A)/(D-A)*(C-w),k))};for(const v of l){const w=[];for(const A of v){if(A.length<=2)continue;const C=[];for(let F=0;F<A.length-1;F++){const V=A[F].x,H=A[F].y,Q=A[F+1].x,ce=A[F+1].y,ge=h===0?V:H,Ce=h===0?Q:ce;ge<i?Ce>i&&_(C,V,H,Q,ce,i):ge>c?Ce<c&&_(C,V,H,Q,ce,c):C.push(A[F]),Ce<i&&ge>=i&&_(C,V,H,Q,ce,i),Ce>c&&ge<=c&&_(C,V,H,Q,ce,c)}let D=A[A.length-1];const k=h===0?D.x:D.y;k>=i&&k<=c&&C.push(D),C.length&&(D=C[C.length-1],C[0].x===D.x&&C[0].y===D.y||C.push(C[0]),w.push(C))}w.length&&p.push(w)}return p}const xL=Tc.VectorTileFeature.types,bL=Math.pow(2,13);function _f(l,i,c,h,p,_,v,w){l.emplaceBack((i<<1)+v,(c<<1)+_,(Math.floor(h*bL)<<1)+p,Math.round(w))}function yf(l,i,c){l.emplaceBack(i.x,i.y,i.z,c[0]*16384,c[1]*16384,c[2]*16384)}class TE{constructor(){this.acc=new S(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new S(i.x,i.y),this.max=new S(i.x,i.y))}append(i,c){this.currentPolyCount.edges++,this.acc._add(i);const h=this.min,p=this.max;i.x<h.x?h.x=i.x:i.x>p.x&&(p.x=i.x),i.y<h.y?h.y=i.y:i.y>p.y&&(p.y=i.y),((i.x===0||i.x===nr)&&i.x===c.x)!=((i.y===0||i.y===nr)&&i.y===c.y)&&this.processBorderOverlap(i,c),c.x<0!=i.x<0&&this.addBorderIntersection(0,Dr(c.y,i.y,(0-c.x)/(i.x-c.x))),c.x>nr!=i.x>nr&&this.addBorderIntersection(1,Dr(c.y,i.y,(nr-c.x)/(i.x-c.x))),c.y<0!=i.y<0&&this.addBorderIntersection(2,Dr(c.x,i.x,(0-c.y)/(i.y-c.y))),c.y>nr!=i.y>nr&&this.addBorderIntersection(3,Dr(c.x,i.x,(nr-c.y)/(i.y-c.y)))}addBorderIntersection(i,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[i];c<h[0]&&(h[0]=c),c>h[1]&&(h[1]=c)}processBorderOverlap(i,c){if(i.x===c.x){if(i.y===c.y)return;const h=i.x===0?0:1;this.addBorderIntersection(h,c.y),this.addBorderIntersection(h,i.y)}else{const h=i.y===0?2:3;this.addBorderIntersection(h,c.x),this.addBorderIntersection(h,i.x)}}centroid(){const i=this.polyCount.reduce((c,h)=>c+h.edges,0);return i!==0?this.acc.div(i)._round():new S(0,0)}span(){return new S(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,c)=>i+ +(c[0]!==Number.MAX_VALUE),0)}}class vf{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new Xt,this.centroidVertexArray=new zw,this.indexArray=new Mr,this.programConfigurations=new _c(i.layers,i.zoom),this.segments=new Si,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=i.enableTerrain}populate(i,c,h,p){this.features=[],this.hasPattern=u0("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const v=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*v/(v*v+1)/nr/(1<<_.z)}(h);for(const{feature:_,id:v,index:w,sourceLayerIndex:A}of i){const C=this.layers[0]._featureFilter.needGeometry,D=xc(_,C);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),D,h))continue;const k={id:v,sourceLayerIndex:A,index:w,geometry:C?D.geometry:sa(_,h,p),properties:_.properties,type:_.type,patterns:{}},F=this.layoutVertexArray.length;this.hasPattern?this.features.push(h0("fill-extrusion",this.layers,k,this.zoom,c)):this.addFeature(k,k.geometry,w,h,{},c.availableImages,p),c.featureIndex.insert(_,k.geometry,w,A,this.index,F)}this.sortBorders()}addFeatures(i,c,h,p,_){for(const v of this.features){const{geometry:w}=v;this.addFeature(v,w,v.index,c,h,p,_)}this.sortBorders()}update(i,c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,mL),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,pL.members,!0))),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,fL.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,c,h,p,_,v,w){const A=[new S(0,0),new S(nr,nr)],C=w.projection,D=C.name==="globe",k=this.enableTerrain&&!D?new TE:null;D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Sw);const F=c0(c,500);for(let Q=F.length-1;Q>=0;Q--){const ce=F[Q];(ce.length===0||(V=ce[0]).every(ge=>ge.x<=0)||V.every(ge=>ge.x>=nr)||V.every(ge=>ge.y<=0)||V.every(ge=>ge.y>=nr))&&F.splice(Q,1)}var V;let H;if(D)H=AE(F,A,p);else{H=[];for(const Q of F)H.push({polygon:Q,bounds:A})}for(const Q of H){const ce=Q.polygon;let ge=0,Ce=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let qe=0;qe<ce.length;qe++){const Xe=ce[qe];if(Xe.length===0)continue;ge+=Xe.length;let at=0;k&&k.startRing(Xe[0]);for(let vt=0;vt<Xe.length;vt++){const Ue=Xe[vt];if(vt>=1){const nt=Xe[vt-1];if(!wL(Ue,nt,Q.bounds)){k&&k.append(Ue,nt),Ce.vertexLength+4>Si.MAX_VERTEX_ARRAY_LENGTH&&(Ce=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const xt=Ue.sub(nt)._perp(),bt=xt.x/(Math.abs(xt.x)+Math.abs(xt.y)),Bt=xt.y>0?1:0,_t=nt.dist(Ue);at+_t>32768&&(at=0),_f(this.layoutVertexArray,Ue.x,Ue.y,bt,Bt,0,0,at),_f(this.layoutVertexArray,Ue.x,Ue.y,bt,Bt,0,1,at),at+=_t,_f(this.layoutVertexArray,nt.x,nt.y,bt,Bt,0,0,at),_f(this.layoutVertexArray,nt.x,nt.y,bt,Bt,0,1,at);const kt=Ce.vertexLength;if(this.indexArray.emplaceBack(kt,kt+2,kt+1),this.indexArray.emplaceBack(kt+1,kt+2,kt+3),Ce.vertexLength+=4,Ce.primitiveLength+=2,D){const gr=this.layoutVertexExtArray,vr=C.projectTilePoint(Ue.x,Ue.y,p),er=C.projectTilePoint(nt.x,nt.y,p),Ut=C.upVector(p,Ue.x,Ue.y),Er=C.upVector(p,nt.x,nt.y);yf(gr,vr,Ut),yf(gr,vr,Ut),yf(gr,er,Er),yf(gr,er,Er)}}}}}if(Ce.vertexLength+ge>Si.MAX_VERTEX_ARRAY_LENGTH&&(Ce=this.segments.prepareSegment(ge,this.layoutVertexArray,this.indexArray)),xL[i.type]!=="Polygon")continue;const Pe=[],De=[],Le=Ce.vertexLength;for(let qe=0;qe<ce.length;qe++){const Xe=ce[qe];if(Xe.length!==0){Xe!==ce[0]&&De.push(Pe.length/2);for(let at=0;at<Xe.length;at++){const vt=Xe[at];_f(this.layoutVertexArray,vt.x,vt.y,0,0,1,1,0),Pe.push(vt.x),Pe.push(vt.y),k&&k.currentPolyCount.top++,D&&yf(this.layoutVertexExtArray,C.projectTilePoint(vt.x,vt.y,p),C.upVector(p,vt.x,vt.y))}}}const je=cg(Pe,De);for(let qe=0;qe<je.length;qe+=3)this.indexArray.emplaceBack(Le+je[qe],Le+je[qe+2],Le+je[qe+1]);Ce.primitiveLength+=je.length/3,Ce.vertexLength+=ge}if(k&&k.polyCount.length>0){if(k.borders){k.vertexArrayOffset=this.centroidVertexArray.length;const Q=k.borders,ce=this.featuresOnBorder.push(k)-1;for(let ge=0;ge<4;ge++)Q[ge][0]!==Number.MAX_VALUE&&this.borders[ge].push(ce)}this.encodeCentroid(k.borders?void 0:k.centroid(),k)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,_,v,p)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((c,h)=>this.featuresOnBorder[c].borders[i][0]-this.featuresOnBorder[h].borders[i][0])}encodeCentroid(i,c,h=!0){let p,_;if(i)if(i.y!==0){const w=c.span()._mult(this.tileToMeter);p=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(w.x/10)),_=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else p=Math.ceil(7*(i.x+450)),_=0;else p=0,_=+h;let v=h?this.centroidVertexArray.length:c.vertexArrayOffset;for(const w of c.polyCount){h&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let A=0;A<2*w.edges;A++)this.centroidVertexArray.emplace(v++,0,_),this.centroidVertexArray.emplace(v++,p,_);for(let A=0;A<w.top;A++)this.centroidVertexArray.emplace(v++,p,_)}}}function wL(l,i,c){return l.x===i.x&&(l.x<c[0].x||l.x>c[1].x)||l.y===i.y&&(l.y<c[0].y||l.y>c[1].y)}function SE(){const l=Math.PI/32,i=Math.tan(l),c=Gv;return c*Math.sqrt(1+2*i*i)-c}function AE(l,i,c){const h=1<<c.z,p=wn(c.x/h),_=wn((c.x+1)/h),v=Fi(c.y/h),w=Fi((c.y+1)/h);return function(A,C,D,k,F=0,V){const H=[];if(!A.length||!D||!k)return H;const Q=(je,qe)=>{for(const Xe of je)H.push({polygon:Xe,bounds:qe})},ce=Math.ceil(Math.log2(D)),ge=Math.ceil(Math.log2(k)),Ce=ce-ge,Pe=[];for(let je=0;je<Math.abs(Ce);je++)Pe.push(Ce>0?0:1);for(let je=0;je<Math.min(ce,ge);je++)Pe.push(0),Pe.push(1);let De=A;if(De=mg(De,C[0].y-F,C[1].y+F,1),De=mg(De,C[0].x-F,C[1].x+F,0),!De.length)return H;const Le=[];for(Pe.length?Le.push({polygons:De,bounds:C,depth:0}):Q(De,C);Le.length;){const je=Le.pop(),qe=je.depth,Xe=Pe[qe],at=je.bounds[0],vt=je.bounds[1],Ue=Xe===0?at.x:at.y,nt=Xe===0?vt.x:vt.y,xt=V?V(Xe,Ue,nt):.5*(Ue+nt),bt=mg(je.polygons,Ue-F,xt+F,Xe),Bt=mg(je.polygons,xt-F,nt+F,Xe);if(bt.length){const _t=[at,new S(Xe===0?xt:vt.x,Xe===1?xt:vt.y)];Pe.length>qe+1?Le.push({polygons:bt,bounds:_t,depth:qe+1}):Q(bt,_t)}if(Bt.length){const _t=[new S(Xe===0?xt:at.x,Xe===1?xt:at.y),vt];Pe.length>qe+1?Le.push({polygons:Bt,bounds:_t,depth:qe+1}):Q(Bt,_t)}}return H}(l,i,Math.ceil((_-p)/11.25),Math.ceil((v-w)/11.25),1,(A,C,D)=>{if(A===0)return .5*(C+D);{const k=Fi((c.y+C/nr)/h);return(vc(.5*(Fi((c.y+D/nr)/h)+k))*h-c.y)*nr}})}Vt(vf,"FillExtrusionBucket",{omit:["layers","features"]}),Vt(TE,"PartMetadata");var EL={paint:new Qe({"fill-extrusion-opacity":new Ge(ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Se(ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ge(ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ge(ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new dt(ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Se(ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Se(ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ge(ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function PE(l,i,c){var h=2*Math.PI*6378137/256/Math.pow(2,c);return[l*h-2*Math.PI*6378137/2,i*h-2*Math.PI*6378137/2]}class gg{constructor(i,c,h){this.z=i,this.x=c,this.y=h,this.key=xf(0,i,i,c,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,c){const h=function(_,v,w){var A=PE(256*_,256*(v=Math.pow(2,w)-v-1),w),C=PE(256*(_+1),256*(v+1),w);return A[0]+","+A[1]+","+C[0]+","+C[1]}(this.x,this.y,this.z),p=function(_,v,w){let A,C="";for(let D=_;D>0;D--)A=1<<D-1,C+=(v&A?1:0)+(w&A?2:0);return C}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class CE{constructor(i,c){this.wrap=i,this.canonical=c,this.key=xf(i,c.z,c.z,c.x,c.y)}}class Tn{constructor(i,c,h,p,_){this.overscaledZ=i,this.wrap=c,this.canonical=new gg(h,+p,+_),this.key=c===0&&i===h?this.canonical.key:xf(c,i,h,p,_)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const c=this.canonical.z-i;return i>this.canonical.z?new Tn(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Tn(i,this.wrap,i,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(i,c=!0){if(this.overscaledZ===i&&c)return this.key;if(i>this.canonical.z)return xf(this.wrap*+c,i,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-i;return xf(this.wrap*+c,i,i,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const c=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>c&&i.canonical.y===this.canonical.y>>c}children(i){if(this.overscaledZ>=i)return[new Tn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,h=2*this.canonical.x,p=2*this.canonical.y;return[new Tn(c,this.wrap,c,h,p),new Tn(c,this.wrap,c,h+1,p),new Tn(c,this.wrap,c,h,p+1),new Tn(c,this.wrap,c,h+1,p+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Tn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Tn(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new CE(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function xf(l,i,c,h,p){const _=1<<Math.min(c,22);let v=_*(p%_)+h%_;return l&&c<22&&(v+=_*_*((l<0?-2*l-1:2*l)%(1<<2*(22-c)))),16*(32*v+c)+(i-c)}function bf(l,i){return l.x*i.x+l.y*i.y}function IE(l,i){if(l.length===1){let c=0;const h=i[c++];let p;for(;!p||h.equals(p);)if(p=i[c++],!p)return 1/0;for(;c<i.length;c++){const _=i[c],v=l[0],w=p.sub(h),A=_.sub(h),C=v.sub(h),D=bf(w,w),k=bf(w,A),F=bf(A,A),V=bf(C,w),H=bf(C,A),Q=D*F-k*k,ce=(F*V-k*H)/Q,ge=(D*H-k*V)/Q,Ce=h.z*(1-ce-ge)+p.z*ce+_.z*ge;if(isFinite(Ce))return Ce}return 1/0}{let c=1/0;for(const h of i)c=Math.min(c,h.z);return c}}function _g(l){const i=new S(l[0],l[1]);return i.z=l[2],i}function ME(l,i,c,h,p,_,v,w){const A=v*p.getElevationAt(l,i,!0,!0),C=_[0]!==0,D=C?_[1]===0?v*(_[0]/7-450):v*function(k,F,V){const H=Math.floor(F[0]/8),Q=Math.floor(F[1]/8),ce=10*(F[0]-8*H),ge=10*(F[1]-8*Q),Ce=k.getElevationAt(H,Q,!0,!0),Pe=k.getMeterToDEM(V),De=Math.floor(.5*(ce*Pe-1)),Le=Math.floor(.5*(ge*Pe-1)),je=k.tileCoordToPixel(H,Q),qe=2*De+1,Xe=2*Le+1,at=function(Bt,_t,kt,gr,vr){return[Bt.getElevationAtPixel(_t,kt,!0),Bt.getElevationAtPixel(_t+vr,kt,!0),Bt.getElevationAtPixel(_t,kt+vr,!0),Bt.getElevationAtPixel(_t+gr,kt+vr,!0)]}(k,je.x-De,je.y-Le,qe,Xe),vt=Math.abs(at[0]-at[1]),Ue=Math.abs(at[2]-at[3]),nt=Math.abs(at[0]-at[2])+Math.abs(at[1]-at[3]),xt=Math.min(.25,.5*Pe*(vt+Ue)/qe),bt=Math.min(.25,.5*Pe*nt/Xe);return Ce+Math.max(xt*ce,bt*ge)}(p,_,w):A;return{base:A+(c===0)?-1:c,top:C?Math.max(D+h,A+c+2):A+h}}Vt(gg,"CanonicalTileID"),Vt(Tn,"OverscaledTileID",{omit:["projMatrix"]});const TL=Pt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:SL}=TL,AL=Pt([{name:"a_packed",components:4,type:"Float32"}]),{members:PL}=AL,CL=Tc.VectorTileFeature.types,IL=Math.cos(Math.PI/180*37.5);class yg{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new mr,this.layoutVertexArray2=new Br,this.indexArray=new Mr,this.programConfigurations=new _c(i.layers,i.zoom),this.segments=new Si,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,h,p){this.hasPattern=u0("line",this.layers,c);const _=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:D,id:k,index:F,sourceLayerIndex:V}of i){const H=this.layers[0]._featureFilter.needGeometry,Q=xc(D,H);if(!this.layers[0]._featureFilter.filter(new he(this.zoom),Q,h))continue;const ce=_?_.evaluate(Q,{},h):void 0,ge={id:k,properties:D.properties,type:D.type,sourceLayerIndex:V,index:F,geometry:H?Q.geometry:sa(D,h,p),patterns:{},sortKey:ce};v.push(ge)}_&&v.sort((D,k)=>D.sortKey-k.sortKey);const{lineAtlas:w,featureIndex:A}=c,C=this.addConstantDashes(w);for(const D of v){const{geometry:k,index:F,sourceLayerIndex:V}=D;if(C&&this.addFeatureDashes(D,w),this.hasPattern){const H=h0("line",this.layers,D,this.zoom,c);this.patternFeatures.push(H)}else this.addFeature(D,k,F,h,w.positions,c.availableImages);A.insert(i[F].feature,k,F,V,this.index)}}addConstantDashes(i){let c=!1;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,_=h.layout.get("line-cap").value;if(p.kind!=="constant"||_.kind!=="constant")c=!0;else{const v=_.value,w=p.value;if(!w)continue;i.addDash(w.from,v),i.addDash(w.to,v),w.other&&i.addDash(w.other,v)}}return c}addFeatureDashes(i,c){const h=this.zoom;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,v=p.layout.get("line-cap").value;if(_.kind==="constant"&&v.kind==="constant")continue;let w,A,C,D,k,F;if(_.kind==="constant"){const ce=_.value;if(!ce)continue;w=ce.other||ce.to,A=ce.to,C=ce.from}else w=_.evaluate({zoom:h-1},i),A=_.evaluate({zoom:h},i),C=_.evaluate({zoom:h+1},i);v.kind==="constant"?D=k=F=v.value:(D=v.evaluate({zoom:h-1},i),k=v.evaluate({zoom:h},i),F=v.evaluate({zoom:h+1},i)),c.addDash(w,D),c.addDash(A,k),c.addDash(C,F);const V=c.getKey(w,D),H=c.getKey(A,k),Q=c.getKey(C,F);i.patterns[p.id]={min:V,mid:H,max:Q}}}update(i,c,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,h,p)}addFeatures(i,c,h,p,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,c,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,PL)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,SL),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,c,h,p,_,v){const w=this.layers[0].layout,A=w.get("line-join").evaluate(i,{}),C=w.get("line-cap").evaluate(i,{}),D=w.get("line-miter-limit"),k=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const F of c)this.addLine(F,i,A,C,D,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,_,v,p)}addLine(i,c,h,p,_,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<i.length-1;ge++)this.totalDistance+=i[ge].dist(i[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=CL[c.type]==="Polygon";let A=i.length;for(;A>=2&&i[A-1].equals(i[A-2]);)A--;let C=0;for(;C<A-1&&i[C].equals(i[C+1]);)C++;if(A<(w?3:2))return;h==="bevel"&&(_=1.05);const D=this.overscaling<=16?122880/(512*this.overscaling):0,k=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let F,V,H,Q,ce;this.e1=this.e2=-1,w&&(F=i[A-2],ce=i[C].sub(F)._unit()._perp());for(let ge=C;ge<A;ge++){if(H=ge===A-1?w?i[C+1]:void 0:i[ge+1],H&&i[ge].equals(H))continue;ce&&(Q=ce),F&&(V=F),F=i[ge],ce=H?H.sub(F)._unit()._perp():Q,Q=Q||ce;let Ce=Q.add(ce);Ce.x===0&&Ce.y===0||Ce._unit();const Pe=Q.x*ce.x+Q.y*ce.y,De=Ce.x*ce.x+Ce.y*ce.y,Le=De!==0?1/De:1/0,je=2*Math.sqrt(2-2*De),qe=De<IL&&V&&H,Xe=Q.x*ce.y-Q.y*ce.x>0;if(qe&&ge>C){const Ue=F.dist(V);if(Ue>2*D){const nt=F.sub(F.sub(V)._mult(D/Ue)._round());this.updateDistance(V,nt),this.addCurrentVertex(nt,Q,0,0,k),V=nt}}const at=V&&H;let vt=at?h:w?"butt":p;if(at&&vt==="round"&&(Le<v?vt="miter":Le<=2&&(vt="fakeround")),vt==="miter"&&Le>_&&(vt="bevel"),vt==="bevel"&&(Le>2&&(vt="flipbevel"),Le<_&&(vt="miter")),V&&this.updateDistance(V,F),vt==="miter")Ce._mult(Le),this.addCurrentVertex(F,Ce,0,0,k);else if(vt==="flipbevel"){if(Le>100)Ce=ce.mult(-1);else{const Ue=Le*Q.add(ce).mag()/Q.sub(ce).mag();Ce._perp()._mult(Ue*(Xe?-1:1))}this.addCurrentVertex(F,Ce,0,0,k),this.addCurrentVertex(F,Ce.mult(-1),0,0,k)}else if(vt==="bevel"||vt==="fakeround"){const Ue=-Math.sqrt(Le*Le-1),nt=Xe?Ue:0,xt=Xe?0:Ue;if(V&&this.addCurrentVertex(F,Q,nt,xt,k),vt==="fakeround"){const bt=Math.round(180*je/Math.PI/20);for(let Bt=1;Bt<bt;Bt++){let _t=Bt/bt;if(_t!==.5){const gr=_t-.5;_t+=_t*gr*(_t-1)*((1.0904+Pe*(Pe*(3.55645-1.43519*Pe)-3.2452))*gr*gr+(.848013+Pe*(.215638*Pe-1.06021)))}const kt=ce.sub(Q)._mult(_t)._add(Q)._unit()._mult(Xe?-1:1);this.addHalfVertex(F,kt.x,kt.y,!1,Xe,0,k)}}H&&this.addCurrentVertex(F,ce,-nt,-xt,k)}else if(vt==="butt")this.addCurrentVertex(F,Ce,0,0,k);else if(vt==="square"){const Ue=V?1:-1;V||this.addCurrentVertex(F,Ce,Ue,Ue,k),this.addCurrentVertex(F,Ce,0,0,k),V&&this.addCurrentVertex(F,Ce,Ue,Ue,k)}else vt==="round"&&(V&&(this.addCurrentVertex(F,Q,0,0,k),this.addCurrentVertex(F,Q,1,1,k,!0)),H&&(this.addCurrentVertex(F,ce,-1,-1,k,!0),this.addCurrentVertex(F,ce,0,0,k)));if(qe&&ge<A-1){const Ue=F.dist(H);if(Ue>2*D){const nt=F.add(H.sub(F)._mult(D/Ue)._round());this.updateDistance(F,nt),this.addCurrentVertex(nt,ce,0,0,k),F=nt}}}}addCurrentVertex(i,c,h,p,_,v=!1){const w=c.y*p-c.x,A=-c.y-c.x*p;this.addHalfVertex(i,c.x+c.y*h,c.y-c.x*h,v,!1,h,_),this.addHalfVertex(i,w,A,v,!0,-p,_)}addHalfVertex({x:i,y:c},h,p,_,v,w,A){this.layoutVertexArray.emplaceBack((i<<1)+(_?1:0),(c<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(w===0?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const C=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),A.primitiveLength++),v?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,c){this.distance+=i.dist(c),this.updateScaledDistance()}}Vt(yg,"LineBucket",{omit:["layers","patternFeatures"]});const ML=new Qe({"line-cap":new Se(ze.layout_line["line-cap"]),"line-join":new Se(ze.layout_line["line-join"]),"line-miter-limit":new Ge(ze.layout_line["line-miter-limit"]),"line-round-limit":new Ge(ze.layout_line["line-round-limit"]),"line-sort-key":new Se(ze.layout_line["line-sort-key"])});var OE={paint:new Qe({"line-opacity":new Se(ze.paint_line["line-opacity"]),"line-color":new Se(ze.paint_line["line-color"]),"line-translate":new Ge(ze.paint_line["line-translate"]),"line-translate-anchor":new Ge(ze.paint_line["line-translate-anchor"]),"line-width":new Se(ze.paint_line["line-width"]),"line-gap-width":new Se(ze.paint_line["line-gap-width"]),"line-offset":new Se(ze.paint_line["line-offset"]),"line-blur":new Se(ze.paint_line["line-blur"]),"line-dasharray":new dt(ze.paint_line["line-dasharray"]),"line-pattern":new dt(ze.paint_line["line-pattern"]),"line-gradient":new Rt(ze.paint_line["line-gradient"]),"line-trim-offset":new Ge(ze.paint_line["line-trim-offset"])}),layout:ML};const DE=new class extends Se{possiblyEvaluate(l,i){return i=new he(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(l,i)}evaluate(l,i,c,h){return i=xe({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(l,i,c,h)}}(OE.paint.properties["line-width"].specification);function RE(l,i){return i>0?i+2*l:l}DE.useIntegerZoom=!0;const OL=Pt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),DL=Pt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),RL=Pt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Pt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const LL=Pt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),kL=Pt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Pt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const LE=Pt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),zL=Pt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Pt([{name:"triangle",components:3,type:"Uint16"}]),Pt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Pt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Pt([{type:"Float32",name:"offsetX"}]),Pt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var an=24;const To=128;function d0(l,i){const{expression:c}=i;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new he(l+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:p}=c;let _=0;for(;_<h.length&&h[_]<=l;)_++;_=Math.max(0,_-1);let v=_;for(;v<h.length&&h[v]<l+1;)v++;v=Math.min(h.length-1,v);const w=h[_],A=h[v];return c.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:A,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:A,minSize:c.evaluate(new he(w)),maxSize:c.evaluate(new he(A)),interpolationType:p}}}function vg(l,{uSize:i,uSizeT:c},{lowerSize:h,upperSize:p}){return l.kind==="source"?h/To:l.kind==="composite"?Dr(h/To,p/To,c):i}function uh(l,i){let c=0,h=0;if(l.kind==="constant")h=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:p,minZoom:_,maxZoom:v}=l,w=p?X(Ms.interpolationFactor(p,i,_,v),0,1):0;l.kind==="camera"?h=Dr(l.minSize,l.maxSize,w):c=w}return{uSizeT:c,uSize:h}}var FL=Object.freeze({__proto__:null,getSizeData:d0,evaluateSizeForFeature:vg,evaluateSizeForZoom:uh,SIZE_PACK_FACTOR:To});function BL(l,i,c){return l.sections.forEach(h=>{h.text=function(p,_,v){const w=_.layout.get("text-transform").evaluate(v,{});return w==="uppercase"?p=p.toLocaleUpperCase():w==="lowercase"&&(p=p.toLocaleLowerCase()),oe.applyArabicShaping&&(p=oe.applyArabicShaping(p)),p}(h.text,i,c)}),l}const wf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function NL(l){return l==="\uFE36"||l==="\uFE48"||l==="\uFE38"||l==="\uFE44"||l==="\uFE42"||l==="\uFE3E"||l==="\uFE3C"||l==="\uFE3A"||l==="\uFE18"||l==="\uFE40"||l==="\uFE10"||l==="\uFE13"||l==="\uFE14"||l==="\uFF40"||l==="\uFFE3"||l==="\uFE11"||l==="\uFE12"}function jL(l){return l==="\uFE35"||l==="\uFE47"||l==="\uFE37"||l==="\uFE43"||l==="\uFE41"||l==="\uFE3D"||l==="\uFE3B"||l==="\uFE39"||l==="\uFE17"||l==="\uFE3F"}var kE=function(l,i,c,h,p){var _,v,w=8*p-h-1,A=(1<<w)-1,C=A>>1,D=-7,k=c?p-1:0,F=c?-1:1,V=l[i+k];for(k+=F,_=V&(1<<-D)-1,V>>=-D,D+=w;D>0;_=256*_+l[i+k],k+=F,D-=8);for(v=_&(1<<-D)-1,_>>=-D,D+=h;D>0;v=256*v+l[i+k],k+=F,D-=8);if(_===0)_=1-C;else{if(_===A)return v?NaN:1/0*(V?-1:1);v+=Math.pow(2,h),_-=C}return(V?-1:1)*v*Math.pow(2,_-h)},zE=function(l,i,c,h,p,_){var v,w,A,C=8*_-p-1,D=(1<<C)-1,k=D>>1,F=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=h?0:_-1,H=h?1:-1,Q=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(w=isNaN(i)?1:0,v=D):(v=Math.floor(Math.log(i)/Math.LN2),i*(A=Math.pow(2,-v))<1&&(v--,A*=2),(i+=v+k>=1?F/A:F*Math.pow(2,1-k))*A>=2&&(v++,A/=2),v+k>=D?(w=0,v=D):v+k>=1?(w=(i*A-1)*Math.pow(2,p),v+=k):(w=i*Math.pow(2,k-1)*Math.pow(2,p),v=0));p>=8;l[c+V]=255&w,V+=H,w/=256,p-=8);for(v=v<<p|w,C+=p;C>0;l[c+V]=255&v,V+=H,v/=256,C-=8);l[c+V-H]|=128*Q},Ef=ei;function ei(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}ei.Varint=0,ei.Fixed64=1,ei.Bytes=2,ei.Fixed32=5;var f0=4294967296,FE=1/f0,BE=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function aa(l){return l.type===ei.Bytes?l.readVarint()+l.pos:l.pos+1}function hh(l,i,c){return c?4294967296*i+(l>>>0):4294967296*(i>>>0)+(l>>>0)}function NE(l,i,c){var h=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));c.realloc(h);for(var p=c.pos-1;p>=l;p--)c.buf[p+h]=c.buf[p]}function $L(l,i){for(var c=0;c<l.length;c++)i.writeVarint(l[c])}function VL(l,i){for(var c=0;c<l.length;c++)i.writeSVarint(l[c])}function UL(l,i){for(var c=0;c<l.length;c++)i.writeFloat(l[c])}function GL(l,i){for(var c=0;c<l.length;c++)i.writeDouble(l[c])}function HL(l,i){for(var c=0;c<l.length;c++)i.writeBoolean(l[c])}function WL(l,i){for(var c=0;c<l.length;c++)i.writeFixed32(l[c])}function ZL(l,i){for(var c=0;c<l.length;c++)i.writeSFixed32(l[c])}function qL(l,i){for(var c=0;c<l.length;c++)i.writeFixed64(l[c])}function KL(l,i){for(var c=0;c<l.length;c++)i.writeSFixed64(l[c])}function xg(l,i){return(l[i]|l[i+1]<<8|l[i+2]<<16)+16777216*l[i+3]}function dh(l,i,c){l[c]=i,l[c+1]=i>>>8,l[c+2]=i>>>16,l[c+3]=i>>>24}function jE(l,i){return(l[i]|l[i+1]<<8|l[i+2]<<16)+(l[i+3]<<24)}function XL(l,i,c){i.glyphs=[],l===1&&c.readMessage(YL,i)}function YL(l,i,c){if(l===3){const{id:h,bitmap:p,width:_,height:v,left:w,top:A,advance:C}=c.readMessage(JL,{});i.glyphs.push({id:h,bitmap:new oa({width:_+6,height:v+6},p),metrics:{width:_,height:v,left:w,top:A,advance:C}})}else l===4?i.ascender=c.readSVarint():l===5&&(i.descender=c.readSVarint())}function JL(l,i,c){l===1?i.id=c.readVarint():l===2?i.bitmap=c.readBytes():l===3?i.width=c.readVarint():l===4?i.height=c.readVarint():l===5?i.left=c.readSVarint():l===6?i.top=c.readSVarint():l===7&&(i.advance=c.readVarint())}function p0(l){let i=0,c=0;for(const v of l)i+=v.w*v.h,c=Math.max(c,v.w);l.sort((v,w)=>w.h-v.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),c),h:1/0}];let p=0,_=0;for(const v of l)for(let w=h.length-1;w>=0;w--){const A=h[w];if(!(v.w>A.w||v.h>A.h)){if(v.x=A.x,v.y=A.y,_=Math.max(_,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===A.w&&v.h===A.h){const C=h.pop();w<h.length&&(h[w]=C)}else v.h===A.h?(A.x+=v.w,A.w-=v.w):v.w===A.w?(A.y+=v.h,A.h-=v.h):(h.push({x:A.x+v.w,y:A.y,w:A.w-v.w,h:v.h}),A.y+=v.h,A.h-=v.h);break}}return{w:p,h:_,fill:i/(p*_)||0}}ei.prototype={destroy:function(){this.buf=null},readFields:function(l,i,c){for(c=c||this.length;this.pos<c;){var h=this.readVarint(),p=h>>3,_=this.pos;this.type=7&h,l(p,i,this),this.pos===_&&this.skip(h)}return i},readMessage:function(l,i){return this.readFields(l,i,this.readVarint()+this.pos)},readFixed32:function(){var l=xg(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=jE(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=xg(this.buf,this.pos)+xg(this.buf,this.pos+4)*f0;return this.pos+=8,l},readSFixed64:function(){var l=xg(this.buf,this.pos)+jE(this.buf,this.pos+4)*f0;return this.pos+=8,l},readFloat:function(){var l=kE(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=kE(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var i,c,h=this.buf;return i=127&(c=h[this.pos++]),c<128?i:(i|=(127&(c=h[this.pos++]))<<7,c<128?i:(i|=(127&(c=h[this.pos++]))<<14,c<128?i:(i|=(127&(c=h[this.pos++]))<<21,c<128?i:function(p,_,v){var w,A,C=v.buf;if(w=(112&(A=C[v.pos++]))>>4,A<128||(w|=(127&(A=C[v.pos++]))<<3,A<128)||(w|=(127&(A=C[v.pos++]))<<10,A<128)||(w|=(127&(A=C[v.pos++]))<<17,A<128)||(w|=(127&(A=C[v.pos++]))<<24,A<128)||(w|=(1&(A=C[v.pos++]))<<31,A<128))return hh(p,w,_);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(c=h[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var l=this.readVarint()+this.pos,i=this.pos;return this.pos=l,l-i>=12&&BE?function(c,h,p){return BE.decode(c.subarray(h,p))}(this.buf,i,l):function(c,h,p){for(var _="",v=h;v<p;){var w,A,C,D=c[v],k=null,F=D>239?4:D>223?3:D>191?2:1;if(v+F>p)break;F===1?D<128&&(k=D):F===2?(192&(w=c[v+1]))==128&&(k=(31&D)<<6|63&w)<=127&&(k=null):F===3?(A=c[v+2],(192&(w=c[v+1]))==128&&(192&A)==128&&((k=(15&D)<<12|(63&w)<<6|63&A)<=2047||k>=55296&&k<=57343)&&(k=null)):F===4&&(A=c[v+2],C=c[v+3],(192&(w=c[v+1]))==128&&(192&A)==128&&(192&C)==128&&((k=(15&D)<<18|(63&w)<<12|(63&A)<<6|63&C)<=65535||k>=1114112)&&(k=null)),k===null?(k=65533,F=1):k>65535&&(k-=65536,_+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),_+=String.fromCharCode(k),v+=F}return _}(this.buf,i,l)},readBytes:function(){var l=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,l);return this.pos=l,i},readPackedVarint:function(l,i){if(this.type!==ei.Bytes)return l.push(this.readVarint(i));var c=aa(this);for(l=l||[];this.pos<c;)l.push(this.readVarint(i));return l},readPackedSVarint:function(l){if(this.type!==ei.Bytes)return l.push(this.readSVarint());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==ei.Bytes)return l.push(this.readBoolean());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==ei.Bytes)return l.push(this.readFloat());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==ei.Bytes)return l.push(this.readDouble());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==ei.Bytes)return l.push(this.readFixed32());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==ei.Bytes)return l.push(this.readSFixed32());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==ei.Bytes)return l.push(this.readFixed64());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==ei.Bytes)return l.push(this.readSFixed64());var i=aa(this);for(l=l||[];this.pos<i;)l.push(this.readSFixed64());return l},skip:function(l){var i=7&l;if(i===ei.Varint)for(;this.buf[this.pos++]>127;);else if(i===ei.Bytes)this.pos=this.readVarint()+this.pos;else if(i===ei.Fixed32)this.pos+=4;else{if(i!==ei.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(l,i){this.writeVarint(l<<3|i)},realloc:function(l){for(var i=this.length||16;i<this.pos+l;)i*=2;if(i!==this.length){var c=new Uint8Array(i);c.set(this.buf),this.buf=c,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),dh(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),dh(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),dh(this.buf,-1&l,this.pos),dh(this.buf,Math.floor(l*FE),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),dh(this.buf,-1&l,this.pos),dh(this.buf,Math.floor(l*FE),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(i,c){var h,p;if(i>=0?(h=i%4294967296|0,p=i/4294967296|0):(p=~(-i/4294967296),4294967295^(h=~(-i%4294967296))?h=h+1|0:(h=0,p=p+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(_,v,w){w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,w.buf[w.pos]=127&(_>>>=7)}(h,0,c),function(_,v){var w=(7&_)<<4;v.buf[v.pos++]|=w|((_>>>=3)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_)))))}(p,c)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(Boolean(l))},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var i=this.pos;this.pos=function(h,p,_){for(var v,w,A=0;A<p.length;A++){if((v=p.charCodeAt(A))>55295&&v<57344){if(!w){v>56319||A+1===p.length?(h[_++]=239,h[_++]=191,h[_++]=189):w=v;continue}if(v<56320){h[_++]=239,h[_++]=191,h[_++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(h[_++]=239,h[_++]=191,h[_++]=189,w=null);v<128?h[_++]=v:(v<2048?h[_++]=v>>6|192:(v<65536?h[_++]=v>>12|224:(h[_++]=v>>18|240,h[_++]=v>>12&63|128),h[_++]=v>>6&63|128),h[_++]=63&v|128)}return _}(this.buf,l,this.pos);var c=this.pos-i;c>=128&&NE(i,c,this),this.pos=i-1,this.writeVarint(c),this.pos+=c},writeFloat:function(l){this.realloc(4),zE(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),zE(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var i=l.length;this.writeVarint(i),this.realloc(i);for(var c=0;c<i;c++)this.buf[this.pos++]=l[c]},writeRawMessage:function(l,i){this.pos++;var c=this.pos;l(i,this);var h=this.pos-c;h>=128&&NE(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeMessage:function(l,i,c){this.writeTag(l,ei.Bytes),this.writeRawMessage(i,c)},writePackedVarint:function(l,i){i.length&&this.writeMessage(l,$L,i)},writePackedSVarint:function(l,i){i.length&&this.writeMessage(l,VL,i)},writePackedBoolean:function(l,i){i.length&&this.writeMessage(l,HL,i)},writePackedFloat:function(l,i){i.length&&this.writeMessage(l,UL,i)},writePackedDouble:function(l,i){i.length&&this.writeMessage(l,GL,i)},writePackedFixed32:function(l,i){i.length&&this.writeMessage(l,WL,i)},writePackedSFixed32:function(l,i){i.length&&this.writeMessage(l,ZL,i)},writePackedFixed64:function(l,i){i.length&&this.writeMessage(l,qL,i)},writePackedSFixed64:function(l,i){i.length&&this.writeMessage(l,KL,i)},writeBytesField:function(l,i){this.writeTag(l,ei.Bytes),this.writeBytes(i)},writeFixed32Field:function(l,i){this.writeTag(l,ei.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(l,i){this.writeTag(l,ei.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(l,i){this.writeTag(l,ei.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(l,i){this.writeTag(l,ei.Fixed64),this.writeSFixed64(i)},writeVarintField:function(l,i){this.writeTag(l,ei.Varint),this.writeVarint(i)},writeSVarintField:function(l,i){this.writeTag(l,ei.Varint),this.writeSVarint(i)},writeStringField:function(l,i){this.writeTag(l,ei.Bytes),this.writeString(i)},writeFloatField:function(l,i){this.writeTag(l,ei.Fixed32),this.writeFloat(i)},writeDoubleField:function(l,i){this.writeTag(l,ei.Fixed64),this.writeDouble(i)},writeBooleanField:function(l,i){this.writeVarintField(l,Boolean(i))}};class m0{constructor(i,{pixelRatio:c,version:h,stretchX:p,stretchY:_,content:v}){this.paddedRect=i,this.pixelRatio=c,this.stretchX=p,this.stretchY=_,this.content=v,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class $E{constructor(i,c){const h={},p={};this.haveRenderCallbacks=[];const _=[];this.addImages(i,h,_),this.addImages(c,p,_);const{w:v,h:w}=p0(_),A=new Qn({width:v||1,height:w||1});for(const C in i){const D=i[C],k=h[C].paddedRect;Qn.copy(D.data,A,{x:0,y:0},{x:k.x+1,y:k.y+1},D.data)}for(const C in c){const D=c[C],k=p[C].paddedRect,F=k.x+1,V=k.y+1,H=D.data.width,Q=D.data.height;Qn.copy(D.data,A,{x:0,y:0},{x:F,y:V},D.data),Qn.copy(D.data,A,{x:0,y:Q-1},{x:F,y:V-1},{width:H,height:1}),Qn.copy(D.data,A,{x:0,y:0},{x:F,y:V+Q},{width:H,height:1}),Qn.copy(D.data,A,{x:H-1,y:0},{x:F-1,y:V},{width:1,height:Q}),Qn.copy(D.data,A,{x:0,y:0},{x:F+H,y:V},{width:1,height:Q})}this.image=A,this.iconPositions=h,this.patternPositions=p}addImages(i,c,h){for(const p in i){const _=i[p],v={x:0,y:0,w:_.data.width+2,h:_.data.height+2};h.push(v),c[p]=new m0(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(i,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>i.hasImage(h)),i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in i.updatedImages)this.patchUpdatedImage(this.iconPositions[h],i.getImage(h),c),this.patchUpdatedImage(this.patternPositions[h],i.getImage(h),c)}patchUpdatedImage(i,c,h){if(!i||!c||i.version===c.version)return;i.version=c.version;const[p,_]=i.tl;h.update(c.data,void 0,{x:p,y:_})}}Vt(m0,"ImagePosition"),Vt($E,"ImageAtlas");const ms={horizontal:1,vertical:2,horizontalOnly:3};class Tf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,c){const h=new Tf;return h.scale=i||1,h.fontStack=c,h}static forImage(i){const c=new Tf;return c.imageName=i,c}}class fh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,c){const h=new fh;for(let p=0;p<i.sections.length;p++){const _=i.sections[p];_.image?h.addImageSection(_):h.addTextSection(_,c)}return h}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(c,h){let p="";for(let _=0;_<c.length;_++){const v=c.charCodeAt(_+1)||null,w=c.charCodeAt(_-1)||null;p+=!h&&(v&&f(v)&&!wf[c[_+1]]||w&&f(w)&&!wf[c[_-1]])||!wf[c[_]]?c[_]:wf[c[_]]}return p}(this.text,i)}trim(){let i=0;for(let h=0;h<this.text.length&&bg[this.text.charCodeAt(h)];h++)i++;let c=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&bg[this.text.charCodeAt(h)];h--)c--;this.text=this.text.substring(i,c),this.sectionIndex=this.sectionIndex.slice(i,c)}substring(i,c){const h=new fh;return h.text=this.text.substring(i,c),h.sectionIndex=this.sectionIndex.slice(i,c),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,c)=>Math.max(i,this.sections[c].scale),0)}addTextSection(i,c){this.text+=i.text,this.sections.push(Tf.forText(i.scale,i.fontStack||c));const h=this.sections.length-1;for(let p=0;p<i.text.length;++p)this.sectionIndex.push(h)}addImageSection(i){const c=i.image?i.image.name:"";if(c.length===0)return void Nt("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Tf.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Nt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function g0(l,i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q){const ce=fh.fromFeature(l,p);let ge;k===ms.vertical&&ce.verticalizePunctuation(F);const{processBidirectionalText:Ce,processStyledBidirectionalText:Pe}=oe;if(Ce&&ce.sections.length===1){ge=[];const je=Ce(ce.toString(),_0(ce,C,_,i,h,V,H));for(const qe of je){const Xe=new fh;Xe.text=qe,Xe.sections=ce.sections;for(let at=0;at<qe.length;at++)Xe.sectionIndex.push(0);ge.push(Xe)}}else if(Pe){ge=[];const je=Pe(ce.text,ce.sectionIndex,_0(ce,C,_,i,h,V,H));for(const qe of je){const Xe=new fh;Xe.text=qe[0],Xe.sectionIndex=qe[1],Xe.sections=ce.sections,ge.push(Xe)}}else ge=function(je,qe){const Xe=[],at=je.text;let vt=0;for(const Ue of qe)Xe.push(je.substring(vt,Ue)),vt=Ue;return vt<at.length&&Xe.push(je.substring(vt,at.length)),Xe}(ce,_0(ce,C,_,i,h,V,H));const De=[],Le={positionedLines:De,text:ce.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(je,qe,Xe,at,vt,Ue,nt,xt,bt,Bt,_t,kt){let gr=0,vr=0,er=0;const Ut=xt==="right"?1:xt==="left"?0:.5;let Er=!1;for(const Tr of vt){const Lr=Tr.getSections();for(const ti of Lr){if(ti.imageName)continue;const Jr=qe[ti.fontStack];if(Jr&&(Er=Jr.ascender!==void 0&&Jr.descender!==void 0,!Er))break}if(!Er)break}let yr=0;for(const Tr of vt){Tr.trim();const Lr=Tr.getMaxScale(),ti=(Lr-1)*an,Jr={positionedGlyphs:[],lineOffset:0};je.positionedLines[yr]=Jr;const Zr=Jr.positionedGlyphs;let ni=0;if(!Tr.length()){vr+=Ue,++yr;continue}let hi=0,Xi=0;for(let Pr=0;Pr<Tr.length();Pr++){const vi=Tr.getSection(Pr),pn=Tr.getSectionIndex(Pr),Vr=Tr.getCharCode(Pr);let di=vi.scale,An=null,li=null,Pi=null,Yi=an,Hi=0;const ln=!(bt===ms.horizontal||!_t&&!a(Vr)||_t&&(bg[Vr]||(Kt=Vr,$m(Kt)||Vm(Kt)||pc(Kt)||nf(Kt)||af(Kt))));if(vi.imageName){const Pn=at[vi.imageName];if(!Pn)continue;Pi=vi.imageName,je.iconsInText=je.iconsInText||!0,li=Pn.paddedRect;const Ji=Pn.displaySize;di=di*an/kt,An={width:Ji[0],height:Ji[1],left:1,top:-3,advance:ln?Ji[1]:Ji[0],localGlyph:!1},Hi=Er?-An.height*di:Lr*an-17-Ji[1]*di,Yi=An.advance;const ca=(ln?Ji[0]:Ji[1])*di-an*Lr;ca>0&&ca>ni&&(ni=ca)}else{const Pn=Xe[vi.fontStack];if(!Pn)continue;Pn[Vr]&&(li=Pn[Vr]);const Ji=qe[vi.fontStack];if(!Ji)continue;const ca=Ji.glyphs[Vr];if(!ca)continue;if(An=ca.metrics,Yi=Vr!==8203?an:0,Er){const vh=Ji.ascender!==void 0?Math.abs(Ji.ascender):0,Lf=Ji.descender!==void 0?Math.abs(Ji.descender):0,kf=(vh+Lf)*di;hi<kf&&(hi=kf,Xi=(vh-Lf)/2*di),Hi=-vh*di}else Hi=(Lr-di)*an-17}ln?(je.verticalizable=!0,Zr.push({glyph:Vr,imageName:Pi,x:gr,y:vr+Hi,vertical:ln,scale:di,localGlyph:An.localGlyph,fontStack:vi.fontStack,sectionIndex:pn,metrics:An,rect:li}),gr+=Yi*di+Bt):(Zr.push({glyph:Vr,imageName:Pi,x:gr,y:vr+Hi,vertical:ln,scale:di,localGlyph:An.localGlyph,fontStack:vi.fontStack,sectionIndex:pn,metrics:An,rect:li}),gr+=An.advance*di+Bt)}Zr.length!==0&&(er=Math.max(gr-Bt,er),Er?WE(Zr,Ut,ni,Xi,Ue*Lr/2):WE(Zr,Ut,ni,0,Ue/2)),gr=0;const zn=Ue*Lr+ni;Jr.lineOffset=Math.max(ni,ti),vr+=zn,++yr}var Kt;const Bi=vr,{horizontalAlign:Ai,verticalAlign:yi}=y0(nt);(function(Tr,Lr,ti,Jr,Zr,ni){const hi=(Lr-ti)*Zr,Xi=-ni*Jr;for(const zn of Tr)for(const Pr of zn.positionedGlyphs)Pr.x+=hi,Pr.y+=Xi})(je.positionedLines,Ut,Ai,yi,er,Bi),je.top+=-yi*Bi,je.bottom=je.top+Bi,je.left+=-Ai*er,je.right=je.left+er,je.hasBaseline=Er}(Le,i,c,h,ge,v,w,A,k,C,F,Q),!function(je){for(const qe of je)if(qe.positionedGlyphs.length!==0)return!1;return!0}(De)&&Le}const bg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},QL={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function VE(l,i,c,h,p,_){if(i.imageName){const v=h[i.imageName];return v?v.displaySize[0]*i.scale*an/_+p:0}{const v=c[i.fontStack],w=v&&v.glyphs[l];return w?w.metrics.advance*i.scale+p:0}}function UE(l,i,c,h){const p=Math.pow(l-i,2);return h?l<i?p/2:2*p:p+Math.abs(c)*c}function ek(l,i,c){let h=0;return l===10&&(h-=1e4),c&&(h+=150),l!==40&&l!==65288||(h+=50),i!==41&&i!==65289||(h+=50),h}function GE(l,i,c,h,p,_){let v=null,w=UE(i,c,p,_);for(const A of h){const C=UE(i-A.x,c,p,_)+A.badness;C<=w&&(v=A,w=C)}return{index:l,x:i,priorBreak:v,badness:w}}function HE(l){return l?HE(l.priorBreak).concat(l.index):[]}function _0(l,i,c,h,p,_,v){if(_!=="point")return[];if(!l)return[];const w=[],A=function(F,V,H,Q,ce,ge){let Ce=0;for(let Pe=0;Pe<F.length();Pe++){const De=F.getSection(Pe);Ce+=VE(F.getCharCode(Pe),De,Q,ce,V,ge)}return Ce/Math.max(1,Math.ceil(Ce/H))}(l,i,c,h,p,v),C=l.text.indexOf("\u200B")>=0;let D=0;for(let F=0;F<l.length();F++){const V=l.getSection(F),H=l.getCharCode(F);if(bg[H]||(D+=VE(H,V,h,p,i,v)),F<l.length()-1){const Q=!((k=H)<11904||!(Qd(k)||Jd(k)||sf(k)||qm(k)||eh(k)||Um(k)||ef(k)||Xu(k)||Hm(k)||rf(k)||Qu(k)||lf(k)||Yu(k)||mc(k)||Gm(k)||tf(k)||Ju(k)||Km(k)||th(k)||Wm(k)));(QL[H]||Q||V.imageName)&&w.push(GE(F+1,D,A,w,ek(H,l.getCharCode(F+1),Q&&C),!1))}}var k;return HE(GE(l.length(),D,A,w,0,!0))}function y0(l){let i=.5,c=.5;switch(l){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:i,verticalAlign:c}}function WE(l,i,c,h,p){if(!(i||c||h||p))return;const _=l.length-1,v=l[_],w=(v.x+v.metrics.advance*v.scale)*i;for(let A=0;A<=_;A++)l[A].x-=w,l[A].y+=c+h+p}function tk(l,i,c){const{horizontalAlign:h,verticalAlign:p}=y0(c),_=i[0]-l.displaySize[0]*h,v=i[1]-l.displaySize[1]*p;return{image:l,top:v,bottom:v+l.displaySize[1],left:_,right:_+l.displaySize[0]}}function ZE(l,i,c,h,p,_){const v=l.image;let w;if(v.content){const ce=v.content,ge=v.pixelRatio||1;w=[ce[0]/ge,ce[1]/ge,v.displaySize[0]-ce[2]/ge,v.displaySize[1]-ce[3]/ge]}const A=i.left*_,C=i.right*_;let D,k,F,V;c==="width"||c==="both"?(V=p[0]+A-h[3],k=p[0]+C+h[1]):(V=p[0]+(A+C-v.displaySize[0])/2,k=V+v.displaySize[0]);const H=i.top*_,Q=i.bottom*_;return c==="height"||c==="both"?(D=p[1]+H-h[0],F=p[1]+Q+h[2]):(D=p[1]+(H+Q-v.displaySize[1])/2,F=D+v.displaySize[1]),{image:v,top:D,right:k,bottom:F,left:V,collisionPadding:w}}class la extends S{constructor(i,c,h,p,_){super(i,c),this.angle=p,this.z=h,_!==void 0&&(this.segment=_)}clone(){return new la(this.x,this.y,this.z,this.angle,this.segment)}}function qE(l,i,c,h,p){if(i.segment===void 0)return!0;let _=i,v=i.segment+1,w=0;for(;w>-c/2;){if(v--,v<0)return!1;w-=l[v].dist(_),_=l[v]}w+=l[v].dist(l[v+1]),v++;const A=[];let C=0;for(;w<c/2;){const D=l[v],k=l[v+1];if(!k)return!1;let F=l[v-1].angleTo(D)-D.angleTo(k);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:w,angleDelta:F}),C+=F;w-A[0].distance>h;)C-=A.shift().angleDelta;if(C>p)return!1;v++,w+=D.dist(k)}return!0}function KE(l){let i=0;for(let c=0;c<l.length-1;c++)i+=l[c].dist(l[c+1]);return i}function XE(l,i,c){return l?.6*i*c:0}function YE(l,i){return Math.max(l?l.right-l.left:0,i?i.right-i.left:0)}function rk(l,i,c,h,p,_){const v=XE(c,p,_),w=YE(c,h)*_;let A=0;const C=KE(l)/2;for(let D=0;D<l.length-1;D++){const k=l[D],F=l[D+1],V=k.dist(F);if(A+V>C){const H=(C-A)/V,Q=Dr(k.x,F.x,H),ce=Dr(k.y,F.y,H),ge=new la(Q,ce,0,F.angleTo(k),D);return!v||qE(l,ge,w,v,i)?ge:void 0}A+=V}}function ik(l,i,c,h,p,_,v,w,A){const C=XE(h,_,v),D=YE(h,p),k=D*v,F=l[0].x===0||l[0].x===A||l[0].y===0||l[0].y===A;return i-k<i/4&&(i=k+i/4),JE(l,F?i/2*w%i:(D/2+2*_)*v*w%i,i,C,c,k,F,!1,A)}function JE(l,i,c,h,p,_,v,w,A){const C=_/2,D=KE(l);let k=0,F=i-c,V=[];for(let H=0;H<l.length-1;H++){const Q=l[H],ce=l[H+1],ge=Q.dist(ce),Ce=ce.angleTo(Q);for(;F+c<k+ge;){F+=c;const Pe=(F-k)/ge,De=Dr(Q.x,ce.x,Pe),Le=Dr(Q.y,ce.y,Pe);if(De>=0&&De<A&&Le>=0&&Le<A&&F-C>=0&&F+C<=D){const je=new la(De,Le,0,Ce,H);je._round(),h&&!qE(l,je,_,h,p)||V.push(je)}}k+=ge}return w||V.length||v||(V=JE(l,k/2,c,h,p,_,v,!0,A)),V}function QE(l,i,c,h,p){const _=[];for(let v=0;v<l.length;v++){const w=l[v];let A;for(let C=0;C<w.length-1;C++){let D=w[C],k=w[C+1];D.x<i&&k.x<i||(D.x<i?D=new S(i,D.y+(i-D.x)/(k.x-D.x)*(k.y-D.y))._round():k.x<i&&(k=new S(i,D.y+(i-D.x)/(k.x-D.x)*(k.y-D.y))._round()),D.y<c&&k.y<c||(D.y<c?D=new S(D.x+(c-D.y)/(k.y-D.y)*(k.x-D.x),c)._round():k.y<c&&(k=new S(D.x+(c-D.y)/(k.y-D.y)*(k.x-D.x),c)._round()),D.x>=h&&k.x>=h||(D.x>=h?D=new S(h,D.y+(h-D.x)/(k.x-D.x)*(k.y-D.y))._round():k.x>=h&&(k=new S(h,D.y+(h-D.x)/(k.x-D.x)*(k.y-D.y))._round()),D.y>=p&&k.y>=p||(D.y>=p?D=new S(D.x+(p-D.y)/(k.y-D.y)*(k.x-D.x),p)._round():k.y>=p&&(k=new S(D.x+(p-D.y)/(k.y-D.y)*(k.x-D.x),p)._round()),A&&D.equals(A[A.length-1])||(A=[D],_.push(A)),A.push(k)))))}}return _}Vt(la,"Anchor");const Sf=1e20;function eT(l,i,c,h,p,_,v,w,A){for(let C=i;C<i+h;C++)tT(l,c*_+C,_,p,v,w,A);for(let C=c;C<c+p;C++)tT(l,C*_+i,1,h,v,w,A)}function tT(l,i,c,h,p,_,v){_[0]=0,v[0]=-Sf,v[1]=Sf,p[0]=l[i];for(let w=1,A=0,C=0;w<h;w++){p[w]=l[i+w*c];const D=w*w;do{const k=_[A];C=(p[w]-p[k]+D-k*k)/(w-k)/2}while(C<=v[A]&&--A>-1);A++,_[A]=w,v[A]=C,v[A+1]=Sf}for(let w=0,A=0;w<h;w++){for(;v[A+1]<w;)A++;const C=_[A],D=w-C;l[i+w*c]=p[C]+D*D}}const v0={none:0,ideographs:1,all:2};class ph{constructor(i,c,h){this.requestManager=i,this.localGlyphMode=c,this.localFontFamily=h,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,c){const h=[];for(const p in i)for(const _ of i[p])h.push({stack:p,id:_});ne(h,({stack:p,id:_},v)=>{let w=this.entries[p];w||(w=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=w.glyphs[_];if(A!==void 0)return void v(null,{stack:p,id:_,glyph:A});if(A=this._tinySDF(w,p,_),A)return w.glyphs[_]=A,void v(null,{stack:p,id:_,glyph:A});const C=Math.floor(_/256);if(256*C>65535)return void v(new Error("glyphs > 65535 not supported"));if(w.ranges[C])return void v(null,{stack:p,id:_,glyph:A});let D=w.requests[C];D||(D=w.requests[C]=[],ph.loadGlyphRange(p,C,this.url,this.requestManager,(k,F)=>{if(F){w.ascender=F.ascender,w.descender=F.descender;for(const V in F.glyphs)this._doesCharSupportLocalGlyph(+V)||(w.glyphs[+V]=F.glyphs[+V]);w.ranges[C]=!0}for(const V of D)V(k,F);delete w.requests[C]})),D.push((k,F)=>{k?v(k):F&&v(null,{stack:p,id:_,glyph:F.glyphs[_]||null})})},(p,_)=>{if(p)c(p);else if(_){const v={};for(const{stack:w,id:A,glyph:C}of _)v[w]===void 0&&(v[w]={}),v[w].glyphs===void 0&&(v[w].glyphs={}),v[w].glyphs[A]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},v[w].ascender=this.entries[w].ascender,v[w].descender=this.entries[w].descender;c(null,v)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==v0.none&&(this.localGlyphMode===v0.all?!!this.localFontFamily:!!this.localFontFamily&&(rf(i)||Zm(i)||Yu(i)||Ju(i)||Xu(i)))}_tinySDF(i,c,h){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(h))return;let _=i.tinySDF;if(!_){let Q="400";/bold/i.test(c)?Q="900":/medium/i.test(c)?Q="500":/light/i.test(c)&&(Q="200"),_=i.tinySDF=new ph.TinySDF({fontFamily:p,fontWeight:Q,fontSize:48,buffer:6,radius:16}),_.fontWeight=Q}if(this.localGlyphs[_.fontWeight][h])return this.localGlyphs[_.fontWeight][h];const v=String.fromCharCode(h),{data:w,width:A,height:C,glyphWidth:D,glyphHeight:k,glyphLeft:F,glyphTop:V,glyphAdvance:H}=_.draw(v);return this.localGlyphs[_.fontWeight][h]={id:h,bitmap:new oa({width:A,height:C},w),metrics:{width:D/2,height:k/2,left:F/2,top:V/2-27,advance:H/2,localGlyph:!0}}}}function rT(l,i,c,h){const p=[],_=l.image,v=_.pixelRatio,w=_.paddedRect.w-2,A=_.paddedRect.h-2,C=l.right-l.left,D=l.bottom-l.top,k=_.stretchX||[[0,w]],F=_.stretchY||[[0,A]],V=(Ue,nt)=>Ue+nt[1]-nt[0],H=k.reduce(V,0),Q=F.reduce(V,0),ce=w-H,ge=A-Q;let Ce=0,Pe=H,De=0,Le=Q,je=0,qe=ce,Xe=0,at=ge;if(_.content&&h){const Ue=_.content;Ce=wg(k,0,Ue[0]),De=wg(F,0,Ue[1]),Pe=wg(k,Ue[0],Ue[2]),Le=wg(F,Ue[1],Ue[3]),je=Ue[0]-Ce,Xe=Ue[1]-De,qe=Ue[2]-Ue[0]-Pe,at=Ue[3]-Ue[1]-Le}const vt=(Ue,nt,xt,bt)=>{const Bt=Eg(Ue.stretch-Ce,Pe,C,l.left),_t=Tg(Ue.fixed-je,qe,Ue.stretch,H),kt=Eg(nt.stretch-De,Le,D,l.top),gr=Tg(nt.fixed-Xe,at,nt.stretch,Q),vr=Eg(xt.stretch-Ce,Pe,C,l.left),er=Tg(xt.fixed-je,qe,xt.stretch,H),Ut=Eg(bt.stretch-De,Le,D,l.top),Er=Tg(bt.fixed-Xe,at,bt.stretch,Q),yr=new S(Bt,kt),Kt=new S(vr,kt),Bi=new S(vr,Ut),Ai=new S(Bt,Ut),yi=new S(_t/v,gr/v),Tr=new S(er/v,Er/v),Lr=i*Math.PI/180;if(Lr){const Zr=Math.sin(Lr),ni=Math.cos(Lr),hi=[ni,-Zr,Zr,ni];yr._matMult(hi),Kt._matMult(hi),Ai._matMult(hi),Bi._matMult(hi)}const ti=Ue.stretch+Ue.fixed,Jr=nt.stretch+nt.fixed;return{tl:yr,tr:Kt,bl:Ai,br:Bi,tex:{x:_.paddedRect.x+1+ti,y:_.paddedRect.y+1+Jr,w:xt.stretch+xt.fixed-ti,h:bt.stretch+bt.fixed-Jr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:yi,pixelOffsetBR:Tr,minFontScaleX:qe/v/C,minFontScaleY:at/v/D,isSDF:c}};if(h&&(_.stretchX||_.stretchY)){const Ue=iT(k,ce,H),nt=iT(F,ge,Q);for(let xt=0;xt<Ue.length-1;xt++){const bt=Ue[xt],Bt=Ue[xt+1];for(let _t=0;_t<nt.length-1;_t++)p.push(vt(bt,nt[_t],Bt,nt[_t+1]))}}else p.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:A+1}));return p}function wg(l,i,c){let h=0;for(const p of l)h+=Math.max(i,Math.min(c,p[1]))-Math.max(i,Math.min(c,p[0]));return h}function iT(l,i,c){const h=[{fixed:-1,stretch:0}];for(const[p,_]of l){const v=h[h.length-1];h.push({fixed:p-v.stretch,stretch:v.stretch}),h.push({fixed:p-v.stretch,stretch:v.stretch+(_-p)})}return h.push({fixed:i+1,stretch:c}),h}function Eg(l,i,c,h){return l/i*c+h}function Tg(l,i,c,h){return l-i*c/h}function nk(l,i,c,h){const p=i+l.positionedLines[h].lineOffset;return h===0?c+p/2:c+(p+(i+l.positionedLines[h-1].lineOffset))/2}ph.loadGlyphRange=function(l,i,c,h,p){const _=256*i,v=_+255,w=h.transformRequest(h.normalizeGlyphsURL(c).replace("{fontstack}",l).replace("{range}",`${_}-${v}`),Ee.Glyphs);Y(w,(A,C)=>{if(A)p(A);else if(C){const D={},k=function(F){return new Ef(F).readFields(XL,{})}(C);for(const F of k.glyphs)D[F.id]=F;p(null,{glyphs:D,ascender:k.ascender,descender:k.descender})}})},ph.TinySDF=class{constructor({fontSize:l=24,buffer:i=3,radius:c=8,cutoff:h=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:v="normal"}={}){this.buffer=i,this.cutoff=h,this.radius=c;const w=this.size=l+4*i,A=this._createCanvas(w),C=this.ctx=A.getContext("2d",{willReadFrequently:!0});C.font=`${v} ${_} ${l}px ${p}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(l){const i=document.createElement("canvas");return i.width=i.height=l,i}draw(l){const{width:i,actualBoundingBoxAscent:c,actualBoundingBoxDescent:h,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(l),v=Math.ceil(c),w=Math.min(this.size-this.buffer,Math.ceil(_-p)),A=Math.min(this.size-this.buffer,v+Math.ceil(h)),C=w+2*this.buffer,D=A+2*this.buffer,k=Math.max(C*D,0),F=new Uint8ClampedArray(k),V={data:F,width:C,height:D,glyphWidth:w,glyphHeight:A,glyphTop:v,glyphLeft:0,glyphAdvance:i};if(w===0||A===0)return V;const{ctx:H,buffer:Q,gridInner:ce,gridOuter:ge}=this;H.clearRect(Q,Q,w,A),H.fillText(l,Q,Q+v);const Ce=H.getImageData(Q,Q,w,A);ge.fill(Sf,0,k),ce.fill(0,0,k);for(let Pe=0;Pe<A;Pe++)for(let De=0;De<w;De++){const Le=Ce.data[4*(Pe*w+De)+3]/255;if(Le===0)continue;const je=(Pe+Q)*C+De+Q;if(Le===1)ge[je]=0,ce[je]=Sf;else{const qe=.5-Le;ge[je]=qe>0?qe*qe:0,ce[je]=qe<0?qe*qe:0}}eT(ge,0,0,C,D,C,this.f,this.v,this.z),eT(ce,Q,Q,w,A,C,this.f,this.v,this.z);for(let Pe=0;Pe<k;Pe++){const De=Math.sqrt(ge[Pe])-Math.sqrt(ce[Pe]);F[Pe]=Math.round(255-255*(De/this.radius+this.cutoff))}return V}};class sk{constructor(i=[],c=ok){if(this.data=i,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:c,compare:h}=this,p=c[i];for(;i>0;){const _=i-1>>1,v=c[_];if(h(p,v)>=0)break;c[i]=v,i=_}c[i]=p}_down(i){const{data:c,compare:h}=this,p=this.length>>1,_=c[i];for(;i<p;){let v=1+(i<<1),w=c[v];const A=v+1;if(A<this.length&&h(c[A],w)<0&&(v=A,w=c[A]),h(w,_)>=0)break;c[i]=w,i=v}c[i]=_}}function ok(l,i){return l<i?-1:l>i?1:0}function ak(l,i=1,c=!1){let h=1/0,p=1/0,_=-1/0,v=-1/0;const w=l[0];for(let V=0;V<w.length;V++){const H=w[V];(!V||H.x<h)&&(h=H.x),(!V||H.y<p)&&(p=H.y),(!V||H.x>_)&&(_=H.x),(!V||H.y>v)&&(v=H.y)}const A=Math.min(_-h,v-p);let C=A/2;const D=new sk([],lk);if(A===0)return new S(h,p);for(let V=h;V<_;V+=A)for(let H=p;H<v;H+=A)D.push(new mh(V+C,H+C,C,l));let k=function(V){let H=0,Q=0,ce=0;const ge=V[0];for(let Ce=0,Pe=ge.length,De=Pe-1;Ce<Pe;De=Ce++){const Le=ge[Ce],je=ge[De],qe=Le.x*je.y-je.x*Le.y;Q+=(Le.x+je.x)*qe,ce+=(Le.y+je.y)*qe,H+=3*qe}return new mh(Q/H,ce/H,0,V)}(l),F=D.length;for(;D.length;){const V=D.pop();(V.d>k.d||!k.d)&&(k=V,c&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,F)),V.max-k.d<=i||(C=V.h/2,D.push(new mh(V.p.x-C,V.p.y-C,C,l)),D.push(new mh(V.p.x+C,V.p.y-C,C,l)),D.push(new mh(V.p.x-C,V.p.y+C,C,l)),D.push(new mh(V.p.x+C,V.p.y+C,C,l)),F+=4)}return c&&(console.log(`num probes: ${F}`),console.log(`best distance: ${k.d}`)),k.p}function lk(l,i){return i.max-l.max}function mh(l,i,c,h){this.p=new S(l,i),this.h=c,this.d=function(p,_){let v=!1,w=1/0;for(let A=0;A<_.length;A++){const C=_[A];for(let D=0,k=C.length,F=k-1;D<k;F=D++){const V=C[D],H=C[F];V.y>p.y!=H.y>p.y&&p.x<(H.x-V.x)*(p.y-V.y)/(H.y-V.y)+V.x&&(v=!v),w=Math.min(w,Xw(p,V,H))}}return(v?1:-1)*Math.sqrt(w)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const x0=Number.POSITIVE_INFINITY,ck=Math.sqrt(2);function nT(l,i){return i[1]!==x0?function(c,h,p){let _=0,v=0;switch(h=Math.abs(h),p=Math.abs(p),c){case"top-right":case"top-left":case"top":v=p-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-p}switch(c){case"top-right":case"bottom-right":case"right":_=-h;break;case"top-left":case"bottom-left":case"left":_=h}return[_,v]}(l,i[0],i[1]):function(c,h){let p=0,_=0;h<0&&(h=0);const v=h/ck;switch(c){case"top-right":case"top-left":_=v-7;break;case"bottom-right":case"bottom-left":_=7-v;break;case"bottom":_=7-h;break;case"top":_=h-7}switch(c){case"top-right":case"bottom-right":p=-v;break;case"top-left":case"bottom-left":p=v;break;case"left":p=h;break;case"right":p=-h}return[p,_]}(l,i[0])}function uk(l,i,c,h,p,_,v,w,A,C){l.createArrays(),l.tilePixelRatio=nr/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const D=l.layers[0].layout,k=l.layers[0]._unevaluatedLayout._values,F={};if(l.textSizeData.kind==="composite"){const{minZoom:Q,maxZoom:ce}=l.textSizeData;F.compositeTextSizes=[k["text-size"].possiblyEvaluate(new he(Q),w),k["text-size"].possiblyEvaluate(new he(ce),w)]}if(l.iconSizeData.kind==="composite"){const{minZoom:Q,maxZoom:ce}=l.iconSizeData;F.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new he(Q),w),k["icon-size"].possiblyEvaluate(new he(ce),w)]}F.layoutTextSize=k["text-size"].possiblyEvaluate(new he(A+1),w),F.layoutIconSize=k["icon-size"].possiblyEvaluate(new he(A+1),w),F.textMaxSize=k["text-size"].possiblyEvaluate(new he(18),w);const V=D.get("text-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",H=D.get("text-size");for(const Q of l.features){const ce=D.get("text-font").evaluate(Q,{},w).join(","),ge=H.evaluate(Q,{},w),Ce=F.layoutTextSize.evaluate(Q,{},w),Pe=(F.layoutIconSize.evaluate(Q,{},w),{horizontal:{},vertical:void 0}),De=Q.text;let Le,je=[0,0];if(De){const at=De.toString(),vt=D.get("text-letter-spacing").evaluate(Q,{},w)*an,Ue=D.get("text-line-height").evaluate(Q,{},w)*an,nt=ih(at)?vt:0,xt=D.get("text-anchor").evaluate(Q,{},w),bt=D.get("text-variable-anchor");if(!bt){const er=D.get("text-radial-offset").evaluate(Q,{},w);je=er?nT(xt,[er*an,x0]):D.get("text-offset").evaluate(Q,{},w).map(Ut=>Ut*an)}let Bt=V?"center":D.get("text-justify").evaluate(Q,{},w);const _t=D.get("symbol-placement"),kt=_t==="point",gr=_t==="point"?D.get("text-max-width").evaluate(Q,{},w)*an:0,vr=er=>{l.allowVerticalPlacement&&rh(at)&&(Pe.vertical=g0(De,i,c,p,ce,gr,Ue,xt,er,nt,je,ms.vertical,!0,_t,Ce,ge))};if(!V&&bt){const er=Bt==="auto"?bt.map(Er=>b0(Er)):[Bt];let Ut=!1;for(let Er=0;Er<er.length;Er++){const yr=er[Er];if(!Pe.horizontal[yr])if(Ut)Pe.horizontal[yr]=Pe.horizontal[0];else{const Kt=g0(De,i,c,p,ce,gr,Ue,"center",yr,nt,je,ms.horizontal,!1,_t,Ce,ge);Kt&&(Pe.horizontal[yr]=Kt,Ut=Kt.positionedLines.length===1)}}vr("left")}else{if(Bt==="auto"&&(Bt=b0(xt)),kt||D.get("text-writing-mode").indexOf("horizontal")>=0||!rh(at)){const er=g0(De,i,c,p,ce,gr,Ue,xt,Bt,nt,je,ms.horizontal,!1,_t,Ce,ge);er&&(Pe.horizontal[Bt]=er)}vr(_t==="point"?"left":Bt)}}let qe=!1;if(Q.icon&&Q.icon.name){const at=h[Q.icon.name];at&&(Le=tk(p[Q.icon.name],D.get("icon-offset").evaluate(Q,{},w),D.get("icon-anchor").evaluate(Q,{},w)),qe=at.sdf,l.sdfIcons===void 0?l.sdfIcons=at.sdf:l.sdfIcons!==at.sdf&&Nt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(at.pixelRatio!==l.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const Xe=oT(Pe.horizontal)||Pe.vertical;l.iconsInText||(l.iconsInText=!!Xe&&Xe.iconsInText),(Xe||Le)&&hk(l,Q,Pe,Le,h,F,Ce,0,je,qe,v,w,C)}_&&l.generateCollisionDebugBuffers(A,l.collisionBoxArray)}function b0(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function hk(l,i,c,h,p,_,v,w,A,C,D,k,F){let V=_.textMaxSize.evaluate(i,{},k);V===void 0&&(V=v);const H=l.layers[0].layout,Q=H.get("icon-offset").evaluate(i,{},k),ce=oT(c.horizontal)||c.vertical,ge=F.name==="globe",Ce=v/24,Pe=l.tilePixelRatio*V/24,De=(nt=l.overscaling,l.zoom>18&&nt>2&&(nt>>=1),Math.max(nr/(512*nt),1)*H.get("symbol-spacing")),Le=H.get("text-padding")*l.tilePixelRatio,je=H.get("icon-padding")*l.tilePixelRatio,qe=z(H.get("text-max-angle")),Xe=H.get("text-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",at=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",vt=H.get("symbol-placement"),Ue=De/2;var nt;const xt=H.get("icon-text-fit");let bt;h&&xt!=="none"&&(l.allowVerticalPlacement&&c.vertical&&(bt=ZE(h,c.vertical,xt,H.get("icon-text-fit-padding"),Q,Ce)),ce&&(h=ZE(h,ce,xt,H.get("icon-text-fit-padding"),Q,Ce)));const Bt=(_t,kt,gr)=>{if(kt.x<0||kt.x>=nr||kt.y<0||kt.y>=nr)return;let vr=null;if(ge){const{x:er,y:Ut,z:Er}=F.projectTilePoint(kt.x,kt.y,gr);vr={anchor:new la(er,Ut,Er,0,void 0),up:F.upVector(gr,kt.x,kt.y)}}(function(er,Ut,Er,yr,Kt,Bi,Ai,yi,Tr,Lr,ti,Jr,Zr,ni,hi,Xi,zn,Pr,vi,pn,Vr,di,An,li,Pi){const Yi=er.addToLineVertexArray(Ut,yr);let Hi,ln,Pn,Ji,ca,vh,Lf,kf=0,UT=0,GT=0,HT=0,B0=-1,N0=-1;const Io={};let WT=cf("");const Cc=Er?Er.anchor:Ut;let j0=0,$0=0;if(Tr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[j0,$0]=Tr.layout.get("text-offset").evaluate(Vr,{},Pi).map(rs=>rs*an):(j0=Tr.layout.get("text-radial-offset").evaluate(Vr,{},Pi)*an,$0=x0),er.allowVerticalPlacement&&Kt.vertical){const rs=Kt.vertical;if(hi)vh=w0(rs),yi&&(Lf=w0(yi));else{const is=Tr.layout.get("text-rotate").evaluate(Vr,{},Pi)+90;Pn=Sg(Lr,Cc,Ut,ti,Jr,Zr,rs,ni,is,Xi),yi&&(Ji=Sg(Lr,Cc,Ut,ti,Jr,Zr,yi,Pr,is))}}if(Bi){const rs=Tr.layout.get("icon-rotate").evaluate(Vr,{},Pi),is=Tr.layout.get("icon-text-fit")!=="none",zf=rT(Bi,rs,An,is),U0=yi?rT(yi,rs,An,is):void 0;ln=Sg(Lr,Cc,Ut,ti,Jr,Zr,Bi,Pr,rs),kf=4*zf.length;const ZT=er.iconSizeData;let Ic=null;ZT.kind==="source"?(Ic=[To*Tr.layout.get("icon-size").evaluate(Vr,{},Pi)],Ic[0]>nl&&Nt(`${er.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):ZT.kind==="composite"&&(Ic=[To*di.compositeIconSizes[0].evaluate(Vr,{},Pi),To*di.compositeIconSizes[1].evaluate(Vr,{},Pi)],(Ic[0]>nl||Ic[1]>nl)&&Nt(`${er.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),er.addSymbols(er.icon,zf,Ic,pn,vi,Vr,!1,Er,Ut,Yi.lineStartIndex,Yi.lineLength,-1,li,Pi),B0=er.icon.placedSymbolArray.length-1,U0&&(UT=4*U0.length,er.addSymbols(er.icon,U0,Ic,pn,vi,Vr,ms.vertical,Er,Ut,Yi.lineStartIndex,Yi.lineLength,-1,li,Pi),N0=er.icon.placedSymbolArray.length-1)}for(const rs in Kt.horizontal){const is=Kt.horizontal[rs];Hi||(WT=cf(is.text),hi?ca=w0(is):Hi=Sg(Lr,Cc,Ut,ti,Jr,Zr,is,ni,Tr.layout.get("text-rotate").evaluate(Vr,{},Pi),Xi));const zf=is.positionedLines.length===1;if(GT+=sT(er,Er,Ut,is,Ai,Tr,hi,Vr,Xi,Yi,Kt.vertical?ms.horizontal:ms.horizontalOnly,zf?Object.keys(Kt.horizontal):[rs],Io,B0,di,li,Pi),zf)break}Kt.vertical&&(HT+=sT(er,Er,Ut,Kt.vertical,Ai,Tr,hi,Vr,Xi,Yi,ms.vertical,["vertical"],Io,N0,di,li,Pi));let ul=-1;const V0=(rs,is)=>rs?Math.max(rs,is):is;ul=V0(ca,ul),ul=V0(vh,ul),ul=V0(Lf,ul);const Uk=ul>-1?1:0;er.glyphOffsetArray.length>=ol.MAX_GLYPHS&&Nt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Vr.sortKey!==void 0&&er.addToSortKeyRanges(er.symbolInstances.length,Vr.sortKey),er.symbolInstances.emplaceBack(Cc.x,Cc.y,Cc.z,Ut.x,Ut.y,Io.right>=0?Io.right:-1,Io.center>=0?Io.center:-1,Io.left>=0?Io.left:-1,Io.vertical>=0?Io.vertical:-1,B0,N0,WT,Hi!==void 0?Hi:er.collisionBoxArray.length,Hi!==void 0?Hi+1:er.collisionBoxArray.length,Pn!==void 0?Pn:er.collisionBoxArray.length,Pn!==void 0?Pn+1:er.collisionBoxArray.length,ln!==void 0?ln:er.collisionBoxArray.length,ln!==void 0?ln+1:er.collisionBoxArray.length,Ji||er.collisionBoxArray.length,Ji?Ji+1:er.collisionBoxArray.length,ti,GT,HT,kf,UT,Uk,0,j0,$0,ul)})(l,kt,vr,_t,c,h,p,bt,l.layers[0],l.collisionBoxArray,i.index,i.sourceLayerIndex,l.index,Le,Xe,A,0,je,at,Q,i,_,C,D,k)};if(vt==="line")for(const _t of QE(i.geometry,0,0,nr,nr)){const kt=ik(_t,De,qe,c.vertical||ce,h,24,Pe,l.overscaling,nr);for(const gr of kt){const vr=ce;vr&&dk(l,vr.text,Ue,gr)||Bt(_t,gr,k)}}else if(vt==="line-center"){for(const _t of i.geometry)if(_t.length>1){const kt=rk(_t,qe,c.vertical||ce,h,24,Pe);kt&&Bt(_t,kt,k)}}else if(i.type==="Polygon")for(const _t of c0(i.geometry,0)){const kt=ak(_t,16);Bt(_t[0],new la(kt.x,kt.y,0,0,void 0),k)}else if(i.type==="LineString")for(const _t of i.geometry)Bt(_t,new la(_t[0].x,_t[0].y,0,0,void 0),k);else if(i.type==="Point")for(const _t of i.geometry)for(const kt of _t)Bt([kt],new la(kt.x,kt.y,0,0,void 0),k)}const nl=32640;function sT(l,i,c,h,p,_,v,w,A,C,D,k,F,V,H,Q,ce){const ge=function(De,Le,je,qe,Xe,at,vt,Ue){const nt=[];if(Le.positionedLines.length===0)return nt;const xt=qe.layout.get("text-rotate").evaluate(at,{})*Math.PI/180,bt=function(vr){const er=vr[0],Ut=vr[1],Er=er*Ut;return Er>0?[er,-Ut]:Er<0?[-er,Ut]:er===0?[Ut,er]:[Ut,-er]}(je);let Bt=Math.abs(Le.top-Le.bottom);for(const vr of Le.positionedLines)Bt-=vr.lineOffset;const _t=Le.positionedLines.length,kt=Bt/_t;let gr=Le.top-je[1];for(let vr=0;vr<_t;++vr){const er=Le.positionedLines[vr];gr=nk(Le,kt,gr,vr);for(const Ut of er.positionedGlyphs){if(!Ut.rect)continue;const Er=Ut.rect||{};let yr=4,Kt=!0,Bi=1,Ai=0;if(Ut.imageName){const li=vt[Ut.imageName];if(!li)continue;if(li.sdf){Nt("SDF images are not supported in formatted text and will be ignored.");continue}Kt=!1,Bi=li.pixelRatio,yr=1/Bi}const yi=(Xe||Ue)&&Ut.vertical,Tr=Ut.metrics.advance*Ut.scale/2,Lr=Ut.metrics,ti=Ut.rect;if(ti===null)continue;Ue&&Le.verticalizable&&(Ai=Ut.imageName?Tr-Ut.metrics.width*Ut.scale/2:0);const Jr=Xe?[Ut.x+Tr,Ut.y]:[0,0];let Zr=[0,0],ni=[0,0],hi=!1;Xe||(yi?(ni=[Ut.x+Tr+bt[0],Ut.y+bt[1]-Ai],hi=!0):Zr=[Ut.x+Tr+je[0],Ut.y+je[1]-Ai]);const Xi=ti.w*Ut.scale/(Bi*(Ut.localGlyph?2:1)),zn=ti.h*Ut.scale/(Bi*(Ut.localGlyph?2:1));let Pr,vi,pn,Vr;if(yi){const li=Ut.y-gr,Pi=new S(-Tr,Tr-li),Yi=-Math.PI/2,Hi=new S(...ni);Pr=new S(-Tr+Zr[0],Zr[1]),Pr._rotateAround(Yi,Pi)._add(Hi),Pr.x+=-li+Tr,Pr.y-=(Lr.left-yr)*Ut.scale;const ln=Ut.imageName?Lr.advance*Ut.scale:an*Ut.scale,Pn=String.fromCharCode(Ut.glyph);NL(Pn)?Pr.x+=(1-yr)*Ut.scale:jL(Pn)?Pr.x+=ln-Lr.height*Ut.scale+(-yr-1)*Ut.scale:Pr.x+=Ut.imageName||Lr.width+2*yr===ti.w&&Lr.height+2*yr===ti.h?(ln-zn)/2:(ln-(Lr.height+2*yr)*Ut.scale)/2,vi=new S(Pr.x,Pr.y-Xi),pn=new S(Pr.x+zn,Pr.y),Vr=new S(Pr.x+zn,Pr.y-Xi)}else{const li=(Lr.left-yr)*Ut.scale-Tr+Zr[0],Pi=(-Lr.top-yr)*Ut.scale+Zr[1],Yi=li+Xi,Hi=Pi+zn;Pr=new S(li,Pi),vi=new S(Yi,Pi),pn=new S(li,Hi),Vr=new S(Yi,Hi)}if(xt){let li;li=Xe?new S(0,0):hi?new S(bt[0],bt[1]):new S(je[0],je[1]),Pr._rotateAround(xt,li),vi._rotateAround(xt,li),pn._rotateAround(xt,li),Vr._rotateAround(xt,li)}const di=new S(0,0),An=new S(0,0);nt.push({tl:Pr,tr:vi,bl:pn,br:Vr,tex:Er,writingMode:Le.writingMode,glyphOffset:Jr,sectionIndex:Ut.sectionIndex,isSDF:Kt,pixelOffsetTL:di,pixelOffsetBR:An,minFontScaleX:0,minFontScaleY:0})}}return nt}(0,h,A,_,v,w,p,l.allowVerticalPlacement),Ce=l.textSizeData;let Pe=null;Ce.kind==="source"?(Pe=[To*_.layout.get("text-size").evaluate(w,{},ce)],Pe[0]>nl&&Nt(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ce.kind==="composite"&&(Pe=[To*H.compositeTextSizes[0].evaluate(w,{},ce),To*H.compositeTextSizes[1].evaluate(w,{},ce)],(Pe[0]>nl||Pe[1]>nl)&&Nt(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,ge,Pe,A,v,w,D,i,c,C.lineStartIndex,C.lineLength,V,Q,ce);for(const De of k)F[De]=l.text.placedSymbolArray.length-1;return 4*ge.length}function oT(l){for(const i in l)return l[i];return null}function Sg(l,i,c,h,p,_,v,w,A,C){let D=v.top,k=v.bottom,F=v.left,V=v.right;const H=v.collisionPadding;if(H&&(F-=H[0],D-=H[1],V+=H[2],k+=H[3]),A){const Q=new S(F,D),ce=new S(V,D),ge=new S(F,k),Ce=new S(V,k),Pe=z(A);let De=new S(0,0);C&&(De=new S(C[0],C[1])),Q._rotateAround(Pe,De),ce._rotateAround(Pe,De),ge._rotateAround(Pe,De),Ce._rotateAround(Pe,De),F=Math.min(Q.x,ce.x,ge.x,Ce.x),V=Math.max(Q.x,ce.x,ge.x,Ce.x),D=Math.min(Q.y,ce.y,ge.y,Ce.y),k=Math.max(Q.y,ce.y,ge.y,Ce.y)}return l.emplaceBack(i.x,i.y,i.z,c.x,c.y,F,D,V,k,w,h,p,_),l.length-1}function w0(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const i=l.bottom-l.top;return i>0?Math.max(10,i):null}function dk(l,i,c,h){const p=l.compareText;if(i in p){const _=p[i];for(let v=_.length-1;v>=0;v--)if(h.dist(_[v])<c)return!0}else p[i]=[];return p[i].push(h),!1}const fk=Pt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),{members:aT}=fk,lT=Pt([{name:"a_pos_3",components:3,type:"Int16"}]);var Af=Pt([{name:"a_pos",type:"Int16",components:2}]);const Sc=nr/Math.PI/2,E0=2*Ls(1,0)*Sc*Math.PI,gh=[64,32,16],es=-Sc,ts=Sc,pk=[new ps([es,es,es],[ts,ts,ts]),new ps([es,es,es],[0,0,ts]),new ps([0,es,es],[ts,0,ts]),new ps([es,0,es],[0,ts,ts]),new ps([0,0,es],[ts,ts,ts])];function cT(l,i,c,h=!0){const p=Eo([],l._camera.position,l.worldSize),_=[i,c,1,1];Ec(_,_,l.pixelMatrixInverse),oE(_,_,1/_[3]);const v=En([],zs([],_,p)),w=l.globeMatrix,A=[w[12],w[13],w[14]],C=zs([],A,p),D=hf(C),k=En([],C),F=l.worldSize/(2*Math.PI),V=ks(k,v),H=Math.asin(F/D);if(H<Math.acos(V)){if(!h)return null;const vt=[],Ue=[];Eo(vt,v,D/V),En(Ue,zs(Ue,vt,C)),En(v,rl(v,C,Eo(v,Ue,Math.tan(H)*D)))}const Q=[];new t0(p,v).closestPointOnSphere(A,F,Q);const ce=En([],Zt(w,0)),ge=En([],Zt(w,1)),Ce=En([],Zt(w,2)),Pe=ks(ce,Q),De=ks(ge,Q),Le=ks(Ce,Q),je=B(Math.asin(-De/F));let qe=B(Math.atan2(Pe,Le));qe=l.center.lng+function(vt,Ue){const nt=(Ue-vt+180)%360-180;return nt<-180?nt+360:nt}(l.center.lng,qe);const Xe=yc(qe),at=X(vc(je),0,1);return new sh(Xe,at)}class mk{constructor(i,c,h){this.a=zs([],i,h),this.b=zs([],c,h),this.center=h;const p=En([],this.a),_=En([],this.b);this.angle=Math.acos(ks(p,_))}}function T0(l,i){if(l.angle===0)return null;let c;return c=l.a[i]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[i]/l.a[i]/Math.sin(l.angle)-1/Math.tan(l.angle)),c<0||c>1?null:function(h,p,_,v){const w=Math.sin(_);return h*(Math.sin((1-v)*_)/w)+p*(Math.sin(v*_)/w)}(l.a[i],l.b[i],l.angle,X(c,0,1))+l.center[i]}function So(l){if(l.z<=1)return pk[l.z+2*l.y+l.x];const[i,c]=S0(l),h=[Sn(i[0],i[1]),Sn(i[0],c[1]),Sn(c[0],i[1]),Sn(c[0],c[1])],p=[ts,ts,ts],_=[es,es,es];for(const v of h)p[0]=Math.min(p[0],v[0]),p[1]=Math.min(p[1],v[1]),p[2]=Math.min(p[2],v[2]),_[0]=Math.max(_[0],v[0]),_[1]=Math.max(_[1],v[1]),_[2]=Math.max(_[2],v[2]);return new ps(p,_)}function gk(l,i,c){const h=i/l.worldSize,p=Number.MAX_VALUE,_=[-p,-p,-p],v=[p,p,p],w=Jn(new Float64Array(16));if(wo(w,w,[h,h,h]),tl(w,w,l.globeMatrix),c.z<=1){const Ue=So(c).getCorners();for(let nt=0;nt<Ue.length;nt++)on(Ue[nt],Ue[nt],w),og(v,v,Ue[nt]),ag(_,_,Ue[nt]);return new ps(v,_)}const[A,C]=S0(c),D=new el;D.setSouthWest([A[1],C[0]]),D.setNorthEast([C[1],A[0]]);const k=[Sn(D.getSouth(),D.getWest()),Sn(D.getSouth(),D.getEast()),Sn(D.getNorth(),D.getEast()),Sn(D.getNorth(),D.getWest())];for(let Ue=0;Ue<k.length;Ue++)on(k[Ue],k[Ue],w),og(v,v,k[Ue]),ag(_,_,k[Ue]);if(D.contains(l.center)){_[2]=0;const Ue=l.point,nt=[Ue.x*h,Ue.y*h,0];return og(v,v,nt),ag(_,_,nt),new ps(v,_)}const F=[w[12],w[13],w[14]],V=l.center.lng,H=X(l.center.lat,-85.051129,bo),Q=[yc(V),vc(H)],ce=D.getCenter().lng,ge=X(D.getCenter().lat,-85.051129,bo),Ce=[yc(ce),vc(ge)];let Pe=new Array(3),De=0,Le=Q[0]-Ce[0];const je=Q[1]-Ce[1];if(Le>.5?Le-=1:Le<-.5&&(Le+=1),Math.abs(Le)>Math.abs(je))De=Le>=0?1:3,Pe=F;else{De=je>=0?0:2;const Ue=[w[4],w[5],w[6]];let nt;nt=je>=0?-Math.sin(z(D.getSouth()))*Sc:-Math.sin(z(D.getNorth()))*Sc,Pe=lg(Pe,F,Ue,nt)}const qe=k[De],Xe=k[(De+1)%4],at=new mk(qe,Xe,Pe),vt=[T0(at,0)||qe[0],T0(at,1)||qe[1],T0(at,2)||qe[2]];return v[2]=Math.min(qe[2],Xe[2]),og(v,v,vt),ag(_,_,vt),new ps(v,_)}function S0(l){const i=1<<l.z,c=l.x/i,h=(l.x+1)/i,p=(l.y+1)/i;return[[Fi(l.y/i),wn(c)],[Fi(p),wn(h)]]}function uT(l,i,c,h=Sc){return c=z(c),[l*Math.sin(c)*h,-i*h,l*Math.cos(c)*h]}function Sn(l,i,c){return uT(Math.cos(z(l)),Math.sin(z(l)),i,c)}function hT(l,i,c){const h=Math.pow(2,c.z),p=(l/nr+c.x)/h;return Sn(Fi((i/nr+c.y)/h),wn(p))}function Ag(l){return 16383/Math.max(...zs([],l.max,l.min))}function Pf(l){const i=Jn(new Float64Array(16)),c=Ag(l);var h,p;return wo(i,i,[c,c,c]),wc(i,i,((h=[])[0]=-(p=l.min)[0],h[1]=-p[1],h[2]=-p[2],h)),i}function dT(l){const i=Jn(new Float64Array(16)),c=1/Ag(l);return wc(i,i,l.min),wo(i,i,[c,c,c]),i}function fT(l,i,c,h,p){const _=function(A){const C=nr/(2*Math.PI);return A/(2*Math.PI)/C}(c),v=[l,i,-c/(2*Math.PI)],w=Jn(new Float64Array(16));return wc(w,w,v),wo(w,w,[_,_,_]),ng(w,w,z(-p)),sg(w,w,z(-h)),w}function A0(l){return re(5,6,l)}function pT(l,i){const c=Sn(i.lat,i.lng);return _=(h=Qv([],function(V){const H=Sn(V._center.lat,V._center.lng);let Q=e0([],ah(0,1,0),H);const ce=rE([],-V.angle,H);Q=on(Q,Q,ce),rE(ce,-V._pitch,Q);const ge=En([],H);return Eo(ge,ge,V.cameraToCenterDistance/V.pixelsPerMeter*E0),on(ge,ge,ce),rl([],H,ge)}(l),c))[0],v=h[1],w=h[2],A=(p=c)[0],C=p[1],D=p[2],F=(k=Math.sqrt(_*_+v*v+w*w)*Math.sqrt(A*A+C*C+D*D))&&ks(h,p)/k,Math.acos(Math.min(Math.max(F,-1),1));var h,p,_,v,w,A,C,D,k,F}const mT=z(85),_k=Math.cos(mT),yk=Math.sin(mT);function gT(l,i){const c=l.fovAboveCenter,h=l.elevation?l.elevation.getMinElevationBelowMSL()*i:0,p=(l._camera.position[2]*l.worldSize-h)/Math.cos(l._pitch),_=Math.sin(c)*p/Math.sin(Math.max(Math.PI/2-l._pitch-c,.01)),v=Math.sin(l._pitch)*_+p;return Math.min(1.01*v,p*(1/l._horizonShift))}function Ac(l,i){if(!i.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:i};const c=Math.pow(2,-l.z),h=l.x*c,p=(l.x+1)*c,_=l.y*c,v=(l.y+1)*c,w=wn(h),A=wn(p),C=Fi(_),D=Fi(v),k=i.project(w,C),F=i.project(A,C),V=i.project(A,D),H=i.project(w,D);let Q=Math.min(k.x,F.x,V.x,H.x),ce=Math.min(k.y,F.y,V.y,H.y),ge=Math.max(k.x,F.x,V.x,H.x),Ce=Math.max(k.y,F.y,V.y,H.y);const Pe=c/16;function De(je,qe,Xe,at,vt,Ue){const nt=(Xe+vt)/2,xt=(at+Ue)/2,bt=i.project(wn(nt),Fi(xt)),Bt=Math.max(0,Q-bt.x,ce-bt.y,bt.x-ge,bt.y-Ce);Q=Math.min(Q,bt.x),ge=Math.max(ge,bt.x),ce=Math.min(ce,bt.y),Ce=Math.max(Ce,bt.y),Bt>Pe&&(De(je,bt,Xe,at,nt,xt),De(bt,qe,nt,xt,vt,Ue))}De(k,F,h,_,p,_),De(F,V,p,_,p,v),De(V,H,p,v,h,v),De(H,k,h,v,h,_),Q-=Pe,ce-=Pe,ge+=Pe,Ce+=Pe;const Le=1/Math.max(ge-Q,Ce-ce);return{scale:Le,x:Q*Le,y:ce*Le,x2:ge*Le,y2:Ce*Le,projection:i}}const vk=Jn(new Float32Array(16));class sl{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,c){return{x:0,y:0,z:0}}unproject(i,c){return new Wr(0,0)}projectTilePoint(i,c,h){return{x:i,y:c,z:0}}locationPoint(i,c,h=!0){return i._coordinatePoint(i.locationCoordinate(c),h)}pixelsPerMeter(i,c){return Ls(1,i)*c}pixelSpaceConversion(i,c,h){return 1}farthestPixelDistance(i){return gT(i,i.pixelsPerMeter)}pointCoordinate(i,c,h,p){const _=i.horizonLineFromTop(!1),v=new S(c,Math.max(_,h));return i.rayIntersectionCoordinate(i.pointRayIntersection(v,p))}pointCoordinate3D(i,c,h){const p=new S(c,h);if(i.elevation)return i.elevation.pointCoordinate(p);{const _=this.pointCoordinate(i,p.x,p.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(i,c){if(i.elevation)return!this.pointCoordinate3D(i,c.x,c.y);const h=i.horizonLineFromTop();return c.y<h}createInversionMatrix(i,c){return vk}createTileMatrix(i,c,h){let p,_,v;const w=h.canonical,A=Jn(new Float64Array(16));if(this.isReprojectedInTileSpace){const C=Ac(w,this);p=1,_=C.x+h.wrap*C.scale,v=C.y,wo(A,A,[p/C.scale,p/C.scale,i.pixelsPerMeter/c])}else p=c/i.zoomScale(w.z),_=(w.x+Math.pow(2,w.z)*h.wrap)*p,v=w.y*p;return wc(A,A,[_,v,0]),wo(A,A,[p/nr,p/nr,1]),A}upVector(i,c,h){return[0,0,1]}upVectorScale(i,c,h){return{metersToTile:1}}}class xk extends sl{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[c,h]=this.parallels=i.parallels||[29.5,45.5],p=Math.sin(z(c));this.n=(p+Math.sin(z(h)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(i,c){const{n:h,c:p,r0:_}=this,v=z(i-this.center[0]),w=z(c),A=Math.sqrt(p-2*h*Math.sin(w))/h;return{x:A*Math.sin(v*h),y:A*Math.cos(v*h)-_,z:0}}unproject(i,c){const{n:h,c:p,r0:_}=this,v=_+c;let w=Math.atan2(i,Math.abs(v))*Math.sign(v);v*h<0&&(w-=Math.PI*Math.sign(i)*Math.sign(v));const A=z(this.center[0])*h;w=ue(w,-Math.PI-A,Math.PI-A);const C=B(w/h)+this.center[0],D=Math.asin(X((p-(i*i+v*v)*h*h)/(2*h),-1,1)),k=X(B(D),-85.051129,bo);return new Wr(C,k)}}const Cf=1.340264,If=-.081106,Mf=893e-6,Of=.003796,Pg=Math.sqrt(3)/2;class bk extends sl{project(i,c){c=c/180*Math.PI,i=i/180*Math.PI;const h=Math.asin(Pg*Math.sin(c)),p=h*h,_=p*p*p;return{x:.5*(i*Math.cos(h)/(Pg*(Cf+3*If*p+_*(7*Mf+9*Of*p)))/Math.PI+.5),y:1-.5*(h*(Cf+If*p+_*(Mf+Of*p))/Math.PI+1),z:0}}unproject(i,c){i=(2*i-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,p=h*h,_=p*p*p;for(let D,k,F,V=0;V<12&&(k=h*(Cf+If*p+_*(Mf+Of*p))-c,F=Cf+3*If*p+_*(7*Mf+9*Of*p),D=k/F,h=X(h-D,-Math.PI/3,Math.PI/3),p=h*h,_=p*p*p,!(Math.abs(D)<1e-12));++V);const v=Pg*i*(Cf+3*If*p+_*(7*Mf+9*Of*p))/Math.cos(h),w=Math.asin(Math.sin(h)/Pg),A=X(180*v/Math.PI,-180,180),C=X(180*w/Math.PI,-85.051129,bo);return new Wr(A,C)}}class wk extends sl{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,c){return{x:.5+i/360,y:.5-c/360,z:0}}unproject(i,c){const h=360*(i-.5),p=X(360*(.5-c),-85.051129,bo);return new Wr(h,p)}}const _h=Math.PI/2;function Cg(l){return Math.tan((_h+l)/2)}class Ek extends sl{constructor(i){super(i),this.center=i.center||[0,30];const[c,h]=this.parallels=i.parallels||[30,30],p=z(c),_=z(h),v=Math.cos(p);this.n=p===_?Math.sin(p):Math.log(v/Math.cos(_))/Math.log(Cg(_)/Cg(p)),this.f=v*Math.pow(Cg(p),this.n)/this.n}project(i,c){c=z(c),i=z(i-this.center[0]);const h=1e-6,{n:p,f:_}=this;_>0?c<-_h+h&&(c=-_h+h):c>_h-h&&(c=_h-h);const v=_/Math.pow(Cg(c),p),w=v*Math.sin(p*i),A=_-v*Math.cos(p*i);return{x:.5*(w/Math.PI+.5),y:1-.5*(A/Math.PI+.5),z:0}}unproject(i,c){i=(2*i-.5)*Math.PI,c=(2*(1-c)-.5)*Math.PI;const{n:h,f:p}=this,_=p-c,v=Math.sign(_),w=Math.sign(h)*Math.sqrt(i*i+_*_);let A=Math.atan2(i,Math.abs(_))*v;_*h<0&&(A-=Math.PI*Math.sign(i)*v);const C=X(B(A/h)+this.center[0],-180,180),D=X(B(2*Math.atan(Math.pow(p/w,1/h))-_h),-85.051129,bo);return new Wr(C,D)}}class _T extends sl{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,c){return{x:yc(i),y:vc(c),z:0}}unproject(i,c){const h=wn(i),p=Fi(c);return new Wr(h,p)}}const yT=z(bo);class Tk extends sl{project(i,c){const h=(c=z(c))*c,p=h*h;return{x:.5*((i=z(i))*(.8707-.131979*h+p*(p*(.003971*h-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+h*(.015085+p*(.028874*h-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(i,c){i=(2*i-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,p=25,_=0,v=h*h;do{v=h*h;const C=v*v;_=(h*(1.007226+v*(.015085+C*(.028874*v-.044475-.005916*C)))-c)/(1.007226+v*(.045255+C*(.259866*v-.311325-.005916*11*C))),h=X(h-_,-yT,yT)}while(Math.abs(_)>1e-6&&--p>0);v=h*h;const w=X(B(i/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),A=B(h);return new Wr(w,A)}}const vT=z(bo);class Sk extends sl{project(i,c){c=z(c),i=z(i);const h=Math.cos(c),p=2/Math.PI,_=Math.acos(h*Math.cos(i/2)),v=Math.sin(_)/_,w=.5*(i*p+2*h*Math.sin(i/2)/v)||0,A=.5*(c+Math.sin(c)/v)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(i,c){let h=i=(2*i-.5)*Math.PI,p=c=(2*(1-c)-1)*Math.PI,_=25;const v=1e-6;let w=0,A=0;do{const C=Math.cos(p),D=Math.sin(p),k=2*D*C,F=D*D,V=C*C,H=Math.cos(h/2),Q=Math.sin(h/2),ce=2*H*Q,ge=Q*Q,Ce=1-V*H*H,Pe=Ce?1/Ce:0,De=Ce?Math.acos(C*H)*Math.sqrt(1/Ce):0,Le=.5*(2*De*C*Q+2*h/Math.PI)-i,je=.5*(De*D+p)-c,qe=.5*Pe*(V*ge+De*C*H*F)+1/Math.PI,Xe=Pe*(ce*k/4-De*D*Q),at=.125*Pe*(k*Q-De*D*V*ce),vt=.5*Pe*(F*H+De*ge*C)+.5,Ue=Xe*at-vt*qe;w=(je*Xe-Le*vt)/Ue,A=(Le*at-je*qe)/Ue,h=X(h-w,-Math.PI,Math.PI),p=X(p-A,-vT,vT)}while((Math.abs(w)>v||Math.abs(A)>v)&&--_>0);return new Wr(B(h),B(p))}}class xT extends sl{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(z(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,c){const{scale:h,cosPhi:p}=this;return{x:z(i)*p*h+.5,y:-Math.sin(z(c))/p*h+.5,z:0}}unproject(i,c){const{scale:h,cosPhi:p}=this,_=-(c-.5)/h,v=X(B((i-.5)/h)/p,-180,180),w=Math.asin(X(_*p,-1,1)),A=X(B(w),-85.051129,bo);return new Wr(v,A)}}class Ak extends _T{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(i,c,h){const p=Math.pow(2,h.z),_=(i/nr+h.x)/p,v=Sn(Fi((c/nr+h.y)/p),wn(_));return on(v,v,Pf(So(h))),{x:v[0],y:v[1],z:v[2]}}locationPoint(i,c){const h=Sn(c.lat,c.lng),p=En([],h),_=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(c),i._centerAltitude):i._centerAltitude;lg(h,h,p,Ls(1,0)*nr*_);const v=Jn(new Float64Array(16));return tl(v,i.pixelMatrix,i.globeMatrix),on(h,h,v),new S(h[0],h[1])}pixelsPerMeter(i,c){return Ls(1,0)*c}pixelSpaceConversion(i,c,h){const p=Dr(Ls(1,45)*c,Ls(1,i)*c,h);return this.pixelsPerMeter(i,c)/p}createTileMatrix(i,c,h){const p=dT(So(h.canonical));return tl(new Float64Array(16),i.globeMatrix,p)}createInversionMatrix(i,c){const{center:h}=i,p=Jn(new Float64Array(16));return tl(p,p,Pf(So(c))),sg(p,p,z(h.lng)),ng(p,p,z(h.lat)),wo(p,p,[i._projectionScaler,i._projectionScaler,1]),Float32Array.from(p)}pointCoordinate(i,c,h,p){return cT(i,c,h,!0)||new sh(0,0)}pointCoordinate3D(i,c,h){const p=this.pointCoordinate(i,c,h,0);return[p.x,p.y,p.z]}isPointAboveHorizon(i,c){return!cT(i,c.x,c.y,!1)}farthestPixelDistance(i){const c=function(p,_){const v=p.cameraToCenterDistance,w=p._centerAltitude*_,A=p._camera,C=p._camera.forward(),D=rl([],Eo([],C,-v),[0,0,w]),k=p.worldSize/(2*Math.PI),F=[0,0,-k],V=p.width/p.height,H=Math.tan(p.fovAboveCenter),Q=Eo([],A.up(),H),ce=Eo([],A.right(),H*V),ge=En([],rl([],rl([],C,Q),ce)),Ce=[];let Pe;if(new t0(D,ge).closestPointOnSphere(F,k,Ce)){const De=rl([],Ce,F),Le=zs([],De,D);Pe=Math.cos(p.fovAboveCenter)*hf(Le)}else{const De=zs([],D,F),Le=zs([],F,D);En(Le,Le);const je=hf(De)-k;Pe=Math.sqrt(je*(je+2*k));const qe=Math.acos(Pe/(k+je))-Math.acos(ks(C,Le));Pe*=Math.cos(qe)}return 1.01*Pe}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),h=A0(i.zoom);if(h>0){const p=gT(i,Ls(1,i.center.lat)*i.worldSize),_=i.worldSize/(2*Math.PI),v=Math.max(i.width,i.height)/i.worldSize*Math.PI;return Dr(c,p+_*(1-Math.cos(v)),Math.pow(h,10))}return c}upVector(i,c,h){const p=1<<i.z,_=(c/nr+i.x)/p;return Sn(Fi((h/nr+i.y)/p),wn(_),1)}upVectorScale(i){return{metersToTile:E0*Ag(So(i))}}}function bT(l){const i=l.parallels,c=!!i&&Math.abs(i[0]+i[1])<.01;switch(l.name){case"mercator":return new _T(l);case"equirectangular":return new wk(l);case"naturalEarth":return new Tk(l);case"equalEarth":return new bk(l);case"winkelTripel":return new Sk(l);case"albers":return c?new xT(l):new xk(l);case"lambertConformalConic":return c?new xT(l):new Ek(l);case"globe":return new Ak(l)}throw new Error(`Invalid projection name: ${l.name}`)}const Pk=Tc.VectorTileFeature.types,Ck=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ig(l,i,c,h,p,_,v,w,A,C,D,k,F){const V=w?Math.min(nl,Math.round(w[0])):0,H=w?Math.min(nl,Math.round(w[1])):0;l.emplaceBack(i,c,Math.round(32*h),Math.round(32*p),_,v,(V<<1)+(A?1:0),H,16*C,16*D,256*k,256*F)}function Mg(l,i,c,h,p,_,v){l.emplaceBack(i,c,h,p,_,v)}function Og(l,i,c,h,p){l.emplaceBack(i,c,h,p),l.emplaceBack(i,c,h,p),l.emplaceBack(i,c,h,p),l.emplaceBack(i,c,h,p)}function Ik(l){for(const i of l.sections)if(T(i.text))return!0;return!1}class P0{constructor(i){this.layoutVertexArray=new kn,this.indexArray=new Mr,this.programConfigurations=i,this.segments=new Si,this.dynamicLayoutVertexArray=new Br,this.opacityVertexArray=new Qs,this.placedSymbolArray=new Cw,this.globeExtVertexArray=new Ds}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,c,h,p){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,OL.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,RL.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Ck,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,DL.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||p)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Vt(P0,"SymbolBuffers");class C0{constructor(i,c,h){this.layoutVertexArray=new i,this.layoutAttributes=c,this.indexArray=new h,this.segments=new Si,this.collisionVertexArray=new Mi,this.collisionVertexArrayExt=new Ki}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,LL.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,kL.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Vt(C0,"CollisionBuffers");class ol{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(v=>v.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Jn([]),this.placementViewportMatrix=Jn([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=d0(this.zoom,c["text-size"]),this.iconSizeData=d0(this.zoom,c["icon-size"]);const h=this.layers[0].layout,p=h.get("symbol-sort-key"),_=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(v=>ms[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=i.sourceID,this.projection=i.projection}createArrays(){this.text=new P0(new _c(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new P0(new _c(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Ow,this.lineVertexArray=new Dw,this.symbolInstances=new Mw}calculateGlyphDependencies(i,c,h,p,_){for(let v=0;v<i.length;v++)if(c[i.charCodeAt(v)]=!0,p&&_){const w=wf[i.charAt(v)];w&&(c[w.charCodeAt(0)]=!0)}}populate(i,c,h,p){const _=this.layers[0],v=_.layout,w=this.projection.name==="globe",A=v.get("text-font"),C=v.get("text-field"),D=v.get("icon-image"),k=(C.value.kind!=="constant"||C.value.value instanceof sn&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),F=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,V=v.get("symbol-sort-key");if(this.features=[],!k&&!F)return;const H=c.iconDependencies,Q=c.glyphDependencies,ce=c.availableImages,ge=new he(this.zoom);for(const{feature:Ce,id:Pe,index:De,sourceLayerIndex:Le}of i){const je=_._featureFilter.needGeometry,qe=xc(Ce,je);if(!_._featureFilter.filter(ge,qe,h))continue;if(je||(qe.geometry=sa(Ce,h,p)),w&&Ce.type!==1&&h.z<=5){const Ue=qe.geometry,nt=1<<h.z,xt=h.x,bt=h.y,Bt=.98078528056;for(let _t=0;_t<Ue.length;_t++)Ue[_t]=RR(Ue[_t],kt=>kt,(kt,gr)=>ks(Sn(Fi((kt.y/nr+bt)/nt),wn((kt.x/nr+xt)/nt),1),Sn(Fi((gr.y/nr+bt)/nt),wn((gr.x/nr+xt)/nt),1))<Bt)}let Xe,at;if(k){const Ue=_.getValueAndResolveTokens("text-field",qe,h,ce),nt=sn.factory(Ue);Ik(nt)&&(this.hasRTLText=!0),(!this.hasRTLText||ie()==="unavailable"||this.hasRTLText&&oe.isParsed())&&(Xe=BL(nt,_,qe))}if(F){const Ue=_.getValueAndResolveTokens("icon-image",qe,h,ce);at=Ue instanceof qn?Ue:qn.fromString(Ue)}if(!Xe&&!at)continue;const vt=this.sortFeaturesByKey?V.evaluate(qe,{},h):void 0;if(this.features.push({id:Pe,text:Xe,icon:at,index:De,sourceLayerIndex:Le,geometry:qe.geometry,properties:Ce.properties,type:Pk[Ce.type],sortKey:vt}),at&&(H[at.name]=!0),Xe){const Ue=A.evaluate(qe,{},h).join(","),nt=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ms.vertical)>=0;for(const xt of Xe.sections)if(xt.image)H[xt.image.name]=!0;else{const bt=rh(Xe.toString()),Bt=xt.fontStack||Ue,_t=Q[Bt]=Q[Bt]||{};this.calculateGlyphDependencies(xt.text,_t,nt,this.allowVerticalPlacement,bt)}}}v.get("symbol-placement")==="line"&&(this.features=function(Ce){const Pe={},De={},Le=[];let je=0;function qe(Ue){Le.push(Ce[Ue]),je++}function Xe(Ue,nt,xt){const bt=De[Ue];return delete De[Ue],De[nt]=bt,Le[bt].geometry[0].pop(),Le[bt].geometry[0]=Le[bt].geometry[0].concat(xt[0]),bt}function at(Ue,nt,xt){const bt=Pe[nt];return delete Pe[nt],Pe[Ue]=bt,Le[bt].geometry[0].shift(),Le[bt].geometry[0]=xt[0].concat(Le[bt].geometry[0]),bt}function vt(Ue,nt,xt){const bt=xt?nt[0][nt[0].length-1]:nt[0][0];return`${Ue}:${bt.x}:${bt.y}`}for(let Ue=0;Ue<Ce.length;Ue++){const nt=Ce[Ue],xt=nt.geometry,bt=nt.text?nt.text.toString():null;if(!bt){qe(Ue);continue}const Bt=vt(bt,xt),_t=vt(bt,xt,!0);if(Bt in De&&_t in Pe&&De[Bt]!==Pe[_t]){const kt=at(Bt,_t,xt),gr=Xe(Bt,_t,Le[kt].geometry);delete Pe[Bt],delete De[_t],De[vt(bt,Le[gr].geometry,!0)]=gr,Le[kt].geometry=null}else Bt in De?Xe(Bt,_t,xt):_t in Pe?at(Bt,_t,xt):(qe(Ue),Pe[Bt]=je-1,De[_t]=je-1)}return Le.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ce,Pe)=>Ce.sortKey-Pe.sortKey)}update(i,c,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,c,this.layers,h,p),this.icon.programConfigurations.updatePaintArrays(i,c,this.layers,h,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=bT(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,c){const h=this.lineVertexArray.length,p=i.segment;if(p!==void 0){let _=i.dist(c[p+1]),v=i.dist(c[p]);const w={};for(let A=p+1;A<c.length;A++)w[A]={x:c[A].x,y:c[A].y,tileUnitDistanceFromAnchor:_},A<c.length-1&&(_+=c[A+1].dist(c[A]));for(let A=p||0;A>=0;A--)w[A]={x:c[A].x,y:c[A].y,tileUnitDistanceFromAnchor:v},A>0&&(v+=c[A-1].dist(c[A]));for(let A=0;A<c.length;A++){const C=w[A];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,c,h,p,_,v,w,A,C,D,k,F,V,H){const Q=i.indexArray,ce=i.layoutVertexArray,ge=i.globeExtVertexArray,Ce=i.segments.prepareSegment(4*c.length,ce,Q,this.canOverlap?v.sortKey:void 0),Pe=this.glyphOffsetArray.length,De=Ce.vertexLength,Le=this.allowVerticalPlacement&&w===ms.vertical?Math.PI/2:0,je=v.text&&v.text.sections;for(let Xe=0;Xe<c.length;Xe++){const{tl:at,tr:vt,bl:Ue,br:nt,tex:xt,pixelOffsetTL:bt,pixelOffsetBR:Bt,minFontScaleX:_t,minFontScaleY:kt,glyphOffset:gr,isSDF:vr,sectionIndex:er}=c[Xe],Ut=Ce.vertexLength,Er=gr[1];if(Ig(ce,C.x,C.y,at.x,Er+at.y,xt.x,xt.y,h,vr,bt.x,bt.y,_t,kt),Ig(ce,C.x,C.y,vt.x,Er+vt.y,xt.x+xt.w,xt.y,h,vr,Bt.x,bt.y,_t,kt),Ig(ce,C.x,C.y,Ue.x,Er+Ue.y,xt.x,xt.y+xt.h,h,vr,bt.x,Bt.y,_t,kt),Ig(ce,C.x,C.y,nt.x,Er+nt.y,xt.x+xt.w,xt.y+xt.h,h,vr,Bt.x,Bt.y,_t,kt),A){const yr=A.anchor,Kt=A.up;Mg(ge,yr.x,yr.y,yr.z,Kt[0],Kt[1],Kt[2]),Mg(ge,yr.x,yr.y,yr.z,Kt[0],Kt[1],Kt[2]),Mg(ge,yr.x,yr.y,yr.z,Kt[0],Kt[1],Kt[2]),Mg(ge,yr.x,yr.y,yr.z,Kt[0],Kt[1],Kt[2]),Og(i.dynamicLayoutVertexArray,yr.x,yr.y,yr.z,Le)}else Og(i.dynamicLayoutVertexArray,C.x,C.y,C.z,Le);Q.emplaceBack(Ut,Ut+1,Ut+2),Q.emplaceBack(Ut+1,Ut+2,Ut+3),Ce.vertexLength+=4,Ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gr[0]),Xe!==c.length-1&&er===c[Xe+1].sectionIndex||i.programConfigurations.populatePaintArrays(ce.length,v,v.index,{},V,H,je&&je[er])}const qe=A?A.anchor:C;i.placedSymbolArray.emplaceBack(qe.x,qe.y,qe.z,C.x,C.y,Pe,this.glyphOffsetArray.length-Pe,De,D,k,C.segment,h?h[0]:0,h?h[1]:0,p[0],p[1],w,0,!1,0,F,0)}_commitLayoutVertex(i,c,h,p,_,v,w){i.emplaceBack(c,h,p,_,v,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(i,c,h,p,_,v,w){const A=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),C=A.vertexLength,D=w.tileAnchorX,k=w.tileAnchorY;for(let V=0;V<4;V++)h.collisionVertexArray.emplaceBack(0,0,0,0);h.collisionVertexArrayExt.emplaceBack(c,-i.padding,-i.padding),h.collisionVertexArrayExt.emplaceBack(c,i.padding,-i.padding),h.collisionVertexArrayExt.emplaceBack(c,i.padding,i.padding),h.collisionVertexArrayExt.emplaceBack(c,-i.padding,i.padding),this._commitLayoutVertex(h.layoutVertexArray,p,_,v,D,k,new S(i.x1,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,_,v,D,k,new S(i.x2,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,_,v,D,k,new S(i.x2,i.y2)),this._commitLayoutVertex(h.layoutVertexArray,p,_,v,D,k,new S(i.x1,i.y2)),A.vertexLength+=4;const F=h.indexArray;F.emplaceBack(C,C+1),F.emplaceBack(C+1,C+2),F.emplaceBack(C+2,C+3),F.emplaceBack(C+3,C),A.primitiveLength+=4}_addTextDebugCollisionBoxes(i,c,h,p,_,v){for(let w=p;w<_;w++){const A=h.get(w),C=this.getSymbolInstanceTextSize(i,v,c,w);this._addCollisionDebugVertices(A,C,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(i,c,h,p,_,v){for(let w=p;w<_;w++){const A=h.get(w),C=this.getSymbolInstanceIconSize(i,c,w);this._addCollisionDebugVertices(A,C,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,v)}}generateCollisionDebugBuffers(i,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new C0(ai,LE.members,Oi),this.iconCollisionBox=new C0(ai,LE.members,Oi);const h=uh(this.iconSizeData,i),p=uh(this.textSizeData,i);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(p,i,c,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(p,i,c,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(h,i,c,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(h,i,c,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(i,c,h,p){const _=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:p),v=vg(this.textSizeData,i,_)/an;return this.tilePixelRatio*v}getSymbolInstanceIconSize(i,c,h){const p=this.icon.placedSymbolArray.get(h),_=vg(this.iconSizeData,i,p);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(i,c,h){i.emplaceBack(c,-h,-h),i.emplaceBack(c,h,-h),i.emplaceBack(c,h,h),i.emplaceBack(c,-h,h)}_updateTextDebugCollisionBoxes(i,c,h,p,_,v){for(let w=p;w<_;w++){const A=h.get(w),C=this.getSymbolInstanceTextSize(i,v,c,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,A.padding)}}_updateIconDebugCollisionBoxes(i,c,h,p,_){for(let v=p;v<_;v++){const w=h.get(v),A=this.getSymbolInstanceIconSize(i,c,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,w.padding)}}updateCollisionDebugBuffers(i,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=uh(this.iconSizeData,i),p=uh(this.textSizeData,i);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(p,i,c,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(p,i,c,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(h,i,c,v.iconBoxStartIndex,v.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(h,i,c,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,c,h,p,_,v,w,A,C){const D={};for(let k=c;k<h;k++){const F=i.get(k);D.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,padding:F.padding,projectedAnchorX:F.projectedAnchorX,projectedAnchorY:F.projectedAnchorY,projectedAnchorZ:F.projectedAnchorZ,tileAnchorX:F.tileAnchorX,tileAnchorY:F.tileAnchorY},D.textFeatureIndex=F.featureIndex;break}for(let k=p;k<_;k++){const F=i.get(k);D.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,padding:F.padding,projectedAnchorX:F.projectedAnchorX,projectedAnchorY:F.projectedAnchorY,projectedAnchorZ:F.projectedAnchorZ,tileAnchorX:F.tileAnchorX,tileAnchorY:F.tileAnchorY},D.verticalTextFeatureIndex=F.featureIndex;break}for(let k=v;k<w;k++){const F=i.get(k);D.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,padding:F.padding,projectedAnchorX:F.projectedAnchorX,projectedAnchorY:F.projectedAnchorY,projectedAnchorZ:F.projectedAnchorZ,tileAnchorX:F.tileAnchorX,tileAnchorY:F.tileAnchorY},D.iconFeatureIndex=F.featureIndex;break}for(let k=A;k<C;k++){const F=i.get(k);D.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,padding:F.padding,projectedAnchorX:F.projectedAnchorX,projectedAnchorY:F.projectedAnchorY,projectedAnchorZ:F.projectedAnchorZ,tileAnchorX:F.tileAnchorX,tileAnchorY:F.tileAnchorY},D.verticalIconFeatureIndex=F.featureIndex;break}return D}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,c){const h=i.placedSymbolArray.get(c),p=h.vertexStartIndex+4*h.numGlyphs;for(let _=h.vertexStartIndex;_<p;_+=4)i.indexArray.emplaceBack(_,_+1,_+2),i.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(i),h=Math.cos(i),p=[],_=[],v=[];for(let w=0;w<this.symbolInstances.length;++w){v.push(w);const A=this.symbolInstances.get(w);p.push(0|Math.round(c*A.tileAnchorX+h*A.tileAnchorY)),_.push(A.featureIndex)}return v.sort((w,A)=>p[w]-p[A]||_[A]-_[w]),v}addToSortKeyRanges(i,c){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===c?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const h=this.symbolInstances.get(c);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((p,_,v)=>{p>=0&&v.indexOf(p)===_&&this.addIndicesForPlacedSymbol(this.text,p)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Vt(ol,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ol.MAX_GLYPHS=65535,ol.addDynamicAttributes=Og;const Mk=new Qe({"symbol-placement":new Ge(ze.layout_symbol["symbol-placement"]),"symbol-spacing":new Ge(ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ge(ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Se(ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ge(ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ge(ze.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ge(ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ge(ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ge(ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new Se(ze.layout_symbol["icon-size"]),"icon-text-fit":new Ge(ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ge(ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new Se(ze.layout_symbol["icon-image"]),"icon-rotate":new Se(ze.layout_symbol["icon-rotate"]),"icon-padding":new Ge(ze.layout_symbol["icon-padding"]),"icon-keep-upright":new Ge(ze.layout_symbol["icon-keep-upright"]),"icon-offset":new Se(ze.layout_symbol["icon-offset"]),"icon-anchor":new Se(ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ge(ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ge(ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ge(ze.layout_symbol["text-rotation-alignment"]),"text-field":new Se(ze.layout_symbol["text-field"]),"text-font":new Se(ze.layout_symbol["text-font"]),"text-size":new Se(ze.layout_symbol["text-size"]),"text-max-width":new Se(ze.layout_symbol["text-max-width"]),"text-line-height":new Se(ze.layout_symbol["text-line-height"]),"text-letter-spacing":new Se(ze.layout_symbol["text-letter-spacing"]),"text-justify":new Se(ze.layout_symbol["text-justify"]),"text-radial-offset":new Se(ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ge(ze.layout_symbol["text-variable-anchor"]),"text-anchor":new Se(ze.layout_symbol["text-anchor"]),"text-max-angle":new Ge(ze.layout_symbol["text-max-angle"]),"text-writing-mode":new Ge(ze.layout_symbol["text-writing-mode"]),"text-rotate":new Se(ze.layout_symbol["text-rotate"]),"text-padding":new Ge(ze.layout_symbol["text-padding"]),"text-keep-upright":new Ge(ze.layout_symbol["text-keep-upright"]),"text-transform":new Se(ze.layout_symbol["text-transform"]),"text-offset":new Se(ze.layout_symbol["text-offset"]),"text-allow-overlap":new Ge(ze.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ge(ze.layout_symbol["text-ignore-placement"]),"text-optional":new Ge(ze.layout_symbol["text-optional"])});var I0={paint:new Qe({"icon-opacity":new Se(ze.paint_symbol["icon-opacity"]),"icon-color":new Se(ze.paint_symbol["icon-color"]),"icon-halo-color":new Se(ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new Se(ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Se(ze.paint_symbol["icon-halo-blur"]),"icon-translate":new Ge(ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ge(ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new Se(ze.paint_symbol["text-opacity"]),"text-color":new Se(ze.paint_symbol["text-color"],{runtimeType:vn,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Se(ze.paint_symbol["text-halo-color"]),"text-halo-width":new Se(ze.paint_symbol["text-halo-width"]),"text-halo-blur":new Se(ze.paint_symbol["text-halo-blur"]),"text-translate":new Ge(ze.paint_symbol["text-translate"]),"text-translate-anchor":new Ge(ze.paint_symbol["text-translate-anchor"])}),layout:Mk};class wT{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:nn,this.defaultValue=i}evaluate(i){if(i.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(i.formattedSection))return c.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Vt(wT,"FormatSectionOverride",{omit:["defaultValue"]});class Dg extends ro{constructor(i){super(i,I0)}recalculate(i,c){super.recalculate(i,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const p=[];for(const _ of h)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,c,h,p){const _=this.layout.get(i).evaluate(c,{},h,p),v=this._unevaluatedLayout._values[i];return v.isDataDriven()||ju(v.value)||!_?_:function(w,A){return A.replace(/{([^{}]+)}/g,(C,D)=>D in w?String(w[D]):"")}(c.properties,_)}createBucket(i){return new ol(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of I0.paint.overridableProperties){if(!Dg.hasPaintOverride(this.layout,i))continue;const c=this.paint.get(i),h=new wT(c),p=new Nu(h,c.property.specification);let _=null;_=c.value.kind==="constant"||c.value.kind==="source"?new $u("source",p):new oc("composite",p,c.value.zoomStops,c.value._interpolationType),this.paint._values[i]=new Ke(c.property,_,c.parameters)}}_handleOverridablePaintPropertyUpdate(i,c,h){return!(!this.layout||c.isDataDriven()||h.isDataDriven())&&Dg.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,c){const h=i.get("text-field"),p=I0.paint.properties[c];let _=!1;const v=w=>{for(const A of w)if(p.overrides&&p.overrides.hasOverride(A))return void(_=!0)};if(h.value.kind==="constant"&&h.value.value instanceof sn)v(h.value.value.sections);else if(h.value.kind==="source"){const w=C=>{_||(C instanceof Kl&&pi(C.value)===us?v(C.value.sections):C instanceof yo?v(C.sections):C.eachChild(w))},A=h.value;A._styleExpression&&w(A._styleExpression.expression)}return _}getProgramConfiguration(i){return new Qa(this,i)}}var Ok={paint:new Qe({"background-color":new Ge(ze.paint_background["background-color"]),"background-pattern":new ct(ze.paint_background["background-pattern"]),"background-opacity":new Ge(ze.paint_background["background-opacity"])})},Dk={paint:new Qe({"raster-opacity":new Ge(ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ge(ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ge(ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ge(ze.paint_raster["raster-brightness-max"]),"raster-saturation":new Ge(ze.paint_raster["raster-saturation"]),"raster-contrast":new Ge(ze.paint_raster["raster-contrast"]),"raster-resampling":new Ge(ze.paint_raster["raster-resampling"]),"raster-fade-duration":new Ge(ze.paint_raster["raster-fade-duration"])})};class Rk extends ro{constructor(i){super(i,{}),this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var Lk={paint:new Qe({"sky-type":new Ge(ze.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ge(ze.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ge(ze.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ge(ze.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ge(ze.paint_sky["sky-gradient-radius"]),"sky-gradient":new Rt(ze.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ge(ze.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ge(ze.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ge(ze.paint_sky["sky-opacity"])})};function M0(l,i,c){const h=[0,0,1],p=lE([]);return uE(p,p,c?-z(l)+Math.PI:z(l)),cE(p,p,-z(i)),sE(h,h,p),En(h,h)}const kk={circle:class extends ro{constructor(l){super(l,jR)}createBucket(l){return new Kv(l)}queryRadius(l){const i=l;return oh("circle-radius",this,i)+oh("circle-stroke-width",this,i)+rg(this.paint.get("circle-translate"))}queryIntersectsFeature(l,i,c,h,p,_,v,w){const A=eE(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(i,c)+this.paint.get("circle-stroke-width").evaluate(i,c);return hE(l,h,_,v,w,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,C)}getProgramIds(){return["circle"]}getProgramConfiguration(l){return new Qa(this,l)}},heatmap:class extends ro{createBucket(l){return new fE(l)}constructor(l){super(l,ZR),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=s0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return oh("heatmap-radius",this,l)}queryIntersectsFeature(l,i,c,h,p,_,v,w){const A=this.paint.get("heatmap-radius").evaluate(i,c);return hE(l,h,_,v,w,!0,!0,new S(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(l){return new Qa(this,l)}},hillshade:class extends ro{constructor(l){super(l,qR)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ro{constructor(l){super(l,hL)}getProgramIds(){const l=this.paint.get("fill-pattern"),i=l&&l.constantOr(1),c=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(l){return new Qa(this,l)}recalculate(l,i){super.recalculate(l,i);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new pg(l)}queryRadius(){return rg(this.paint.get("fill-translate"))}queryIntersectsFeature(l,i,c,h,p,_){return!l.queryGeometry.isAboveHorizon&&Kw(Qw(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}},"fill-extrusion":class extends ro{constructor(l){super(l,EL)}createBucket(l){return new vf(l)}queryRadius(){return rg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(l){return new Qa(this,l)}queryIntersectsFeature(l,i,c,h,p,_,v,w,A){const C=eE(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(i,c),k=this.paint.get("fill-extrusion-base").evaluate(i,c),F=[0,0],V=w&&_.elevation,H=_.elevation?_.elevation.exaggeration():1,Q=l.tile.getBucket(this);if(V&&Q instanceof vf){const Ce=Q.centroidVertexArray,Pe=A+1;if(Pe<Ce.length){const De=Ce.get(Pe);F[0]=De.a_centroid_pos0,F[1]=De.a_centroid_pos1}}if(F[0]===0&&F[1]===1)return!1;_.projection.name==="globe"&&(h=AE([h],[new S(0,0),new S(nr,nr)],l.tileID.canonical).map(Ce=>Ce.polygon).flat());const ce=function(Ce,Pe,De,Le,je,qe,Xe,at,vt,Ue,nt){return Ce.projection.name==="globe"?function(xt,bt,Bt,_t,kt,gr,vr,er,Ut,Er,yr){const Kt=[],Bi=[],Ai=xt.projection.upVectorScale(yr,xt.center.lat,xt.worldSize).metersToTile,yi=[0,0,0,1],Tr=[0,0,0,1],Lr=(Jr,Zr,ni,hi)=>{Jr[0]=Zr,Jr[1]=ni,Jr[2]=hi,Jr[3]=1},ti=SE();Bt>0&&(Bt+=ti),_t+=ti;for(const Jr of bt){const Zr=[],ni=[];for(const hi of Jr){const Xi=hi.x+kt.x,zn=hi.y+kt.y,Pr=xt.projection.projectTilePoint(Xi,zn,yr),vi=xt.projection.upVector(yr,hi.x,hi.y);let pn=Bt,Vr=_t;if(vr){const di=ME(Xi,zn,Bt,_t,vr,er,Ut,Er);pn+=di.base,Vr+=di.top}Bt!==0?Lr(yi,Pr.x+vi[0]*Ai*pn,Pr.y+vi[1]*Ai*pn,Pr.z+vi[2]*Ai*pn):Lr(yi,Pr.x,Pr.y,Pr.z),Lr(Tr,Pr.x+vi[0]*Ai*Vr,Pr.y+vi[1]*Ai*Vr,Pr.z+vi[2]*Ai*Vr),on(yi,yi,gr),on(Tr,Tr,gr),Zr.push(_g(yi)),ni.push(_g(Tr))}Kt.push(Zr),Bi.push(ni)}return[Kt,Bi]}(Ce,Pe,De,Le,je,qe,Xe,at,vt,Ue,nt):Xe?function(xt,bt,Bt,_t,kt,gr,vr,er,Ut){const Er=[],yr=[],Kt=[0,0,0,1];for(const Bi of xt){const Ai=[],yi=[];for(const Tr of Bi){const Lr=Tr.x+_t.x,ti=Tr.y+_t.y,Jr=ME(Lr,ti,bt,Bt,gr,vr,er,Ut);Kt[0]=Lr,Kt[1]=ti,Kt[2]=Jr.base,Kt[3]=1,Ec(Kt,Kt,kt),Kt[3]=Math.max(Kt[3],1e-5);const Zr=_g([Kt[0]/Kt[3],Kt[1]/Kt[3],Kt[2]/Kt[3]]);Kt[0]=Lr,Kt[1]=ti,Kt[2]=Jr.top,Kt[3]=1,Ec(Kt,Kt,kt),Kt[3]=Math.max(Kt[3],1e-5);const ni=_g([Kt[0]/Kt[3],Kt[1]/Kt[3],Kt[2]/Kt[3]]);Ai.push(Zr),yi.push(ni)}Er.push(Ai),yr.push(yi)}return[Er,yr]}(Pe,De,Le,je,qe,Xe,at,vt,Ue):function(xt,bt,Bt,_t,kt){const gr=[],vr=[],er=kt[8]*bt,Ut=kt[9]*bt,Er=kt[10]*bt,yr=kt[11]*bt,Kt=kt[8]*Bt,Bi=kt[9]*Bt,Ai=kt[10]*Bt,yi=kt[11]*Bt;for(const Tr of xt){const Lr=[],ti=[];for(const Jr of Tr){const Zr=Jr.x+_t.x,ni=Jr.y+_t.y,hi=kt[0]*Zr+kt[4]*ni+kt[12],Xi=kt[1]*Zr+kt[5]*ni+kt[13],zn=kt[2]*Zr+kt[6]*ni+kt[14],Pr=kt[3]*Zr+kt[7]*ni+kt[15],vi=hi+er,pn=Xi+Ut,Vr=zn+Er,di=Math.max(Pr+yr,1e-5),An=hi+Kt,li=Xi+Bi,Pi=zn+Ai,Yi=Math.max(Pr+yi,1e-5),Hi=new S(vi/di,pn/di);Hi.z=Vr/di,Lr.push(Hi);const ln=new S(An/Yi,li/Yi);ln.z=Pi/Yi,ti.push(ln)}gr.push(Lr),vr.push(ti)}return[gr,vr]}(Pe,De,Le,je,qe)}(_,h,k,D,C,v,V?w:null,F,H,_.center.lat,l.tileID.canonical),ge=l.queryGeometry;return function(Ce,Pe,De){let Le=1/0;Kw(De,Pe)&&(Le=IE(De,Pe[0]));for(let je=0;je<Pe.length;je++){const qe=Pe[je],Xe=Ce[je];for(let at=0;at<qe.length-1;at++){const vt=qe[at],Ue=[vt,qe[at+1],Xe[at+1],Xe[at],vt];qw(De,Ue)&&(Le=Math.min(Le,IE(De,Ue)))}}return Le!==1/0&&Le}(ce[0],ce[1],ge.isPointQuery()?ge.screenBounds:ge.screenGeometry)}},line:class extends ro{constructor(l){super(l,OE),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof Cu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,i){super.recalculate(l,i),this.paint._values["line-floorwidth"]=DE.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new yg(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(l){return new Qa(this,l)}queryRadius(l){const i=l,c=RE(oh("line-width",this,i),oh("line-gap-width",this,i)),h=oh("line-offset",this,i);return c/2+Math.abs(h)+rg(this.paint.get("line-translate"))}queryIntersectsFeature(l,i,c,h,p,_){if(l.queryGeometry.isAboveHorizon)return!1;const v=Qw(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),w=l.pixelToTileUnitsFactor/2*RE(this.paint.get("line-width").evaluate(i,c),this.paint.get("line-gap-width").evaluate(i,c)),A=this.paint.get("line-offset").evaluate(i,c);return A&&(h=function(C,D){const k=[],F=new S(0,0);for(let V=0;V<C.length;V++){const H=C[V],Q=[];for(let ce=0;ce<H.length;ce++){const ge=H[ce-1],Ce=H[ce],Pe=H[ce+1],De=ce===0?F:Ce.sub(ge)._unit()._perp(),Le=ce===H.length-1?F:Pe.sub(Ce)._unit()._perp(),je=De._add(Le)._unit();je._mult(1/(je.x*Le.x+je.y*Le.y)),Q.push(je._mult(D)._add(Ce))}k.push(Q)}return k}(h,A*l.pixelToTileUnitsFactor)),function(C,D,k){for(let F=0;F<D.length;F++){const V=D[F];if(C.length>=3){for(let H=0;H<V.length;H++)if(bc(C,V[H]))return!0}if(zR(C,V,k))return!0}return!1}(v,h,w)}isTileClipped(){return!0}},symbol:Dg,background:class extends ro{constructor(l){super(l,Ok)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ro{constructor(l){super(l,Dk)}getProgramIds(){return["raster"]}},sky:class extends ro{constructor(l){super(l,Lk),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=s0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(l,i){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),p=!h,_=l.style.light,v=_.properties.get("position");return p&&_.properties.get("anchor")==="viewport"&&Nt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?M0(v.azimuthal,90-v.polar,i):M0(h[0],90-h[1],i)}const c=this.paint.get("sky-gradient-center");return M0(c[0],90-c[1],i)}is3D(){return!1}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}}};class Df{constructor(i,c,h,p){this.context=i,this.format=h,this.texture=i.gl.createTexture(),this.update(c,p)}update(i,c,h){const{width:p,height:_}=i,{context:v}=this,{gl:w}=v,{HTMLImageElement:A,HTMLCanvasElement:C,HTMLVideoElement:D,ImageData:k,ImageBitmap:F}=g;if(w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!c||c.premultiply!==!1)),h||this.size&&this.size[0]===p&&this.size[1]===_){const{x:V,y:H}=h||{x:0,y:0};i instanceof A||i instanceof C||i instanceof D||i instanceof k||F&&i instanceof F?w.texSubImage2D(w.TEXTURE_2D,0,V,H,w.RGBA,w.UNSIGNED_BYTE,i):w.texSubImage2D(w.TEXTURE_2D,0,V,H,p,_,w.RGBA,w.UNSIGNED_BYTE,i.data)}else this.size=[p,_],i instanceof A||i instanceof C||i instanceof D||i instanceof k||F&&i instanceof F?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,i):w.texImage2D(w.TEXTURE_2D,0,this.format,p,_,0,this.format,w.UNSIGNED_BYTE,i.data);this.useMipmap=Boolean(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(i,c){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),i!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?i===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:i),this.filter=i),c!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,c),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class O0{constructor(i,c){this.width=i,this.height=c,this.nextRow=0,this.image=new oa({width:i,height:c}),this.positions={},this.uploaded=!1}getDash(i,c){const h=this.getKey(i,c);return this.positions[h]}trim(){const i=this.width,c=this.height=se(this.nextRow);this.image.resize({width:i,height:c})}getKey(i,c){return i.join(",")+c}getDashRanges(i,c,h){const p=[];let _=i.length%2==1?-i[i.length-1]*h:0,v=i[0]*h,w=!0;p.push({left:_,right:v,isDash:w,zeroLength:i[0]===0});let A=i[0];for(let C=1;C<i.length;C++){w=!w;const D=i[C];_=A*h,A+=D,v=A*h,p.push({left:_,right:v,isDash:w,zeroLength:D===0})}return p}addRoundDash(i,c,h){const p=c/2;for(let _=-h;_<=h;_++){const v=this.width*(this.nextRow+h+_);let w=0,A=i[w];for(let C=0;C<this.width;C++){C/A.right>1&&(A=i[++w]);const D=Math.abs(C-A.left),k=Math.abs(C-A.right),F=Math.min(D,k);let V;const H=_/h*(p+1);if(A.isDash){const Q=p-Math.abs(H);V=Math.sqrt(F*F+Q*Q)}else V=p-Math.sqrt(F*F+H*H);this.image.data[v+C]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(i,c){for(let A=i.length-1;A>=0;--A){const C=i[A],D=i[A+1];C.zeroLength?i.splice(A,1):D&&D.isDash===C.isDash&&(D.left=C.left,i.splice(A,1))}const h=i[0],p=i[i.length-1];h.isDash===p.isDash&&(h.left=p.left-this.width,p.right=h.right+this.width);const _=this.width*this.nextRow;let v=0,w=i[v];for(let A=0;A<this.width;A++){A/w.right>1&&(w=i[++v]);const C=Math.abs(A-w.left),D=Math.abs(A-w.right),k=Math.min(C,D);this.image.data[_+A]=Math.max(0,Math.min(255,(w.isDash?k:-k)+c+128))}}addDash(i,c){const h=this.getKey(i,c);if(this.positions[h])return this.positions[h];const p=c==="round",_=p?7:0,v=2*_+1;if(this.nextRow+v>this.height)return Nt("LineAtlas out of space"),null;i.length===0&&i.push(1);let w=0;for(let D=0;D<i.length;D++)i[D]<0&&(Nt("Negative value is found in line dasharray, replacing values with 0"),i[D]=0),w+=i[D];if(w!==0){const D=this.width/w,k=this.getDashRanges(i,this.width,D);p?this.addRoundDash(k,D,_):this.addRegularDash(k,c==="square"?.5*D:0)}const A=this.nextRow+_;this.nextRow+=v;const C={tl:[A,_],br:[w,0]};return this.positions[h]=C,C}}Vt(O0,"LineAtlas");class zk{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Fk{constructor(){this.tasks={},this.taskQueue=[],Ve(["process"],this),this.invoker=new zk(this.process),this.nextId=0}add(i,c){const h=this.nextId++,p=function({type:_,isSymbolTile:v,zoom:w}){return w=w||0,_==="message"?0:_!=="maybePrepare"||v?_!=="parseTile"||v?_==="parseTile"&&v?300-w:_==="maybePrepare"&&v?400-w:500:200-w:100-w}(c);if(p===0){Ne();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[h]={fn:i,metadata:c,priority:p,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){Ne();try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const c=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let i=null,c=1/0;for(let p=0;p<this.taskQueue.length;p++){const _=this.tasks[this.taskQueue[p]];_.priority<c&&(c=_.priority,i=p)}if(i===null)return null;const h=this.taskQueue[i];return this.taskQueue.splice(i,1),h}remove(){this.invoker.remove()}}class ET{constructor(i){this._stringToNumber={},this._numberToString=[];for(let c=0;c<i.length;c++){const h=i[c];this._stringToNumber[h]=c,this._numberToString[c]=h}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const Bk=["tile","layer","source","sourceLayer","state"];class TT{constructor(i,c,h,p,_){this.type="Feature",this._vectorTileFeature=i,this._z=c,this._x=h,this._y=p,this.properties=i.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(i.id=this.id);for(const c of Bk)this[c]!==void 0&&(i[c]=this[c]);return i}}const Fs=32,Ao=33,al=new Uint16Array(8184);for(let l=0;l<2046;l++){let i=l+2,c=0,h=0,p=0,_=0,v=0,w=0;for(1&i?p=_=v=Fs:c=h=w=Fs;(i>>=1)>1;){const C=c+p>>1,D=h+_>>1;1&i?(p=c,_=h,c=v,h=w):(c=p,h=_,p=v,_=w),v=C,w=D}const A=4*l;al[A+0]=c,al[A+1]=h,al[A+2]=p,al[A+3]=_}const Po=new Uint16Array(2178),ll=new Uint8Array(1089),Rg=new Uint16Array(1089);function ST(l){return l===0?-.03125:l===32?.03125:0}var AT=Pt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const PT={type:2,extent:nr,loadGeometry:()=>[[new S(0,0),new S(8193,0),new S(8193,8193),new S(0,8193),new S(0,0)]]};class D0{constructor(i,c,h,p,_){this.tileID=i,this.uid=Ie(),this.uses=0,this.tileSize=c,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(i){const c=i+this.timeAdded;c<gt.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Ac(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,c,h){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(p,_){const v={};if(!_)return v;for(const w of p){const A=w.layerIds.map(C=>_.getLayer(C)).filter(Boolean);if(A.length!==0){w.layers=A,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(C=>A.filter(D=>D.id===C)[0]));for(const C of A)v[C.id]=w}}return v}(i.buckets,c.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof ol){if(this.hasSymbolBuckets=!0,!h)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof ol&&_.hasRTLText){this.hasRTLText=!0,oe.isLoading()||oe.isLoaded()||ie()!=="deferred"||ve();break}}this.queryPadding=0;for(const p in this.buckets){const _=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(p).queryRadius(_))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new $v}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.id]}upload(i){for(const h in this.buckets){const p=this.buckets[h];p.uploadPending()&&p.upload(i)}const c=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Df(i,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Df(i,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Df(i,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,c,h,p,_,v,w,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:w,transform:v,params:_,tileTransform:this.tileTransform},i,c,h):{}}querySourceFeatures(i,c){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const p=h.loadVTLayers(),_=c?c.sourceLayer:"",v=p._geojsonTileLayer||p[_];if(!v)return;const w=ea(c&&c.filter),{z:A,x:C,y:D}=this.tileID.canonical,k={z:A,x:C,y:D};for(let F=0;F<v.length;F++){const V=v.feature(F);if(w.needGeometry){const ce=xc(V,!0);if(!w.filter(new he(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!w.filter(new he(this.tileID.overscaledZ),V))continue;const H=h.getId(V,_),Q=new TT(V,A,C,D,H);Q.tile=k,i.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const c=this.expirationTime;if(i.cacheControl){const h=tt(i.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const h=Date.now();let p=!1;if(this.expirationTime>h)p=!1;else if(c)if(this.expirationTime<c)p=!0;else{const _=this.expirationTime-c;_?this.expirationTime=h+Math.max(_,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0||!c)return;const h=this.latestFeatureIndex.loadVTLayers(),p=c.style.listImages();for(const _ in this.buckets){if(!c.style.hasLayer(_))continue;const v=this.buckets[_],w=v.layers[0].sourceLayer||"_geojsonTileLayer",A=h[w],C=i[w];if(!A||!C||Object.keys(C).length===0)continue;if(v.update(C,A,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof yg||v instanceof pg){const k=c.style._getSourceCache(v.layers[0].source);c._terrain&&c._terrain.enabled&&k&&v.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(k.id,this.tileID)}const D=c&&c.style&&c.style.getLayer(_);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<gt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=gt.now()+i}setTexture(i,c){const h=c.context,p=h.gl;this.texture=c.getTileTexture(i.width),this.texture?this.texture.update(i,{useMipmap:!0}):(this.texture=new Df(h,i,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),h.extTextureFilterAnisotropic&&p.texParameterf(p.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax))}setDependencies(i,c){const h={};for(const p of c)h[p]=!0;this.dependencies[i]=h}hasDependency(i,c){for(const h of i){const p=this.dependencies[h];if(p){for(const _ of c)if(p[_])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const h=sa(PT,this.tileID.canonical,this.tileTransform)[0],p=new tr,_=new Rs;for(let v=0;v<h.length;v++){const{x:w,y:A}=h[v];p.emplaceBack(w,A),_.emplaceBack(v)}_.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(_),this._tileDebugBuffer=i.createVertexBuffer(p,Af.members),this._tileDebugSegments=Si.simpleSegment(0,0,p.length,_.length)}_makeTileBoundsBuffers(i,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const h=sa(PT,this.tileID.canonical,this.tileTransform)[0];let p,_;if(this.isRaster){const v=function(w,A){const C=Ac(w,A),D=Math.pow(2,w.z);for(let ce=0;ce<Ao;ce++)for(let ge=0;ge<Ao;ge++){const Ce=wn((w.x+(ge+ST(ge))/Fs)/D),Pe=Fi((w.y+(ce+ST(ce))/Fs)/D),De=A.project(Ce,Pe),Le=ce*Ao+ge;Po[2*Le+0]=Math.round((De.x*C.scale-C.x)*nr),Po[2*Le+1]=Math.round((De.y*C.scale-C.y)*nr)}ll.fill(0),Rg.fill(0);for(let ce=2045;ce>=0;ce--){const ge=4*ce,Ce=al[ge+0],Pe=al[ge+1],De=al[ge+2],Le=al[ge+3],je=Ce+De>>1,qe=Pe+Le>>1,Xe=je+qe-Pe,at=qe+Ce-je,vt=Pe*Ao+Ce,Ue=Le*Ao+De,nt=qe*Ao+je,xt=Math.hypot((Po[2*vt+0]+Po[2*Ue+0])/2-Po[2*nt+0],(Po[2*vt+1]+Po[2*Ue+1])/2-Po[2*nt+1])>=16;if(ll[nt]=ll[nt]||(xt?1:0),ce<1022){const bt=(Pe+at>>1)*Ao+(Ce+Xe>>1),Bt=(Le+at>>1)*Ao+(De+Xe>>1);ll[nt]=ll[nt]||ll[bt]||ll[Bt]}}const k=new Xt,F=new Mr;let V=0;function H(ce,ge){const Ce=ge*Ao+ce;return Rg[Ce]===0&&(k.emplaceBack(Po[2*Ce+0],Po[2*Ce+1],ce*nr/Fs,ge*nr/Fs),Rg[Ce]=++V),Rg[Ce]-1}function Q(ce,ge,Ce,Pe,De,Le){const je=ce+Ce>>1,qe=ge+Pe>>1;if(Math.abs(ce-De)+Math.abs(ge-Le)>1&&ll[qe*Ao+je])Q(De,Le,ce,ge,je,qe),Q(Ce,Pe,De,Le,je,qe);else{const Xe=H(ce,ge),at=H(Ce,Pe),vt=H(De,Le);F.emplaceBack(Xe,at,vt)}}return Q(0,0,Fs,Fs,Fs,0),Q(Fs,Fs,0,0,0,Fs),{vertices:k,indices:F}}(this.tileID.canonical,c);p=v.vertices,_=v.indices}else{p=new Xt,_=new Mr;for(const{x:w,y:A}of h)p.emplaceBack(w,A,0,0);const v=cg(p.int16,void 0,4);for(let w=0;w<v.length;w+=3)_.emplaceBack(v[w],v[w+1],v[w+2])}this._tileBoundsBuffer=i.createVertexBuffer(p,AT.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(_),this._tileBoundsSegments=Si.simpleSegment(0,0,p.length,_.length)}_makeGlobeTileDebugBuffers(i,c){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!c||c.name!=="globe")return;const h=this.tileID.canonical,p=Pf(So(h));this._makeGlobeTileDebugBorderBuffer(i,h,p),this._makeGlobeTileDebugTextBuffer(i,h,p)}_makeGlobeTileDebugBorderBuffer(i,c,h){const p=new tr,_=new Rs,v=new _r,w=(C,D,k,F,V)=>{const H=(k-C)/(V-1),Q=(F-D)/(V-1),ce=p.length;for(let ge=0;ge<V;ge++){const Ce=C+ge*H,Pe=D+ge*Q;p.emplaceBack(Ce,Pe);const De=hT(Ce,Pe,c),Le=on(De,De,h);v.emplaceBack(Le[0],Le[1],Le[2]),_.emplaceBack(ce+ge)}},A=nr;w(0,0,A,0,16),w(A,0,A,A,16),w(A,A,0,A,16),w(0,A,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(_),this._tileDebugBuffer=i.createVertexBuffer(p,Af.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(v,lT.members),this._tileDebugSegments=Si.simpleSegment(0,0,p.length,_.length)}_makeGlobeTileDebugTextBuffer(i,c,h){const p=new tr,_=new Mr,v=new _r,w=25;_.reserve(32),p.reserve(w),v.reserve(w);const A=(C,D)=>w*C+D;for(let C=0;C<w;C++){const D=2048*C;for(let k=0;k<w;k++){const F=2048*k;p.emplaceBack(F,D);const V=hT(F,D,c),H=on(V,V,h);v.emplaceBack(H[0],H[1],H[2])}}for(let C=0;C<4;C++)for(let D=0;D<4;D++){const k=A(C,D),F=A(C,D+1),V=A(C+1,D),H=A(C+1,D+1);_.emplaceBack(k,F,V),_.emplaceBack(V,F,H)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(_),this._tileDebugTextBuffer=i.createVertexBuffer(p,Af.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(v,lT.members),this._tileDebugTextSegments=Si.simpleSegment(0,0,w,32)}}class Nk{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,c,h){const p=String(c);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][p]=this.stateChanges[i][p]||{},xe(this.stateChanges[i][p],h),this.deletedStates[i]===null){this.deletedStates[i]={};for(const _ in this.state[i])_!==p&&(this.deletedStates[i][_]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][p]===null){this.deletedStates[i][p]={};for(const _ in this.state[i][p])h[_]||(this.deletedStates[i][p][_]=null)}else for(const _ in h)this.deletedStates[i]&&this.deletedStates[i][p]&&this.deletedStates[i][p][_]===null&&delete this.deletedStates[i][p][_]}removeFeatureState(i,c,h){if(this.deletedStates[i]===null)return;const p=String(c);if(this.deletedStates[i]=this.deletedStates[i]||{},h&&c!==void 0)this.deletedStates[i][p]!==null&&(this.deletedStates[i][p]=this.deletedStates[i][p]||{},this.deletedStates[i][p][h]=null);else if(c!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][p])for(h in this.deletedStates[i][p]={},this.stateChanges[i][p])this.deletedStates[i][p][h]=null;else this.deletedStates[i][p]=null;else this.deletedStates[i]=null}getState(i,c){const h=String(c),p=xe({},(this.state[i]||{})[h],(this.stateChanges[i]||{})[h]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const _=this.deletedStates[i][c];if(_===null)return{};for(const v in _)delete p[v]}return p}initializeTileState(i,c){i.setFeatureState(this.state,c)}coalesceChanges(i,c){const h={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const _={};for(const v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),xe(this.state[p][v],this.stateChanges[p][v]),_[v]=this.state[p][v];h[p]=_}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const _={};if(this.deletedStates[p]===null)for(const v in this.state[p])_[v]={},this.state[p][v]={};else for(const v in this.deletedStates[p]){if(this.deletedStates[p][v]===null)this.state[p][v]={};else for(const w of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][w];_[v]=this.state[p][v]}h[p]=h[p]||{},xe(h[p],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const p in i)i[p].setFeatureState(h,c)}}class CT{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,c){const h=this.toIdx(i,c);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(i,c){return this.leaves[this.toIdx(i,c)]}toIdx(i,c){return c*this.size+i}}function IT(l,i,c,h){let p=0,_=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(h[v])<1e-15){if(c[v]<l[v]||c[v]>i[v])return null}else{const w=1/h[v];let A=(l[v]-c[v])*w,C=(i[v]-c[v])*w;if(A>C){const D=A;A=C,C=D}if(A>p&&(p=A),C<_&&(_=C),p>_)return null}return p}function MT(l,i,c,h,p,_,v,w,A,C,D){const k=h-l,F=p-i,V=_-c,H=v-l,Q=w-i,ce=A-c,ge=D[1]*ce-D[2]*Q,Ce=D[2]*H-D[0]*ce,Pe=D[0]*Q-D[1]*H,De=k*ge+F*Ce+V*Pe;if(Math.abs(De)<1e-15)return null;const Le=1/De,je=C[0]-l,qe=C[1]-i,Xe=C[2]-c,at=(je*ge+qe*Ce+Xe*Pe)*Le;if(at<0||at>1)return null;const vt=qe*V-Xe*F,Ue=Xe*k-je*V,nt=je*F-qe*k,xt=(D[0]*vt+D[1]*Ue+D[2]*nt)*Le;return xt<0||at+xt>1?null:(H*vt+Q*Ue+ce*nt)*Le}function OT(l,i,c){return(l-i)/(c-i)}function DT(l,i,c,h,p,_,v,w,A){const C=1<<c,D=_-h,k=v-p,F=(l+1)/C*D+h,V=(i+0)/C*k+p,H=(i+1)/C*k+p;w[0]=(l+0)/C*D+h,w[1]=V,A[0]=F,A[1]=H}class RT{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(_){const v=Math.ceil(Math.log2(_.dim/8)),w=[];let A=Math.ceil(Math.pow(2,v));const C=1/A,D=(V,H,Q,ce,ge)=>{const Ce=ce?1:0,Pe=(V+1)*Q-Ce,De=H*Q,Le=(H+1)*Q-Ce;ge[0]=V*Q,ge[1]=De,ge[2]=Pe,ge[3]=Le};let k=new CT(A);const F=[];for(let V=0;V<A*A;V++){D(V%A,Math.floor(V/A),C,!1,F);const H=cl(F[0],F[1],_),Q=cl(F[2],F[1],_),ce=cl(F[2],F[3],_),ge=cl(F[0],F[3],_);k.minimums.push(Math.min(H,Q,ce,ge)),k.maximums.push(Math.max(H,Q,ce,ge)),k.leaves.push(1)}for(w.push(k),A/=2;A>=1;A/=2){const V=w[w.length-1];k=new CT(A);for(let H=0;H<A*A;H++){D(H%A,Math.floor(H/A),2,!0,F);const Q=V.getElevation(F[0],F[1]),ce=V.getElevation(F[2],F[1]),ge=V.getElevation(F[2],F[3]),Ce=V.getElevation(F[0],F[3]),Pe=V.isLeaf(F[0],F[1]),De=V.isLeaf(F[2],F[1]),Le=V.isLeaf(F[2],F[3]),je=V.isLeaf(F[0],F[3]),qe=Math.min(Q.min,ce.min,ge.min,Ce.min),Xe=Math.max(Q.max,ce.max,ge.max,Ce.max),at=Pe&&De&&Le&&je;k.maximums.push(Xe),k.minimums.push(qe),k.leaves.push(Xe-qe<=5&&at?1:0)}w.push(k)}return w}(this.dem),h=c.length-1,p=c[h];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(c,0,0,h,0)}raycastRoot(i,c,h,p,_,v,w=1){return IT([i,c,-100],[h,p,this.maximums[0]*w],_,v)}raycast(i,c,h,p,_,v,w=1){if(!this.nodeCount)return null;const A=this.raycastRoot(i,c,h,p,_,v,w);if(A==null)return null;const C=[],D=[],k=[],F=[],V=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;V.length>0;){const{idx:H,t:Q,nodex:ce,nodey:ge,depth:Ce}=V.pop();if(this.leaves[H]){DT(ce,ge,Ce,i,c,h,p,k,F);const De=1<<Ce,Le=(ce+0)/De,je=(ce+1)/De,qe=(ge+0)/De,Xe=(ge+1)/De,at=cl(Le,qe,this.dem)*w,vt=cl(je,qe,this.dem)*w,Ue=cl(je,Xe,this.dem)*w,nt=cl(Le,Xe,this.dem)*w,xt=MT(k[0],k[1],at,F[0],k[1],vt,F[0],F[1],Ue,_,v),bt=MT(F[0],F[1],Ue,k[0],F[1],nt,k[0],k[1],at,_,v),Bt=Math.min(xt!==null?xt:Number.MAX_VALUE,bt!==null?bt:Number.MAX_VALUE);if(Bt!==Number.MAX_VALUE)return Bt;{const _t=lg([],_,v,Q);if(LT(at,vt,nt,Ue,OT(_t[0],k[0],F[0]),OT(_t[1],k[1],F[1]))>=_t[2])return Q}continue}let Pe=0;for(let De=0;De<this._siblingOffset.length;De++){DT((ce<<1)+this._siblingOffset[De][0],(ge<<1)+this._siblingOffset[De][1],Ce+1,i,c,h,p,k,F),k[2]=-100,F[2]=this.maximums[this.childOffsets[H]+De]*w;const Le=IT(k,F,_,v);if(Le!=null){const je=Le;C[De]=je;let qe=!1;for(let Xe=0;Xe<Pe&&!qe;Xe++)je>=C[D[Xe]]&&(D.splice(Xe,0,De),qe=!0);qe||(D[Pe]=De),Pe++}}for(let De=0;De<Pe;De++){const Le=D[De];V.push({idx:this.childOffsets[H]+Le,t:C[Le],nodex:(ce<<1)+this._siblingOffset[Le][0],nodey:(ge<<1)+this._siblingOffset[Le][1],depth:Ce+1})}}return null}_addNode(i,c,h){return this.minimums.push(i),this.maximums.push(c),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(i,c,h,p,_){if(i[p].isLeaf(c,h)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const v=p-1,w=i[v];let A=0,C=0;for(let D=0;D<this._siblingOffset.length;D++){const k=2*c+this._siblingOffset[D][0],F=2*h+this._siblingOffset[D][1],V=w.getElevation(k,F),H=w.isLeaf(k,F),Q=this._addNode(V.min,V.max,H);H&&(A|=1<<D),C||(C=Q)}for(let D=0;D<this._siblingOffset.length;D++)A&1<<D||this._construct(i,2*c+this._siblingOffset[D][0],2*h+this._siblingOffset[D][1],v,C+D)}}function LT(l,i,c,h,p,_){return Dr(Dr(l,c,_),Dr(i,h,_),p)}function cl(l,i,c){const h=c.dim,p=X(l*h-.5,0,h-1),_=X(i*h-.5,0,h-1),v=Math.floor(p),w=Math.floor(_),A=Math.min(v+1,h-1),C=Math.min(w+1,h-1);return LT(c.get(v,w),c.get(A,w),c.get(v,C),c.get(A,C),p-v,_-w)}const kT={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Lg{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,c,h,p=!1,_=!1){if(this.uid=i,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return Nt(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const v=this.dim=c.height-2,w=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=h||"mapbox",this.borderReady=p,!p){for(let A=0;A<v;A++)w[this._idx(-1,A)]=w[this._idx(0,A)],w[this._idx(v,A)]=w[this._idx(v-1,A)],w[this._idx(A,-1)]=w[this._idx(A,0)],w[this._idx(A,v)]=w[this._idx(A,v-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(v,-1)]=w[this._idx(v-1,0)],w[this._idx(-1,v)]=w[this._idx(0,v-1)],w[this._idx(v,v)]=w[this._idx(v-1,v-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new RT(this)}get(i,c,h=!1){h&&(i=X(i,-1,this.dim),c=X(c,-1,this.dim));const p=4*this._idx(i,c);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(i){return kT[i]}get unpackVector(){return kT[this.encoding]}_idx(i,c){if(i<-1||i>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(i+1)}_unpackMapbox(i,c,h){return(256*i*256+256*c+h)/10-1e4}_unpackTerrarium(i,c,h){return 256*i+c+h/256-32768}static pack(i,c){const h=[0,0,0,0],p=Lg.getUnpackVector(c);let _=Math.floor((i+p[3])/p[2]);return h[2]=_%256,_=Math.floor(_/256),h[1]=_%256,_=Math.floor(_/256),h[0]=_,h}getPixels(){return new Qn({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,c,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let p=c*this.dim,_=c*this.dim+this.dim,v=h*this.dim,w=h*this.dim+this.dim;switch(c){case-1:p=_-1;break;case 1:_=p+1}switch(h){case-1:v=w-1;break;case 1:w=v+1}const A=-c*this.dim,C=-h*this.dim;for(let D=v;D<w;D++)for(let k=p;k<_;k++){const F=4*this._idx(k,D),V=4*this._idx(k+A,D+C);this.pixels[F+0]=i.pixels[V+0],this.pixels[F+1]=i.pixels[V+1],this.pixels[F+2]=i.pixels[V+2],this.pixels[F+3]=i.pixels[V+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Vt(Lg,"DEMData"),Vt(RT,"DemMinMaxQuadTree",{omit:["dem"]});class jk{constructor(i,c){this.max=i,this.onRemove=c,this.reset()}reset(){for(const i in this.data)for(const c of this.data[i])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(i,c,h){const p=i.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const _={value:c,timeout:void 0};if(h!==void 0&&(_.timeout=setTimeout(()=>{this.remove(i,_)},h)),this.data[p].push(_),this.order.push(p),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const c=this.data[i].shift();return c.timeout&&clearTimeout(c.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),c.value}getByKey(i){const c=this.data[i];return c?c[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,c){if(!this.has(i))return this;const h=i.wrapped().key,p=c===void 0?0:this.data[h].indexOf(c),_=this.data[h][p];return this.data[h].splice(p,1),_.timeout&&clearTimeout(_.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(_.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(i){const c=[];for(const h in this.data)for(const p of this.data[h])i(p.value)||c.push(p);for(const h of c)this.remove(h.value.tileID,h)}}class yh{constructor(i,c,h){this.func=i,this.mask=c,this.range=h}}yh.ReadOnly=!1,yh.ReadWrite=!0,yh.disabled=new yh(519,yh.ReadOnly,[0,1]);const R0=7680;class L0{constructor(i,c,h,p,_,v){this.test=i,this.ref=c,this.mask=h,this.fail=p,this.depthFail=_,this.pass=v}}L0.disabled=new L0({func:519,mask:0},0,0,R0,R0,R0);class Co{constructor(i,c,h){this.blendFunction=i,this.blendColor=c,this.mask=h}}Co.Replace=[1,0],Co.disabled=new Co(Co.Replace,_i.transparent,[!1,!1,!1,!1]),Co.unblended=new Co(Co.Replace,_i.transparent,[!0,!0,!0,!0]),Co.alphaBlended=new Co([1,771],_i.transparent,[!0,!0,!0,!0]);const k0=1029,z0=2305;class io{constructor(i,c,h){this.enable=i,this.mode=c,this.frontFace=h}}io.disabled=new io(!1,k0,z0),io.backCCW=new io(!0,k0,z0),io.backCW=new io(!0,k0,2304),io.frontCW=new io(!0,1028,2304),io.frontCCW=new io(!0,1028,z0);class Pc extends ar{constructor(i,c,h){super(),this.id=i,this._onlySymbols=h,c.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new jk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Nk,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(i){this.map=i,this._minTileCacheSize=this._minTileCacheSize===void 0&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const c=this._tiles[i];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,c){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,c)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const c in this._tiles){const h=this._tiles[c];this._source.prepareTile(h)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,h.tileID),h.upload(i),h.prepare(this.map.style.imageManager)}else for(const c in this._tiles){const h=this._tiles[c];h.upload(i),h.prepare(this.map.style.imageManager)}}getIds(){return we(this._tiles).map(i=>i.tileID).sort(zT).map(i=>i.key)}getRenderableIds(i){const c=[];for(const h in this._tiles)this._isIdRenderable(+h,i)&&c.push(this._tiles[h]);return i?c.sort((h,p)=>{const _=h.tileID,v=p.tileID,w=new S(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),A=new S(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-v.overscaledZ||A.y-w.y||A.x-w.x}).map(h=>h.tileID.key):c.map(h=>h.tileID).sort(zT).map(h=>h.key)}hasRenderableParent(i){const c=this.findLoadedParent(i,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(i,c){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(c||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(+i,"reloading")}}_reloadTile(i,c){const h=this._tiles[i];h&&(h.state!=="loading"&&(h.state=c),this._loadTile(h,this._tileLoaded.bind(this,h,i,c)))}_tileLoaded(i,c,h,p){if(p)if(i.state="errored",p.status!==404)this._source.fire(new Wt(p,{tile:i}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else i.timeAdded=gt.now(),h==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(c,i),this._source.type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new lr("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const c=this.getRenderableIds();for(let p=0;p<c.length;p++){const _=c[p];if(i.neighboringTiles&&i.neighboringTiles[_]){const v=this.getTileByID(_);h(i,v),h(v,i)}}function h(p,_){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let v=_.tileID.canonical.x-p.tileID.canonical.x;const w=_.tileID.canonical.y-p.tileID.canonical.y,A=Math.pow(2,p.tileID.canonical.z),C=_.tileID.key;v===0&&w===0||Math.abs(w)>1||(Math.abs(v)>1&&(Math.abs(v+A)===1?v+=A:Math.abs(v-A)===1&&(v-=A)),_.dem&&p.dem&&(p.dem.backfillBorder(_.dem,v,w),p.neighboringTiles&&p.neighboringTiles[C]&&(p.neighboringTiles[C].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,c,h,p){for(const _ in this._tiles){let v=this._tiles[_];if(p[_]||!v.hasData()||v.tileID.overscaledZ<=c||v.tileID.overscaledZ>h)continue;let w=v.tileID;for(;v&&v.tileID.overscaledZ>c+1;){const C=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[C.key],v&&v.hasData()&&(w=C)}let A=w;for(;A.overscaledZ>c;)if(A=A.scaledTo(A.overscaledZ-1),i[A.key]){p[w.key]=w;break}}}findLoadedParent(i,c){if(i.key in this._loadedParentTiles){const h=this._loadedParentTiles[i.key];return h&&h.tileID.overscaledZ>=c?h:null}for(let h=i.overscaledZ-1;h>=c;h--){const p=i.scaledTo(h),_=this._getLoadedTile(p);if(_)return _}}_getLoadedTile(i){const c=this._tiles[i.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,c){c=c||this._source.tileSize;const h=Math.ceil(i.width/c)+1,p=Math.ceil(i.height/c)+1,_=Math.floor(h*p*5),v=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,_):_,w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(w)}handleWrapJump(i){const c=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,c){const h={};for(const p in this._tiles){const _=this._tiles[p];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+c),h[_.tileID.key]=_}this._tiles=h;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(i,c,h){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;let p;this.updateCacheSize(i,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new Tn(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(p=i.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(w=>this._source.hasTile(w)))):p=[];const _=this._updateRetainedTiles(p);if(FT(this._source.type)&&p.length!==0){const w={},A={},C=Object.keys(_);for(const k of C){const F=_[k],V=this._tiles[k];if(!V||V.fadeEndTime&&V.fadeEndTime<=gt.now())continue;const H=this.findLoadedParent(F,Math.max(F.overscaledZ-Pc.maxOverzooming,this._source.minzoom));H&&(this._addTile(H.tileID),w[H.tileID.key]=H.tileID),A[k]=F}const D=p[p.length-1].overscaledZ;for(const k in this._tiles){const F=this._tiles[k];if(_[k]||!F.hasData())continue;let V=F.tileID;for(;V.overscaledZ>D;){V=V.scaledTo(V.overscaledZ-1);const H=this._tiles[V.key];if(H&&H.hasData()&&A[V.key]){_[k]=F.tileID;break}}}for(const k in w)_[k]||(this._coveredTiles[k]=!0,_[k]=w[k])}for(const w in _)this._tiles[w].clearFadeHold();const v=function(w,A){const C=[];for(const D in w)D in A||C.push(D);return C}(this._tiles,_);for(const w of v){const A=this._tiles[w];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const c={};if(i.length===0)return c;const h={},p=i.reduce((C,D)=>Math.min(C,D.overscaledZ),1/0),_=i[0].overscaledZ,v=Math.max(_-Pc.maxOverzooming,this._source.minzoom),w=Math.max(_+Pc.maxUnderzooming,this._source.minzoom),A={};for(const C of i){const D=this._addTile(C);c[C.key]=C,D.hasData()||p<this._source.maxzoom&&(A[C.key]=C)}this._retainLoadedChildren(A,p,w,c);for(const C of i){let D=this._tiles[C.key];if(D.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const F=C.children(this._source.maxzoom)[0],V=this.getTile(F);if(V&&V.hasData()){c[F.key]=F;continue}}else{const F=C.children(this._source.maxzoom);if(c[F[0].key]&&c[F[1].key]&&c[F[2].key]&&c[F[3].key])continue}let k=D.wasRequested();for(let F=C.overscaledZ-1;F>=v;--F){const V=C.scaledTo(F);if(h[V.key]||(h[V.key]=!0,D=this.getTile(V),!D&&k&&(D=this._addTile(V)),D&&(c[V.key]=V,k=D.wasRequested(),D.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const c=[];let h,p=this._tiles[i].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){h=this._loadedParentTiles[p.key];break}c.push(p.key);const _=p.scaledTo(p.overscaledZ-1);if(h=this._getLoadedTile(_),h)break;p=_}for(const _ of c)this._loadedParentTiles[_]=h}}_addTile(i){let c=this._tiles[i.key];if(c)return this._source.prepareTile&&this._source.prepareTile(c),c;c=this._cache.getAndRemove(i),c&&(this._setTileReloadTimer(i.key,c),c.tileID=i,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,c)));const h=Boolean(c);if(!h){const p=this.map?this.map.painter:null;c=new D0(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._source.prepareTile&&this._source.prepareTile(c)||this._loadTile(c,this._tileLoaded.bind(this,c,i.key,c.state))}return c?(c.uses++,this._tiles[i.key]=c,h||this._source.fire(new lr("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(i,c){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const h=c.getExpiryTimeout();h&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},h))}_removeTile(i){const c=this._tiles[i];c&&(c.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,c,h){const p=[],_=this.transform;if(!_)return p;const v=_.projection.name==="globe",w=yc(_.center.lng);for(const A in this._tiles){const C=this._tiles[A];if(h&&C.clearQueryDebugViz(),C.holdingForFade())continue;let D;if(v){const k=C.tileID.canonical;if(k.z===0){const F=[Math.abs(X(w,...Rf(k,-1))-w),Math.abs(X(w,...Rf(k,1))-w)];D=[0,2*F.indexOf(Math.min(...F))-1]}else{const F=[Math.abs(X(w,...Rf(k,-1))-w),Math.abs(X(w,...Rf(k,0))-w),Math.abs(X(w,...Rf(k,1))-w)];D=[F.indexOf(Math.min(...F))-1]}}else D=[0];for(const k of D){const F=i.containsTile(C,_,c,k);F&&p.push(F)}}return p}getVisibleCoordinates(i){const c=this.getRenderableIds(i).map(h=>this._tiles[h].tileID);for(const h of c)h.projMatrix=this.transform.calculateProjMatrix(h.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(FT(this._source.type))for(const i in this._tiles){const c=this._tiles[i];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=gt.now())return!0}return!1}setFeatureState(i,c,h){this._state.updateState(i=i||"_geojsonTileLayer",c,h)}removeFeatureState(i,c,h){this._state.removeFeatureState(i=i||"_geojsonTileLayer",c,h)}getFeatureState(i,c){return this._state.getState(i=i||"_geojsonTileLayer",c)}setDependencies(i,c,h){const p=this._tiles[i];p&&p.setDependencies(c,h)}reloadTilesForDependencies(i,c){for(const h in this._tiles)this._tiles[h].hasDependency(i,c)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(i,c))}_preloadTiles(i,c){const h=new Map,p=Array.isArray(i)?i:[i],_=this.map.painter.terrain,v=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const w of p){const A=w.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of A)h.set(C.key,C);this.usedForTerrain&&w.updateElevation(!1)}ne(Array.from(h.values()),(w,A)=>{const C=new D0(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(C,D=>{this._source.type==="raster-dem"&&C.dem&&this._backfillDEM(C),A(D,C)})},c)}}function zT(l,i){const c=Math.abs(2*l.wrap)-+(l.wrap<0),h=Math.abs(2*i.wrap)-+(i.wrap<0);return l.overscaledZ-i.overscaledZ||h-c||i.canonical.y-l.canonical.y||i.canonical.x-l.canonical.x}function FT(l){return l==="raster"||l==="image"||l==="video"}function Rf(l,i){const c=1<<l.z;return[l.x/c+i,(l.x+1)/c+i]}Pc.maxOverzooming=10,Pc.maxUnderzooming=3;class kg{constructor(i,c,h){this._demTile=i,this._dem=this._demTile.dem,this._scale=c,this._offset=h}static create(i,c,h){const p=h||i.findDEMTileFor(c);if(!p||!p.dem)return;const _=p.dem,v=p.tileID,w=1<<c.canonical.z-v.canonical.z;return new kg(p,p.tileSize/nr/w,[(c.canonical.x/w-v.canonical.x)*_.dim,(c.canonical.y/w-v.canonical.y)*_.dim])}tileCoordToPixel(i,c){const h=c*this._scale+this._offset[1],p=Math.floor(i*this._scale+this._offset[0]),_=Math.floor(h);return new S(p,_)}getElevationAt(i,c,h,p){const _=i*this._scale+this._offset[0],v=c*this._scale+this._offset[1],w=Math.floor(_),A=Math.floor(v),C=this._dem;return p=!!p,h?Dr(Dr(C.get(w,A,p),C.get(w,A+1,p),v-A),Dr(C.get(w+1,A,p),C.get(w+1,A+1,p),v-A),_-w):C.get(w,A,p)}getElevationAtPixel(i,c,h){return this._dem.get(i,c,!!h)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*Ls(1,i)*this._dem.stride}}class BT{constructor(i,c){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Ka(nr,16,0),this.featureIndexArray=new Lw,this.promoteId=c}insert(i,c,h,p,_,v=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,p,_,v);const A=this.grid;for(let C=0;C<c.length;C++){const D=c[C],k=[1/0,1/0,-1/0,-1/0];for(let F=0;F<D.length;F++){const V=D[F];k[0]=Math.min(k[0],V.x),k[1]=Math.min(k[1],V.y),k[2]=Math.max(k[2],V.x),k[3]=Math.max(k[3],V.y)}k[0]<nr&&k[1]<nr&&k[2]>=0&&k[3]>=0&&A.insert(w,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Tc.VectorTile(new Ef(this.rawTileData)).layers,this.sourceLayerCoder=new ET(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,c,h,p){this.loadVTLayers();const _=i.params||{},v=ea(_.filter),w=i.tileResult,A=i.transform,C=w.bufferedTilespaceBounds,D=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(H,Q,ce,ge)=>Jw(w.bufferedTilespaceGeometry,H,Q,ce,ge));D.sort($k);let k=null;A.elevation&&D.length>0&&(k=kg.create(A.elevation,this.tileID));const F={};let V;for(let H=0;H<D.length;H++){const Q=D[H];if(Q===V)continue;V=Q;const ce=this.featureIndexArray.get(Q);let ge=null;this.loadMatchingFeature(F,ce,v,_.layers,_.availableImages,c,h,p,(Ce,Pe,De,Le=0)=>(ge||(ge=sa(Ce,this.tileID.canonical,i.tileTransform)),Pe.queryIntersectsFeature(w,Ce,De,ge,this.z,i.transform,i.pixelPosMatrix,k,Le)))}return F}loadMatchingFeature(i,c,h,p,_,v,w,A,C){const{featureIndex:D,bucketIndex:k,sourceLayerIndex:F,layoutVertexArrayOffset:V}=c,H=this.bucketLayerIDs[k];if(p&&!function(Ce,Pe){for(let De=0;De<Ce.length;De++)if(Pe.indexOf(Ce[De])>=0)return!0;return!1}(p,H))return;const Q=this.sourceLayerCoder.decode(F),ce=this.vtLayers[Q].feature(D);if(h.needGeometry){const Ce=xc(ce,!0);if(!h.filter(new he(this.tileID.overscaledZ),Ce,this.tileID.canonical))return}else if(!h.filter(new he(this.tileID.overscaledZ),ce))return;const ge=this.getId(ce,Q);for(let Ce=0;Ce<H.length;Ce++){const Pe=H[Ce];if(p&&p.indexOf(Pe)<0)continue;const De=v[Pe];if(!De)continue;let Le={};ge!==void 0&&A&&(Le=A.getState(De.sourceLayer||"_geojsonTileLayer",ge));const je=xe({},w[Pe]);je.paint=NT(je.paint,De.paint,ce,Le,_),je.layout=NT(je.layout,De.layout,ce,Le,_);const qe=!C||C(ce,De,Le,V);if(!qe)continue;const Xe=new TT(ce,this.z,this.x,this.y,ge);Xe.layer=je;let at=i[Pe];at===void 0&&(at=i[Pe]=[]),at.push({featureIndex:D,feature:Xe,intersectionZ:qe})}}lookupSymbolFeatures(i,c,h,p,_,v,w,A){const C={};this.loadVTLayers();const D=ea(_);for(const k of i)this.loadMatchingFeature(C,{bucketIndex:h,sourceLayerIndex:p,featureIndex:k,layoutVertexArrayOffset:0},D,v,w,A,c);return C}loadFeature(i){const{featureIndex:c,sourceLayerIndex:h}=i;this.loadVTLayers();const p=this.sourceLayerCoder.decode(h),_=this.vtFeatures[p];if(_[c])return _[c];const v=this.vtLayers[p].feature(c);return _[c]=v,v}hasLayer(i){for(const c of this.bucketLayerIDs)for(const h of c)if(i===h)return!0;return!1}getId(i,c){let h=i.id;return this.promoteId&&(h=i.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[c]],typeof h=="boolean"&&(h=Number(h))),h}}function NT(l,i,c,h,p){return ut(l,(_,v)=>{const w=i instanceof Ze?i.get(v):null;return w&&w.evaluate?w.evaluate(c,h,p):w})}function $k(l,i){return i-l}Vt(BT,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class jT{constructor(i){const c={},h=[];for(const w in i){const A=i[w],C=c[w]={};for(const D in A.glyphs){const k=A.glyphs[+D];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const F=k.metrics.localGlyph?2:1,V={x:0,y:0,w:k.bitmap.width+2*F,h:k.bitmap.height+2*F};h.push(V),C[D]=V}}const{w:p,h:_}=p0(h),v=new oa({width:p||1,height:_||1});for(const w in i){const A=i[w];for(const C in A.glyphs){const D=A.glyphs[+C];if(!D||D.bitmap.width===0||D.bitmap.height===0)continue;const k=c[w][C],F=D.metrics.localGlyph?2:1;oa.copy(D.bitmap,v,{x:0,y:0},{x:k.x+F,y:k.y+F},D.bitmap)}}this.image=v,this.positions=c}}Vt(jT,"GlyphAtlas");class Vk{constructor(i){this.tileID=new Tn(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile,this.tileTransform=Ac(i.tileID.canonical,i.projection),this.projection=i.projection}parse(i,c,h,p,_){this.status="parsing",this.data=i,this.collisionBoxArray=new $v;const v=new ET(Object.keys(i.layers).sort()),w=new BT(this.tileID,this.promoteId);w.bucketLayerIDs=[];const A={},C=new O0(256,256),D={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:h},k=c.familiesBySource[this.source];for(const Le in k){const je=i.layers[Le];if(!je)continue;let qe=!1,Xe=!1;for(const Ue of k[Le])Ue[0].type==="symbol"?qe=!0:Xe=!0;if(this.isSymbolTile===!0&&!qe||this.isSymbolTile===!1&&!Xe)continue;je.version===1&&Nt(`Vector tile source "${this.source}" layer "${Le}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const at=v.encode(Le),vt=[];for(let Ue=0;Ue<je.length;Ue++){const nt=je.feature(Ue),xt=w.getId(nt,Le);vt.push({feature:nt,id:xt,index:Ue,sourceLayerIndex:at})}for(const Ue of k[Le]){const nt=Ue[0];this.isSymbolTile!==void 0&&nt.type==="symbol"!==this.isSymbolTile||nt.minzoom&&this.zoom<Math.floor(nt.minzoom)||nt.maxzoom&&this.zoom>=nt.maxzoom||nt.visibility!=="none"&&(F0(Ue,this.zoom,h),(A[nt.id]=nt.createBucket({index:w.bucketLayerIDs.length,layers:Ue,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:at,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:h})).populate(vt,D,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(Ue.map(xt=>xt.id)))}}let F,V,H,Q;C.trim();const ce={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ge=ut(D.glyphDependencies,Le=>Object.keys(Le).map(Number));Object.keys(ge).length?p.send("getGlyphs",{uid:this.uid,stacks:ge},(Le,je)=>{F||(F=Le,V=je,De.call(this))},void 0,!1,ce):V={};const Ce=Object.keys(D.iconDependencies);Ce.length?p.send("getImages",{icons:Ce,source:this.source,tileID:this.tileID,type:"icons"},(Le,je)=>{F||(F=Le,H=je,De.call(this))},void 0,!1,ce):H={};const Pe=Object.keys(D.patternDependencies);function De(){if(F)return _(F);if(V&&H&&Q){const Le=new jT(V),je=new $E(H,Q);for(const qe in A){const Xe=A[qe];Xe instanceof ol?(F0(Xe.layers,this.zoom,h),uk(Xe,V,Le.positions,H,je.iconPositions,this.showCollisionBoxes,h,this.tileID.canonical,this.tileZoom,this.projection)):Xe.hasPattern&&(Xe instanceof yg||Xe instanceof pg||Xe instanceof vf)&&(F0(Xe.layers,this.zoom,h),Xe.addFeatures(D,this.tileID.canonical,je.patternPositions,h,this.tileTransform))}this.status="done",_(null,{buckets:we(A).filter(qe=>!qe.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Le.image,lineAtlas:C,imageAtlas:je,glyphMap:this.returnDependencies?V:null,iconMap:this.returnDependencies?H:null,glyphPositions:this.returnDependencies?Le.positions:null})}}Pe.length?p.send("getImages",{icons:Pe,source:this.source,tileID:this.tileID,type:"patterns"},(Le,je)=>{F||(F=Le,Q=je,De.call(this))},void 0,!1,ce):Q={},De.call(this)}}function F0(l,i,c){const h=new he(i);for(const p of l)p.recalculate(h,c)}class $T{constructor(i){this.entries={},this.scheduler=i}request(i,c,h,p){const _=this.entries[i]=this.entries[i]||{callbacks:[]};if(_.result){const[v,w]=_.result;return this.scheduler?this.scheduler.add(()=>{p(v,w)},c):p(v,w),()=>{}}return _.callbacks.push(p),_.cancel||(_.cancel=h((v,w)=>{_.result=[v,w];for(const A of _.callbacks)this.scheduler?this.scheduler.add(()=>{A(v,w)},c):A(v,w);setTimeout(()=>delete this.entries[i],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(v=>v!==p),_.callbacks.length||(_.cancel(),delete this.entries[i]))}}}function VT(l,i,c){const h=JSON.stringify(l.request);return l.data&&(this.deduped.entries[h]={result:[null,l.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},p=>{const _=Y(l.request,(v,w,A,C)=>{v?p(v):w&&p(null,{vectorTile:c?void 0:new Tc.VectorTile(new Ef(w)),rawData:w,cacheControl:A,expires:C})});return()=>{_.cancel(),p()}},i)}o.ARRAY_TYPE=Yn,o.AUTH_ERR_MSG=fr,o.Aabb=ps,o.Actor=class{constructor(l,i,c){this.target=l,this.parent=i,this.mapId=c,this.callbacks={},this.cancelCallbacks={},Ve(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ne()?l:g,this.scheduler=new Fk}send(l,i,c,h,p=!1,_){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=_,this.callbacks[v]=c);const w=mt(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:l,hasCallback:!!c,targetMapId:h,mustQueue:p,sourceMapId:this.mapId,data:dc(i,w)},w),{cancel:()=>{c&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(l){const i=l.data,c=i.id;if(c&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const h=this.cancelCallbacks[c];delete this.cancelCallbacks[c],h&&h.cancel()}else if(i.mustQueue||Ne()){const h=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,i),h&&h.metadata||{type:"message"})}else this.processTask(c,i)}processTask(l,i){if(i.type==="<response>"){const c=this.callbacks[l];delete this.callbacks[l],c&&(i.error?c(fc(i.error)):c(null,fc(i.data)))}else{const c=mt(this.globalScope)?void 0:[],h=i.hasCallback?(_,v)=>{delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:_?dc(_):null,data:dc(v,c)},c)}:_=>{},p=fc(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,p,h);else if(this.parent.getWorkerSource){const _=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,_[0],p.source)[_[1]](p,h)}else h(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=gg,o.Color=_i,o.ColorMode=Co,o.CullFaceMode=io,o.DEMData=Lg,o.DataConstantProperty=Ge,o.DedupedRequest=$T,o.DepthMode=yh,o.EXTENT=nr,o.Elevation=class{isDataAvailableAtPoint(l){const i=this._source();if(!i||l.y<0||l.y>1)return!1;const c=i.getSource().maxzoom,h=1<<c,p=Math.floor(l.x),_=Math.floor((l.x-p)*h),v=Math.floor(l.y*h),w=this.findDEMTileFor(new Tn(c,p,c,_,v));return!(!w||!w.dem)}getAtPointOrZero(l,i=0){return this.getAtPoint(l,i)||0}getAtPoint(l,i,c=!0){i==null&&(i=null);const h=this._source();if(!h||l.y<0||l.y>1)return i;const p=h.getSource().maxzoom,_=1<<p,v=Math.floor(l.x),w=l.x-v,A=new Tn(p,v,p,Math.floor(w*_),Math.floor(l.y*_)),C=this.findDEMTileFor(A);if(!C||!C.dem)return i;const D=C.dem,k=1<<C.tileID.canonical.z,F=(w*k-C.tileID.canonical.x)*D.dim,V=(l.y*k-C.tileID.canonical.y)*D.dim,H=Math.floor(F),Q=Math.floor(V);return(c?this.exaggeration():1)*Dr(Dr(D.get(H,Q),D.get(H,Q+1),V-Q),Dr(D.get(H+1,Q),D.get(H+1,Q+1),V-Q),F-H)}getAtTileOffset(l,i,c){const h=1<<l.canonical.z;return this.getAtPointOrZero(new sh(l.wrap+(l.canonical.x+i/nr)/h,(l.canonical.y+c/nr)/h))}getAtTileOffsetFunc(l,i,c,h){return p=>{const _=this.getAtTileOffset(l,p.x,p.y),v=h.upVector(l.canonical,p.x,p.y);return Eo(v,v,_*h.upVectorScale(l.canonical,i,c).metersToTile),v}}getForTilePoints(l,i,c,h){const p=kg.create(this,l,h);return!!p&&(i.forEach(_=>{_[2]=this.exaggeration()*p.getElevationAt(_[0],_[1],c)}),!0)}getMinMaxForTile(l){const i=this.findDEMTileFor(l);if(!i||!i.dem)return null;const c=i.dem.tree,h=i.tileID,p=1<<l.canonical.z-h.canonical.z;let _=l.canonical.x/p-h.canonical.x,v=l.canonical.y/p-h.canonical.y,w=0;for(let A=0;A<l.canonical.z-h.canonical.z&&!c.leaves[w];A++){_*=2,v*=2;const C=2*Math.floor(v)+Math.floor(_);w=c.childOffsets[w]+C,_%=1,v%=1}return{min:this.exaggeration()*c.minimums[w],max:this.exaggeration()*c.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,i,c){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=Wt,o.EvaluationParameters=he,o.Event=lr,o.Evented=ar,o.FillExtrusionBucket=vf,o.Frustum=i0,o.FrustumCorners=r0,o.GLOBE_METERS_TO_ECEF=E0,o.GLOBE_RADIUS=Sc,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=6,o.GLOBE_ZOOM_THRESHOLD_MIN=5,o.GlobeSharedBuffers=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const l of this._wireframeSegments)l.destroy()}}_createGrid(l){const i=new tr,c=new Mr,h=65;for(let p=0;p<h;p++)for(let _=0;_<h;_++)i.emplaceBack(_,p);this._gridSegments=[];for(let p=0,_=0;p<gh.length;p++){const v=gh[p];for(let A=0;A<v;A++)for(let C=0;C<64;C++){const D=A*h+C;c.emplaceBack(D+1,D,D+h),c.emplaceBack(D+h,D+h+1,D+1)}const w=64*v*2;this._gridSegments.push(Si.simpleSegment(0,_,(v+1)*h,w)),_+=w}this._gridBuffer=l.createVertexBuffer(i,Af.members),this._gridIndexBuffer=l.createIndexBuffer(c,!0)}_createPoles(l){const i=new Mr;for(let p=0;p<=64;p++)i.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=l.createIndexBuffer(i,!0);const c=new Xa,h=new Xa;this._poleSegments=[];for(let p=0,_=0;p<5;p++){const v=1<<p,w=512*v/Math.PI/2,A=360/v;c.emplaceBack(0,-w,0,0,0,.5,0),h.emplaceBack(0,-w,0,0,0,.5,1);for(let C=0;C<=64;C++){const D=C/64,k=Dr(0,A,D),[F,V,H]=uT(_k,yk,k,w);c.emplaceBack(F,V,H,0,0,D,0),h.emplaceBack(F,V,H,0,0,D,1)}this._poleSegments.push(Si.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(c,aT,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(h,aT,!1)}getGridBuffers(l){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[l]]}getPoleBuffers(l){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}getWirefameBuffers(l,i){if(!this._wireframeSegments){const c=new Oi,h=64,p=h+1;this._wireframeSegments=[];for(let _=0,v=0;_<gh.length;_++){const w=gh[_];for(let C=0;C<w;C++)for(let D=0;D<h;D++){const k=C*p+D;c.emplaceBack(k,k+1),c.emplaceBack(k,k+p),c.emplaceBack(k,k+p+1)}const A=w*h*3;this._wireframeSegments.push(Si.simpleSegment(0,v,(w+1)*p,A)),v+=A}this._wireframeIndexBuffer=l.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[i]]}},o.GlyphManager=ph,o.ImagePosition=m0,o.LineAtlas=O0,o.LngLat=Wr,o.LngLatBounds=el,o.LocalGlyphMode=v0,o.MAX_MERCATOR_LATITUDE=bo,o.MercatorCoordinate=sh,o.ONE_EM=an,o.OverscaledTileID=Tn,o.Properties=Qe,o.RGBAImage=Qn,o.Ray=t0,o.RequestManager=class{constructor(l,i,c){this._transformRequestFn=l,this._customAccessToken=i,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const l=function(){let i="";for(let c=0;c<10;c++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",xr,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(l,i){return this._transformRequestFn&&this._transformRequestFn(l,i)||{url:l}}normalizeStyleURL(l,i){if(!br(l))return l;const c=Ei(l);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||i)}normalizeGlyphsURL(l,i){if(!br(l))return l;const c=Ei(l);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||i)}normalizeSourceURL(l,i,c,h){if(!br(l))return l;const p=Ei(l);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),c&&p.params.push(`language=${c}`),h&&p.params.push(`worldview=${h}`),this._makeAPIURL(p,this._customAccessToken||i)}normalizeSpriteURL(l,i,c,h){const p=Ei(l);return br(l)?(p.path=`/styles/v1${p.path}/sprite${i}${c}`,this._makeAPIURL(p,this._customAccessToken||h)):(p.path+=`${i}${c}`,ui(p))}normalizeTileURL(l,i,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!br(l))return l;const h=Ei(l);h.path=h.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||c&&h.authority!=="raster"&&c===512?"@2x":""}${pt.supported?".webp":"$1"}`),h.authority==="raster"?h.path=`/${Ye.RASTER_URL_PREFIX}${h.path}`:(h.path=h.path.replace(/^.+\/v4\//,"/"),h.path=`/${Ye.TILE_URL_VERSION}${h.path}`);const p=this._customAccessToken||function(_){for(const v of _){const w=v.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(h.params)||Ye.ACCESS_TOKEN;return Ye.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&h.params.push(`sku=${this._skuToken}`),this._makeAPIURL(h,p)}canonicalizeTileURL(l,i){const c=Ei(l);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return l;let h="mapbox://";c.path.match(/^\/raster\/v1\//)?h+=`raster/${c.path.replace(`/${Ye.RASTER_URL_PREFIX}/`,"")}`:h+=`tiles/${c.path.replace(`/${Ye.TILE_URL_VERSION}/`,"")}`;let p=c.params;return i&&(p=p.filter(_=>!_.match(/^access_token=/))),p.length&&(h+=`?${p.join("&")}`),h}canonicalizeTileset(l,i){const c=!!i&&br(i),h=[];for(const p of l.tiles||[])Qr(p)?h.push(this.canonicalizeTileURL(p,c)):h.push(p);return h}_makeAPIURL(l,i){const c="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",h=Ei(Ye.API_URL);if(l.protocol=h.protocol,l.authority=h.authority,l.protocol==="http"){const p=l.params.indexOf("secure");p>=0&&l.params.splice(p,1)}if(h.path!=="/"&&(l.path=`${h.path}${l.path}`),!Ye.REQUIRE_ACCESS_TOKEN)return ui(l);if(i=i||Ye.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(i[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return l.params=l.params.filter(p=>p.indexOf("access_token")===-1),l.params.push(`access_token=${i||""}`),ui(l)}},o.ResourceType=Ee,o.SegmentVector=Si,o.SourceCache=Pc,o.StencilMode=L0,o.StructArrayLayout1ui2=Rs,o.StructArrayLayout2f1f2i16=$r,o.StructArrayLayout2i4=tr,o.StructArrayLayout2ui4=Oi,o.StructArrayLayout3f12=Ki,o.StructArrayLayout3ui6=Mr,o.StructArrayLayout4i8=Xt,o.StructArrayLayout5f20=Ya,o.Texture=Df,o.Tile=D0,o.Transitionable=_e,o.Uniform1f=Jm,o.Uniform1i=class extends ia{constructor(l,i){super(l,i),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},o.Uniform2f=class extends ia{constructor(l,i){super(l,i),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},o.Uniform3f=class extends ia{constructor(l,i){super(l,i),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},o.Uniform4f=$w,o.UniformColor=Vw,o.UniformMatrix2f=class extends ia{constructor(l,i){super(l,i),this.current=AR}set(l){for(let i=0;i<4;i++)if(l[i]!==this.current[i]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}},o.UniformMatrix3f=class extends ia{constructor(l,i){super(l,i),this.current=SR}set(l){for(let i=0;i<9;i++)if(l[i]!==this.current[i]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}},o.UniformMatrix4f=class extends ia{constructor(l,i){super(l,i),this.current=TR}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let i=1;i<16;i++)if(l[i]!==this.current[i]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},o.UnwrappedTileID=CE,o.ValidationError=$t,o.VectorTileWorkerSource=class extends ar{constructor(l,i,c,h,p){super(),this.actor=l,this.layerIndex=i,this.availableImages=c,this.loadVectorData=p||VT,this.loading={},this.loaded={},this.deduped=new $T(l.scheduler),this.isSpriteLoaded=h,this.scheduler=l.scheduler}loadTile(l,i){const c=l.uid,h=l&&l.request,p=h&&h.collectResourceTiming,_=this.loading[c]=new Vk(l);_.abort=this.loadVectorData(l,(v,w)=>{const A=!this.loading[c];if(delete this.loading[c],A||v||!w)return _.status="done",A||(this.loaded[c]=_),i(v);const C=w.rawData,D={};w.expires&&(D.expires=w.expires),w.cacheControl&&(D.cacheControl=w.cacheControl),_.vectorTile=w.vectorTile||new Tc.VectorTile(new Ef(C));const k=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(F,V)=>{if(F||!V)return i(F);const H={};if(p){const Q=ye(h);Q.length>0&&(H.resourceTiming=JSON.parse(JSON.stringify(Q)))}i(null,xe({rawTileData:C.slice(0)},V,D,H))})};this.isSpriteLoaded?k():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(k,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom}):k()}),this.loaded=this.loaded||{},this.loaded[c]=_})}reloadTile(l,i){const c=this.loaded,h=l.uid,p=this;if(c&&c[h]){const _=c[h];_.showCollisionBoxes=l.showCollisionBoxes,_.enableTerrain=!!l.enableTerrain,_.projection=l.projection,_.tileTransform=Ac(l.tileID.canonical,l.projection);const v=(w,A)=>{const C=_.reloadCallback;C&&(delete _.reloadCallback,_.parse(_.vectorTile,p.layerIndex,this.availableImages,p.actor,C)),i(w,A)};_.status==="parsing"?_.reloadCallback=v:_.status==="done"&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(l,i){const c=l.uid,h=this.loading[c];h&&(h.abort&&h.abort(),delete this.loading[c]),i()}removeTile(l,i){const c=this.loaded,h=l.uid;c&&c[h]&&delete c[h],i()}},o.WritingMode=ms,o.ZoomHistory=jm,o.add=rl,o.addDynamicAttributes=Og,o.adjoint=function(l,i){var c=i[0],h=i[1],p=i[2],_=i[3],v=i[4],w=i[5],A=i[6],C=i[7],D=i[8];return l[0]=v*D-w*C,l[1]=p*C-h*D,l[2]=h*w-p*v,l[3]=w*A-_*D,l[4]=c*D-p*A,l[5]=p*_-c*w,l[6]=_*C-v*A,l[7]=h*A-c*C,l[8]=c*v-h*_,l},o.asyncAll=ne,o.bezier=G,o.bindAll=Ve,o.boundsAttributes=AT,o.bufferConvexPolygon=function(l,i){const c=[];for(let h=0;h<l.length;h++){const p=ue(h-1,-1,l.length-1),_=ue(h+1,-1,l.length-1),v=l[h],w=l[_],A=l[p].sub(v).unit(),C=w.sub(v).unit(),D=C.angleWithSep(A.x,A.y),k=A.add(C).unit().mult(-1*i/Math.sin(D/2));c.push(v.add(k))}return c},o.cacheEntryPossiblyAdded=function(l){pe++,pe>Ra&&(l.getActor().send("enforceCacheSizeLimit",Ln),pe=0)},o.calculateGlobeLabelMatrix=function(l,i){const{x:c,y:h}=l.point,p=fT(c,h,l.worldSize/l._projectionScaler,0,0);return tl(p,p,dT(So(i)))},o.calculateGlobeMatrix=function(l){const{x:i,y:c}=l.point,{lng:h,lat:p}=l._center;return fT(i,c,l.worldSize,h,p)},o.calculateGlobeMercatorMatrix=function(l){const i=l.worldSize,c=l.point,h=Ls(1,l.center.lat)*i,p=l.pixelsPerMeter,_=i/(h/l.pixelsPerMeter),v=Jn(new Float64Array(16));return wc(v,v,[c.x,c.y,0]),wo(v,v,[_,_,p]),Float32Array.from(v)},o.circumferenceAtLatitude=Hv,o.clamp=X,o.clearTileCache=function(l){const i=[];for(const c in Zi)i.push(g.caches.delete(c)),delete Zi[c];l&&Promise.all(i).catch(l).then(()=>l())},o.clipLine=QE,o.clone=function(l){var i=new Yn(16);return i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3],i[4]=l[4],i[5]=l[5],i[6]=l[6],i[7]=l[7],i[8]=l[8],i[9]=l[9],i[10]=l[10],i[11]=l[11],i[12]=l[12],i[13]=l[13],i[14]=l[14],i[15]=l[15],i},o.clone$1=Et,o.collisionCircleLayout=zL,o.config=Ye,o.conjugate=function(l,i){return l[0]=-i[0],l[1]=-i[1],l[2]=-i[2],l[3]=i[3],l},o.create=function(){var l=new Yn(16);return Yn!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},o.create$1=tE,o.createExpression=Yo,o.createLayout=Pt,o.createStyleLayer=function(l){return l.type==="custom"?new Rk(l):new kk[l.type](l)},o.cross=e0,o.degToRad=z,o.distance=function(l,i){return Math.hypot(i[0]-l[0],i[1]-l[1],i[2]-l[2])},o.div=function(l,i,c){return l[0]=i[0]/c[0],l[1]=i[1]/c[1],l[2]=i[2]/c[2],l},o.dot=ks,o.ease=K,o.easeCubicInOut=j,o.emitValidationErrors=Fm,o.endsWith=Je,o.enforceCacheSizeLimit=function(l){for(const i in Zi)me(i),Zi[i].then(c=>{c.keys().then(h=>{for(let p=0;p<h.length-l;p++)c.delete(h[p])})})},o.evaluateSizeForFeature=vg,o.evaluateSizeForZoom=uh,o.evaluateVariableOffset=nT,o.evented=le,o.exactEquals=function(l,i){return l[0]===i[0]&&l[1]===i[1]&&l[2]===i[2]&&l[3]===i[3]},o.exactEquals$1=function(l,i){return l[0]===i[0]&&l[1]===i[1]&&l[2]===i[2]},o.exported=gt,o.exported$1=pt,o.extend=xe,o.extend$1=Ir,o.fillExtrusionHeightLift=SE,o.filterObject=ht,o.fromMat4=function(l,i){return l[0]=i[0],l[1]=i[1],l[2]=i[2],l[3]=i[4],l[4]=i[5],l[5]=i[6],l[6]=i[8],l[7]=i[9],l[8]=i[10],l},o.fromQuat=function(l,i){var c=i[0],h=i[1],p=i[2],_=i[3],v=c+c,w=h+h,A=p+p,C=c*v,D=h*v,k=h*w,F=p*v,V=p*w,H=p*A,Q=_*v,ce=_*w,ge=_*A;return l[0]=1-k-H,l[1]=D+ge,l[2]=F-ce,l[3]=0,l[4]=D-ge,l[5]=1-C-H,l[6]=V+Q,l[7]=0,l[8]=F+ce,l[9]=V-Q,l[10]=1-C-k,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},o.fromRotation=function(l,i){var c=Math.sin(i),h=Math.cos(i);return l[0]=h,l[1]=c,l[2]=0,l[3]=-c,l[4]=h,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},o.fromScaling=function(l,i){return l[0]=i[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=i[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=i[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},o.furthestTileCorner=function(l){const i=Math.round((l+45+360)%360/90)%4;return $[i]},o.getAABBPointSquareDist=function(l,i,c){let h=0;for(let p=0;p<2;++p){const _=c?c[p]:0;l[p]>_&&(h+=(l[p]-_)*(l[p]-_)),i[p]<_&&(h+=(_-i[p])*(_-i[p]))}return h},o.getAnchorAlignment=y0,o.getAnchorJustification=b0,o.getBounds=function(l){let i=1/0,c=1/0,h=-1/0,p=-1/0;for(const _ of l)i=Math.min(i,_.x),c=Math.min(c,_.y),h=Math.max(h,_.x),p=Math.max(p,_.y);return{min:new S(i,c),max:new S(h,p)}},o.getColumn=Zt,o.getGridMatrix=function(l,i,c){const[h,p]=i,_=.015625;return[0,(p[1]-h[1])*_,1<<l.z,(p[0]-h[0])/gh[c],0,l.y,h[0],h[1],_]},o.getImage=jt,o.getJSON=function(l,i){return q(xe(l,{type:"json"}),i)},o.getLatitudinalLod=function(l){const i=80.051129;l=X(l,-80.051129,i)/i*90;const c=Math.pow(Math.abs(Math.sin(z(l))),3);return Math.round(c*(gh.length-1))},o.getMapSessionAPI=Ks,o.getPerformanceMeasurement=ye,o.getProjection=bT,o.getRTLTextPluginStatus=ie,o.getReferrer=ee,o.getTilePoint=function(l,{x:i,y:c},h=0){return new S(((i-h)*l.scale-l.x)*nr,(c*l.scale-l.y)*nr)},o.getTileVec3=function(l,i,c=0){return ah(((i.x-c)*l.scale-l.x)*nr,(i.y*l.scale-l.y)*nr,Hw(i.z,i.y))},o.getVideo=function(l,i){const c=g.document.createElement("video");c.muted=!0,c.onloadstart=function(){i(null,c)};for(let h=0;h<l.length;h++){const p=g.document.createElement("source");rt(l[h])||(c.crossOrigin="Anonymous"),p.src=l[h],c.appendChild(p)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(l){const i=[0,0,0],c=Jn(new Float64Array(16));return tl(c,l.pixelMatrix,l.globeMatrix),on(i,i,c),new S(i[0],i[1])},o.globeECEFOrigin=function(l,i){const c=[0,0,0];return on(c,c,Pf(So(i.canonical))),on(c,c,l),c},o.globeNormalizeECEF=Pf,o.globePixelsToTileUnits=function(l,i){return nr/(512*Math.pow(2,l))*Ag(So(i))},o.globePoleMatrixForTile=function(l,i,c){const h=Jn(new Float64Array(16)),p=1<<l,_=360*(i/p-.5),v=c.point,w=c.worldSize/(c.tileSize*p);return wc(h,h,[v.x,v.y,-c.worldSize/Math.PI/2]),wo(h,h,[w,w,w]),ng(h,h,z(-c._center.lat)),sg(h,h,z(-c._center.lng+_)),Float32Array.from(h)},o.globeTileBounds=So,o.globeTileLatLngCorners=S0,o.globeTiltAtLngLat=pT,o.globeToMercatorTransition=A0,o.globeUseCustomAntiAliasing=function(l,i,c){const h=A0(c.zoom),p=l.style.map._antialias,_=!!i.extStandardDerivatives,v=i.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return h===0&&!p&&!v&&_},o.identity=Jn,o.identity$1=lE,o.invert=function(l,i){var c=i[0],h=i[1],p=i[2],_=i[3],v=i[4],w=i[5],A=i[6],C=i[7],D=i[8],k=i[9],F=i[10],V=i[11],H=i[12],Q=i[13],ce=i[14],ge=i[15],Ce=c*w-h*v,Pe=c*A-p*v,De=c*C-_*v,Le=h*A-p*w,je=h*C-_*w,qe=p*C-_*A,Xe=D*Q-k*H,at=D*ce-F*H,vt=D*ge-V*H,Ue=k*ce-F*Q,nt=k*ge-V*Q,xt=F*ge-V*ce,bt=Ce*xt-Pe*nt+De*Ue+Le*vt-je*at+qe*Xe;return bt?(l[0]=(w*xt-A*nt+C*Ue)*(bt=1/bt),l[1]=(p*nt-h*xt-_*Ue)*bt,l[2]=(Q*qe-ce*je+ge*Le)*bt,l[3]=(F*je-k*qe-V*Le)*bt,l[4]=(A*vt-v*xt-C*at)*bt,l[5]=(c*xt-p*vt+_*at)*bt,l[6]=(ce*De-H*qe-ge*Pe)*bt,l[7]=(D*qe-F*De+V*Pe)*bt,l[8]=(v*nt-w*vt+C*Xe)*bt,l[9]=(h*vt-c*nt-_*Xe)*bt,l[10]=(H*je-Q*De+ge*Ce)*bt,l[11]=(k*De-D*je-V*Ce)*bt,l[12]=(w*at-v*Ue-A*Xe)*bt,l[13]=(c*Ue-h*at+p*Xe)*bt,l[14]=(Q*Pe-H*Le-ce*Ce)*bt,l[15]=(D*Le-k*Pe+F*Ce)*bt,l):null},o.isLngLatBehindGlobe=function(l,i){return pT(l,i)>Math.PI/2*1.01},o.isMapAuthenticated=function(l){return Gn.has(l)},o.isMapboxURL=br,o.isSafariWithAntialiasingBug=function(l){const i=l.navigator?l.navigator.userAgent:null;return!!mt(l)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=Fi,o.len=UR,o.length=hf,o.length$1=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},o.loadVectorTile=VT,o.makeRequest=q,o.mapValue=function(l,i,c,h,p){return X((l-i)/(c-i)*(p-h)+h,h,p)},o.mercatorXfromLng=yc,o.mercatorYfromLat=vc,o.mercatorZfromAltitude=Ls,o.mul=$R,o.mul$1=VR,o.multiply=tl,o.multiply$1=function(l,i,c){var h=i[0],p=i[1],_=i[2],v=i[3],w=i[4],A=i[5],C=i[6],D=i[7],k=i[8],F=c[0],V=c[1],H=c[2],Q=c[3],ce=c[4],ge=c[5],Ce=c[6],Pe=c[7],De=c[8];return l[0]=F*h+V*v+H*C,l[1]=F*p+V*w+H*D,l[2]=F*_+V*A+H*k,l[3]=Q*h+ce*v+ge*C,l[4]=Q*p+ce*w+ge*D,l[5]=Q*_+ce*A+ge*k,l[6]=Ce*h+Pe*v+De*C,l[7]=Ce*p+Pe*w+De*D,l[8]=Ce*_+Pe*A+De*k,l},o.multiply$2=nE,o.nextPowerOfTwo=se,o.normalize=En,o.normalize$1=function(l,i){var c=i[0],h=i[1],p=i[2],_=i[3],v=c*c+h*h+p*p+_*_;return v>0&&(v=1/Math.sqrt(v)),l[0]=c*v,l[1]=h*v,l[2]=p*v,l[3]=_*v,l},o.number=Dr,o.ortho=function(l,i,c,h,p,_,v){var w=1/(i-c),A=1/(h-p),C=1/(_-v);return l[0]=-2*w,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*A,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*C,l[11]=0,l[12]=(i+c)*w,l[13]=(p+h)*A,l[14]=(v+_)*C,l[15]=1,l},o.pbf=Ef,o.perspective=function(l,i,c,h,p){var _,v=1/Math.tan(i/2);return l[0]=v/c,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=v,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,p!=null&&p!==1/0?(l[10]=(p+h)*(_=1/(h-p)),l[14]=2*p*h*_):(l[10]=-1,l[14]=-2*h),l},o.pick=function(l,i){const c={};for(let h=0;h<i.length;h++){const p=i[h];p in l&&(c[p]=l[p])}return c},o.plugin=oe,o.pointGeometry=S,o.polygonContainsPoint=bc,o.polygonIntersectsBox=Jw,o.polygonIntersectsPolygon=qw,o.polygonizeBounds=function(l,i,c=0,h=!0){const p=new S(c,c),_=l.sub(p),v=i.add(p),w=[_,new S(v.x,_.y),v,new S(_.x,v.y)];return h&&w.push(_.clone()),w},o.posAttributes=Af,o.postMapLoadEvent=zr,o.postTurnstileEvent=rr,o.potpack=p0,o.prevPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},o.radToDeg=B,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(l){return l({pluginStatus:U,pluginURL:Z}),le.on("pluginStateChange",l),l},o.removeAuthState=function(l){Gn.delete(l)},o.renderColorRamp=s0,o.resample=Ww,o.rotateX=ng,o.rotateX$1=cE,o.rotateY=sg,o.rotateY$1=uE,o.rotateZ=function(l,i,c){var h=Math.sin(c),p=Math.cos(c),_=i[0],v=i[1],w=i[2],A=i[3],C=i[4],D=i[5],k=i[6],F=i[7];return i!==l&&(l[8]=i[8],l[9]=i[9],l[10]=i[10],l[11]=i[11],l[12]=i[12],l[13]=i[13],l[14]=i[14],l[15]=i[15]),l[0]=_*p+C*h,l[1]=v*p+D*h,l[2]=w*p+k*h,l[3]=A*p+F*h,l[4]=C*p-_*h,l[5]=D*p-v*h,l[6]=k*p-w*h,l[7]=F*p-A*h,l},o.rotateZ$1=function(l,i,c){c*=.5;var h=i[0],p=i[1],_=i[2],v=i[3],w=Math.sin(c),A=Math.cos(c);return l[0]=h*A+p*w,l[1]=p*A-h*w,l[2]=_*A+v*w,l[3]=v*A-_*w,l},o.scale=wo,o.scale$1=oE,o.scale$2=Eo,o.scaleAndAdd=lg,o.setCacheLimits=function(l,i){Ln=l,Ra=i},o.setColumn=function(l,i,c){l[4*i+0]=c[0],l[4*i+1]=c[1],l[4*i+2]=c[2],l[4*i+3]=c[3]},o.setRTLTextPlugin=function(l,i,c=!1){if(U===M||U===O||U===L)throw new Error("setRTLTextPlugin cannot be called multiple times.");Z=gt.resolveURL(l),U=M,N=i,ae(),c||ve()},o.smoothstep=re,o.spec=ze,o.storeAuthState=function(l,i){i?Gn.add(l):Gn.delete(l)},o.sub=zs,o.subtract=Qv,o.symbolSize=FL,o.tileAABB=function(l,i,c,h,p,_,v,w,A){if(A.name==="globe")return gk(l,i,new gg(c,h,p));const C=Ac({z:c,x:h,y:p},A);return new ps([(_+C.x/C.scale)*i,i*(C.y/C.scale),v],[(_+C.x2/C.scale)*i,i*(C.y2/C.scale),w])},o.tileTransform=Ac,o.transformMat3=function(l,i,c){var h=i[0],p=i[1],_=i[2];return l[0]=h*c[0]+p*c[3]+_*c[6],l[1]=h*c[1]+p*c[4]+_*c[7],l[2]=h*c[2]+p*c[5]+_*c[8],l},o.transformMat4=on,o.transformMat4$1=Ec,o.transformQuat=sE,o.translate=wc,o.transpose=function(l,i){if(l===i){var c=i[1],h=i[2],p=i[5];l[1]=i[3],l[2]=i[6],l[3]=c,l[5]=i[7],l[6]=h,l[7]=p}else l[0]=i[0],l[1]=i[3],l[2]=i[6],l[3]=i[1],l[4]=i[4],l[5]=i[7],l[6]=i[2],l[7]=i[5],l[8]=i[8];return l},o.triggerPluginCompletionEvent=te,o.uniqueId=Ie,o.updateGlobeVertexNormal=function(l,i,c,h,p){const _=5*i+2;l.float32[_+0]=c,l.float32[_+1]=h,l.float32[_+2]=p},o.validateCustomStyleLayer=function(l){const i=[],c=l.id;return c===void 0&&i.push({message:`layers.${c}: missing required property "id"`}),l.render===void 0&&i.push({message:`layers.${c}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&i.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),i},o.validateFilter=l=>ds(Kd(l)),o.validateFog=l=>ds(Rm(l)),o.validateLayer=l=>ds(Om(l)),o.validateLight=l=>ds(Xd(l)),o.validateSource=l=>ds(Dm(l)),o.validateStyle=km,o.validateTerrain=l=>ds(Yd(l)),o.values=we,o.vectorTile=Tc,o.version=Me,o.warnOnce=Nt,o.window=g,o.wrap=ue}),u(["./shared"],function(o){function g(me){if(typeof me=="number"||typeof me=="boolean"||typeof me=="string"||me==null)return JSON.stringify(me);if(Array.isArray(me)){let J="[";for(const pe of me)J+=`${g(pe)},`;return`${J}]`}let W="{";for(const J of Object.keys(me).sort())W+=`${J}:${g(me[J])},`;return`${W}}`}function x(me){let W="";for(const J of o.refProperties)W+=`/${g(me[J])}`;return W}class E{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,J){for(const Ee of W)this._layerConfigs[Ee.id]=Ee,(this._layers[Ee.id]=o.createStyleLayer(Ee)).compileFilter(),this.keyCache[Ee.id]&&delete this.keyCache[Ee.id];for(const Ee of J)delete this.keyCache[Ee],delete this._layerConfigs[Ee],delete this._layers[Ee];this.familiesBySource={};const pe=function(Ee,Oe){const ee={};for(let Y=0;Y<Ee.length;Y++){const fe=Oe&&Oe[Ee[Y].id]||x(Ee[Y]);Oe&&(Oe[Ee[Y].id]=fe);let Te=ee[fe];Te||(Te=ee[fe]=[]),Te.push(Ee[Y])}const q=[];for(const Y in ee)q.push(ee[Y]);return q}(o.values(this._layerConfigs),this.keyCache);for(const Ee of pe){const Oe=Ee.map(rt=>this._layers[rt.id]),ee=Oe[0];if(ee.visibility==="none")continue;const q=ee.source||"";let Y=this.familiesBySource[q];Y||(Y=this.familiesBySource[q]={});const fe=ee.sourceLayer||"_geojsonTileLayer";let Te=Y[fe];Te||(Te=Y[fe]=[]),Te.push(Oe)}}}class S{loadTile(W,J){const{uid:pe,encoding:Ee,rawImageData:Oe,padding:ee,buildQuadTree:q}=W,Y=o.window.ImageBitmap&&Oe instanceof o.window.ImageBitmap?this.getImageData(Oe,ee):Oe;J(null,new o.DEMData(pe,Y,Ee,ee<1,q))}getImageData(W,J){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(W.width,W.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=W.width,this.offscreenCanvas.height=W.height,this.offscreenCanvasContext.drawImage(W,0,0,W.width,W.height);const pe=this.offscreenCanvasContext.getImageData(-J,-J,W.width+2*J,W.height+2*J);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),pe}}var P=function me(W,J){var pe,Ee=W&&W.type;if(Ee==="FeatureCollection")for(pe=0;pe<W.features.length;pe++)me(W.features[pe],J);else if(Ee==="GeometryCollection")for(pe=0;pe<W.geometries.length;pe++)me(W.geometries[pe],J);else if(Ee==="Feature")me(W.geometry,J);else if(Ee==="Polygon")I(W.coordinates,J);else if(Ee==="MultiPolygon")for(pe=0;pe<W.coordinates.length;pe++)I(W.coordinates[pe],J);return W};function I(me,W){if(me.length!==0){R(me[0],W);for(var J=1;J<me.length;J++)R(me[J],!W)}}function R(me,W){for(var J=0,pe=0,Ee=0,Oe=me.length,ee=Oe-1;Ee<Oe;ee=Ee++){var q=(me[Ee][0]-me[ee][0])*(me[ee][1]+me[Ee][1]),Y=J+q;pe+=Math.abs(J)>=Math.abs(q)?J-Y+q:q-Y+J,J=Y}J+pe>=0!=!!W&&me.reverse()}const z=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class B{constructor(W){this._feature=W,this.extent=o.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))}loadGeometry(){if(this._feature.type===1){const W=[];for(const J of this._feature.geometry)W.push([new o.pointGeometry(J[0],J[1])]);return W}{const W=[];for(const J of this._feature.geometry){const pe=[];for(const Ee of J)pe.push(new o.pointGeometry(Ee[0],Ee[1]));W.push(pe)}return W}}toGeoJSON(W,J,pe){return z.call(this,W,J,pe)}}class ${constructor(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=W.length,this._features=W}feature(W){return new B(this._features[W])}}var j=o.vectorTile.VectorTileFeature,G=K;function K(me,W){this.options=W||{},this.features=me,this.length=me.length}function X(me,W){this.id=typeof me.id=="number"?me.id:void 0,this.type=me.type,this.rawGeometry=me.type===1?[me.geometry]:me.geometry,this.properties=me.tags,this.extent=W||4096}K.prototype.feature=function(me){return new X(this.features[me],this.options.extent)},X.prototype.loadGeometry=function(){var me=this.rawGeometry;this.geometry=[];for(var W=0;W<me.length;W++){for(var J=me[W],pe=[],Ee=0;Ee<J.length;Ee++)pe.push(new o.pointGeometry(J[Ee][0],J[Ee][1]));this.geometry.push(pe)}return this.geometry},X.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var me=this.geometry,W=1/0,J=-1/0,pe=1/0,Ee=-1/0,Oe=0;Oe<me.length;Oe++)for(var ee=me[Oe],q=0;q<ee.length;q++){var Y=ee[q];W=Math.min(W,Y.x),J=Math.max(J,Y.x),pe=Math.min(pe,Y.y),Ee=Math.max(Ee,Y.y)}return[W,pe,J,Ee]},X.prototype.toGeoJSON=j.prototype.toGeoJSON;var re=ne,ue=G;function ne(me){var W=new o.pbf;return function(J,pe){for(var Ee in J.layers)pe.writeMessage(3,we,J.layers[Ee])}(me,W),W.finish()}function we(me,W){var J;W.writeVarintField(15,me.version||1),W.writeStringField(1,me.name||""),W.writeVarintField(5,me.extent||4096);var pe={keys:[],values:[],keycache:{},valuecache:{}};for(J=0;J<me.length;J++)pe.feature=me.feature(J),W.writeMessage(2,xe,pe);var Ee=pe.keys;for(J=0;J<Ee.length;J++)W.writeStringField(3,Ee[J]);var Oe=pe.values;for(J=0;J<Oe.length;J++)W.writeMessage(4,Be,Oe[J])}function xe(me,W){var J=me.feature;J.id!==void 0&&W.writeVarintField(1,J.id),W.writeMessage(2,ke,me),W.writeVarintField(3,J.type),W.writeMessage(4,se,J)}function ke(me,W){var J=me.feature,pe=me.keys,Ee=me.values,Oe=me.keycache,ee=me.valuecache;for(var q in J.properties){var Y=J.properties[q],fe=Oe[q];if(Y!==null){fe===void 0&&(pe.push(q),Oe[q]=fe=pe.length-1),W.writeVarint(fe);var Te=typeof Y;Te!=="string"&&Te!=="boolean"&&Te!=="number"&&(Y=JSON.stringify(Y));var rt=Te+":"+Y,He=ee[rt];He===void 0&&(Ee.push(Y),ee[rt]=He=Ee.length-1),W.writeVarint(He)}}}function Ie(me,W){return(W<<3)+(7&me)}function Fe(me){return me<<1^me>>31}function se(me,W){for(var J=me.loadGeometry(),pe=me.type,Ee=0,Oe=0,ee=J.length,q=0;q<ee;q++){var Y=J[q],fe=1;pe===1&&(fe=Y.length),W.writeVarint(Ie(1,fe));for(var Te=pe===3?Y.length-1:Y.length,rt=0;rt<Te;rt++){rt===1&&pe!==1&&W.writeVarint(Ie(2,Te-1));var He=Y[rt].x-Ee,At=Y[rt].y-Oe;W.writeVarint(Fe(He)),W.writeVarint(Fe(At)),Ee+=He,Oe+=At}pe===3&&W.writeVarint(Ie(7,1))}}function Be(me,W){var J=typeof me;J==="string"?W.writeStringField(1,me):J==="boolean"?W.writeBooleanField(7,me):J==="number"&&(me%1!=0?W.writeDoubleField(3,me):me<0?W.writeSVarintField(6,me):W.writeVarintField(5,me))}function Ve(me,W,J,pe,Ee,Oe){if(Ee-pe<=J)return;const ee=pe+Ee>>1;Je(me,W,ee,pe,Ee,Oe%2),Ve(me,W,J,pe,ee-1,Oe+1),Ve(me,W,J,ee+1,Ee,Oe+1)}function Je(me,W,J,pe,Ee,Oe){for(;Ee>pe;){if(Ee-pe>600){const fe=Ee-pe+1,Te=J-pe+1,rt=Math.log(fe),He=.5*Math.exp(2*rt/3),At=.5*Math.sqrt(rt*He*(fe-He)/fe)*(Te-fe/2<0?-1:1);Je(me,W,J,Math.max(pe,Math.floor(J-Te*He/fe+At)),Math.min(Ee,Math.floor(J+(fe-Te)*He/fe+At)),Oe)}const ee=W[2*J+Oe];let q=pe,Y=Ee;for(ut(me,W,pe,J),W[2*Ee+Oe]>ee&&ut(me,W,pe,Ee);q<Y;){for(ut(me,W,q,Y),q++,Y--;W[2*q+Oe]<ee;)q++;for(;W[2*Y+Oe]>ee;)Y--}W[2*pe+Oe]===ee?ut(me,W,pe,Y):(Y++,ut(me,W,Y,Ee)),Y<=J&&(pe=Y+1),J<=Y&&(Ee=Y-1)}}function ut(me,W,J,pe){ht(me,J,pe),ht(W,2*J,2*pe),ht(W,2*J+1,2*pe+1)}function ht(me,W,J){const pe=me[W];me[W]=me[J],me[J]=pe}function Et(me,W,J,pe){const Ee=me-J,Oe=W-pe;return Ee*Ee+Oe*Oe}re.fromVectorTileJs=ne,re.fromGeojsonVt=function(me,W){W=W||{};var J={};for(var pe in me)J[pe]=new G(me[pe].features,W),J[pe].name=pe,J[pe].version=W.version,J[pe].extent=W.extent;return ne({layers:J})},re.GeoJSONWrapper=ue;const Qt=me=>me[0],Nt=me=>me[1];class yt{constructor(W,J=Qt,pe=Nt,Ee=64,Oe=Float64Array){this.nodeSize=Ee,this.points=W;const ee=W.length<65536?Uint16Array:Uint32Array,q=this.ids=new ee(W.length),Y=this.coords=new Oe(2*W.length);for(let fe=0;fe<W.length;fe++)q[fe]=fe,Y[2*fe]=J(W[fe]),Y[2*fe+1]=pe(W[fe]);Ve(q,Y,Ee,0,q.length-1,0)}range(W,J,pe,Ee){return function(Oe,ee,q,Y,fe,Te,rt){const He=[0,Oe.length-1,0],At=[];let Ft,jt;for(;He.length;){const Ot=He.pop(),qt=He.pop(),lr=He.pop();if(qt-lr<=rt){for(let ze=lr;ze<=qt;ze++)Ft=ee[2*ze],jt=ee[2*ze+1],Ft>=q&&Ft<=fe&&jt>=Y&&jt<=Te&&At.push(Oe[ze]);continue}const Wt=Math.floor((lr+qt)/2);Ft=ee[2*Wt],jt=ee[2*Wt+1],Ft>=q&&Ft<=fe&&jt>=Y&&jt<=Te&&At.push(Oe[Wt]);const ar=(Ot+1)%2;(Ot===0?q<=Ft:Y<=jt)&&(He.push(lr),He.push(Wt-1),He.push(ar)),(Ot===0?fe>=Ft:Te>=jt)&&(He.push(Wt+1),He.push(qt),He.push(ar))}return At}(this.ids,this.coords,W,J,pe,Ee,this.nodeSize)}within(W,J,pe){return function(Ee,Oe,ee,q,Y,fe){const Te=[0,Ee.length-1,0],rt=[],He=Y*Y;for(;Te.length;){const At=Te.pop(),Ft=Te.pop(),jt=Te.pop();if(Ft-jt<=fe){for(let ar=jt;ar<=Ft;ar++)Et(Oe[2*ar],Oe[2*ar+1],ee,q)<=He&&rt.push(Ee[ar]);continue}const Ot=Math.floor((jt+Ft)/2),qt=Oe[2*Ot],lr=Oe[2*Ot+1];Et(qt,lr,ee,q)<=He&&rt.push(Ee[Ot]);const Wt=(At+1)%2;(At===0?ee-Y<=qt:q-Y<=lr)&&(Te.push(jt),Te.push(Ot-1),Te.push(Wt)),(At===0?ee+Y>=qt:q+Y>=lr)&&(Te.push(Ot+1),Te.push(Ft),Te.push(Wt))}return rt}(this.ids,this.coords,W,J,pe,this.nodeSize)}}const et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:me=>me},Ne=Math.fround||(tt=new Float32Array(1),me=>(tt[0]=+me,tt[0]));var tt;class ft{constructor(W){this.options=it(Object.create(et),W),this.trees=new Array(this.options.maxZoom+1)}load(W){const{log:J,minZoom:pe,maxZoom:Ee,nodeSize:Oe}=this.options;J&&console.time("total time");const ee=`prepare ${W.length} points`;J&&console.time(ee),this.points=W;let q=[];for(let Y=0;Y<W.length;Y++)W[Y].geometry&&q.push(Ht(W[Y],Y));this.trees[Ee+1]=new yt(q,ot,st,Oe,Float32Array),J&&console.timeEnd(ee);for(let Y=Ee;Y>=pe;Y--){const fe=+Date.now();q=this._cluster(q,Y),this.trees[Y]=new yt(q,ot,st,Oe,Float32Array),J&&console.log("z%d: %d clusters in %dms",Y,q.length,+Date.now()-fe)}return J&&console.timeEnd("total time"),this}getClusters(W,J){let pe=((W[0]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,W[1]));let Oe=W[2]===180?180:((W[2]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)pe=-180,Oe=180;else if(pe>Oe){const Te=this.getClusters([pe,Ee,180,ee],J),rt=this.getClusters([-180,Ee,Oe,ee],J);return Te.concat(rt)}const q=this.trees[this._limitZoom(J)],Y=q.range(ye(pe),Me(ee),ye(Oe),Me(Ee)),fe=[];for(const Te of Y){const rt=q.points[Te];fe.push(rt.numPoints?Zt(rt):this.points[rt.index])}return fe}getChildren(W){const J=this._getOriginId(W),pe=this._getOriginZoom(W),Ee="No cluster with the specified id.",Oe=this.trees[pe];if(!Oe)throw new Error(Ee);const ee=Oe.points[J];if(!ee)throw new Error(Ee);const q=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),Y=Oe.within(ee.x,ee.y,q),fe=[];for(const Te of Y){const rt=Oe.points[Te];rt.parentId===W&&fe.push(rt.numPoints?Zt(rt):this.points[rt.index])}if(fe.length===0)throw new Error(Ee);return fe}getLeaves(W,J,pe){const Ee=[];return this._appendLeaves(Ee,W,J=J||10,pe=pe||0,0),Ee}getTile(W,J,pe){const Ee=this.trees[this._limitZoom(W)],Oe=Math.pow(2,W),{extent:ee,radius:q}=this.options,Y=q/ee,fe=(pe-Y)/Oe,Te=(pe+1+Y)/Oe,rt={features:[]};return this._addTileFeatures(Ee.range((J-Y)/Oe,fe,(J+1+Y)/Oe,Te),Ee.points,J,pe,Oe,rt),J===0&&this._addTileFeatures(Ee.range(1-Y/Oe,fe,1,Te),Ee.points,Oe,pe,Oe,rt),J===Oe-1&&this._addTileFeatures(Ee.range(0,fe,Y/Oe,Te),Ee.points,-1,pe,Oe,rt),rt.features.length?rt:null}getClusterExpansionZoom(W){let J=this._getOriginZoom(W)-1;for(;J<=this.options.maxZoom;){const pe=this.getChildren(W);if(J++,pe.length!==1)break;W=pe[0].properties.cluster_id}return J}_appendLeaves(W,J,pe,Ee,Oe){const ee=this.getChildren(J);for(const q of ee){const Y=q.properties;if(Y&&Y.cluster?Oe+Y.point_count<=Ee?Oe+=Y.point_count:Oe=this._appendLeaves(W,Y.cluster_id,pe,Ee,Oe):Oe<Ee?Oe++:W.push(q),W.length===pe)break}return Oe}_addTileFeatures(W,J,pe,Ee,Oe,ee){for(const q of W){const Y=J[q],fe=Y.numPoints;let Te,rt,He;if(fe)Te=Lt(Y),rt=Y.x,He=Y.y;else{const jt=this.points[Y.index];Te=jt.properties,rt=ye(jt.geometry.coordinates[0]),He=Me(jt.geometry.coordinates[1])}const At={type:1,geometry:[[Math.round(this.options.extent*(rt*Oe-pe)),Math.round(this.options.extent*(He*Oe-Ee))]],tags:Te};let Ft;fe?Ft=Y.id:this.options.generateId?Ft=Y.index:this.points[Y.index].id&&(Ft=this.points[Y.index].id),Ft!==void 0&&(At.id=Ft),ee.features.push(At)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(+W,this.options.maxZoom+1))}_cluster(W,J){const pe=[],{radius:Ee,extent:Oe,reduce:ee,minPoints:q}=this.options,Y=Ee/(Oe*Math.pow(2,J));for(let fe=0;fe<W.length;fe++){const Te=W[fe];if(Te.zoom<=J)continue;Te.zoom=J;const rt=this.trees[J+1],He=rt.within(Te.x,Te.y,Y),At=Te.numPoints||1;let Ft=At;for(const jt of He){const Ot=rt.points[jt];Ot.zoom>J&&(Ft+=Ot.numPoints||1)}if(Ft>At&&Ft>=q){let jt=Te.x*At,Ot=Te.y*At,qt=ee&&At>1?this._map(Te,!0):null;const lr=(fe<<5)+(J+1)+this.points.length;for(const Wt of He){const ar=rt.points[Wt];if(ar.zoom<=J)continue;ar.zoom=J;const ze=ar.numPoints||1;jt+=ar.x*ze,Ot+=ar.y*ze,ar.parentId=lr,ee&&(qt||(qt=this._map(Te,!0)),ee(qt,this._map(ar)))}Te.parentId=lr,pe.push(mt(jt/Ft,Ot/Ft,lr,Ft,qt))}else if(pe.push(Te),Ft>1)for(const jt of He){const Ot=rt.points[jt];Ot.zoom<=J||(Ot.zoom=J,pe.push(Ot))}}return pe}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,J){if(W.numPoints)return J?it({},W.properties):W.properties;const pe=this.points[W.index].properties,Ee=this.options.map(pe);return J&&Ee===pe?it({},Ee):Ee}}function mt(me,W,J,pe,Ee){return{x:Ne(me),y:Ne(W),zoom:1/0,id:J,parentId:-1,numPoints:pe,properties:Ee}}function Ht(me,W){const[J,pe]=me.geometry.coordinates;return{x:Ne(ye(J)),y:Ne(Me(pe)),zoom:1/0,index:W,parentId:-1}}function Zt(me){return{type:"Feature",id:me.id,properties:Lt(me),geometry:{type:"Point",coordinates:[(W=me.x,360*(W-.5)),$e(me.y)]}};var W}function Lt(me){const W=me.numPoints,J=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W;return it(it({},me.properties),{cluster:!0,cluster_id:me.id,point_count:W,point_count_abbreviated:J})}function ye(me){return me/360+.5}function Me(me){const W=Math.sin(me*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function $e(me){const W=(180-360*me)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function it(me,W){for(const J in W)me[J]=W[J];return me}function ot(me){return me.x}function st(me){return me.y}function gt(me,W,J,pe){for(var Ee,Oe=pe,ee=J-W>>1,q=J-W,Y=me[W],fe=me[W+1],Te=me[J],rt=me[J+1],He=W+3;He<J;He+=3){var At=lt(me[He],me[He+1],Y,fe,Te,rt);if(At>Oe)Ee=He,Oe=At;else if(At===Oe){var Ft=Math.abs(He-ee);Ft<q&&(Ee=He,q=Ft)}}Oe>pe&&(Ee-W>3&&gt(me,W,Ee,pe),me[Ee+2]=Oe,J-Ee>3&&gt(me,Ee,J,pe))}function lt(me,W,J,pe,Ee,Oe){var ee=Ee-J,q=Oe-pe;if(ee!==0||q!==0){var Y=((me-J)*ee+(W-pe)*q)/(ee*ee+q*q);Y>1?(J=Ee,pe=Oe):Y>0&&(J+=ee*Y,pe+=q*Y)}return(ee=me-J)*ee+(q=W-pe)*q}function Ye(me,W,J,pe){var Ee={id:me===void 0?null:me,type:W,geometry:J,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Oe){var ee=Oe.geometry,q=Oe.type;if(q==="Point"||q==="MultiPoint"||q==="LineString")pt(Oe,ee);else if(q==="Polygon"||q==="MultiLineString")for(var Y=0;Y<ee.length;Y++)pt(Oe,ee[Y]);else if(q==="MultiPolygon")for(Y=0;Y<ee.length;Y++)for(var fe=0;fe<ee[Y].length;fe++)pt(Oe,ee[Y][fe])}(Ee),Ee}function pt(me,W){for(var J=0;J<W.length;J+=3)me.minX=Math.min(me.minX,W[J]),me.minY=Math.min(me.minY,W[J+1]),me.maxX=Math.max(me.maxX,W[J]),me.maxY=Math.max(me.maxY,W[J+1])}function Tt(me,W,J,pe){if(W.geometry){var Ee=W.geometry.coordinates,Oe=W.geometry.type,ee=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2),q=[],Y=W.id;if(J.promoteId?Y=W.properties[J.promoteId]:J.generateId&&(Y=pe||0),Oe==="Point")St(Ee,q);else if(Oe==="MultiPoint")for(var fe=0;fe<Ee.length;fe++)St(Ee[fe],q);else if(Oe==="LineString")zt(Ee,q,ee,!1);else if(Oe==="MultiLineString"){if(J.lineMetrics){for(fe=0;fe<Ee.length;fe++)zt(Ee[fe],q=[],ee,!1),me.push(Ye(Y,"LineString",q,W.properties));return}Yt(Ee,q,ee,!1)}else if(Oe==="Polygon")Yt(Ee,q,ee,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(fe=0;fe<W.geometry.geometries.length;fe++)Tt(me,{id:Y,geometry:W.geometry.geometries[fe],properties:W.properties},J,pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(fe=0;fe<Ee.length;fe++){var Te=[];Yt(Ee[fe],Te,ee,!0),q.push(Te)}}me.push(Ye(Y,Oe,q,W.properties))}}function St(me,W){W.push(ur(me[0])),W.push(xr(me[1])),W.push(0)}function zt(me,W,J,pe){for(var Ee,Oe,ee=0,q=0;q<me.length;q++){var Y=ur(me[q][0]),fe=xr(me[q][1]);W.push(Y),W.push(fe),W.push(0),q>0&&(ee+=pe?(Ee*fe-Y*Oe)/2:Math.sqrt(Math.pow(Y-Ee,2)+Math.pow(fe-Oe,2))),Ee=Y,Oe=fe}var Te=W.length-3;W[2]=1,gt(W,0,Te,J),W[Te+2]=1,W.size=Math.abs(ee),W.start=0,W.end=W.size}function Yt(me,W,J,pe){for(var Ee=0;Ee<me.length;Ee++){var Oe=[];zt(me[Ee],Oe,J,pe),W.push(Oe)}}function ur(me){return me/360+.5}function xr(me){var W=Math.sin(me*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function fr(me,W,J,pe,Ee,Oe,ee,q){if(pe/=W,Oe>=(J/=W)&&ee<pe)return me;if(ee<J||Oe>=pe)return null;for(var Y=[],fe=0;fe<me.length;fe++){var Te=me[fe],rt=Te.geometry,He=Te.type,At=Ee===0?Te.minX:Te.minY,Ft=Ee===0?Te.maxX:Te.maxY;if(At>=J&&Ft<pe)Y.push(Te);else if(!(Ft<J||At>=pe)){var jt=[];if(He==="Point"||He==="MultiPoint")br(rt,jt,J,pe,Ee);else if(He==="LineString")Qr(rt,jt,J,pe,Ee,!1,q.lineMetrics);else if(He==="MultiLineString")Ei(rt,jt,J,pe,Ee,!1);else if(He==="Polygon")Ei(rt,jt,J,pe,Ee,!0);else if(He==="MultiPolygon")for(var Ot=0;Ot<rt.length;Ot++){var qt=[];Ei(rt[Ot],qt,J,pe,Ee,!0),qt.length&&jt.push(qt)}if(jt.length){if(q.lineMetrics&&He==="LineString"){for(Ot=0;Ot<jt.length;Ot++)Y.push(Ye(Te.id,He,jt[Ot],Te.tags));continue}He!=="LineString"&&He!=="MultiLineString"||(jt.length===1?(He="LineString",jt=jt[0]):He="MultiLineString"),He!=="Point"&&He!=="MultiPoint"||(He=jt.length===3?"Point":"MultiPoint"),Y.push(Ye(Te.id,He,jt,Te.tags))}}}return Y.length?Y:null}function br(me,W,J,pe,Ee){for(var Oe=0;Oe<me.length;Oe+=3){var ee=me[Oe+Ee];ee>=J&&ee<=pe&&(W.push(me[Oe]),W.push(me[Oe+1]),W.push(me[Oe+2]))}}function Qr(me,W,J,pe,Ee,Oe,ee){for(var q,Y,fe=Wi(me),Te=Ee===0?Un:or,rt=me.start,He=0;He<me.length-3;He+=3){var At=me[He],Ft=me[He+1],jt=me[He+2],Ot=me[He+3],qt=me[He+4],lr=Ee===0?At:Ft,Wt=Ee===0?Ot:qt,ar=!1;ee&&(q=Math.sqrt(Math.pow(At-Ot,2)+Math.pow(Ft-qt,2))),lr<J?Wt>J&&(Y=Te(fe,At,Ft,Ot,qt,J),ee&&(fe.start=rt+q*Y)):lr>pe?Wt<pe&&(Y=Te(fe,At,Ft,Ot,qt,pe),ee&&(fe.start=rt+q*Y)):ui(fe,At,Ft,jt),Wt<J&&lr>=J&&(Y=Te(fe,At,Ft,Ot,qt,J),ar=!0),Wt>pe&&lr<=pe&&(Y=Te(fe,At,Ft,Ot,qt,pe),ar=!0),!Oe&&ar&&(ee&&(fe.end=rt+q*Y),W.push(fe),fe=Wi(me)),ee&&(rt+=q)}var ze=me.length-3;At=me[ze],Ft=me[ze+1],jt=me[ze+2],(lr=Ee===0?At:Ft)>=J&&lr<=pe&&ui(fe,At,Ft,jt),ze=fe.length-3,Oe&&ze>=3&&(fe[ze]!==fe[0]||fe[ze+1]!==fe[1])&&ui(fe,fe[0],fe[1],fe[2]),fe.length&&W.push(fe)}function Wi(me){var W=[];return W.size=me.size,W.start=me.start,W.end=me.end,W}function Ei(me,W,J,pe,Ee,Oe){for(var ee=0;ee<me.length;ee++)Qr(me[ee],W,J,pe,Ee,Oe,!1)}function ui(me,W,J,pe){me.push(W),me.push(J),me.push(pe)}function Un(me,W,J,pe,Ee,Oe){var ee=(Oe-W)/(pe-W);return me.push(Oe),me.push(J+(Ee-J)*ee),me.push(1),ee}function or(me,W,J,pe,Ee,Oe){var ee=(Oe-J)/(Ee-J);return me.push(W+(pe-W)*ee),me.push(Oe),me.push(1),ee}function Gt(me,W){for(var J=[],pe=0;pe<me.length;pe++){var Ee,Oe=me[pe],ee=Oe.type;if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Ee=rr(Oe.geometry,W);else if(ee==="MultiLineString"||ee==="Polygon"){Ee=[];for(var q=0;q<Oe.geometry.length;q++)Ee.push(rr(Oe.geometry[q],W))}else if(ee==="MultiPolygon")for(Ee=[],q=0;q<Oe.geometry.length;q++){for(var Y=[],fe=0;fe<Oe.geometry[q].length;fe++)Y.push(rr(Oe.geometry[q][fe],W));Ee.push(Y)}J.push(Ye(Oe.id,ee,Ee,Oe.tags))}return J}function rr(me,W){var J=[];J.size=me.size,me.start!==void 0&&(J.start=me.start,J.end=me.end);for(var pe=0;pe<me.length;pe+=3)J.push(me[pe]+W,me[pe+1],me[pe+2]);return J}function Sr(me,W){if(me.transformed)return me;var J,pe,Ee,Oe=1<<me.z,ee=me.x,q=me.y;for(J=0;J<me.features.length;J++){var Y=me.features[J],fe=Y.geometry,Te=Y.type;if(Y.geometry=[],Te===1)for(pe=0;pe<fe.length;pe+=2)Y.geometry.push(zr(fe[pe],fe[pe+1],W,Oe,ee,q));else for(pe=0;pe<fe.length;pe++){var rt=[];for(Ee=0;Ee<fe[pe].length;Ee+=2)rt.push(zr(fe[pe][Ee],fe[pe][Ee+1],W,Oe,ee,q));Y.geometry.push(rt)}}return me.transformed=!0,me}function zr(me,W,J,pe,Ee,Oe){return[Math.round(J*(me*pe-Ee)),Math.round(J*(W*pe-Oe))]}function Ii(me,W,J,pe,Ee){for(var Oe=W===Ee.maxZoom?0:Ee.tolerance/((1<<W)*Ee.extent),ee={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:J,y:pe,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},q=0;q<me.length;q++){ee.numFeatures++,Ks(ee,me[q],Oe,Ee);var Y=me[q].minX,fe=me[q].minY,Te=me[q].maxX,rt=me[q].maxY;Y<ee.minX&&(ee.minX=Y),fe<ee.minY&&(ee.minY=fe),Te>ee.maxX&&(ee.maxX=Te),rt>ee.maxY&&(ee.maxY=rt)}return ee}function Ks(me,W,J,pe){var Ee=W.geometry,Oe=W.type,ee=[];if(Oe==="Point"||Oe==="MultiPoint")for(var q=0;q<Ee.length;q+=3)ee.push(Ee[q]),ee.push(Ee[q+1]),me.numPoints++,me.numSimplified++;else if(Oe==="LineString")Gn(ee,Ee,me,J,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(q=0;q<Ee.length;q++)Gn(ee,Ee[q],me,J,Oe==="Polygon",q===0);else if(Oe==="MultiPolygon")for(var Y=0;Y<Ee.length;Y++){var fe=Ee[Y];for(q=0;q<fe.length;q++)Gn(ee,fe[q],me,J,!0,q===0)}if(ee.length){var Te=W.tags||null;if(Oe==="LineString"&&pe.lineMetrics){for(var rt in Te={},W.tags)Te[rt]=W.tags[rt];Te.mapbox_clip_start=Ee.start/Ee.size,Te.mapbox_clip_end=Ee.end/Ee.size}var He={geometry:ee,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:Te};W.id!==null&&(He.id=W.id),me.features.push(He)}}function Gn(me,W,J,pe,Ee,Oe){var ee=pe*pe;if(pe>0&&W.size<(Ee?ee:pe))J.numPoints+=W.length/3;else{for(var q=[],Y=0;Y<W.length;Y+=3)(pe===0||W[Y+2]>ee)&&(J.numSimplified++,q.push(W[Y]),q.push(W[Y+1])),J.numPoints++;Ee&&function(fe,Te){for(var rt=0,He=0,At=fe.length,Ft=At-2;He<At;Ft=He,He+=2)rt+=(fe[He]-fe[Ft])*(fe[He+1]+fe[Ft+1]);if(rt>0===Te)for(He=0,At=fe.length;He<At/2;He+=2){var jt=fe[He],Ot=fe[He+1];fe[He]=fe[At-2-He],fe[He+1]=fe[At-1-He],fe[At-2-He]=jt,fe[At-1-He]=Ot}}(q,Oe),me.push(q)}}function rn(me,W){var J=(W=this.options=function(Ee,Oe){for(var ee in Oe)Ee[ee]=Oe[ee];return Ee}(Object.create(this.options),W)).debug;if(J&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var pe=function(Ee,Oe){var ee=[];if(Ee.type==="FeatureCollection")for(var q=0;q<Ee.features.length;q++)Tt(ee,Ee.features[q],Oe,q);else Tt(ee,Ee.type==="Feature"?Ee:{geometry:Ee},Oe);return ee}(me,W);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(pe=function(Ee,Oe){var ee=Oe.buffer/Oe.extent,q=Ee,Y=fr(Ee,1,-1-ee,ee,0,-1,2,Oe),fe=fr(Ee,1,1-ee,2+ee,0,-1,2,Oe);return(Y||fe)&&(q=fr(Ee,1,-ee,1+ee,0,-1,2,Oe)||[],Y&&(q=Gt(Y,1).concat(q)),fe&&(q=q.concat(Gt(fe,-1)))),q}(pe,W)).length&&this.splitTile(pe,0,0,0),J&&(pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ln(me,W,J){return 32*((1<<me)*J+W)+me}function Ra(me,W){const J=me.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);const pe=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!pe)return W(null,null);const Ee=new $(pe.features);let Oe=re(Ee);Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),W(null,{vectorTile:Ee,rawData:Oe.buffer})}rn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},rn.prototype.splitTile=function(me,W,J,pe,Ee,Oe,ee){for(var q=[me,W,J,pe],Y=this.options,fe=Y.debug;q.length;){pe=q.pop(),J=q.pop(),W=q.pop(),me=q.pop();var Te=1<<W,rt=Ln(W,J,pe),He=this.tiles[rt];if(!He&&(fe>1&&console.time("creation"),He=this.tiles[rt]=Ii(me,W,J,pe,Y),this.tileCoords.push({z:W,x:J,y:pe}),fe)){fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,J,pe,He.numFeatures,He.numPoints,He.numSimplified),console.timeEnd("creation"));var At="z"+W;this.stats[At]=(this.stats[At]||0)+1,this.total++}if(He.source=me,Ee){if(W===Y.maxZoom||W===Ee)continue;var Ft=1<<Ee-W;if(J!==Math.floor(Oe/Ft)||pe!==Math.floor(ee/Ft))continue}else if(W===Y.indexMaxZoom||He.numPoints<=Y.indexMaxPoints)continue;if(He.source=null,me.length!==0){fe>1&&console.time("clipping");var jt,Ot,qt,lr,Wt,ar,ze=.5*Y.buffer/Y.extent,Ir=.5-ze,jr=.5+ze,gi=1+ze;jt=Ot=qt=lr=null,Wt=fr(me,Te,J-ze,J+jr,0,He.minX,He.maxX,Y),ar=fr(me,Te,J+Ir,J+gi,0,He.minX,He.maxX,Y),me=null,Wt&&(jt=fr(Wt,Te,pe-ze,pe+jr,1,He.minY,He.maxY,Y),Ot=fr(Wt,Te,pe+Ir,pe+gi,1,He.minY,He.maxY,Y),Wt=null),ar&&(qt=fr(ar,Te,pe-ze,pe+jr,1,He.minY,He.maxY,Y),lr=fr(ar,Te,pe+Ir,pe+gi,1,He.minY,He.maxY,Y),ar=null),fe>1&&console.timeEnd("clipping"),q.push(jt||[],W+1,2*J,2*pe),q.push(Ot||[],W+1,2*J,2*pe+1),q.push(qt||[],W+1,2*J+1,2*pe),q.push(lr||[],W+1,2*J+1,2*pe+1)}}},rn.prototype.getTile=function(me,W,J){var pe=this.options,Ee=pe.extent,Oe=pe.debug;if(me<0||me>24)return null;var ee=1<<me,q=Ln(me,W=(W%ee+ee)%ee,J);if(this.tiles[q])return Sr(this.tiles[q],Ee);Oe>1&&console.log("drilling down to z%d-%d-%d",me,W,J);for(var Y,fe=me,Te=W,rt=J;!Y&&fe>0;)fe--,Te=Math.floor(Te/2),rt=Math.floor(rt/2),Y=this.tiles[Ln(fe,Te,rt)];return Y&&Y.source?(Oe>1&&console.log("found parent tile z%d-%d-%d",fe,Te,rt),Oe>1&&console.time("drilling down"),this.splitTile(Y.source,fe,Te,rt,me,W,J),Oe>1&&console.timeEnd("drilling down"),this.tiles[q]?Sr(this.tiles[q],Ee):null):null};class Zi extends o.VectorTileWorkerSource{constructor(W,J,pe,Ee,Oe){super(W,J,pe,Ee,Ra),Oe&&(this.loadGeoJSON=Oe)}loadData(W,J){const pe=W&&W.request,Ee=pe&&pe.collectResourceTiming;this.loadGeoJSON(W,(Oe,ee)=>{if(Oe||!ee)return J(Oe);if(typeof ee!="object")return J(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));{P(ee,!0);try{if(W.filter){const Y=o.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Y.result==="error")throw new Error(Y.value.map(Te=>`${Te.key}: ${Te.message}`).join(", "));const fe=ee.features.filter(Te=>Y.value.evaluate({zoom:0},Te));ee={type:"FeatureCollection",features:fe}}this._geoJSONIndex=W.cluster?new ft(function({superclusterOptions:Y,clusterProperties:fe}){if(!fe||!Y)return Y;const Te={},rt={},He={accumulated:null,zoom:0},At={properties:null},Ft=Object.keys(fe);for(const jt of Ft){const[Ot,qt]=fe[jt],lr=o.createExpression(qt),Wt=o.createExpression(typeof Ot=="string"?[Ot,["accumulated"],["get",jt]]:Ot);Te[jt]=lr.value,rt[jt]=Wt.value}return Y.map=jt=>{At.properties=jt;const Ot={};for(const qt of Ft)Ot[qt]=Te[qt].evaluate(He,At);return Ot},Y.reduce=(jt,Ot)=>{At.properties=Ot;for(const qt of Ft)He.accumulated=jt[qt],jt[qt]=rt[qt].evaluate(He,At)},Y}(W)).load(ee.features):function(Y,fe){return new rn(Y,fe)}(ee,W.geojsonVtOptions)}catch(Y){return J(Y)}this.loaded={};const q={};if(Ee){const Y=o.getPerformanceMeasurement(pe);Y&&(q.resourceTiming={},q.resourceTiming[W.source]=JSON.parse(JSON.stringify(Y)))}J(null,q)}})}reloadTile(W,J){const pe=this.loaded;return pe&&pe[W.uid]?super.reloadTile(W,J):this.loadTile(W,J)}loadGeoJSON(W,J){if(W.request)o.getJSON(W.request,J);else{if(typeof W.data!="string")return J(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));try{return J(null,JSON.parse(W.data))}catch{return J(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(W,J){try{J(null,this._geoJSONIndex.getClusterExpansionZoom(W.clusterId))}catch(pe){J(pe)}}getClusterChildren(W,J){try{J(null,this._geoJSONIndex.getChildren(W.clusterId))}catch(pe){J(pe)}}getClusterLeaves(W,J){try{J(null,this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset))}catch(pe){J(pe)}}}class Wo{constructor(W){this.self=W,this.actor=new o.Actor(W,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Zi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(J,pe)=>{if(this.workerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.workerSourceTypes[J]=pe},this.self.registerRTLTextPlugin=J=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=J.applyArabicShaping,o.plugin.processBidirectionalText=J.processBidirectionalText,o.plugin.processStyledBidirectionalText=J.processStyledBidirectionalText}}clearCaches(W,J,pe){delete this.layerIndexes[W],delete this.availableImages[W],delete this.workerSources[W],delete this.demWorkerSources[W],pe()}checkIfReady(W,J,pe){pe()}setReferrer(W,J){this.referrer=J}spriteLoaded(W,J){this.isSpriteLoaded[W]=J;for(const pe in this.workerSources[W]){const Ee=this.workerSources[W][pe];for(const Oe in Ee)Ee[Oe]instanceof o.VectorTileWorkerSource&&(Ee[Oe].isSpriteLoaded=J,Ee[Oe].fire(new o.Event("isSpriteLoaded")))}}setImages(W,J,pe){this.availableImages[W]=J;for(const Ee in this.workerSources[W]){const Oe=this.workerSources[W][Ee];for(const ee in Oe)Oe[ee].availableImages=J}pe()}enableTerrain(W,J,pe){this.terrain=J,pe()}setProjection(W,J){this.projections[W]=o.getProjection(J)}setLayers(W,J,pe){this.getLayerIndex(W).replace(J),pe()}updateLayers(W,J,pe){this.getLayerIndex(W).update(J.layers,J.removedIds),pe()}loadTile(W,J,pe){const Ee=this.enableTerrain?o.extend({enableTerrain:this.terrain},J):J;Ee.projection=this.projections[W]||this.defaultProjection,this.getWorkerSource(W,J.type,J.source).loadTile(Ee,pe)}loadDEMTile(W,J,pe){const Ee=this.enableTerrain?o.extend({buildQuadTree:this.terrain},J):J;this.getDEMWorkerSource(W,J.source).loadTile(Ee,pe)}reloadTile(W,J,pe){const Ee=this.enableTerrain?o.extend({enableTerrain:this.terrain},J):J;Ee.projection=this.projections[W]||this.defaultProjection,this.getWorkerSource(W,J.type,J.source).reloadTile(Ee,pe)}abortTile(W,J,pe){this.getWorkerSource(W,J.type,J.source).abortTile(J,pe)}removeTile(W,J,pe){this.getWorkerSource(W,J.type,J.source).removeTile(J,pe)}removeSource(W,J,pe){if(!this.workerSources[W]||!this.workerSources[W][J.type]||!this.workerSources[W][J.type][J.source])return;const Ee=this.workerSources[W][J.type][J.source];delete this.workerSources[W][J.type][J.source],Ee.removeSource!==void 0?Ee.removeSource(J,pe):pe()}loadWorkerSource(W,J,pe){try{this.self.importScripts(J.url),pe()}catch(Ee){pe(Ee.toString())}}syncRTLPluginState(W,J,pe){try{o.plugin.setState(J);const Ee=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&Ee!=null){this.self.importScripts(Ee);const Oe=o.plugin.isParsed();pe(Oe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ee}`),Oe)}}catch(Ee){pe(Ee.toString())}}getAvailableImages(W){let J=this.availableImages[W];return J||(J=[]),J}getLayerIndex(W){let J=this.layerIndexes[W];return J||(J=this.layerIndexes[W]=new E),J}getWorkerSource(W,J,pe){return this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][J]||(this.workerSources[W][J]={}),this.workerSources[W][J][pe]||(this.workerSources[W][J][pe]=new this.workerSourceTypes[J]({send:(Ee,Oe,ee,q,Y,fe)=>{this.actor.send(Ee,Oe,ee,W,Y,fe)},scheduler:this.actor.scheduler},this.getLayerIndex(W),this.getAvailableImages(W),this.isSpriteLoaded[W])),this.workerSources[W][J][pe]}getDEMWorkerSource(W,J){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][J]||(this.demWorkerSources[W][J]=new S),this.demWorkerSources[W][J]}enforceCacheSizeLimit(W,J){o.enforceCacheSizeLimit(J)}getWorkerPerformanceMetrics(W,J,pe){pe(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Wo(self)),Wo}),u(["./shared"],function(o){function g(m,a){if(Array.isArray(m)){if(!Array.isArray(a)||m.length!==a.length)return!1;for(let f=0;f<m.length;f++)if(!g(m[f],a[f]))return!1;return!0}if(typeof m=="object"&&m!==null&&a!==null){if(typeof a!="object"||Object.keys(m).length!==Object.keys(a).length)return!1;for(const f in m)if(!g(m[f],a[f]))return!1;return!0}return m===a}var x=E;function E(m){return!function(a){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,b,T=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(T);try{b=new Worker(M),y=!0}catch{y=!1}return b&&b.terminate(),URL.revokeObjectURL(M),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var b=y.getContext("2d");if(!b)return!1;var T=b.getImageData(0,0,1,1);return T&&T.width===y.width}()?(S[f=a&&a.failIfMajorPerformanceCaveat]===void 0&&(S[f]=function(y){var b,T=function(M){var O=document.createElement("canvas"),L=Object.create(E.webGLContextAttributes);return L.failIfMajorPerformanceCaveat=M,O.getContext("webgl",L)||O.getContext("experimental-webgl",L)}(y);if(!T)return!1;try{b=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!b||T.isContextLost())&&(T.shaderSource(b,"void main() {}"),T.compileShader(b),T.getShaderParameter(b,T.COMPILE_STATUS)===!0)}(f)),S[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(m)}var S={};function P(m,a,f){const y=o.window.document.createElement(m);return a!==void 0&&(y.className=a),f&&f.appendChild(y),y}function I(m,a,f){const y=o.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const b of Object.keys(a))y.setAttributeNS(null,b,a[b]);return f&&f.appendChild(y),y}E.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const R=o.window.document&&o.window.document.documentElement.style,z=R&&R.userSelect!==void 0?"userSelect":"WebkitUserSelect";let B;function $(){R&&z&&(B=R[z],R[z]="none")}function j(){R&&z&&(R[z]=B)}function G(m){m.preventDefault(),m.stopPropagation(),o.window.removeEventListener("click",G,!0)}function K(){o.window.addEventListener("click",G,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",G,!0)},0)}function X(m,a){const f=m.getBoundingClientRect();return ne(m,f,a)}function re(m,a){const f=m.getBoundingClientRect(),y=[];for(let b=0;b<a.length;b++)y.push(ne(m,f,a[b]));return y}function ue(m){return o.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function ne(m,a,f){const y=m.offsetWidth===a.width?1:m.offsetWidth/a.width;return new o.pointGeometry((f.clientX-a.left)*y,(f.clientY-a.top)*y)}function we(m,a){var f=a[0],y=a[1],b=a[2],T=a[3],M=f*T-b*y;return M?(m[0]=T*(M=1/M),m[1]=-y*M,m[2]=-b*M,m[3]=f*M,m):null}function xe(m){const{userImage:a}=m;return!!(a&&a.render&&a.render())&&(m.data.replace(new Uint8Array(a.data.buffer)),!0)}class ke extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:f,callback:y}of this.requestors)this._notify(f,y);this.requestors=[]}}hasImage(a){return!!this.getImage(a)}getImage(a){return this.images[a]}addImage(a,f){this._validate(a,f)&&(this.images[a]=f)}_validate(a,f){let y=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),y=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),y=!1),this._validateContent(f.content,f)||(this.fire(new o.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),y=!1),y}_validateStretch(a,f){if(!a)return!0;let y=0;for(const b of a){if(b[0]<y||b[1]<b[0]||f<b[1])return!1;y=b[1]}return!0}_validateContent(a,f){return!(a&&(a.length!==4||a[0]<0||f.data.width<a[0]||a[1]<0||f.data.height<a[1]||a[2]<0||f.data.width<a[2]||a[3]<0||f.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))}updateImage(a,f){f.version=this.images[a].version+1,this.images[a]=f,this.updatedImages[a]=!0}removeImage(a){const f=this.images[a];delete this.images[a],delete this.patterns[a],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,f){let y=!0;if(!this.isLoaded())for(const b of a)this.images[b]||(y=!1);this.isLoaded()||y?this._notify(a,f):this.requestors.push({ids:a,callback:f})}_notify(a,f){const y={};for(const b of a){this.images[b]||this.fire(new o.Event("styleimagemissing",{id:b}));const T=this.images[b];T?y[b]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:Boolean(T.userImage&&T.userImage.render)}:o.warnOnce(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,y)}getPixelSize(){const{width:a,height:f}=this.atlasImage;return{width:a,height:f}}getPattern(a){const f=this.patterns[a],y=this.getImage(a);if(!y)return null;if(f&&f.position.version===y.version)return f.position;if(f)f.position.version=y.version;else{const b={w:y.data.width+2,h:y.data.height+2,x:0,y:0},T=new o.ImagePosition(b,y);this.patterns[a]={bin:b,position:T}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const f=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(a,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const T in this.patterns)a.push(this.patterns[T].bin);const{w:f,h:y}=o.potpack(a),b=this.atlasImage;b.resize({width:f||1,height:y||1});for(const T in this.patterns){const{bin:M}=this.patterns[T],O=M.x+1,L=M.y+1,N=this.images[T].data,U=N.width,Z=N.height;o.RGBAImage.copy(N,b,{x:0,y:0},{x:O,y:L},{width:U,height:Z}),o.RGBAImage.copy(N,b,{x:0,y:Z-1},{x:O,y:L-1},{width:U,height:1}),o.RGBAImage.copy(N,b,{x:0,y:0},{x:O,y:L+Z},{width:U,height:1}),o.RGBAImage.copy(N,b,{x:U-1,y:0},{x:O-1,y:L},{width:1,height:Z}),o.RGBAImage.copy(N,b,{x:0,y:0},{x:O+U,y:L},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const f of a){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const y=this.images[f];xe(y)&&this.updateImage(f,y)}}}const Ie=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(m,a){return function([f,y,b]){const T=o.degToRad(y+90),M=o.degToRad(b);return{x:f*Math.cos(T)*Math.sin(M),y:f*Math.sin(T)*Math.sin(M),z:f*Math.cos(M),azimuthal:y,polar:b}}(m.expression.evaluate(a))}interpolate(m,a,f){return{x:o.number(m.x,a.x,f),y:o.number(m.y,a.y,f),z:o.number(m.z,a.z,f),azimuthal:o.number(m.azimuthal,a.azimuthal,f),polar:o.number(m.polar,a.polar,f)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),Fe="-transition";class se extends o.Evented{constructor(a){super(),this._transitionable=new o.Transitionable(Ie),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,f={}){if(!this._validate(o.validateLight,a,f))for(const y in a){const b=a[y];o.endsWith(y,Fe)?this._transitionable.setTransition(y.slice(0,-Fe.length),b):this._transitionable.setValue(y,b)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,f,y){return(!y||y.validate!==!1)&&o.emitValidationErrors(this,a.call(o.validateStyle,o.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const Be=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)}),Ve="-transition";class Je extends o.Evented{constructor(a,f){super(),this._transitionable=new o.Transitionable(Be),this.set(a),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=f}get(){return this._transitionable.serialize()}set(a){for(const f in a){const y=a[f];o.endsWith(f,Ve)?this._transitionable.setTransition(f.slice(0,-Ve.length),y):this._transitionable.setValue(f,y)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}}function ut(m,a,f,y){const b=o.smoothstep(45,65,f),[T,M]=ht(m,y),O=o.length(a);let L=1-Math.min(1,Math.exp((O-T)/(M-T)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*b*m.alpha}function ht(m,a){const f=.5/Math.tan(.5*a);return[m.range[0]+f,m.range[1]+f]}const Et=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])}),Qt="-transition";class Nt extends o.Evented{constructor(a,f){super(),this._transitionable=new o.Transitionable(Et),this.set(a),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const a=this._transform,f=a.projection.name==="globe",y=o.globeToMercatorTransition(a.zoom),b=this.properties.get("range"),T=[.5,3];return{range:f?[o.number(T[0],b[0],y),o.number(T[1],b[1],y)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,f={}){if(!this._validate(o.validateFog,a,f)){for(const y of Object.keys(o.spec.fog))a&&a[y]===void 0&&(a[y]=o.spec.fog[y].default);for(const y in a){const b=a[y];o.endsWith(y,Qt)?this._transitionable.setTransition(y.slice(0,-Qt.length),b):this._transitionable.setValue(y,b)}}}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,a))*f.a}getOpacityAtLatLng(a,f){return this._transform.projection.supportsFog?function(y,b,T){const M=o.MercatorCoordinate.fromLngLat(b),O=T.elevation?T.elevation.getAtPointOrZero(M):0,L=[M.x,M.y,O];return o.transformMat4(L,L,T.mercatorFogMatrix),ut(y,L,T.pitch,T._fov)}(this.state,a,f):0}getFovAdjustedRange(a){return this._transform.projection.supportsFog?ht(this.state,a):[0,1]}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,f,y){return(!y||y.validate!==!1)&&o.emitValidationErrors(this,a.call(o.validateStyle,o.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class yt{constructor(a,f){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const y=this.workerPool.acquire(this.id);for(let b=0;b<y.length;b++){const T=new yt.Actor(y[b],f,this.id);T.name=`Worker ${b}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,f,y){o.asyncAll(this.actors,(b,T)=>{b.send(a,f,T)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}function et(m,a,f){return a*(o.EXTENT/(m.tileSize*Math.pow(2,f-m.tileID.overscaledZ)))}yt.Actor=o.Actor;class Ne{constructor(a,f,y,b){this.screenBounds=a,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(a,f){let y,b;if(a instanceof o.pointGeometry||typeof a[0]=="number"){const T=o.pointGeometry.convert(a);y=[o.pointGeometry.convert(a)],b=f.isPointAboveHorizon(T)}else{const T=o.pointGeometry.convert(a[0]),M=o.pointGeometry.convert(a[1]);y=[T,M],b=o.polygonizeBounds(T,M).every(O=>f.isPointAboveHorizon(O))}return new Ne(y,f.getCameraPoint(),b,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(a){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],b=o.polygonizeBounds(f,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<y.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?b[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(b[3]=this.cameraPoint)),o.bufferConvexPolygon(b,a)}bufferedCameraGeometryGlobe(a){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],b=o.polygonizeBounds(f,y,a),T=this.cameraPoint.clone();switch(3*((T.y>f.y)+(T.y>y.y))+((T.x>f.x)+(T.x>y.x))){case 0:b[0]=T,b[4]=T.clone();break;case 1:b.splice(1,0,T);break;case 2:b[1]=T;break;case 3:b.splice(4,0,T);break;case 5:b.splice(2,0,T);break;case 6:b[3]=T;break;case 7:b.splice(3,0,T);break;case 8:b[2]=T}return b}containsTile(a,f,y,b=0){const T=a.queryPadding/f._projectionScaler+1,M=y?this._bufferedCameraMercator(T,f):this._bufferedScreenMercator(T,f);let O=a.tileID.wrap+(M.unwrapped?b:0);const L=M.polygon.map(ve=>o.getTilePoint(a.tileTransform,ve,O));if(!o.polygonIntersectsBox(L,0,0,o.EXTENT,o.EXTENT))return;O=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const N=this.screenGeometryMercator.polygon.map(ve=>o.getTileVec3(a.tileTransform,ve,O)),U=N.map(ve=>new o.pointGeometry(ve[0],ve[1])),Z=f.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),te=o.getTileVec3(a.tileTransform,Z,O),ae=N.map(ve=>{const oe=o.sub(ve,ve,te);return o.normalize(oe,oe),new o.Ray(te,oe)}),le=et(a,1,f.zoom)*f._projectionScaler;return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:ae,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(ie=o.getBounds(L),ie.min.x=o.clamp(ie.min.x,0,o.EXTENT),ie.min.y=o.clamp(ie.min.y,0,o.EXTENT),ie.max.x=o.clamp(ie.max.x,0,o.EXTENT),ie.max.y=o.clamp(ie.max.y,0,o.EXTENT),ie),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:le};var ie}_bufferedScreenMercator(a,f){const y=mt(a);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let b;return b=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(a),f):{polygon:this.bufferedScreenGeometry(a).map(T=>f.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[y]=b,b}}_bufferedCameraMercator(a,f){const y=mt(a);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let b;return b=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),f):{polygon:this.bufferedCameraGeometry(a).map(T=>f.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[y]=b,b}}_projectAndResample(a,f){const y=function(T,M){const O=o.multiply([],M.pixelMatrix,M.globeMatrix),L=[0,-o.GLOBE_RADIUS,0,1],N=[0,o.GLOBE_RADIUS,0,1],U=[0,0,0,1];o.transformMat4$1(L,L,O),o.transformMat4$1(N,N,O),o.transformMat4$1(U,U,O);const Z=new o.pointGeometry(L[0]/L[3],L[1]/L[3]),te=new o.pointGeometry(N[0]/N[3],N[1]/N[3]),ae=o.polygonContainsPoint(T,Z)&&L[3]<U[3],le=o.polygonContainsPoint(T,te)&&N[3]<U[3];if(!ae&&!le)return null;const ie=function(Re,We,Ke){for(let Ze=1;Ze<Re.length;Ze++){const Ge=ft(We.pointCoordinate3D(Re[Ze-1]).x),Se=ft(We.pointCoordinate3D(Re[Ze]).x);if(Ke<0){if(Ge<Se)return{idx:Ze,t:-Ge/(Se-1-Ge)}}else if(Se<Ge)return{idx:Ze,t:(1-Ge)/(Se+1-Ge)}}return null}(T,M,ae?-1:1);if(!ie)return null;const{idx:ve,t:oe}=ie;let he=ve>1?tt(T.slice(0,ve),M):[],de=ve<T.length?tt(T.slice(ve),M):[];he=he.map(Re=>new o.pointGeometry(ft(Re.x),Re.y)),de=de.map(Re=>new o.pointGeometry(ft(Re.x),Re.y));const Ae=[...he];Ae.length===0&&Ae.push(de[de.length-1]);const _e=o.number(Ae[Ae.length-1].y,(de.length===0?he[0]:de[0]).y,oe);let be;return be=ae?[new o.pointGeometry(0,_e),new o.pointGeometry(0,0),new o.pointGeometry(1,0),new o.pointGeometry(1,_e)]:[new o.pointGeometry(1,_e),new o.pointGeometry(1,1),new o.pointGeometry(0,1),new o.pointGeometry(0,_e)],Ae.push(...be),de.length===0?Ae.push(he[0]):Ae.push(...de),{polygon:Ae.map(Re=>new o.MercatorCoordinate(Re.x,Re.y)),unwrapped:!1}}(a,f);if(y)return y;const b=function(T,M){let O=!1,L=-1/0,N=0;for(let Z=0;Z<T.length-1;Z++)T[Z].x>L&&(L=T[Z].x,N=Z);for(let Z=0;Z<T.length-1;Z++){const te=(N+Z)%(T.length-1),ae=T[te],le=T[te+1];Math.abs(ae.x-le.x)>.5&&(ae.x<le.x?(ae.x+=1,te===0&&(T[T.length-1].x+=1)):(le.x+=1,te+1===T.length-1&&(T[0].x+=1)),O=!0)}const U=o.mercatorXfromLng(M.center.lng);return O&&U<Math.abs(U-1)&&T.forEach(Z=>{Z.x-=1}),{polygon:T,unwrapped:O}}(tt(a,f).map(T=>new o.pointGeometry(ft(T.x),T.y)),f);return{polygon:b.polygon.map(T=>new o.MercatorCoordinate(T.x,T.y)),unwrapped:b.unwrapped}}}function tt(m,a){return o.resample(m,f=>{const y=a.pointCoordinate3D(f);f.x=y.x,f.y=y.y},1/256)}function ft(m){return m<0?1+m%1:m%1}function mt(m){return 100*m|0}function Ht(m,a,f,y,b){const T=function(M,O){if(M)return b(M);if(O){const L=o.pick(o.extend(O,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(L.vectorLayers=O.vector_layers,L.vectorLayerIds=L.vectorLayers.map(N=>N.id)),O.language_options&&(L.languageOptions=O.language_options),O.language&&O.language[O.id]&&(L.language=O.language[O.id]),O.worldview_options&&(L.worldviewOptions=O.worldview_options),O.worldview?L.worldview=O.worldview[O.id]:O.worldview_default&&(L.worldview=O.worldview_default),L.tiles=a.canonicalizeTileset(L,m.url),b(null,L)}};return m.url?o.getJSON(a.transformRequest(a.normalizeSourceURL(m.url,null,f,y),o.ResourceType.Source),T):o.exported.frame(()=>T(null,m))}class Zt{constructor(a,f,y){this.bounds=o.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=f||0,this.maxzoom=y||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const f=Math.pow(2,a.z),y=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*f),b=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*f),T=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*f),M=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*f);return a.x>=y&&a.x<T&&a.y>=b&&a.y<M}}class Lt{constructor(a,f,y){this.context=a;const b=a.gl;this.buffer=b.createBuffer(),this.dynamicDraw=Boolean(y),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ye={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Me{constructor(a,f,y,b){this.length=f.length,this.attributes=y,this.itemSize=f.bytesPerElement,this.dynamicDraw=b,this.context=a;const T=a.gl;this.buffer=T.createBuffer(),a.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,f){for(let y=0;y<this.attributes.length;y++){const b=f.attributes[this.attributes[y].name];b!==void 0&&a.enableVertexAttribArray(b)}}setVertexAttribPointers(a,f,y){for(let b=0;b<this.attributes.length;b++){const T=this.attributes[b],M=f.attributes[T.name];M!==void 0&&a.vertexAttribPointer(M,T.components,a[ye[T.type]],!1,this.itemSize,T.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $e{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class it extends $e{getDefault(){return o.Color.transparent}set(a){const f=this.current;(a.r!==f.r||a.g!==f.g||a.b!==f.b||a.a!==f.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class ot extends $e{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class st extends $e{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class gt extends $e{getDefault(){return[!0,!0,!0,!0]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||a[3]!==f[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class lt extends $e{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class Ye extends $e{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class pt extends $e{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const f=this.current;(a.func!==f.func||a.ref!==f.ref||a.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Tt extends $e{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class St extends $e{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=a,this.dirty=!1}}class zt extends $e{getDefault(){return[0,1]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Yt extends $e{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=a,this.dirty=!1}}class ur extends $e{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class xr extends $e{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.BLEND):f.disable(f.BLEND),this.current=a,this.dirty=!1}}class fr extends $e{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class br extends $e{getDefault(){return o.Color.transparent}set(a){const f=this.current;(a.r!==f.r||a.g!==f.g||a.b!==f.b||a.a!==f.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Qr extends $e{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class Wi extends $e{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;a?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=a,this.dirty=!1}}class Ei extends $e{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class ui extends $e{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}class Un extends $e{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}}class or extends $e{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class Gt extends $e{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const f=this.current;(a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||a[3]!==f[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class rr extends $e{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class Sr extends $e{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class zr extends $e{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Ii extends $e{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Ks extends $e{getDefault(){return null}set(a){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Gn extends $e{constructor(a){super(a),this.vao=a.extVertexArrayObject}getDefault(){return null}set(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)}}class rn extends $e{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class Ln extends $e{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class Ra extends $e{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class Zi extends $e{constructor(a,f){super(a),this.context=a,this.parent=f}getDefault(){return null}}class Wo extends Zi{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class me extends Zi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class W extends me{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class J{constructor(a,f,y,b){this.context=a,this.width=f,this.height=y;const T=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new Wo(a,T),b&&(this.depthAttachment=new me(a,T))}destroy(){const a=this.context.gl,f=this.colorAttachment.get();if(f&&a.deleteTexture(f),this.depthAttachment){const y=this.depthAttachment.get();y&&a.deleteRenderbuffer(y)}a.deleteFramebuffer(this.framebuffer)}}class pe{constructor(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new it(this),this.clearDepth=new ot(this),this.clearStencil=new st(this),this.colorMask=new gt(this),this.depthMask=new lt(this),this.stencilMask=new Ye(this),this.stencilFunc=new pt(this),this.stencilOp=new Tt(this),this.stencilTest=new St(this),this.depthRange=new zt(this),this.depthTest=new Yt(this),this.depthFunc=new ur(this),this.blend=new xr(this),this.blendFunc=new fr(this),this.blendColor=new br(this),this.blendEquation=new Qr(this),this.cullFace=new Wi(this),this.cullFaceSide=new Ei(this),this.frontFace=new ui(this),this.program=new Un(this),this.activeTexture=new or(this),this.viewport=new Gt(this),this.bindFramebuffer=new rr(this),this.bindRenderbuffer=new Sr(this),this.bindTexture=new zr(this),this.bindVertexBuffer=new Ii(this),this.bindElementBuffer=new Ks(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Gn(this),this.pixelStoreUnpack=new rn(this),this.pixelStoreUnpackPremultiplyAlpha=new Ln(this),this.pixelStoreUnpackFlipY=new Ra(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=a.getExtension("OES_standard_derivatives"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,f){return new Lt(this,a,f)}createVertexBuffer(a,f,y){return new Me(this,a,f,y)}createRenderbuffer(a,f,y){const b=this.gl,T=b.createRenderbuffer();return this.bindRenderbuffer.set(T),b.renderbufferStorage(b.RENDERBUFFER,a,f,y),this.bindRenderbuffer.set(null),T}createFramebuffer(a,f,y){return new J(this,a,f,y)}clear({color:a,depth:f,stencil:y}){const b=this.gl;let T=0;a&&(T|=b.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(T|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),y!==void 0&&(T|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),b.clear(T)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){g(a.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Ee extends o.Evented{constructor(a,f,y,b){super(),this.id=a,this.dispatcher=y,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},f),o.extend(this,o.pick(f,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ht(this._options,this.map._requestManager,null,null,(a,f)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new o.ErrorEvent(a)):f&&(o.extend(this,f),f.bounds&&(this.tileBounds=new Zt(f.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(f.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,f){const y=o.exported.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);a.request=o.getImage(this.map._requestManager.transformRequest(b,o.ResourceType.Tile),(T,M,O,L)=>(delete a.request,a.aborted?(a.state="unloaded",f(null)):T?(a.state="errored",f(T)):M?(this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:O,expires:L}),a.setTexture(M,this.map.painter),a.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null)))}static loadTileData(a,f,y){a.setTexture(f,y)}static unloadTileData(a,f){a.texture&&f.saveTileTexture(a.texture)}abortTile(a,f){a.request&&(a.request.cancel(),delete a.request),f()}unloadTile(a,f){a.texture&&this.map.painter.saveTileTexture(a.texture),f()}hasTransition(){return!1}}let Oe;function ee(m,a,f,y,b,T,M,O){const L=[m,f,b,a,y,T,1,1,1],N=[M,O,1],U=o.adjoint([],L),[Z,te,ae]=o.transformMat3(N,N,o.transpose(U,U));return o.multiply$1(L,[Z,0,0,0,te,0,0,0,ae],L)}class q extends o.Evented{constructor(a,f,y,b){super(),this.id=a,this.dispatcher=y,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=f}load(a,f){this._loaded=f||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(y,b)=>{if(this._loaded=!0,y)this.fire(new o.ErrorEvent(y));else if(b){const{HTMLImageElement:T}=o.window;this.image=b instanceof T?o.exported.getImageData(b):b,this.width=this.image.width,this.height=this.image.height,a&&(this.coordinates=a),this._finishLoading()}})}loaded(){return this._loaded}updateImage(a){return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(a){this.coordinates=a,this._boundsArray=void 0;const f=a.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let b=1/0,T=1/0,M=-1/0,O=-1/0;for(const Z of y)b=Math.min(b,Z.x),T=Math.min(T,Z.y),M=Math.max(M,Z.x),O=Math.max(O,Z.y);const L=Math.max(M-b,O-T),N=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),U=Math.pow(2,N);return new o.CanonicalTileID(N,Math.floor((b+M)/2*U),Math.floor((T+O)/2*U))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(a){for(const L in this.tiles){const N=this.tiles[L];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture)}if(this._boundsArray)return;const f=o.tileTransform(this.tileID,this.map.transform.projection),[y,b,T,M]=this.coordinates.map(L=>{const N=f.projection.project(L[0],L[1]);return o.getTilePoint(f,N)._round()});this.perspectiveTransform=function(L,N,U,Z,te,ae,le,ie,ve,oe){const he=ee(0,0,L,0,0,N,L,N),de=ee(U,Z,te,ae,le,ie,ve,oe);return o.multiply$1(de,o.adjoint(he,he),de),[de[6]/de[8]*L/o.EXTENT,de[7]/de[8]*N/o.EXTENT]}(this.width,this.height,y.x,y.y,b.x,b.y,M.x,M.y,T.x,T.y);const O=this._boundsArray=new o.StructArrayLayout4i8;O.emplaceBack(y.x,y.y,0,0),O.emplaceBack(b.x,b.y,o.EXTENT,0),O.emplaceBack(M.x,M.y,0,o.EXTENT),O.emplaceBack(T.x,T.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=a.createVertexBuffer(O,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const a=this.map.painter.context,f=a.gl;this.texture?this.texture.update(this.image):(this.texture=new o.Texture(a,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._prepareData(a)}loadTile(a,f){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},f(null)):(a.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Y={vector:class extends o.Evented{constructor(m,a,f,y){if(super(),this.id=m,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(a,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(m){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const a=this.language||this.map._language,f=this.worldview||this.map._worldview;this._tileJSONRequest=Ht(this._options,this.map._requestManager,a,f,(y,b)=>{this._tileJSONRequest=null,this._loaded=!0,y?(a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${a}`),f&&f.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new o.ErrorEvent(y))):b&&(o.extend(this,b),b.bounds&&(this.tileBounds=new Zt(b.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),m&&m(y)})}loaded(){return this._loaded}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}onAdd(m){this.map=m,this.load()}setSourceProperty(m){this._tileJSONRequest&&this._tileJSONRequest.cancel(),m(),this.load(()=>{const a=this.map.style._getSourceCaches(this.id);for(const f of a)f.clearTiles()})}setTiles(m){return this.setSourceProperty(()=>{this._options.tiles=m}),this}setUrl(m){return this.setSourceProperty(()=>{this.url=m,this._options.url=m}),this}_setLanguage(m){return m===this.language||this.setSourceProperty(()=>{this.language=m}),this}_setWorldview(m){return m===this.worldview?this:this.worldviewOptions&&m&&!this.worldviewOptions[m]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${m}".`),this):(this.setSourceProperty(()=>{this.worldview=m}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(m,a){const f=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(f,o.ResourceType.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:m.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,m.actor&&m.state!=="expired")m.state==="loading"?m.reloadCallback=a:m.request=m.actor.send("reloadTile",y,b.bind(this));else if(m.actor=this._tileWorkers[f]=this._tileWorkers[f]||this.dispatcher.getActor(),this.dispatcher.ready)m.request=m.actor.send("loadTile",y,b.bind(this),void 0,!0);else{const T=o.loadVectorTile.call({deduped:this._deduped},y,(M,O)=>{M||!O?b.call(this,M):(y.data={cacheControl:O.cacheControl,expires:O.expires,rawData:O.rawData.slice(0)},m.actor&&m.actor.send("loadTile",y,b.bind(this),void 0,!0))},!0);m.request={cancel:T}}function b(T,M){return delete m.request,m.aborted?a(null):T&&T.status!==404?a(T):(M&&M.resourceTiming&&(m.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&m.setExpiryData(M),m.loadVectorData(M,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),a(null),void(m.reloadCallback&&(this.loadTile(m,m.reloadCallback),m.reloadCallback=null)))}}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.actor&&m.actor.send("abortTile",{uid:m.uid,type:this.type,source:this.id})}unloadTile(m){m.unloadVectorData(),m.actor&&m.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Ee,"raster-dem":class extends Ee{constructor(m,a,f,y){super(m,a,f,y),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(m,a){const f=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(b,T){b&&(m.state="errored",a(b)),T&&(m.dem=T,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",a(null))}m.request=o.getImage(this.map._requestManager.transformRequest(f,o.ResourceType.Tile),function(b,T,M,O){if(delete m.request,m.aborted)m.state="unloaded",a(null);else if(b)m.state="errored",a(b);else if(T){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:M,expires:O});const L=o.window.ImageBitmap&&T instanceof o.window.ImageBitmap&&(Oe==null&&(Oe=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),Oe),N=1-(T.width-o.prevPowerOfTwo(T.width))/2;N<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const U=L?T:o.exported.getImageData(T,N),Z={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:U,encoding:this.encoding,padding:N};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",Z,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const a=m.canonical,f=Math.pow(2,a.z),y=(a.x-1+f)%f,b=a.x===0?m.wrap-1:m.wrap,T=(a.x+1+f)%f,M=a.x+1===f?m.wrap+1:m.wrap,O={};return O[new o.OverscaledTileID(m.overscaledZ,b,a.z,y,a.y).key]={backfilled:!1},O[new o.OverscaledTileID(m.overscaledZ,M,a.z,T,a.y).key]={backfilled:!1},a.y>0&&(O[new o.OverscaledTileID(m.overscaledZ,b,a.z,y,a.y-1).key]={backfilled:!1},O[new o.OverscaledTileID(m.overscaledZ,m.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},O[new o.OverscaledTileID(m.overscaledZ,M,a.z,T,a.y-1).key]={backfilled:!1}),a.y+1<f&&(O[new o.OverscaledTileID(m.overscaledZ,b,a.z,y,a.y+1).key]={backfilled:!1},O[new o.OverscaledTileID(m.overscaledZ,m.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},O[new o.OverscaledTileID(m.overscaledZ,M,a.z,T,a.y+1).key]={backfilled:!1}),O}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends o.Evented{constructor(m,a,f,y){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(y),this._data=a.data,this._options=o.extend({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const b=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*b,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*b,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:o.EXTENT,radius:(a.clusterRadius!==void 0?a.clusterRadius:50)*b,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},a),this}getClusterChildren(m,a){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},a),this}getClusterLeaves(m,a,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:a,offset:f},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=o.extend({},this.workerOptions),a=this._data;typeof a=="string"?(m.request=this.map._requestManager.transformRequest(o.exported.resolveURL(a),o.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(a),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(f,y)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new o.ErrorEvent(f));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b.resourceTiming=y.resourceTiming[this.id]),this.fire(new o.Event("data",b)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,a){const f=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(f,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,b)=>(delete m.request,m.unloadVectorData(),m.aborted?a(null):y?a(y):(m.loadVectorData(b,this.map.painter,f==="reloadTile"),a(null))),void 0,f==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends q{constructor(m,a,f,y){super(m,a,f,y),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const a of m.urls)this.urls.push(this.map._requestManager.transformRequest(a,o.ResourceType.Source).url);o.getVideo(this.urls,(a,f)=>{this._loaded=!0,a?this.fire(new o.ErrorEvent(a)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const a=this.video.seekable;m<a.start(0)||m>a.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,a=m.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(m,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:q,canvas:class extends q{constructor(m,a,f,y){super(m,a,f,y),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(T=>typeof T!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(a,this.canvas,a.gl.RGBA,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends o.Evented{constructor(m,a,f,y){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=a,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Zt(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:a,y:f,z:y}=m.canonical;return this._implementation.hasTile({x:a,y:f,z:y})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,a){const{x:f,y,z:b}=m.tileID.canonical,T=new o.window.AbortController,M=this._implementation.loadTile({x:f,y,z:b},{signal:T.signal});if(!M)return this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",a(null);M.cancel=()=>T.abort(),m.request=M.then(function(O){return delete m.request,m.aborted?(m.state="unloaded",a(null)):O?function(L){return L instanceof o.window.ImageData||L instanceof o.window.ImageBitmap||L instanceof o.window.HTMLCanvasElement}(O)?(this.loadTileData(m,O),m.state="loaded",void a(null)):(m.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",a(null))}.bind(this)).catch(O=>{O.code!==20&&(m.state="errored",a(O))})}loadTileData(m,a){Ee.loadTileData(m,a,this._map.painter)}unloadTileData(m){Ee.unloadTileData(m,this._map.painter)}prepareTile(m){if(!this._implementation.prepareTile)return null;const{x:a,y:f,z:y}=m.tileID.canonical,b=this._implementation.prepareTile({x:a,y:f,z:y});return b?(this.loadTileData(m,b),m.state="loaded",b):null}unloadTile(m,a){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:f,y,z:b}=m.tileID.canonical;this._implementation.unloadTile({x:f,y,z:b})}a()}abortTile(m,a){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),a()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},fe=function(m,a,f,y){const b=new Y[a.type](m,a,f,y);if(b.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${b.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],b),b};function Te(m,a){const f=o.identity([]);return o.scale(f,f,[.5*m.width,.5*-m.height,1]),o.translate(f,f,[1,-1,0]),o.multiply(f,f,m.calculateProjMatrix(a.toUnwrapped())),Float32Array.from(f)}function rt(m,a,f,y,b,T,M,O=!1){const L=m.tilesIn(y,M,O);L.sort(At);const N=[];for(const Z of L)N.push({wrappedTileID:Z.tile.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(a,f,m._state,Z,b,T,Te(m.transform,Z.tile.tileID),O)});const U=function(Z){const te={},ae={};for(const le of Z){const ie=le.queryResults,ve=le.wrappedTileID,oe=ae[ve]=ae[ve]||{};for(const he in ie){const de=ie[he],Ae=oe[he]=oe[he]||{},_e=te[he]=te[he]||[];for(const be of de)Ae[be.featureIndex]||(Ae[be.featureIndex]=!0,_e.push(be))}}return te}(N);for(const Z in U)U[Z].forEach(te=>{const ae=te.feature,le=ae.layer;le&&le.type!=="background"&&le.type!=="sky"&&(ae.source=le.source,le["source-layer"]&&(ae.sourceLayer=le["source-layer"]),ae.state=ae.id!==void 0?m.getFeatureState(le["source-layer"],ae.id):{})});return U}function He(m,a){const f=m.getRenderableIds().map(T=>m.getTileByID(T)),y=[],b={};for(let T=0;T<f.length;T++){const M=f[T],O=M.tileID.canonical.key;b[O]||(b[O]=!0,M.querySourceFeatures(y,a))}return y}function At(m,a){const f=m.tileID,y=a.tileID;return f.overscaledZ-y.overscaledZ||f.canonical.y-y.canonical.y||f.wrap-y.wrap||f.canonical.x-y.canonical.x}function Ft(){return ih.workerClass!=null?new ih.workerClass:new o.window.Worker(ih.workerUrl)}const jt="mapboxgl_preloaded_worker_pool";class Ot{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<Ot.workerCount;)this.workers.push(new Ft);return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[jt]}numActive(){return Object.keys(this.active).length}}let qt;function lr(){return qt||(qt=new Ot),qt}function Wt(m,a){const f={};for(const y in m)y!=="ref"&&(f[y]=m[y]);return o.refProperties.forEach(y=>{y in a&&(f[y]=a[y])}),f}function ar(m){m=m.slice();const a=Object.create(null);for(let f=0;f<m.length;f++)a[m[f].id]=m[f];for(let f=0;f<m.length;f++)"ref"in m[f]&&(m[f]=Wt(m[f],a[m[f].ref]));return m}Ot.workerCount=2;const ze={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ir(m,a,f){f.push({command:ze.addSource,args:[m,a[m]]})}function jr(m,a,f){a.push({command:ze.removeSource,args:[m]}),f[m]=!0}function gi(m,a,f,y){jr(m,f,y),Ir(m,a,f)}function Hn(m,a,f){let y;for(y in m[f])if(m[f].hasOwnProperty(y)&&y!=="data"&&!g(m[f][y],a[f][y]))return!1;for(y in a[f])if(a[f].hasOwnProperty(y)&&y!=="data"&&!g(m[f][y],a[f][y]))return!1;return!0}function ki(m,a,f,y,b,T){let M;for(M in a=a||{},m=m||{})m.hasOwnProperty(M)&&(g(m[M],a[M])||f.push({command:T,args:[y,M,a[M],b]}));for(M in a)a.hasOwnProperty(M)&&!m.hasOwnProperty(M)&&(g(m[M],a[M])||f.push({command:T,args:[y,M,a[M],b]}))}function Wn(m){return m.id}function hn(m,a){return m[a.id]=a,m}class nn{constructor(a,f){this.reset(a,f)}reset(a,f){this.points=a||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=o.clamp(a,0,1);let f=1,y=this._distances[f];const b=a*this.paddedLength+this.padding;for(;y<b&&f<this._distances.length;)y=this._distances[++f];const T=f-1,M=this._distances[T],O=y-M,L=O>0?(b-M)/O:0;return this.points[T].mult(1-L).add(this.points[f].mult(L))}}class Dt{constructor(a,f,y){const b=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(a/y),this.yCellCount=Math.ceil(f/y);for(let M=0;M<this.xCellCount*this.yCellCount;M++)b.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=f,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,f,y,b,T){this._forEachCell(f,y,b,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(b),this.bboxes.push(T)}insertCircle(a,f,y,b){this._forEachCell(f-b,y-b,f+b,y+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(f),this.circles.push(y),this.circles.push(b)}_insertBoxCell(a,f,y,b,T,M){this.boxCells[T].push(M)}_insertCircleCell(a,f,y,b,T,M){this.circleCells[T].push(M)}_query(a,f,y,b,T,M){if(y<0||a>this.width||b<0||f>this.height)return!T&&[];const O=[];if(a<=0&&f<=0&&this.width<=y&&this.height<=b){if(T)return!0;for(let L=0;L<this.boxKeys.length;L++)O.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const N=this.circles[3*L],U=this.circles[3*L+1],Z=this.circles[3*L+2];O.push({key:this.circleKeys[L],x1:N-Z,y1:U-Z,x2:N+Z,y2:U+Z})}return M?O.filter(M):O}return this._forEachCell(a,f,y,b,this._queryCell,O,{hitTest:T,seenUids:{box:{},circle:{}}},M),T?O.length>0:O}_queryCircle(a,f,y,b,T){const M=a-y,O=a+y,L=f-y,N=f+y;if(O<0||M>this.width||N<0||L>this.height)return!b&&[];const U=[];return this._forEachCell(M,L,O,N,this._queryCellCircle,U,{hitTest:b,circle:{x:a,y:f,radius:y},seenUids:{box:{},circle:{}}},T),b?U.length>0:U}query(a,f,y,b,T){return this._query(a,f,y,b,!1,T)}hitTest(a,f,y,b,T){return this._query(a,f,y,b,!0,T)}hitTestCircle(a,f,y,b){return this._queryCircle(a,f,y,!0,b)}_queryCell(a,f,y,b,T,M,O,L){const N=O.seenUids,U=this.boxCells[T];if(U!==null){const te=this.bboxes;for(const ae of U)if(!N.box[ae]){N.box[ae]=!0;const le=4*ae;if(a<=te[le+2]&&f<=te[le+3]&&y>=te[le+0]&&b>=te[le+1]&&(!L||L(this.boxKeys[ae]))){if(O.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[ae],x1:te[le],y1:te[le+1],x2:te[le+2],y2:te[le+3]})}}}const Z=this.circleCells[T];if(Z!==null){const te=this.circles;for(const ae of Z)if(!N.circle[ae]){N.circle[ae]=!0;const le=3*ae;if(this._circleAndRectCollide(te[le],te[le+1],te[le+2],a,f,y,b)&&(!L||L(this.circleKeys[ae]))){if(O.hitTest)return M.push(!0),!0;{const ie=te[le],ve=te[le+1],oe=te[le+2];M.push({key:this.circleKeys[ae],x1:ie-oe,y1:ve-oe,x2:ie+oe,y2:ve+oe})}}}}}_queryCellCircle(a,f,y,b,T,M,O,L){const N=O.circle,U=O.seenUids,Z=this.boxCells[T];if(Z!==null){const ae=this.bboxes;for(const le of Z)if(!U.box[le]){U.box[le]=!0;const ie=4*le;if(this._circleAndRectCollide(N.x,N.y,N.radius,ae[ie+0],ae[ie+1],ae[ie+2],ae[ie+3])&&(!L||L(this.boxKeys[le])))return M.push(!0),!0}}const te=this.circleCells[T];if(te!==null){const ae=this.circles;for(const le of te)if(!U.circle[le]){U.circle[le]=!0;const ie=3*le;if(this._circlesCollide(ae[ie],ae[ie+1],ae[ie+2],N.x,N.y,N.radius)&&(!L||L(this.circleKeys[le])))return M.push(!0),!0}}}_forEachCell(a,f,y,b,T,M,O,L){const N=this._convertToXCellCoord(a),U=this._convertToYCellCoord(f),Z=this._convertToXCellCoord(y),te=this._convertToYCellCoord(b);for(let ae=N;ae<=Z;ae++)for(let le=U;le<=te;le++)if(T.call(this,a,f,y,b,this.xCellCount*le+ae,M,O,L))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,f,y,b,T,M){const O=b-a,L=T-f,N=y+M;return N*N>O*O+L*L}_circleAndRectCollide(a,f,y,b,T,M,O){const L=(M-b)/2,N=Math.abs(a-(b+L));if(N>L+y)return!1;const U=(O-T)/2,Z=Math.abs(f-(T+U));if(Z>U+y)return!1;if(N<=L||Z<=U)return!0;const te=N-L,ae=Z-U;return te*te+ae*ae<=y*y}}const pr=Math.tan(85*Math.PI/180);function dr(m,a,f,y,b,T,M){const O=o.create();if(f)if(T.name==="globe"){const L=o.calculateGlobeLabelMatrix(b,a);o.multiply(O,O,L)}else{const L=we([],M);O[0]=L[0],O[1]=L[1],O[4]=L[2],O[5]=L[3],y||o.rotateZ(O,O,b.angle)}else o.multiply(O,b.labelPlaneMatrix,m);return O}function vn(m,a,f,y,b,T,M){const O=dr(m,a,f,y,b,T,M);return T.name==="globe"&&f||(O[2]=O[6]=O[10]=O[14]=0),O}function Is(m,a,f,y,b,T,M){if(f){if(T.name==="globe"){const O=dr(m,a,f,y,b,T,M);return o.invert(O,O),o.multiply(O,m,O),O}{const O=o.clone(m),L=o.identity([]);return L[0]=M[0],L[1]=M[1],L[4]=M[2],L[5]=M[3],o.multiply(O,O,L),y||o.rotateZ(O,O,-b.angle),O}}return b.glCoordMatrix}function hr(m,a,f=0){const y=[m.x,m.y,f,1];f?o.transformMat4$1(y,y,a):_i(y,y,a);const b=y[3];return{point:[y[0]/b,y[1]/b,y[2]/b],signedDistanceFromCamera:b}}function xn(m,a){const f=[m[0],m[1],m[2],1];o.transformMat4$1(f,f,a);const y=f[3];return{point:[f[0]/y,f[1]/y,f[2]/y],signedDistanceFromCamera:y}}function us(m,a){return Math.min(.5+m/a*.5,1.5)}function _o(m,a){const f=m[0]/m[3],y=m[1]/m[3];return f>=-a[0]&&f<=a[0]&&y>=-a[1]&&y<=a[1]}function dn(m,a,f,y,b,T,M,O,L,N){const U=f.transform,Z=y?m.textSizeData:m.iconSizeData,te=o.evaluateSizeForZoom(Z,f.transform.zoom),ae=U.projection.name==="globe",le=[256/f.width*2+1,256/f.height*2+1],ie=y?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ie.clear();let ve=null;ae&&(ve=y?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const oe=m.lineVertexArray,he=y?m.text.placedSymbolArray:m.icon.placedSymbolArray,de=f.transform.width/f.transform.height;let Ae=!1;for(let _e=0;_e<he.length;_e++){const be=he.get(_e);if(be.writingMode!==o.WritingMode.vertical||Ae||_e!==0&&he.get(_e-1).writingMode===o.WritingMode.horizontal||(Ae=!0),(be.hidden||be.writingMode===o.WritingMode.vertical)&&!Ae){zi(be.numGlyphs,ie);continue}Ae=!1;const Re=new o.pointGeometry(be.tileAnchorX,be.tileAnchorY),We=L?L(Re):[0,0,0],Ke=U.projection.projectTilePoint(Re.x,Re.y,N.canonical),Ze=[Ke.x+We[0],Ke.y+We[1],Ke.z+We[2]],Ge=[...Ze,1];if(o.transformMat4$1(Ge,Ge,a),!_o(Ge,le)){zi(be.numGlyphs,ie);continue}const Se=us(f.transform.cameraToCenterDistance,Ge[3]),dt=o.evaluateSizeForFeature(Z,te,be),ct=M?dt/Se:dt*Se,Rt=hr(new o.pointGeometry(Ze[0],Ze[1]),b,Ze[2]);if(Rt.signedDistanceFromCamera<=0){zi(be.numGlyphs,ie);continue}let Qe={};const Jt=M?null:L,Mt=La(be,ct,!1,O,a,b,T,m.glyphOffsetArray,oe,ie,ve,Rt.point,Re,Qe,de,Jt,U.projection,N,M);Ae=Mt.useVertical,Jt&&Mt.needsFlipping&&(Qe={}),(Mt.notEnoughRoom||Ae||Mt.needsFlipping&&La(be,ct,!0,O,a,b,T,m.glyphOffsetArray,oe,ie,ve,Rt.point,Re,Qe,de,Jt,U.projection,N,M).notEnoughRoom)&&zi(be.numGlyphs,ie)}y?(m.text.dynamicLayoutVertexBuffer.updateData(ie),ve&&m.text.globeExtVertexBuffer.updateData(ve)):(m.icon.dynamicLayoutVertexBuffer.updateData(ie),ve&&m.icon.globeExtVertexBuffer.updateData(ve))}function Hr(m,a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie){const ve=O.glyphStartIndex+O.numGlyphs,oe=O.lineStartIndex,he=O.lineStartIndex+O.lineLength,de=a.getoffsetX(O.glyphStartIndex),Ae=a.getoffsetX(ve-1),_e=za(m*de,f,y,b,T,M,O.segment,oe,he,L,N,U,Z,te,!0,ae,le,ie);if(!_e)return null;const be=za(m*Ae,f,y,b,T,M,O.segment,oe,he,L,N,U,Z,te,!0,ae,le,ie);return be?{first:_e,last:be}:null}function nm(m,a,f,y){return m.writingMode===o.WritingMode.horizontal&&Math.abs(f.y-a.y)>Math.abs(f.x-a.x)*y?{useVertical:!0}:m.writingMode===o.WritingMode.vertical?a.y<f.y?{needsFlipping:!0}:null:m.flipState!==0&&function(b,T,M){const O=(T.x-b.x)*M;return O===0||Math.abs((T.y-b.y)/O)>pr}(a,f,y)?m.flipState===1?{needsFlipping:!0}:null:a.x>f.x?{needsFlipping:!0}:null}function La(m,a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie,ve,oe,he){const de=a/24,Ae=m.lineOffsetX*de,_e=m.lineOffsetY*de;let be;if(m.numGlyphs>1){const Re=m.glyphStartIndex+m.numGlyphs,We=m.lineStartIndex,Ke=m.lineStartIndex+m.lineLength,Ze=Hr(de,O,Ae,_e,f,Z,te,m,L,T,ae,ie,!1,ve,oe,he);if(!Ze)return{notEnoughRoom:!0};const Ge=xn(Ze.first.point,M).point,Se=xn(Ze.last.point,M).point,dt=new o.pointGeometry(Ge[0],Ge[1]),ct=new o.pointGeometry(Se[0],Se[1]);if(y&&!f){const Rt=nm(m,dt,ct,le);if(m.flipState=Rt&&Rt.needsFlipping?1:2,Rt)return Rt}be=[Ze.first];for(let Rt=m.glyphStartIndex+1;Rt<Re-1;Rt++)be.push(za(de*O.getoffsetX(Rt),Ae,_e,f,Z,te,m.segment,We,Ke,L,T,ae,ie,!1,!1,ve,oe,he));be.push(Ze.last)}else{if(y&&!f){const We=hr(te,b).point,Ke=m.lineStartIndex+m.segment+1,Ze=new o.pointGeometry(L.getx(Ke),L.gety(Ke)),Ge=hr(Ze,b),Se=Ge.signedDistanceFromCamera>0?Ge.point:ka(te,Ze,We,1,b,void 0,ve,oe.canonical),dt=nm(m,new o.pointGeometry(We[0],We[1]),new o.pointGeometry(Se[0],Se[1]),le);if(m.flipState=dt&&dt.needsFlipping?1:2,dt)return dt}const Re=za(de*O.getoffsetX(m.glyphStartIndex),Ae,_e,f,Z,te,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,L,T,ae,ie,!1,!1,ve,oe,he);if(!Re)return{notEnoughRoom:!0};be=[Re]}if(U)for(const Re of be)o.updateGlobeVertexNormal(U,N.length+0,Re.up[0],Re.up[1],Re.up[2]),o.updateGlobeVertexNormal(U,N.length+1,Re.up[0],Re.up[1],Re.up[2]),o.updateGlobeVertexNormal(U,N.length+2,Re.up[0],Re.up[1],Re.up[2]),o.updateGlobeVertexNormal(U,N.length+3,Re.up[0],Re.up[1],Re.up[2]),o.addDynamicAttributes(N,Re.point[0],Re.point[1],Re.point[2],Re.angle);else for(const Re of be)o.addDynamicAttributes(N,Re.point[0],Re.point[1],Re.point[2],Re.angle);return{}}function yu(m,a,f,y,b){const T=y.projectTilePoint(m.x,m.y,a);if(!b)return hr(T,f,T.z);const M=b(m);return hr(new o.pointGeometry(T.x+M[0],T.y+M[1]),f,T.z+M[2])}function ka(m,a,f,y,b,T,M,O){const L=yu(m.add(m.sub(a)._unit()),O,b,M,T).point,N=o.sub([],f,L);return o.scaleAndAdd([],f,N,y/o.length(N))}function za(m,a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie,ve,oe){const he=y?m-a:m+a;let de=he>0?1:-1,Ae=0;y&&(de*=-1,Ae=Math.PI),de<0&&(Ae+=Math.PI);let _e=de>0?O+M:O+M+1,be=b,Re=b,We=0,Ke=0;const Ze=Math.abs(he),Ge=[],Se=[];let dt=T;const ct=()=>{const Xt=_e-de;return We===0?T:new o.pointGeometry(N.getx(Xt),N.gety(Xt))},Rt=()=>ka(ct(),dt,Re,Ze-We+1,U,te,ie,ve.canonical);for(;We+Ke<=Ze;){if(_e+=de,_e<O||_e>=L)return null;if(Re=be,Ge.push(be),ae&&Se.push(dt||ct()),be=Z[_e],be===void 0){dt=new o.pointGeometry(N.getx(_e),N.gety(_e));const Xt=yu(dt,ve.canonical,U,ie,te);be=Xt.signedDistanceFromCamera>0?Z[_e]=Xt.point:Rt()}else dt=null;We+=Ke,Ke=o.distance(Re,be)}dt=dt||new o.pointGeometry(N.getx(_e),N.gety(_e));const Qe=ct();le&&te&&(Z[_e]=be=Z[_e]===void 0?be:Rt(),Ke=o.distance(Re,be));const Jt=(Ze-We)/Ke,Mt=dt.sub(Qe).mult(Jt)._add(Qe),It=o.sub([],be,Re),wt=o.scaleAndAdd([],Re,It,Jt);let Pt=[0,0,1],cr=It[0],tr=It[1];if(oe&&(Pt=ie.upVector(ve.canonical,Mt.x,Mt.y),Pt[0]!==0||Pt[1]!==0||Pt[2]!==1)){const Xt=[1,0,0],mr=[0,1,0];Xt[0]=Pt[2],Xt[1]=0,Xt[2]=-Pt[0],o.cross(mr,Pt,Xt),o.normalize(Xt,Xt),o.normalize(mr,mr),cr=o.dot(It,Xt),tr=o.dot(It,mr)}if(f){const Xt=o.cross([],Pt,It);o.normalize(Xt,Xt),o.scaleAndAdd(wt,wt,Xt,f*de)}const _r=Ae+Math.atan2(tr,cr);return Ge.push(wt),ae&&Se.push(Mt),{point:wt,angle:_r,path:Ge,tilePath:Se,up:Pt}}const sm=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function zi(m,a){for(let f=0;f<m;f++){const y=a.length;a.resize(y+4),a.float32.set(sm,4*y)}}function _i(m,a,f){const y=a[0],b=a[1];return m[0]=f[0]*y+f[4]*b+f[12],m[1]=f[1]*y+f[5]*b+f[13],m[3]=f[3]*y+f[7]*b+f[15],m}const Zn=100;class wd{constructor(a,f,y=new Dt(a.width+200,a.height+200,25),b=new Dt(a.width+200,a.height+200,25)){this.transform=a,this.grid=y,this.ignoredGrid=b,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+Zn,this.screenBottomBoundary=a.height+Zn,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=f}placeCollisionBox(a,f,y,b,T,M,O,L){let N=y.projectedAnchorX,U=y.projectedAnchorY,Z=y.projectedAnchorZ;const te=y.elevation,ae=y.tileID;if(te&&ae){const _e=a.getProjection().upVector(ae.canonical,y.tileAnchorX,y.tileAnchorY),be=a.getProjection().upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;N+=_e[0]*te*be,U+=_e[1]*te*be,Z+=_e[2]*te*be}const le=this.projectAndGetPerspectiveRatio(O,[N,U,Z],y.tileID,a.projection.name==="globe"||!!te||this.transform.pitch>0,a.getProjection()),ie=M*le.perspectiveRatio,ve=(y.x1*f+b.x-y.padding)*ie+le.point.x,oe=(y.y1*f+b.y-y.padding)*ie+le.point.y,he=(y.x2*f+b.x+y.padding)*ie+le.point.x,de=(y.y2*f+b.y+y.padding)*ie+le.point.y,Ae=le.perspectiveRatio<=.55||le.occluded;return!this.isInsideGrid(ve,oe,he,de)||!T&&this.grid.hitTest(ve,oe,he,de,L)||Ae?{box:[],offscreen:!1,occluded:le.occluded}:{box:[ve,oe,he,de],offscreen:this.isOffscreen(ve,oe,he,de),occluded:!1}}placeCollisionCircles(a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie){const ve=[],oe=this.transform.elevation,he=oe?oe.getAtTileOffsetFunc(ie,this.transform.center.lat,this.transform.worldSize,a.getProjection()):Qe=>[0,0,0],de=new o.pointGeometry(y.tileAnchorX,y.tileAnchorY),Ae=a.getProjection().projectTilePoint(y.tileAnchorX,y.tileAnchorY,ie.canonical),_e=he(de),be=[Ae.x+_e[0],Ae.y+_e[1],Ae.z+_e[2]],Re=a.projection.name==="globe",We=this.projectAndGetPerspectiveRatio(O,[be[0],be[1],be[2]],ie,Re||!!oe||this.transform.pitch>0,a.getProjection()),{perspectiveRatio:Ke}=We,Ze=(Z?M/Ke:M*Ke)/o.ONE_EM,Ge=hr(new o.pointGeometry(be[0],be[1]),L,be[2]).point,Se=We.signedDistanceFromCamera>0?Hr(Ze,T,y.lineOffsetX*Ze,y.lineOffsetY*Ze,!1,Ge,de,y,b,L,{},oe&&!Z?he:null,Z&&!!oe,a.getProjection(),ie,Z):null;let dt=!1,ct=!1,Rt=!0;if(Se&&!We.occluded){const Qe=.5*ae*Ke+le,Jt=new o.pointGeometry(-100,-100),Mt=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),It=new nn,wt=Se.first,Pt=Se.last;let cr=[];for(let Xt=wt.path.length-1;Xt>=1;Xt--)cr.push(wt.path[Xt]);for(let Xt=1;Xt<Pt.path.length;Xt++)cr.push(Pt.path[Xt]);const tr=2.5*Qe;if(N){const Xt=cr.map(oe&&!Re?(mr,Br)=>{const Gr=he(Br<wt.path.length-1?wt.tilePath[wt.path.length-1-Br]:Pt.tilePath[Br-wt.path.length+2]);return mr[2]=Gr[2],xn(mr,N)}:mr=>xn(mr,N));cr=Xt.some(mr=>mr.signedDistanceFromCamera<=0)?[]:Xt.map(mr=>mr.point)}let _r=[];if(cr.length>0){const Xt=cr.map(Yr=>new o.pointGeometry(Yr[0],Yr[1]));let mr=1/0,Br=-1/0,Gr=1/0,Ti=-1/0;for(let Yr=0;Yr<Xt.length;Yr++)mr=Math.min(mr,Xt[Yr].x),Gr=Math.min(Gr,Xt[Yr].y),Br=Math.max(Br,Xt[Yr].x),Ti=Math.max(Ti,Xt[Yr].y);_r=mr>=Jt.x&&Br<=Mt.x&&Gr>=Jt.y&&Ti<=Mt.y?[Xt]:Br<Jt.x||mr>Mt.x||Ti<Jt.y||Gr>Mt.y?[]:o.clipLine([Xt],Jt.x,Jt.y,Mt.x,Mt.y)}for(const Xt of _r){It.reset(Xt,.25*Qe);let mr=0;mr=It.length<=.5*Qe?1:Math.ceil(It.paddedLength/tr)+1;for(let Br=0;Br<mr;Br++){const Gr=Br/Math.max(mr-1,1),Ti=It.lerp(Gr),Yr=Ti.x+Zn,kn=Ti.y+Zn;ve.push(Yr,kn,Qe,0);const Ds=Yr-Qe,Qs=kn-Qe,ii=Yr+Qe,ai=kn+Qe;if(Rt=Rt&&this.isOffscreen(Ds,Qs,ii,ai),ct=ct||this.isInsideGrid(Ds,Qs,ii,ai),!f&&this.grid.hitTestCircle(Yr,kn,Qe,te)&&(dt=!0,!U))return{circles:[],offscreen:!1,collisionDetected:dt,occluded:!1}}}}return{circles:!U&&dt||!ct?[]:ve,offscreen:Rt,collisionDetected:dt,occluded:We.occluded}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let y=1/0,b=1/0,T=-1/0,M=-1/0;for(const U of a){const Z=new o.pointGeometry(U.x+Zn,U.y+Zn);y=Math.min(y,Z.x),b=Math.min(b,Z.y),T=Math.max(T,Z.x),M=Math.max(M,Z.y),f.push(Z)}const O=this.grid.query(y,b,T,M).concat(this.ignoredGrid.query(y,b,T,M)),L={},N={};for(const U of O){const Z=U.key;if(L[Z.bucketInstanceId]===void 0&&(L[Z.bucketInstanceId]={}),L[Z.bucketInstanceId][Z.featureIndex])continue;const te=[new o.pointGeometry(U.x1,U.y1),new o.pointGeometry(U.x2,U.y1),new o.pointGeometry(U.x2,U.y2),new o.pointGeometry(U.x1,U.y2)];o.polygonIntersectsPolygon(f,te)&&(L[Z.bucketInstanceId][Z.featureIndex]=!0,N[Z.bucketInstanceId]===void 0&&(N[Z.bucketInstanceId]=[]),N[Z.bucketInstanceId].push(Z.featureIndex))}return N}insertCollisionBox(a,f,y,b,T){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:T},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,f,y,b,T){const M=f?this.ignoredGrid:this.grid,O={bucketInstanceId:y,featureIndex:b,collisionGroupID:T};for(let L=0;L<a.length;L+=4)M.insertCircle(O,a[L],a[L+1],a[L+2])}projectAndGetPerspectiveRatio(a,f,y,b,T){const M=[f[0],f[1],f[2],1];let O=!1;if(f[2]||this.transform.pitch>0){o.transformMat4$1(M,M,a);const L=T.name==="globe";this.fogState&&y&&!L&&(O=function(N,U,Z,te,ae,le){const ie=le.calculateFogTileMatrix(ae),ve=[U,Z,te];return o.transformMat4(ve,ve,ie),ut(N,ve,le.pitch,le._fov)}(this.fogState,f[0],f[1],f[2],y.toUnwrapped(),this.transform)>.9)}else _i(M,M,a);return{point:new o.pointGeometry((M[0]/M[3]+1)/2*this.transform.width+Zn,(-M[1]/M[3]+1)/2*this.transform.height+Zn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(T)/M[3]*.5,1.5),signedDistanceFromCamera:M[3],occluded:b&&M[2]>M[3]||O}}isOffscreen(a,f,y,b){return y<Zn||a>=this.screenRightBoundary||b<Zn||f>this.screenBottomBoundary}isInsideGrid(a,f,y,b){return y>=0&&a<this.gridRightBoundary&&b>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const a=o.identity([]);return o.translate(a,a,[-100,-100,0]),a}}function sn(m,a,f){const y=a.createTileMatrix(m,m.worldSize,f.toUnwrapped());return o.multiply(new Float32Array(16),m.projMatrix,y)}function qn(m,a,f){if(a.projection.name===f.projection.name)return m.projMatrix;const y=f.clone();return y.setProjection(a.projection),sn(y,a.getProjection(),m)}function vu(m,a,f){return a.name===f.projection.name?m.projMatrix:sn(f,a,m)}class ql{constructor(a,f,y,b){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?f:-f))):b&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class pi{constructor(a,f,y,b,T,M=!1){this.text=new ql(a?a.text:null,f,y,T),this.icon=new ql(a?a.icon:null,f,b,T),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Zo{constructor(a,f,y,b=!1){this.text=a,this.icon=f,this.skipFade=y,this.clipped=b}}class Ed{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Kl{constructor(a,f,y,b,T){this.bucketInstanceId=a,this.featureIndex=f,this.sourceLayerIndex=y,this.bucketIndex=b,this.tileID=T}}class qi{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const f=++this.maxGroupID;this.collisionGroups[a]={ID:f,predicate:y=>y.collisionGroupID===f}}return this.collisionGroups[a]}}function xu(m,a,f,y,b){const{horizontalAlign:T,verticalAlign:M}=o.getAnchorAlignment(m),O=-(T-.5)*a,L=-(M-.5)*f,N=o.evaluateVariableOffset(m,y);return new o.pointGeometry(O+N[0]*b,L+N[1]*b)}function Xl(m,a,f,y,b){const T=new o.pointGeometry(m,a);return f&&T._rotate(y?b:-b),T}class Xs{constructor(a,f,y,b,T){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new wd(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new qi(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,f,y,b){const T=y.getBucket(f),M=y.latestFeatureIndex;if(!T||!M||f.id!==T.layerIds[0])return;const O=T.layers[0].layout,L=y.collisionBoxArray,N=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),U=y.tileSize/o.EXTENT,Z=y.tileID.toUnwrapped();this.transform.setProjection(T.projection);const te=(ae=y.tileID,le=T.getProjection(),ie=this.transform,le.name===this.projection?ie.calculateProjMatrix(ae.toUnwrapped()):sn(ie,le,ae));var ae,le,ie;const ve=O.get("text-pitch-alignment")==="map",oe=O.get("text-rotation-alignment")==="map";f.compileFilter();const he=f.dynamicFilter(),de=f.dynamicFilterNeedsFeature(),Ae=this.transform.calculatePixelsToTileUnitsMatrix(y),_e=vn(te,y.tileID.canonical,ve,oe,this.transform,T.getProjection(),Ae);let be=null;if(ve){const Ke=Is(te,y.tileID.canonical,ve,oe,this.transform,T.getProjection(),Ae);be=o.multiply([],this.transform.labelPlaneMatrix,Ke)}let Re=null;he&&y.latestFeatureIndex&&(Re={unwrappedTileID:Z,dynamicFilter:he,dynamicFilterNeedsFeature:de,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Kl(T.bucketInstanceId,M,T.sourceLayerIndex,T.index,y.tileID);const We={bucket:T,layout:O,posMatrix:te,textLabelPlaneMatrix:_e,labelToScreenMatrix:be,clippingData:Re,scale:N,textPixelRatio:U,holdingForFade:y.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(b)for(const Ke of T.sortKeyRanges){const{sortKey:Ze,symbolInstanceStart:Ge,symbolInstanceEnd:Se}=Ke;a.push({sortKey:Ze,symbolInstanceStart:Ge,symbolInstanceEnd:Se,parameters:We})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:We})}attemptAnchorPlacement(a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie,ve,oe,he){const de=[te.textOffset0,te.textOffset1],Ae=xu(a,y,b,de,T),_e=this.collisionIndex.placeCollisionBox(le,T,f,Xl(Ae.x,Ae.y,M,O,this.transform.angle),Z,L,N,U.predicate);if((!ve||this.collisionIndex.placeCollisionBox(le,le.getSymbolInstanceIconSize(he,this.transform.zoom,ae),ve,Xl(Ae.x,Ae.y,M,O,this.transform.angle),Z,L,N,U.predicate).box.length!==0)&&_e.box.length>0){let be;return this.prevPlacement&&this.prevPlacement.variableOffsets[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID].text&&(be=this.prevPlacement.variableOffsets[te.crossTileID].anchor),this.variableOffsets[te.crossTileID]={textOffset:de,width:y,height:b,anchor:a,textScale:T,prevAnchor:be},this.markUsedJustification(le,a,te,ie),le.allowVerticalPlacement&&(this.markUsedOrientation(le,ie,te),this.placedOrientations[te.crossTileID]=ie),{shift:Ae,placedGlyphBoxes:_e}}}placeLayerBucketPart(a,f,y,b){const{bucket:T,layout:M,posMatrix:O,textLabelPlaneMatrix:L,labelToScreenMatrix:N,clippingData:U,textPixelRatio:Z,holdingForFade:te,collisionBoxArray:ae,partiallyEvaluatedTextSize:le,partiallyEvaluatedIconSize:ie,collisionGroup:ve}=a.parameters,oe=M.get("text-optional"),he=M.get("icon-optional"),de=M.get("text-allow-overlap"),Ae=M.get("icon-allow-overlap"),_e=M.get("text-rotation-alignment")==="map",be=M.get("text-pitch-alignment")==="map",Re=M.get("icon-text-fit")!=="none",We=M.get("symbol-z-order")==="viewport-y";this.transform.setProjection(T.projection);let Ke=de&&(Ae||!T.hasIconData()||he),Ze=Ae&&(de||!T.hasTextData()||oe);!T.collisionArrays&&ae&&T.deserializeCollisionBoxes(ae),y&&b&&T.updateCollisionDebugBuffers(this.transform.zoom,ae);const Ge=(Se,dt,ct)=>{if(U){const ii={zoom:this.transform.zoom,pitch:this.transform.pitch};let ai=null;if(U.dynamicFilterNeedsFeature){const $r=this.retainedQueryData[T.bucketInstanceId];ai=U.featureIndex.loadFeature({featureIndex:Se.featureIndex,bucketIndex:$r.bucketIndex,sourceLayerIndex:$r.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,U.dynamicFilter)(ii,ai,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new o.pointGeometry(Se.tileAnchorX,Se.tileAnchorY),this.transform.calculateDistanceTileData(U.unwrappedTileID)))return this.placements[Se.crossTileID]=new Zo(!1,!1,!1,!0),void(f[Se.crossTileID]=!0)}if(f[Se.crossTileID])return;if(te)return void(this.placements[Se.crossTileID]=new Zo(!1,!1,!1));let Rt=!1,Qe=!1,Jt=!0,Mt=!1,It=!1,wt=null,Pt={box:null,offscreen:null,occluded:null},cr={box:null,offscreen:null,occluded:null},tr=null,_r=null,Xt=null,mr=0,Br=0,Gr=0;ct.textFeatureIndex?mr=ct.textFeatureIndex:Se.useRuntimeCollisionCircles&&(mr=Se.featureIndex),ct.verticalTextFeatureIndex&&(Br=ct.verticalTextFeatureIndex);const Ti=ii=>{ii.tileID=this.retainedQueryData[T.bucketInstanceId].tileID,(this.transform.elevation||ii.elevation)&&(ii.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[T.bucketInstanceId].tileID,ii.tileAnchorX,ii.tileAnchorY):0)},Yr=ct.textBox;if(Yr){Ti(Yr);const ii=$r=>{let Mi=o.WritingMode.horizontal;if(T.allowVerticalPlacement&&!$r&&this.prevPlacement){const Ki=this.prevPlacement.placedOrientations[Se.crossTileID];Ki&&(this.placedOrientations[Se.crossTileID]=Ki,Mi=Ki,this.markUsedOrientation(T,Mi,Se))}return Mi},ai=($r,Mi)=>{if(T.allowVerticalPlacement&&Se.numVerticalGlyphVertices>0&&ct.verticalTextBox){for(const Ki of T.writingModes)if(Ki===o.WritingMode.vertical?(Pt=Mi(),cr=Pt):Pt=$r(),Pt&&Pt.box&&Pt.box.length)break}else Pt=$r()};if(M.get("text-variable-anchor")){let $r=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Se.crossTileID]){const Mr=this.prevPlacement.variableOffsets[Se.crossTileID];$r.indexOf(Mr.anchor)>0&&($r=$r.filter(bn=>bn!==Mr.anchor),$r.unshift(Mr.anchor))}const Mi=(Mr,bn,ra)=>{const fs=T.getSymbolInstanceTextSize(le,Se,this.transform.zoom,dt),Xa=(Mr.x2-Mr.x1)*fs+2*Mr.padding,Ya=(Mr.y2-Mr.y1)*fs+2*Mr.padding,xo=Re&&!Ae?bn:null;xo&&Ti(xo);let Oi={box:[],offscreen:!1,occluded:!1};const Rs=de?2*$r.length:$r.length;for(let eo=0;eo<Rs;++eo){const gc=this.attemptAnchorPlacement($r[eo%$r.length],Mr,Xa,Ya,fs,_e,be,Z,O,ve,eo>=$r.length,Se,dt,T,ra,xo,le,ie);if(gc&&(Oi=gc.placedGlyphBoxes,Oi&&Oi.box&&Oi.box.length)){Rt=!0,wt=gc.shift;break}}return Oi};ai(()=>Mi(Yr,ct.iconBox,o.WritingMode.horizontal),()=>{const Mr=ct.verticalTextBox;return Mr&&Ti(Mr),T.allowVerticalPlacement&&!(Pt&&Pt.box&&Pt.box.length)&&Se.numVerticalGlyphVertices>0&&Mr?Mi(Mr,ct.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Pt&&(Rt=Pt.box,Jt=Pt.offscreen,Mt=Pt.occluded);const Ki=ii(Pt&&Pt.box);if(!Rt&&this.prevPlacement){const Mr=this.prevPlacement.variableOffsets[Se.crossTileID];Mr&&(this.variableOffsets[Se.crossTileID]=Mr,this.markUsedJustification(T,Mr.anchor,Se,Ki))}}else{const $r=(Mi,Ki)=>{const Mr=T.getSymbolInstanceTextSize(le,Se,this.transform.zoom,dt),bn=this.collisionIndex.placeCollisionBox(T,Mr,Mi,new o.pointGeometry(0,0),de,Z,O,ve.predicate);return bn&&bn.box&&bn.box.length&&(this.markUsedOrientation(T,Ki,Se),this.placedOrientations[Se.crossTileID]=Ki),bn};ai(()=>$r(Yr,o.WritingMode.horizontal),()=>{const Mi=ct.verticalTextBox;return T.allowVerticalPlacement&&Se.numVerticalGlyphVertices>0&&Mi?(Ti(Mi),$r(Mi,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),ii(Pt&&Pt.box&&Pt.box.length)}}if(tr=Pt,Rt=tr&&tr.box&&tr.box.length>0,Jt=tr&&tr.offscreen,Mt=tr&&tr.occluded,Se.useRuntimeCollisionCircles){const ii=T.text.placedSymbolArray.get(Se.centerJustifiedTextSymbolIndex>=0?Se.centerJustifiedTextSymbolIndex:Se.verticalPlacedTextSymbolIndex),ai=o.evaluateSizeForFeature(T.textSizeData,le,ii),$r=M.get("text-padding");_r=this.collisionIndex.placeCollisionCircles(T,de,ii,T.lineVertexArray,T.glyphOffsetArray,ai,O,L,N,y,be,ve.predicate,Se.collisionCircleDiameter*ai/o.ONE_EM,$r,this.retainedQueryData[T.bucketInstanceId].tileID),Rt=de||_r.circles.length>0&&!_r.collisionDetected,Jt=Jt&&_r.offscreen,Mt=_r.occluded}if(ct.iconFeatureIndex&&(Gr=ct.iconFeatureIndex),ct.iconBox){const ii=ai=>{Ti(ai);const $r=Re&&wt?Xl(wt.x,wt.y,_e,be,this.transform.angle):new o.pointGeometry(0,0),Mi=T.getSymbolInstanceIconSize(ie,this.transform.zoom,dt);return this.collisionIndex.placeCollisionBox(T,Mi,ai,$r,Ae,Z,O,ve.predicate)};cr&&cr.box&&cr.box.length&&ct.verticalIconBox?(Xt=ii(ct.verticalIconBox),Qe=Xt.box.length>0):(Xt=ii(ct.iconBox),Qe=Xt.box.length>0),Jt=Jt&&Xt.offscreen,It=Xt.occluded}const kn=oe||Se.numHorizontalGlyphVertices===0&&Se.numVerticalGlyphVertices===0,Ds=he||Se.numIconVertices===0;if(kn||Ds?Ds?kn||(Qe=Qe&&Rt):Rt=Qe&&Rt:Qe=Rt=Qe&&Rt,Rt&&tr&&tr.box&&this.collisionIndex.insertCollisionBox(tr.box,M.get("text-ignore-placement"),T.bucketInstanceId,cr&&cr.box&&Br?Br:mr,ve.ID),Qe&&Xt&&this.collisionIndex.insertCollisionBox(Xt.box,M.get("icon-ignore-placement"),T.bucketInstanceId,Gr,ve.ID),_r&&(Rt&&this.collisionIndex.insertCollisionCircles(_r.circles,M.get("text-ignore-placement"),T.bucketInstanceId,mr,ve.ID),y)){const ii=T.bucketInstanceId;let ai=this.collisionCircleArrays[ii];ai===void 0&&(ai=this.collisionCircleArrays[ii]=new Ed);for(let $r=0;$r<_r.circles.length;$r+=4)ai.circles.push(_r.circles[$r+0]),ai.circles.push(_r.circles[$r+1]),ai.circles.push(_r.circles[$r+2]),ai.circles.push(_r.collisionDetected?1:0)}const Qs=T.projection.name!=="globe";Ke=Ke&&(Qs||!Mt),Ze=Ze&&(Qs||!It),this.placements[Se.crossTileID]=new Zo(Rt||Ke,Qe||Ze,Jt||T.justReloaded),f[Se.crossTileID]=!0};if(We){const Se=T.getSortedSymbolIndexes(this.transform.angle);for(let dt=Se.length-1;dt>=0;--dt){const ct=Se[dt];Ge(T.symbolInstances.get(ct),ct,T.collisionArrays[ct])}}else for(let Se=a.symbolInstanceStart;Se<a.symbolInstanceEnd;Se++)Ge(T.symbolInstances.get(Se),Se,T.collisionArrays[Se]);if(y&&T.bucketInstanceId in this.collisionCircleArrays){const Se=this.collisionCircleArrays[T.bucketInstanceId];o.invert(Se.invProjMatrix,O),Se.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(a,f,y,b){let T;T=b===o.WritingMode.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(f)];const M=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(const O of M)O>=0&&(a.text.placedSymbolArray.get(O).crossTileID=T>=0&&O!==T?0:y.crossTileID)}markUsedOrientation(a,f,y){const b=f===o.WritingMode.horizontal||f===o.WritingMode.horizontalOnly?f:0,T=f===o.WritingMode.vertical?f:0,M=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(const O of M)a.text.placedSymbolArray.get(O).placedOrientation=b;y.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let y=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const b=f?f.symbolFadeChange(a):1,T=f?f.opacities:{},M=f?f.variableOffsets:{},O=f?f.placedOrientations:{};for(const L in this.placements){const N=this.placements[L],U=T[L];U?(this.opacities[L]=new pi(U,b,N.text,N.icon,null,N.clipped),y=y||N.text!==U.text.placed||N.icon!==U.icon.placed):(this.opacities[L]=new pi(null,b,N.text,N.icon,N.skipFade,N.clipped),y=y||N.text||N.icon)}for(const L in T){const N=T[L];if(!this.opacities[L]){const U=new pi(N,b,!1,!1);U.isHidden()||(this.opacities[L]=U,y=y||N.text.placed||N.icon.placed)}}for(const L in M)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=M[L]);for(const L in O)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=O[L]);y?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:a)}updateLayerOpacities(a,f){const y={};for(const b of f){const T=b.getBucket(a);T&&b.latestFeatureIndex&&a.id===T.layerIds[0]&&this.updateBucketOpacities(T,y,b.collisionBoxArray)}}updateBucketOpacities(a,f,y){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const b=a.layers[0].layout,T=!!a.layers[0].dynamicFilter(),M=new pi(null,0,!1,!1,!0),O=b.get("text-allow-overlap"),L=b.get("icon-allow-overlap"),N=b.get("text-variable-anchor"),U=b.get("text-rotation-alignment")==="map",Z=b.get("text-pitch-alignment")==="map",te=b.get("icon-text-fit")!=="none",ae=new pi(null,0,O&&(L||!a.hasIconData()||b.get("icon-optional")),L&&(O||!a.hasTextData()||b.get("text-optional")),!0);!a.collisionArrays&&y&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(y);const le=(ve,oe,he)=>{for(let de=0;de<oe/4;de++)ve.opacityVertexArray.emplaceBack(he)};let ie=0;for(let ve=0;ve<a.symbolInstances.length;ve++){const oe=a.symbolInstances.get(ve),{numHorizontalGlyphVertices:he,numVerticalGlyphVertices:de,crossTileID:Ae}=oe;let _e=this.opacities[Ae];f[Ae]?_e=M:_e||(_e=ae,this.opacities[Ae]=_e),f[Ae]=!0;const be=he>0||de>0,Re=oe.numIconVertices>0,We=this.placedOrientations[oe.crossTileID],Ke=We===o.WritingMode.vertical,Ze=We===o.WritingMode.horizontal||We===o.WritingMode.horizontalOnly;if(!be&&!Re||_e.isHidden()||ie++,be){const Ge=Ys(_e.text);le(a.text,he,Ke?qo:Ge),le(a.text,de,Ze?qo:Ge);const Se=_e.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(Rt=>{Rt>=0&&(a.text.placedSymbolArray.get(Rt).hidden=Se||Ke?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=Se||Ze?1:0);const dt=this.variableOffsets[oe.crossTileID];dt&&this.markUsedJustification(a,dt.anchor,oe,We);const ct=this.placedOrientations[oe.crossTileID];ct&&(this.markUsedJustification(a,"left",oe,ct),this.markUsedOrientation(a,ct,oe))}if(Re){const Ge=Ys(_e.icon);oe.placedIconSymbolIndex>=0&&(le(a.icon,oe.numIconVertices,Ke?qo:Ge),a.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=_e.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(le(a.icon,oe.numVerticalIconVertices,Ze?qo:Ge),a.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=_e.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const Ge=a.collisionArrays[ve];if(Ge){let Se=new o.pointGeometry(0,0),dt=!0;if(Ge.textBox||Ge.verticalTextBox){if(N){const Rt=this.variableOffsets[Ae];Rt?(Se=xu(Rt.anchor,Rt.width,Rt.height,Rt.textOffset,Rt.textScale),U&&Se._rotate(Z?this.transform.angle:-this.transform.angle)):dt=!1}T&&(dt=!_e.clipped),Ge.textBox&&yo(a.textCollisionBox.collisionVertexArray,_e.text.placed,!dt||Ke,Se.x,Se.y),Ge.verticalTextBox&&yo(a.textCollisionBox.collisionVertexArray,_e.text.placed,!dt||Ze,Se.x,Se.y)}const ct=dt&&Boolean(!Ze&&Ge.verticalIconBox);Ge.iconBox&&yo(a.iconCollisionBox.collisionVertexArray,_e.icon.placed,ct,te?Se.x:0,te?Se.y:0),Ge.verticalIconBox&&yo(a.iconCollisionBox.collisionVertexArray,_e.icon.placed,!ct,te?Se.x:0,te?Se.y:0)}}}if(a.fullyClipped=ie===0,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const ve=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=ve.invProjMatrix,a.placementViewportMatrix=ve.viewportMatrix,a.collisionCircleArray=ve.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,f){const y=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*y>a}setStale(){this.stale=!0}}function yo(m,a,f,y,b){m.emplaceBack(a?1:0,f?1:0,y||0,b||0),m.emplaceBack(a?1:0,f?1:0,y||0,b||0),m.emplaceBack(a?1:0,f?1:0,y||0,b||0),m.emplaceBack(a?1:0,f?1:0,y||0,b||0)}const bu=Math.pow(2,25),wv=Math.pow(2,24),Td=Math.pow(2,17),Fa=Math.pow(2,16),Ev=Math.pow(2,9),om=Math.pow(2,8),Ba=Math.pow(2,1);function Ys(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const a=m.placed?1:0,f=Math.floor(127*m.opacity);return f*bu+a*wv+f*Td+a*Fa+f*Ev+a*om+f*Ba+a}const qo=0;class vo{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(a,f,y,b,T){const M=this._bucketParts;for(;this._currentTileIndex<a.length;)if(f.getBucketParts(M,b,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((O,L)=>O.sortKey-L.sortKey));this._currentPartIndex<M.length;){const O=M[this._currentPartIndex];if(f.placeLayerBucketPart(O,this._seenCrossTileIDs,y,O.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class Sd{constructor(a,f,y,b,T,M,O,L){this.placement=new Xs(a,T,M,O,L),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(a,f,y){const b=o.exported.now(),T=()=>{const M=o.exported.now()-b;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=f[a[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=O)&&(!M.maxzoom||M.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new vo(M)),this._inProgressLayer.continuePlacement(y[M.source],this.placement,this._showCollisionBoxes,M,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const wu=512/o.EXTENT/2;class Tv{constructor(a,f,y){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=y;for(let b=0;b<f.length;b++){const T=f.get(b),M=T.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:T.crossTileID,coord:this.getScaledCoordinates(T,a)})}}getScaledCoordinates(a,f){const y=wu/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*o.EXTENT+a.tileAnchorX)*y),y:Math.floor((f.canonical.y*o.EXTENT+a.tileAnchorY)*y)}}findMatches(a,f,y){const b=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let T=0;T<a.length;T++){const M=a.get(T);if(M.crossTileID)continue;const O=this.indexedSymbolInstances[M.key];if(!O)continue;const L=this.getScaledCoordinates(M,f);for(const N of O)if(Math.abs(N.coord.x-L.x)<=b&&Math.abs(N.coord.y-L.y)<=b&&!y[N.crossTileID]){y[N.crossTileID]=!0,M.crossTileID=N.crossTileID;break}}}}class Sv{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ad{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const f=Math.round((a-this.lng)/360);if(f!==0)for(const y in this.indexes){const b=this.indexes[y],T={};for(const M in b){const O=b[M];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+f),T[O.tileID.key]=O}this.indexes[y]=T}this.lng=a}addBucket(a,f,y){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let T=0;T<f.symbolInstances.length;T++)f.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});const b=this.usedCrossTileIDs[a.overscaledZ];for(const T in this.indexes){const M=this.indexes[T];if(Number(T)>a.overscaledZ)for(const O in M){const L=M[O];L.tileID.isChildOf(a)&&L.findMatches(f.symbolInstances,a,b)}else{const O=M[a.scaledTo(Number(T)).key];O&&O.findMatches(f.symbolInstances,a,b)}}for(let T=0;T<f.symbolInstances.length;T++){const M=f.symbolInstances.get(T);M.crossTileID||(M.crossTileID=y.generate(),b[M.crossTileID]=!0)}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new Tv(a,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(a,f){for(const y in f.indexedSymbolInstances)for(const b of f.indexedSymbolInstances[y])delete this.usedCrossTileIDs[a][b.crossTileID]}removeStaleBuckets(a){let f=!1;for(const y in this.indexes){const b=this.indexes[y];for(const T in b)a[b[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,b[T]),delete b[T],f=!0)}return f}}class am{constructor(){this.layerIndexes={},this.crossTileIDs=new Sv,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,f,y,b){let T=this.layerIndexes[a.id];T===void 0&&(T=this.layerIndexes[a.id]=new Ad);let M=!1;const O={};b.name!=="globe"&&T.handleWrapJump(y);for(const L of f){const N=L.getBucket(a);N&&a.id===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(L.tileID,N,this.crossTileIDs)&&(M=!0),O[N.bucketInstanceId]=!0)}return T.removeStaleBuckets(O)&&(M=!0),M}pruneUnusedLayers(a){const f={};a.forEach(y=>{f[y]=!0});for(const y in this.layerIndexes)f[y]||delete this.layerIndexes[y]}}const Yl=(m,a)=>o.emitValidationErrors(m,a&&a.filter(f=>f.identifier!=="source.canvas")),Av=o.pick(ze,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),lm=o.pick(ze,["setCenter","setZoom","setBearing","setPitch"]),Pv={version:8,layers:[],sources:{}},Pd={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class hs extends o.Evented{constructor(a,f={}){super(),this.map=a,this.dispatcher=new yt(lr(),this),this.imageManager=new ke,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(a._requestManager,f.localFontFamily?o.LocalGlyphMode.all:f.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.lineAtlas=new o.LineAtlas(256,512),this.crossTileSymbolIndex=new am,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const y=this;this._rtlTextPluginCallback=hs.registerForPluginStateChange(b=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(T,M)=>{if(o.triggerPluginCompletionEvent(T),M&&M.every(O=>O))for(const O in y._sourceCaches){const L=y._sourceCaches[O],N=L.getSource().type;N!=="vector"&&N!=="geojson"||L.reload()}})}),this.on("data",b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const T=this.getSource(b.sourceId);if(T&&T.vectorLayerIds)for(const M in this._layers){const O=this._layers[M];O.source===T.id&&this._validateLayer(O)}})}loadURL(a,f={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const y=typeof f.validate=="boolean"?f.validate:!o.isMapboxURL(a);a=this.map._requestManager.normalizeStyleURL(a,f.accessToken);const b=this.map._requestManager.transformRequest(a,o.ResourceType.Style);this._request=o.getJSON(b,(T,M)=>{this._request=null,T?this.fire(new o.ErrorEvent(T)):M&&this._load(M,y)})}loadJSON(a,f={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(a,f.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Pv,!1)}_updateLayerCount(a,f){const y=f?1:-1;a.is3D()&&(this._num3DLayers+=y),a.type==="circle"&&(this._numCircleLayers+=y),a.type==="symbol"&&(this._numSymbolLayers+=y)}_load(a,f){if(f&&Yl(this,o.validateStyle(a)))return;this._loaded=!0,this.stylesheet=o.clone$1(a),this._updateMapProjection();for(const b in a.sources)this.addSource(b,a.sources[b],{validate:!1});this._changed=!1,a.sprite?this._loadSprite(a.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(a.glyphs);const y=ar(this.stylesheet.layers);this._order=y.map(b=>b.id),this._layers={},this._serializedLayers={};for(let b of y)b=o.createStyleLayer(b),b.setEventedParent(this,{layer:{id:b.id}}),this._layers[b.id]=b,this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new se(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(a){this._spriteRequest=function(f,y,b){let T,M,O;const L=o.exported.devicePixelRatio>1?"@2x":"";let N=o.getJSON(y.transformRequest(y.normalizeSpriteURL(f,L,".json"),o.ResourceType.SpriteJSON),(te,ae)=>{N=null,O||(O=te,T=ae,Z())}),U=o.getImage(y.transformRequest(y.normalizeSpriteURL(f,L,".png"),o.ResourceType.SpriteImage),(te,ae)=>{U=null,O||(O=te,M=ae,Z())});function Z(){if(O)b(O);else if(T&&M){const te=o.exported.getImageData(M),ae={};for(const le in T){const{width:ie,height:ve,x:oe,y:he,sdf:de,pixelRatio:Ae,stretchX:_e,stretchY:be,content:Re}=T[le],We=new o.RGBAImage({width:ie,height:ve});o.RGBAImage.copy(te,We,{x:oe,y:he},{x:0,y:0},{width:ie,height:ve}),ae[le]={data:We,pixelRatio:Ae,sdf:de,stretchX:_e,stretchY:be,content:Re}}b(null,ae)}}return{cancel(){N&&(N.cancel(),N=null),U&&(U.cancel(),U=null)}}}(a,this.map._requestManager,(f,y)=>{if(this._spriteRequest=null,f)this.fire(new o.ErrorEvent(f));else if(y)for(const b in y)this.imageManager.addImage(b,y[b]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(a){const f=this.getSource(a.source);if(!f)return;const y=a.sourceLayer;y&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${f.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(a){const f=[];for(const y of a){const b=this._layers[y];b.type!=="custom"&&f.push(b.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(a){return!!this.terrain&&Pd[a.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(a){if(!this._loaded)return;const f=this._changed;if(this._changed){const b=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(b.length||T.length)&&this._updateWorkerLayers(b,T);for(const M in this._updatedSources){const O=this._updatedSources[M];O==="reload"?this._reloadSource(M):O==="clear"&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(a);this.light.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this._resetUpdates()}const y={};for(const b in this._sourceCaches){const T=this._sourceCaches[b];y[b]=T.used,T.used=!1}for(const b of this._order){const T=this._layers[b];if(T.recalculate(a,this._availableImages),!T.isHidden(a.zoom)){const O=this._getLayerSourceCache(T);O&&(O.used=!0)}const M=this.map.painter;if(M){const O=T.getProgramIds();if(!O)continue;const L=T.getProgramConfiguration(a.zoom);for(const N of O)M.useProgram(N,L)}}for(const b in y){const T=this._sourceCaches[b];y[b]!==T.used&&T.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateWorkerLayers(a,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(a){if(this._checkLoaded(),Yl(this,o.validateStyle(a)))return!1;(a=o.clone$1(a)).layers=ar(a.layers);const f=function(b,T){if(!b)return[{command:ze.setStyle,args:[T]}];let M=[];try{if(!g(b.version,T.version))return[{command:ze.setStyle,args:[T]}];g(b.center,T.center)||M.push({command:ze.setCenter,args:[T.center]}),g(b.zoom,T.zoom)||M.push({command:ze.setZoom,args:[T.zoom]}),g(b.bearing,T.bearing)||M.push({command:ze.setBearing,args:[T.bearing]}),g(b.pitch,T.pitch)||M.push({command:ze.setPitch,args:[T.pitch]}),g(b.sprite,T.sprite)||M.push({command:ze.setSprite,args:[T.sprite]}),g(b.glyphs,T.glyphs)||M.push({command:ze.setGlyphs,args:[T.glyphs]}),g(b.transition,T.transition)||M.push({command:ze.setTransition,args:[T.transition]}),g(b.light,T.light)||M.push({command:ze.setLight,args:[T.light]}),g(b.fog,T.fog)||M.push({command:ze.setFog,args:[T.fog]}),g(b.projection,T.projection)||M.push({command:ze.setProjection,args:[T.projection]});const O={},L=[];(function(Z,te,ae,le){let ie;for(ie in te=te||{},Z=Z||{})Z.hasOwnProperty(ie)&&(te.hasOwnProperty(ie)||jr(ie,ae,le));for(ie in te)te.hasOwnProperty(ie)&&(Z.hasOwnProperty(ie)?g(Z[ie],te[ie])||(Z[ie].type==="geojson"&&te[ie].type==="geojson"&&Hn(Z,te,ie)?ae.push({command:ze.setGeoJSONSourceData,args:[ie,te[ie].data]}):gi(ie,te,ae,le)):Ir(ie,te,ae))})(b.sources,T.sources,L,O);const N=[];b.layers&&b.layers.forEach(Z=>{Z.source&&O[Z.source]?M.push({command:ze.removeLayer,args:[Z.id]}):N.push(Z)});let U=b.terrain;U&&O[U.source]&&(M.push({command:ze.setTerrain,args:[void 0]}),U=void 0),M=M.concat(L),g(U,T.terrain)||M.push({command:ze.setTerrain,args:[T.terrain]}),function(Z,te,ae){te=te||[];const le=(Z=Z||[]).map(Wn),ie=te.map(Wn),ve=Z.reduce(hn,{}),oe=te.reduce(hn,{}),he=le.slice(),de=Object.create(null);let Ae,_e,be,Re,We,Ke,Ze;for(Ae=0,_e=0;Ae<le.length;Ae++)be=le[Ae],oe.hasOwnProperty(be)?_e++:(ae.push({command:ze.removeLayer,args:[be]}),he.splice(he.indexOf(be,_e),1));for(Ae=0,_e=0;Ae<ie.length;Ae++)be=ie[ie.length-1-Ae],he[he.length-1-Ae]!==be&&(ve.hasOwnProperty(be)?(ae.push({command:ze.removeLayer,args:[be]}),he.splice(he.lastIndexOf(be,he.length-_e),1)):_e++,Ke=he[he.length-Ae],ae.push({command:ze.addLayer,args:[oe[be],Ke]}),he.splice(he.length-Ae,0,be),de[be]=!0);for(Ae=0;Ae<ie.length;Ae++)if(be=ie[Ae],Re=ve[be],We=oe[be],!de[be]&&!g(Re,We))if(g(Re.source,We.source)&&g(Re["source-layer"],We["source-layer"])&&g(Re.type,We.type)){for(Ze in ki(Re.layout,We.layout,ae,be,null,ze.setLayoutProperty),ki(Re.paint,We.paint,ae,be,null,ze.setPaintProperty),g(Re.filter,We.filter)||ae.push({command:ze.setFilter,args:[be,We.filter]}),g(Re.minzoom,We.minzoom)&&g(Re.maxzoom,We.maxzoom)||ae.push({command:ze.setLayerZoomRange,args:[be,We.minzoom,We.maxzoom]}),Re)Re.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&(Ze.indexOf("paint.")===0?ki(Re[Ze],We[Ze],ae,be,Ze.slice(6),ze.setPaintProperty):g(Re[Ze],We[Ze])||ae.push({command:ze.setLayerProperty,args:[be,Ze,We[Ze]]}));for(Ze in We)We.hasOwnProperty(Ze)&&!Re.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&(Ze.indexOf("paint.")===0?ki(Re[Ze],We[Ze],ae,be,Ze.slice(6),ze.setPaintProperty):g(Re[Ze],We[Ze])||ae.push({command:ze.setLayerProperty,args:[be,Ze,We[Ze]]}))}else ae.push({command:ze.removeLayer,args:[be]}),Ke=he[he.lastIndexOf(be)+1],ae.push({command:ze.addLayer,args:[We,Ke]})}(N,T.layers,M)}catch(O){console.warn("Unable to compute style diff:",O),M=[{command:ze.setStyle,args:[T]}]}return M}(this.serialize(),a).filter(b=>!(b.command in lm));if(f.length===0)return!1;const y=f.filter(b=>!(b.command in Av));if(y.length>0)throw new Error(`Unimplemented: ${y.map(b=>b.command).join(", ")}.`);return f.forEach(b=>{b.command!=="setTransition"&&this[b.command].apply(this,b.args)}),this.stylesheet=a,this._updateMapProjection(),!0}addImage(a,f){return this.getImage(a)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(a,f),this._afterImageUpdated(a),this)}updateImage(a,f){this.imageManager.updateImage(a,f)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a),this._afterImageUpdated(a),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(a,f,y={}){if(this._checkLoaded(),this.getSource(a)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(o.validateSource,`sources.${a}`,f,null,y))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const b=fe(a,f,this.dispatcher,this);b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(a),source:b.serialize(),sourceId:a}));const T=M=>{const O=(M?"symbol:":"other:")+a,L=this._sourceCaches[O]=new o.SourceCache(O,b,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[a]=L,L.style=this,L.onAdd(this.map)};T(!1),f.type!=="vector"&&f.type!=="geojson"||T(!0),b.onAdd&&b.onAdd(this.map),this._changed=!0}removeSource(a){this._checkLoaded();const f=this.getSource(a);if(!f)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===a)return this.fire(new o.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.get().source===a)return this.fire(new o.ErrorEvent(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(a);for(const b of y)delete this._sourceCaches[b.id],delete this._updatedSources[b.id],b.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles();return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(a,f){this._checkLoaded(),this.getSource(a).setData(f),this._changed=!0}getSource(a){const f=this._getSourceCache(a);return f&&f.getSource()}addLayer(a,f,y={}){this._checkLoaded();const b=a.id;if(this.getLayer(b))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${b}" already exists on this map`)));let T;if(a.type==="custom"){if(Yl(this,o.validateCustomStyleLayer(a)))return;T=o.createStyleLayer(a)}else{if(typeof a.source=="object"&&(this.addSource(b,a.source),a=o.clone$1(a),a=o.extend(a,{source:b})),this._validate(o.validateLayer,`layers.${b}`,a,{arrayIndex:-1},y))return;T=o.createStyleLayer(a),this._validateLayer(T),T.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const M=f?this._order.indexOf(f):this._order.length;if(f&&M===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(M,0,b),this._layerOrderChanged=!0,this._layers[b]=T;const O=this._getLayerSourceCache(T);if(this._removedLayers[b]&&T.source&&O&&T.type!=="custom"){const L=this._removedLayers[b];delete this._removedLayers[b],L.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",O.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(a,f){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new o.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===f)return;const y=this._order.indexOf(a);this._order.splice(y,1);const b=f?this._order.indexOf(f):this._order.length;f&&b===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(b,0,a),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(a){this._checkLoaded();const f=this._layers[a];if(!f)return void this.fire(new o.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const y=this._order.indexOf(a);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=f,delete this._layers[a],delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}hasLayerType(a){for(const f in this._layers)if(this._layers[f].type===a)return!0;return!1}setLayerZoomRange(a,f,y){this._checkLoaded();const b=this.getLayer(a);b?b.minzoom===f&&b.maxzoom===y||(f!=null&&(b.minzoom=f),y!=null&&(b.maxzoom=y),this._updateLayer(b)):this.fire(new o.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(a,f,y={}){this._checkLoaded();const b=this.getLayer(a);if(b){if(!g(b.filter,f))return f==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(o.validateFilter,`layers.${b.id}.filter`,f,{layerType:b.type},y)||(b.filter=o.clone$1(f),this._updateLayer(b)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be filtered.`)))}getFilter(a){const f=this.getLayer(a);return f&&o.clone$1(f.filter)}setLayoutProperty(a,f,y,b={}){this._checkLoaded();const T=this.getLayer(a);T?g(T.getLayoutProperty(f),y)||(T.setLayoutProperty(f,y,b),this._updateLayer(T)):this.fire(new o.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(a,f){const y=this.getLayer(a);if(y)return y.getLayoutProperty(f);this.fire(new o.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style.`)))}setPaintProperty(a,f,y,b={}){this._checkLoaded();const T=this.getLayer(a);T?g(T.getPaintProperty(f),y)||(T.setPaintProperty(f,y,b)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(a,f){const y=this.getLayer(a);return y&&y.getPaintProperty(f)}setFeatureState(a,f){this._checkLoaded();const y=a.source,b=a.sourceLayer,T=this.getSource(y);if(!T)return void this.fire(new o.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const M=T.type;if(M==="geojson"&&b)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(M==="vector"&&!b)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));a.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(y);for(const L of O)L.setFeatureState(b,a.id,f)}removeFeatureState(a,f){this._checkLoaded();const y=a.source,b=this.getSource(y);if(!b)return void this.fire(new o.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const T=b.type,M=T==="vector"?a.sourceLayer:void 0;if(T==="vector"&&!M)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof a.id!="string"&&typeof a.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(y);for(const L of O)L.removeFeatureState(M,a.id,f)}getFeatureState(a){this._checkLoaded();const f=a.source,y=a.sourceLayer,b=this.getSource(f);if(b){if(b.type!=="vector"||y)return a.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(y,a.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const a={};for(const f in this._sourceCaches){const y=this._sourceCaches[f].getSource();a[y.id]||(a[y.id]=y.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:a,layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(a){this._updatedLayers[a.id]=!0;const f=this._getLayerSourceCache(a);a.source&&!this._updatedSources[a.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",f.pause()),this._changed=!0,a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){const f=M=>this._layers[M].type==="fill-extrusion",y={},b=[];for(let M=this._order.length-1;M>=0;M--){const O=this._order[M];if(f(O)){y[O]=M;for(const L of a){const N=L[O];if(N)for(const U of N)b.push(U)}}}b.sort((M,O)=>O.intersectionZ-M.intersectionZ);const T=[];for(let M=this._order.length-1;M>=0;M--){const O=this._order[M];if(f(O))for(let L=b.length-1;L>=0;L--){const N=b[L].feature;if(y[N.layer.id]<M)break;T.push(N),b.pop()}else for(const L of a){const N=L[O];if(N)for(const U of N)T.push(U.feature)}}return T}queryRenderedFeatures(a,f,y){f&&f.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const b={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const L of f.layers){const N=this._layers[L];if(!N)return this.fire(new o.ErrorEvent(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];b[N.source]=!0}}const T=[];f.availableImages=this._availableImages;const M=f&&f.layers?f.layers.some(L=>{const N=this.getLayer(L);return N&&N.is3D()}):this.has3DLayers(),O=Ne.createFromScreenPoints(a,y);for(const L in this._sourceCaches){const N=this._sourceCaches[L].getSource().id;f.layers&&!b[N]||T.push(rt(this._sourceCaches[L],this._layers,this._serializedLayers,O,f,y,M,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(L,N,U,Z,te,ae,le){const ie={},ve=ae.queryRenderedSymbols(Z),oe=[];for(const he of Object.keys(ve).map(Number))oe.push(le[he]);oe.sort(At);for(const he of oe){const de=he.featureIndex.lookupSymbolFeatures(ve[he.bucketInstanceId],N,he.bucketIndex,he.sourceLayerIndex,te.filter,te.layers,te.availableImages,L);for(const Ae in de){const _e=ie[Ae]=ie[Ae]||[],be=de[Ae];be.sort((Re,We)=>{const Ke=he.featureSortOrder;if(Ke){const Ze=Ke.indexOf(Re.featureIndex);return Ke.indexOf(We.featureIndex)-Ze}return We.featureIndex-Re.featureIndex});for(const Re of be)_e.push(Re)}}for(const he in ie)ie[he].forEach(de=>{const Ae=de.feature,_e=U(L[he]).getFeatureState(Ae.layer["source-layer"],Ae.id);Ae.source=Ae.layer.source,Ae.layer["source-layer"]&&(Ae.sourceLayer=Ae.layer["source-layer"]),Ae.state=_e});return ie}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(a,f){f&&f.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const y=this._getSourceCaches(a);let b=[];for(const T of y)b=b.concat(He(T,f));return b}addSourceType(a,f,y){return hs.getSourceType(a)?y(new Error(`A source type called "${a}" already exists.`)):(hs.setSourceType(a,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:f.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(a,f={}){this._checkLoaded();const y=this.light.getLight();let b=!1;for(const M in a)if(!g(a[M],y[M])){b=!0;break}if(!b)return;const T=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(a,f),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(a,f=1){if(this._checkLoaded(),!a)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(f===1){if(typeof a.source=="object"){const y="terrain-dem-src";this.addSource(y,a.source),a=o.clone$1(a),a=o.extend(a,{source:y})}if(this._validate(o.validateTerrain,"terrain",a))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode)this._createTerrain(a,f);else{const y=this.terrain,b=y.get();for(const T of Object.keys(o.spec.terrain))!a.hasOwnProperty(T)&&o.spec.terrain[T].default&&(a[T]=o.spec.terrain[T].default);for(const T in a)if(!g(a[T],b[T])){y.set(a),this.stylesheet.terrain=a;const M=this._setTransitionParameters({duration:0});y.updateTransitions(M);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){const f=this.fog=new Nt(a,this.map.transform);this.stylesheet.fog=a;const y=this._setTransitionParameters({duration:0});f.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const a of this.map._markers)a._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,y=f.get();Object.keys(a).length===0&&f.set(a);for(const b in a)if(!g(a[b],y[b])){f.set(a),this.stylesheet.fog=a;const T=this._setTransitionParameters({duration:0});f.updateTransitions(T);break}}else this._createFog(a);this._markersNeedUpdate=!0}_setTransitionParameters(a){return{now:o.exported.now(),transition:o.extend(a,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const a=this._order.filter(y=>this.isLayerDraped(this._layers[y])),f=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...f)}_createTerrain(a,f){const y=this.terrain=new Je(a,f);this.stylesheet.terrain=a,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const b=this._setTransitionParameters({duration:0});y.updateTransitions(b)}_force3DLayerUpdate(){for(const a in this._layers){const f=this._layers[a];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const a in this._layers){const f=this._layers[a];f.type==="symbol"&&this._updateLayer(f)}}_validate(a,f,y,b,T={}){return(!T||T.validate!==!1)&&Yl(this,a.call(o.validateStyle,o.extend({key:f,style:this.serialize(),value:y,styleSpec:o.spec},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this._sourceCaches)this._sourceCaches[a].clearTiles(),this._sourceCaches[a].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(a){const f=this._getSourceCaches(a);for(const y of f)y.clearTiles()}_reloadSource(a){const f=this._getSourceCaches(a);for(const y of f)y.resume(),y.reload()}_updateSources(a){for(const f in this._sourceCaches)this._sourceCaches[f].update(a)}_generateCollisionBoxes(){for(const a in this._sourceCaches){const f=this._sourceCaches[a];f.resume(),f.reload()}}_updatePlacement(a,f,y,b,T=!1){let M=!1,O=!1;const L={};for(const N of this._order){const U=this._layers[N];if(U.type!=="symbol")continue;if(!L[U.source]){const te=this._getLayerSourceCache(U);if(!te)continue;L[U.source]=te.getRenderableIds(!0).map(ae=>te.getTileByID(ae)).sort((ae,le)=>le.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(le.tileID)?-1:1))}const Z=this.crossTileSymbolIndex.addLayer(U,L[U.source],a.center.lng,a.projection);M=M||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),a.zoom))&&(this.pauseablePlacement=new Sd(a,this._order,T,f,y,b,this.placement,this.fog&&a.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),O=!0),M&&this.pauseablePlacement.placement.setStale()),O||M)for(const N of this._order){const U=this._layers[N];U.type==="symbol"&&this.placement.updateLayerOpacities(U,L[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,f,y){this.imageManager.getImages(f.icons,y),this._updateTilesForChangedImages();const b=T=>{T&&T.setDependencies(f.tileID.key,f.type,f.icons)};b(this._otherSourceCaches[f.source]),b(this._symbolSourceCaches[f.source])}getGlyphs(a,f,y){this.glyphManager.getGlyphs(f.stacks,y)}getResource(a,f,y){return o.makeRequest(f,y)}_getSourceCache(a){return this._otherSourceCaches[a]}_getLayerSourceCache(a){return a.type==="symbol"?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}_getSourceCaches(a){const f=[];return this._otherSourceCaches[a]&&f.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&f.push(this._symbolSourceCaches[a]),f}_isSourceCacheLoaded(a){const f=this._getSourceCaches(a);return f.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${a}'`))),!1):f.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}hs.getSourceType=function(m){return Y[m]},hs.setSourceType=function(m,a){Y[m]=a},hs.registerForPluginStateChange=o.registerForPluginStateChange;var Cd=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Id="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Jl={},Js={};Jl=Fr("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),Js=Fr(`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const Eu=Fr(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Na=Cd,ja=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Tu={background:Fr(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Fr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Fr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Fr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Fr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Fr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Fr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Fr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Fr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Fr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Fr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Fr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Fr(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Fr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Fr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Fr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Fr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
highp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);
#else
vec4 out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Fr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Fr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Fr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Fr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Fr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Fr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Fr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Fr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Id),skyboxGradient:Fr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Id),skyboxCapture:Fr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Fr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
vec4 color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector.xyz*height;vec4 globe=u_globe_matrix*vec4(globe_pos,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Fr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);
#ifdef PROJECTION_GLOBE_VIEW
float globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
float horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Fr(m,a,f){const y=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,T=a.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),M=m.match(b),O=a.match(b),L=Cd.match(b);let N=O?O.concat(M):M;f||(Jl.staticUniforms&&(N=Jl.staticUniforms.concat(N)),Js.staticUniforms&&(N=Js.staticUniforms.concat(N))),N&&(N=N.concat(L));const U={};return{fragmentSource:m=m.replace(y,(Z,te,ae,le,ie)=>(U[ie]=!0,te==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
varying ${ae} ${le} ${ie};
#else
uniform ${ae} ${le} u_${ie};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ie}
    ${ae} ${le} ${ie} = u_${ie};
#endif
`)),vertexSource:a=a.replace(y,(Z,te,ae,le,ie)=>{const ve=le==="float"?"vec2":"vec4",oe=ie.match(/color/)?"color":ve;return U[ie]?te==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
attribute ${ae} ${ve} a_${ie};
varying ${ae} ${le} ${ie};
#else
uniform ${ae} ${le} u_${ie};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = a_${ie};
#else
    ${ae} ${le} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = unpack_mix_${oe}(a_${ie}, u_${ie}_t);
#else
    ${ae} ${le} ${ie} = u_${ie};
#endif
`:te==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
attribute ${ae} ${ve} a_${ie};
#else
uniform ${ae} ${le} u_${ie};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ae} ${le} ${ie} = a_${ie};
#else
    ${ae} ${le} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ae} ${le} ${ie} = unpack_mix_${oe}(a_${ie}, u_${ie}_t);
#else
    ${ae} ${le} ${ie} = u_${ie};
#endif
`}),staticAttributes:T,staticUniforms:N}}class cm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(a,f,y,b,T,M,O,L,N){this.context=a;let U=this.boundPaintVertexBuffers.length!==b.length;for(let Z=0;!U&&Z<b.length;Z++)this.boundPaintVertexBuffers[Z]!==b[Z]&&(U=!0);a.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===y&&!U&&this.boundIndexBuffer===T&&this.boundVertexOffset===M&&this.boundDynamicVertexBuffer===O&&this.boundDynamicVertexBuffer2===L&&this.boundDynamicVertexBuffer3===N?(a.bindVertexArrayOES.set(this.vao),O&&O.bind(),T&&T.dynamicDraw&&T.bind(),L&&L.bind(),N&&N.bind()):this.freshBind(f,y,b,T,M,O,L,N)}freshBind(a,f,y,b,T,M,O,L){let N;const U=a.numAttributes,Z=this.context,te=Z.gl;if(Z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Z.extVertexArrayObject.createVertexArrayOES(),Z.bindVertexArrayOES.set(this.vao),N=0,this.boundProgram=a,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=b,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=O,this.boundDynamicVertexBuffer3=L;else{N=Z.currentNumAttributes||0;for(let ae=U;ae<N;ae++)te.disableVertexAttribArray(ae)}f.enableAttributes(te,a);for(const ae of y)ae.enableAttributes(te,a);M&&M.enableAttributes(te,a),O&&O.enableAttributes(te,a),L&&L.enableAttributes(te,a),f.bind(),f.setVertexAttribPointers(te,a,T);for(const ae of y)ae.bind(),ae.setVertexAttribPointers(te,a,T);M&&(M.bind(),M.setVertexAttribPointers(te,a,T)),b&&b.bind(),O&&(O.bind(),O.setVertexAttribPointers(te,a,T)),L&&(L.bind(),L.setVertexAttribPointers(te,a,T)),Z.currentNumAttributes=U}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Md(m,a){const f=Math.pow(2,a.canonical.z),y=a.canonical.y;return[new o.MercatorCoordinate(0,y/f).toLngLat().lat,new o.MercatorCoordinate(0,(y+1)/f).toLngLat().lat]}function um(m,a,f,y,b,T,M){const O=m.context,L=O.gl,N=f.fbo;if(!N)return;m.prepareDrawTile();const U=m.useProgram("hillshade");O.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,N.colorAttachment.get());const Z=((ie,ve,oe,he)=>{const de=oe.paint.get("hillshade-shadow-color"),Ae=oe.paint.get("hillshade-highlight-color"),_e=oe.paint.get("hillshade-accent-color");let be=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);oe.paint.get("hillshade-illumination-anchor")==="viewport"&&(be-=ie.transform.angle);const Re=!ie.options.moving;return{u_matrix:he||ie.transform.calculateProjMatrix(ve.tileID.toUnwrapped(),Re),u_image:0,u_latrange:Md(0,ve.tileID),u_light:[oe.paint.get("hillshade-exaggeration"),be],u_shadow:de,u_highlight:Ae,u_accent:_e}})(m,f,y,m.terrain?a.projMatrix:null);m.prepareDrawProgram(O,U,a.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:ae,tileBoundsSegments:le}=m.getTileBoundsBuffers(f);U.draw(O,L.TRIANGLES,b,T,M,o.CullFaceMode.disabled,Z,y.id,te,ae,le)}function Su(m,a,f){if(!a.needsDEMTextureUpload)return;const y=m.context,b=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||m.getTileTexture(f.stride);const T=f.getPixels();a.demTexture?a.demTexture.update(T,{premultiply:!1}):a.demTexture=new o.Texture(y,T,b.RGBA,{premultiply:!1}),a.needsDEMTextureUpload=!1}function Au(m,a,f,y,b,T){const M=m.context,O=M.gl;if(!a.dem)return;const L=a.dem;if(M.activeTexture.set(O.TEXTURE1),Su(m,a,L),!a.demTexture)return;a.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const N=L.dim;M.activeTexture.set(O.TEXTURE0);let U=a.fbo;if(!U){const le=new o.Texture(M,{width:N,height:N,data:null},O.RGBA);le.bind(O.LINEAR,O.CLAMP_TO_EDGE),U=a.fbo=M.createFramebuffer(N,N,!0),U.colorAttachment.set(le.texture)}M.bindFramebuffer.set(U.framebuffer),M.viewport.set([0,0,N,N]);const{tileBoundsBuffer:Z,tileBoundsIndexBuffer:te,tileBoundsSegments:ae}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(M,O.TRIANGLES,y,b,T,o.CullFaceMode.disabled,((le,ie)=>{const ve=ie.stride,oe=o.create();return o.ortho(oe,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(oe,oe,[0,-o.EXTENT,0]),{u_matrix:oe,u_image:1,u_dimension:[ve,ve],u_zoom:le.overscaledZ,u_unpack:ie.unpackVector}})(a.tileID,L),f.id,Z,te,ae),a.needsHillshadePrepare=!1}const Pu=(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_image0:new o.Uniform1i(m,a.u_image0),u_skirt_height:new o.Uniform1f(m,a.u_skirt_height)}),Cu=(m,a)=>({u_matrix:m,u_image0:0,u_skirt_height:a}),Dr=(m,a,f,y,b,T,M,O,L,N,U,Z,te,ae)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:f,u_zoom_transition:b,u_merc_center:T,u_image0:0,u_frustum_tl:M,u_frustum_tr:O,u_frustum_br:L,u_frustum_bl:N,u_globe_pos:U,u_globe_radius:Z,u_viewport:te,u_grid_matrix:ae?Float32Array.from(ae):new Float32Array(9)});function Ql(m,a){return m!=null&&a!=null&&!(!m.hasData()||!a.hasData())&&m.demTexture!=null&&a.demTexture!=null&&m.tileID.key!==a.tileID.key}const Ko=new class{constructor(){this.operations={}}newMorphing(m,a,f,y,b){if(m in this.operations){const T=this.operations[m];T.to.tileID.key!==f.tileID.key&&(T.queued=f)}else this.operations[m]={startTime:y,phase:0,duration:b,from:a,to:f,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const a=this.operations[m];return{from:a.from,to:a.to,phase:a.phase}}update(m){for(const a in this.operations){const f=this.operations[a];for(f.phase=(m-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,m)){delete this.operations[a];break}}}_nextOp(m,a){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=a,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},ec={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function hm(m,a){const f=1<<m.z;return!a&&(m.x===0||m.x===f-1)||m.y===0||m.y===f-1}const tc=m=>({u_matrix:m});function Od(m,a,f,y,b){if(b>0){const T=o.exported.now(),M=(T-m.timeAdded)/b,O=a?(T-a.timeAdded)/b:-1,L=f.getSource(),N=y.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),U=!a||Math.abs(a.tileID.overscaledZ-N)>Math.abs(m.tileID.overscaledZ-N),Z=U&&m.refreshedUponExpiration?1:o.clamp(U?M:1-O,0,1);return m.refreshedUponExpiration&&M>=1&&(m.refreshedUponExpiration=!1),a?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class Cv extends o.SourceCache{constructor(a){const f={type:"raster-dem",maxzoom:a.transform.maxZoom},y=new yt(lr(),null),b=fe("mock-dem",f,y,a.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,f){a.state="loaded",f(null)}}class Iv extends o.SourceCache{constructor(a){const f=fe("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},new yt(lr(),null),a.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,f,y){if(a.freezeTileCoverage)return;this.transform=a;const b=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,M)=>{if(T[M.key]="",!this._tiles[M.key]){const O=new o.Tile(M,this._source.tileSize*M.overscaleFactor(),a.tileZoom);O.state="loaded",this._tiles[M.key]=O}return T},{});for(const T in this._tiles)T in b||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(a){const f=this.proxyCachedFBO[a];if(f!==void 0){const y=Object.values(f);this.renderCachePool.push(...y),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach(a=>a.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Iu extends o.OverscaledTileID{constructor(a,f,y){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=f,this.projMatrix=y}}class Dd extends o.Elevation{constructor(a,f){super(),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,b,T]=function(L){const N=new o.StructArrayLayout4i8,U=new o.StructArrayLayout3ui6,Z=131;N.reserve(17161),U.reserve(33800);const te=o.EXTENT/128,ae=o.EXTENT+te/2,le=ae+te;for(let ve=-te;ve<le;ve+=te)for(let oe=-te;oe<le;oe+=te){const he=oe<0||oe>ae||ve<0||ve>ae?24575:0,de=o.clamp(Math.round(oe),0,o.EXTENT),Ae=o.clamp(Math.round(ve),0,o.EXTENT);N.emplaceBack(de+he,Ae,de,Ae)}const ie=(ve,oe)=>{const he=oe*Z+ve;U.emplaceBack(he+1,he,he+Z),U.emplaceBack(he+Z,he+Z+1,he+1)};for(let ve=1;ve<129;ve++)for(let oe=1;oe<129;oe++)ie(oe,ve);return[0,129].forEach(ve=>{for(let oe=0;oe<130;oe++)ie(oe,ve),ie(ve,oe)}),[N,U,32768]}(),M=a.context;this.gridBuffer=M.createVertexBuffer(y,o.boundsAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(b),this.gridSegments=o.SegmentVector.simpleSegment(0,0,y.length,b.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,y.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Iv(f.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,0,o.EXTENT,0,o.EXTENT,0,1);const O=M.gl;this._overlapStencilMode=new o.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Cv(f.map)}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),a.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=a,this._checkRenderCacheEfficiency()}update(a,f,y){if(a&&a.terrain){this._style!==a&&(this.style=a),this.enabled=!0;const b=a.terrain.properties;this.sourceCache=a.terrain.drapeRenderMode===0?this._mockSourceCache:a._getSourceCache(b.get("source")),this._exaggeration=b.get("exaggeration");const T=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(f,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),f.updateElevation(!y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const a=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||a.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${a.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${a.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(a){a.coord&&a.dataType==="source"?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):a.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const a in this._style._sourceCaches)this._style._sourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(a=>a.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=f.getIds().map(L=>{const N=f.getTileByID(L).tileID;return N.projMatrix=y.calculateProjMatrix(N.toUnwrapped()),N});(function(L,N){const U=N.transform.pointCoordinate(N.transform.getCameraPoint()),Z=new o.pointGeometry(U.x,U.y);L.sort((te,ae)=>{if(ae.overscaledZ-te.overscaledZ)return ae.overscaledZ-te.overscaledZ;const le=new o.pointGeometry(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),ie=new o.pointGeometry(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),ve=Z.mult(1<<te.canonical.z);return ve.x-=.5,ve.y-=.5,ve.distSqr(le)-ve.distSqr(ie)})})(b,this.painter),this._previousZoom=y.zoom;const T=this.proxyToSource||{};this.proxyToSource={},b.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const L in M){const N=M[L];if(!N.used||(N!==this.sourceCache&&this.resetTileLookupCache(N.id),this._setupProxiedCoordsForOrtho(N,a[L],T),N.usedForTerrain))continue;const U=a[L];N.getSource().reparseOverscaled&&this._assignTerrainTiles(U)}this.proxiedCoords[f.id]=b.map(L=>new Iu(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const O={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const N=this.terrainTileForTile[L.key];if(!N)continue;const U=N.tileID.key;U in O||(this._visibleDemTiles.push(N),O[U]=U)}}_assignTerrainTiles(a){this._initializing||a.forEach(f=>{if(this.terrainTileForTile[f.key])return;const y=this._findTileCoveringTileID(f,this.sourceCache);y&&(this.terrainTileForTile[f.key]=y)})}_prepareDEMTextures(){const a=this.painter.context,f=a.gl;for(const y in this.terrainTileForTile){const b=this.terrainTileForTile[y],T=b.dem;!T||b.demTexture&&!b.needsDEMTextureUpload||(a.activeTexture.set(f.TEXTURE1),Su(this.painter,b,T))}}_prepareDemTileUniforms(a,f,y,b){if(!f||f.demTexture==null)return!1;const T=a.tileID.canonical,M=Math.pow(2,f.tileID.canonical.z-T.z),O=b||"";return y[`u_dem_tl${O}`]=[T.x*M%1,T.y*M%1],y[`u_dem_scale${O}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const a=this.painter.context,f=a.gl;if(!this._emptyDepthBufferTexture){const y=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(a,y,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let a=0;const f=this._visibleDemTiles.reduce((y,b)=>{if(!b.dem)return y;const T=b.dem.tree.minimums[0];return T>0&&a++,y+T},0);return a?f/a:0}_updateEmptyDEMTexture(){const a=this.painter.context,f=a.gl;a.activeTexture.set(f.TEXTURE2);const y=this._getLoadedAreaMinimum(),b=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(b,{premultiply:!1}):T=this._emptyDEMTexture=new o.Texture(a,b,f.RGBA,{premultiply:!1}),T}setupElevationDraw(a,f,y){const b=this.painter.context,T=b.gl,M=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var O;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();const L=this.painter.transform,N=L.projection,U=a.tileID.canonical;M.u_tile_tl_up=N.upVector(U,0,0),M.u_tile_tr_up=N.upVector(U,o.EXTENT,0),M.u_tile_br_up=N.upVector(U,o.EXTENT,o.EXTENT),M.u_tile_bl_up=N.upVector(U,0,o.EXTENT),M.u_tile_up_scale=y&&y.useDenormalizedUpVectorScale?o.GLOBE_METERS_TO_ECEF:N.upVectorScale(U,L.center.lat,L.worldSize).metersToTile;let Z=null,te=null,ae=1;if(y&&y.morphing&&this._useVertexMorphing){const le=y.morphing.srcDemTile,ie=y.morphing.dstDemTile;ae=y.morphing.phase,le&&ie&&(this._prepareDemTileUniforms(a,le,M,"_prev")&&(te=le),this._prepareDemTileUniforms(a,ie,M)&&(Z=ie))}if(te&&Z?(b.activeTexture.set(T.TEXTURE2),Z.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),b.activeTexture.set(T.TEXTURE4),te.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),M.u_dem_lerp=ae):(Z=this.terrainTileForTile[a.tileID.key],b.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(a,Z,M)?Z.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),b.activeTexture.set(T.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&Z){const le=(1<<Z.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=le}y&&y.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),f.setTerrainUniformValues(b,M)}renderToBackBuffer(a){const f=this.painter,y=this.painter.context;a.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,T,M,O,L){if(b.transform.projection.name==="globe")(function(N,U,Z,te,ae){const le=N.context,ie=le.gl;let ve,oe;const he=N.options.showTerrainWireframe?2:0,de=N.transform,Ae=o.globeUseCustomAntiAliasing(N,le,de),_e=(Se,dt)=>{if(oe===Se)return;const ct=[ec[Se],"PROJECTION_GLOBE_VIEW"];Ae&&ct.push("CUSTOM_ANTIALIASING"),dt&&ct.push(ec[he]),ve=N.useProgram("globeRaster",null,ct),oe=Se},be=N.colorModeForRenderPass(),Re=new o.DepthMode(ie.LEQUAL,o.DepthMode.ReadWrite,N.depthRangeFor3D);Ko.update(ae);const We=o.calculateGlobeMercatorMatrix(de),Ke=[o.mercatorXfromLng(de.center.lng),o.mercatorYfromLat(de.center.lat)],Ze=N.globeSharedBuffers,Ge=[de.width*o.exported.devicePixelRatio,de.height*o.exported.devicePixelRatio];if((he?[!1,!0]:[!1]).forEach(Se=>{oe=-1;const dt=Se?ie.LINES:ie.TRIANGLES;for(const ct of te){const Rt=Z.getTile(ct),Qe=o.StencilMode.disabled,Jt=U.prevTerrainTileForTile[ct.key],Mt=U.terrainTileForTile[ct.key];Ql(Jt,Mt)&&Ko.newMorphing(ct.key,Jt,Mt,ae,250),le.activeTexture.set(ie.TEXTURE0),Rt.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);const It=Ko.getMorphValuesForProxy(ct.key),wt=It?1:0,Pt={useDenormalizedUpVectorScale:!0};It&&o.extend$1(Pt,{morphing:{srcDemTile:It.from,dstDemTile:It.to,phase:o.easeCubicInOut(It.phase)}});const cr=Float32Array.from(de.globeMatrix),tr=o.globeTileLatLngCorners(ct.canonical),_r=o.getLatitudinalLod((tr[0][0]+tr[1][0])/2),Xt=o.getGridMatrix(ct.canonical,tr,_r),mr=o.globeNormalizeECEF(o.globeTileBounds(ct.canonical)),Br=Dr(de.projMatrix,cr,We,mr,o.globeToMercatorTransition(de.zoom),Ke,de.frustumCorners.TL,de.frustumCorners.TR,de.frustumCorners.BR,de.frustumCorners.BL,de.globeCenterInViewSpace,de.globeRadius,Ge,Xt);if(_e(wt,Se),U.setupElevationDraw(Rt,ve,Pt),N.prepareDrawProgram(le,ve,ct.toUnwrapped()),Ze){const[Gr,Ti,Yr]=Se?Ze.getWirefameBuffers(N.context,_r):Ze.getGridBuffers(_r);ve.draw(le,dt,Re,Qe,be,o.CullFaceMode.backCCW,Br,"globe_raster",Gr,Ti,Yr)}}}),Ze){const Se=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ae&&Se.push("CUSTOM_ANTIALIASING"),ve=N.useProgram("globeRaster",null,Se);for(const dt of te){const{x:ct,y:Rt,z:Qe}=dt.canonical,Jt=Rt===0,Mt=Rt===(1<<Qe)-1,[It,wt,Pt,cr]=Ze.getPoleBuffers(Qe);if(cr&&(Jt||Mt)){const tr=Z.getTile(dt);le.activeTexture.set(ie.TEXTURE0),tr.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);let _r=o.globePoleMatrixForTile(Qe,ct,de);const Xt=o.globeNormalizeECEF(o.globeTileBounds(dt.canonical)),mr=(Br,Gr)=>Br.draw(le,ie.TRIANGLES,Re,o.StencilMode.disabled,be,o.CullFaceMode.disabled,Dr(de.projMatrix,_r,_r,Xt,0,Ke,de.frustumCorners.TL,de.frustumCorners.TR,de.frustumCorners.BR,de.frustumCorners.BL,de.globeCenterInViewSpace,de.globeRadius,Ge),"globe_pole_raster",Gr,Pt,cr);U.setupElevationDraw(tr,ve,{}),N.prepareDrawProgram(le,ve,dt.toUnwrapped()),Jt&&mr(ve,It),Mt&&(_r=o.scale(o.create(),_r,[1,-1,1]),mr(ve,wt))}}}})(b,T,M,O,L);else{const N=b.context,U=N.gl;let Z,te;const ae=b.options.showTerrainWireframe?2:0,le=(de,Ae)=>{if(te===de)return;const _e=[ec[de]];Ae&&_e.push(ec[ae]),Z=b.useProgram("terrainRaster",null,_e),te=de},ie=b.colorModeForRenderPass(),ve=new o.DepthMode(U.LEQUAL,o.DepthMode.ReadWrite,b.depthRangeFor3D);Ko.update(L);const oe=b.transform,he=6*Math.pow(1.5,22-oe.zoom)*T.exaggeration();(ae?[!1,!0]:[!1]).forEach(de=>{te=-1;const Ae=de?U.LINES:U.TRIANGLES,[_e,be]=de?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const Re of O){const We=M.getTile(Re),Ke=o.StencilMode.disabled,Ze=T.prevTerrainTileForTile[Re.key],Ge=T.terrainTileForTile[Re.key];Ql(Ze,Ge)&&Ko.newMorphing(Re.key,Ze,Ge,L,250),N.activeTexture.set(U.TEXTURE0),We.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const Se=Ko.getMorphValuesForProxy(Re.key),dt=Se?1:0;let ct;Se&&(ct={morphing:{srcDemTile:Se.from,dstDemTile:Se.to,phase:o.easeCubicInOut(Se.phase)}});const Rt=Cu(Re.projMatrix,hm(Re.canonical,oe.renderWorldCopies)?he/10:he);le(dt,de),T.setupElevationDraw(We,Z,ct),b.prepareDrawProgram(N,Z,Re.toUnwrapped()),Z.draw(N,Ae,ve,Ke,ie,o.CullFaceMode.backCCW,Rt,"terrain_raster",T.gridBuffer,_e,be)}})}}(f,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(this._drapedRenderBatches.length===0)return a+1;this.renderingToTexture=!0;const f=this.painter,y=this.painter.context,b=this.proxySourceCache,T=this.proxiedCoords[b.id],M=this._drapedRenderBatches.shift(),O=[],L=f.style.order;let N=0;for(const U of T){const Z=b.getTileByID(U.proxyTileKey),te=b.proxyCachedFBO[U.key]?b.proxyCachedFBO[U.key][a]:void 0,ae=te!==void 0?b.renderCache[te]:this.pool[N++],le=te!==void 0;if(Z.texture=ae.tex,le&&!ae.dirty){O.push(Z.tileID);continue}let ie;y.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(y.clear({color:o.Color.transparent,stencil:0}),ae.dirty=!1);for(let ve=M.start;ve<=M.end;++ve){const oe=f.style._layers[L[ve]];if(oe.isHidden(f.transform.zoom))continue;const he=f.style._getLayerSourceCache(oe),de=he?this.proxyToSource[U.key][he.id]:[U];if(!de)continue;const Ae=de;y.viewport.set([0,0,ae.fb.width,ae.fb.height]),ie!==(he?he.id:null)&&(this._setupStencil(ae,de,oe,he),ie=he?he.id:null),f.renderLayer(f,he,oe,Ae)}this.renderedToTile?(ae.dirty=!0,O.push(Z.tileID)):le||--N,N===5&&(N=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),M.end+1}postRender(){}renderCacheEfficiency(a){const f=a.order.length;if(f===0)return{efficiency:100};let y,b=0,T=0,M=!1;for(let O=0;O<f;++O){const L=a._layers[a.order[O]];this._style.isLayerDraped(L)?(M&&++b,++T):M||(M=!0,y=L.id)}return T===0?{efficiency:100}:{efficiency:100*(1-b/T),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{a=Math.min(a,f.dem.tree.minimums[0])}),a===0?a:(a-30)*this._exaggeration}raycast(a,f,y){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const M=T.tileID,O=Math.pow(2,M.overscaledZ),{x:L,y:N}=M.canonical,U=L/O,Z=(L+1)/O,te=N/O,ae=(N+1)/O;return{minx:U,miny:te,maxx:Z,maxy:ae,t:T.dem.tree.raycastRoot(U,te,Z,ae,a,f,y),tile:T}});b.sort((T,M)=>(T.t!==null?T.t:Number.MAX_VALUE)-(M.t!==null?M.t:Number.MAX_VALUE));for(const T of b){if(T.t==null)return null;const M=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,a,f,y);if(M!=null)return M}return null}_createFBO(){const a=this.painter.context,f=a.gl,y=this.drapeBufferSize;a.activeTexture.set(f.TEXTURE0);const b=new o.Texture(a,{width:y[0],height:y[1],data:null},f.RGBA);b.bind(f.LINEAR,f.CLAMP_TO_EDGE);const T=a.createFramebuffer(y[0],y[1],!1);return T.colorAttachment.set(b.texture),T.depthAttachment=new W(a,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&!a.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:T,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const a in this._style._sourceCaches)if(this._style._sourceCaches[a].hasTransition())return!0;return this._style.order.some(a=>{const f=this._style._layers[a],y=f.isHidden(this.painter.transform.zoom),b=f.getCrossfadeParameters(),T=!!b&&b.t!==1,M=f.hasTransition();return f.type!=="custom"&&!y&&(T||M)})}_clearRasterFadeFromRenderCache(){let a=!1;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f]._source instanceof Ee){a=!0;break}if(a)for(let f=0;f<this._style.order.length;++f){const y=this._style._layers[this._style.order[f]],b=y.isHidden(this.painter.transform.zoom),T=this._style._getLayerSourceCache(y);if(y.type!=="raster"||b||!T)continue;const M=y.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const L=this.proxyToSource[O.key][T.id];if(L)for(const N of L){const U=Od(T.getTile(N),T.findLoadedParent(N,0),T,this.painter.transform,M);(U.opacity!==1||U.mix!==0)&&this._clearRenderCacheForTile(T.id,N)}}}}_setupDrapedRenderBatches(){const a=this._style.order,f=a.length;if(f===0)return;const y=[];let b,T=0,M=this._style._layers[a[T]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++T<f;)M=this._style._layers[a[T]];for(;T<f;++T){const O=this._style._layers[a[T]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?b===void 0&&(b=T):b!==void 0&&(y.push({start:b,end:T-1}),b=void 0))}b!==void 0&&y.push({start:b,end:T-1}),this._drapedRenderBatches=y}_setupRenderCache(a){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const M=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let O=0;O<M.length;++O){const L=Object.values(M[O]);f.renderCachePool.push(...L)}}return}this._clearRasterFadeFromRenderCache();const y=this.proxyCoords,b=this._tilesDirty;for(let M=y.length-1;M>=0;M--){const O=y[M];if(f.getTileByID(O.key),f.proxyCachedFBO[O.key]!==void 0){const L=a[O.key],N=this.proxyToSource[O.key];let U=0;for(const Z in N){const te=N[Z],ae=L[Z];if(!ae||ae.length!==te.length||te.some((le,ie)=>le!==ae[ie]||b[Z]&&b[Z].hasOwnProperty(le.key))){U=-1;break}++U}for(const Z in f.proxyCachedFBO[O.key])f.renderCache[f.proxyCachedFBO[O.key][Z]].dirty=U<0||U!==Object.values(L).length}}const T=[...this._drapedRenderBatches];T.sort((M,O)=>O.end-O.start-(M.end-M.start));for(const M of T)for(const O of y){if(f.proxyCachedFBO[O.key])continue;let L=f.renderCachePool.pop();L===void 0&&f.renderCache.length<50&&(L=f.renderCache.length,f.renderCache.push(this._createFBO())),L!==void 0&&(f.proxyCachedFBO[O.key]={},f.proxyCachedFBO[O.key][M.start]=L,f.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(a,f,y,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,M=T.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let O;if(y.isTileClipped())O=f.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(a,f){const y=this.painter,b=this.painter.context,T=b.gl;y._tileClippingMaskIDs={},b.setColorMode(o.ColorMode.disabled),b.setDepthMode(o.DepthMode.disabled);const M=y.useProgram("clippingMask");for(const O of a){const L=y._tileClippingMaskIDs[O.key]=--f;M.draw(b,T.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:T.ALWAYS,mask:0},L,255,T.KEEP,T.KEEP,T.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,tc(O.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(a){const f=this.painter.transform;if(a.x<0||a.x>f.width||a.y<0||a.y>f.height)return null;const y=[a.x,a.y,1,1];o.transformMat4$1(y,y,f.pixelMatrixInverse),o.scale$1(y,y,1/y[3]),y[0]/=f.worldSize,y[1]/=f.worldSize;const b=f._camera.position,T=o.mercatorZfromAltitude(1,f.center.lat),M=[b[0],b[1],b[2]/T,0],O=o.subtract([],y.slice(0,3),M);o.normalize(O,O);const L=this.raycast(M,O,this._exaggeration);return L!==null&&L?(o.scaleAndAdd(M,M,O,L),M[3]=M[2],M[2]*=T,M):null}drawDepth(){const a=this.painter,f=a.context,y=this.proxySourceCache,b=Math.ceil(a.width),T=Math.ceil(a.height);if(!this._depthFBO||this._depthFBO.width===b&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=f.gl,O=f.createFramebuffer(b,T,!0);f.activeTexture.set(M.TEXTURE0);const L=new o.Texture(f,{width:b,height:T,data:null},M.RGBA);L.bind(M.NEAREST,M.CLAMP_TO_EDGE),O.colorAttachment.set(L.texture);const N=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,b,T);O.depthAttachment.set(N),this._depthFBO=O,this._depthTexture=L}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,b,T]),function(M,O,L,N){if(M.transform.projection.name==="globe")return;const U=M.context,Z=U.gl;U.clear({depth:1});const te=M.useProgram("terrainDepth"),ae=new o.DepthMode(Z.LESS,o.DepthMode.ReadWrite,M.depthRangeFor3D);for(const le of N){const ie=L.getTile(le),ve=Cu(le.projMatrix,0);O.setupElevationDraw(ie,te),te.draw(U,Z.TRIANGLES,ae,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,ve,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(a,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(a,f,y){if(a.getSource()instanceof q)return this._setupProxiedCoordsForImageSource(a,f,y);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};const b=this.proxiedCoords[a.id]=[],T=this.proxyCoords;for(let O=0;O<T.length;O++){const L=T[O],N=this._findTileCoveringTileID(L,a);if(N){const U=this._createProxiedId(L,N,y[L.key]&&y[L.key][a.id]);b.push(U),this.proxyToSource[L.key][a.id]=[U]}}let M=!1;for(let O=0;O<f.length;O++){const L=a.getTile(f[O]);if(!L||!L.hasData())continue;const N=this._findTileCoveringTileID(L.tileID,this.proxySourceCache);if(N&&N.tileID.canonical.z!==L.tileID.canonical.z){const U=this.proxyToSource[N.tileID.key][a.id],Z=this._createProxiedId(N.tileID,L,y[N.tileID.key]&&y[N.tileID.key][a.id]);U?U.splice(U.length-1,0,Z):this.proxyToSource[N.tileID.key][a.id]=[Z],b.push(Z),M=!0}}this._sourceTilesOverlap[a.id]=M}_setupProxiedCoordsForImageSource(a,f,y){if(!a.getSource().loaded())return;const b=this.proxiedCoords[a.id]=[],T=this.proxyCoords,M=a.getSource(),O=new o.pointGeometry(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),L=M.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((U,Z)=>(U.min.x=Math.min(U.min.x,Z.x-O.x),U.min.y=Math.min(U.min.y,Z.y-O.y),U.max.x=Math.max(U.max.x,Z.x-O.x),U.max.y=Math.max(U.max.y,Z.y-O.y),U),{min:new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),N=(U,Z)=>{const te=U.wrap+U.canonical.x/(1<<U.canonical.z),ae=U.canonical.y/(1<<U.canonical.z),le=o.EXTENT/(1<<U.canonical.z),ie=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),ve=Z.canonical.y/(1<<Z.canonical.z);return te+le<ie+L.min.x||te>ie+L.max.x||ae+le<ve+L.min.y||ae>ve+L.max.y};for(let U=0;U<T.length;U++){const Z=T[U];for(let te=0;te<f.length;te++){const ae=a.getTile(f[te]);if(!ae||!ae.hasData()||N(Z,ae.tileID))continue;const le=this._createProxiedId(Z,ae,y[Z.key]&&y[Z.key][a.id]),ie=this.proxyToSource[Z.key][a.id];ie?ie.push(le):this.proxyToSource[Z.key][a.id]=[le],b.push(le)}}}_createProxiedId(a,f,y){let b=this.orthoMatrix;if(y){const T=y.find(M=>M.key===f.tileID.key);if(T)return T}if(f.tileID.key!==a.key){const T=a.canonical.z-f.tileID.canonical.z;let M,O,L;b=o.create();const N=f.tileID.wrap-a.wrap<<a.overscaledZ;T>0?(M=o.EXTENT>>T,O=M*((f.tileID.canonical.x<<T)-a.canonical.x+N),L=M*((f.tileID.canonical.y<<T)-a.canonical.y)):(M=o.EXTENT<<-T,O=o.EXTENT*(f.tileID.canonical.x-(a.canonical.x+N<<-T)),L=o.EXTENT*(f.tileID.canonical.y-(a.canonical.y<<-T))),o.ortho(b,0,M,0,M,0,1),o.translate(b,b,[O,L,0])}return new Iu(f.tileID,a.key,b)}_findTileCoveringTileID(a,f){let y=f.getTile(a);if(y&&y.hasData())return y;const b=this._findCoveringTileCache[f.id],T=b[a.key];if(y=T?f.getTileByID(T):null,y&&y.hasData()||T===null)return y;let M=y?y.tileID:a,O=M.overscaledZ;const L=f.getSource().minzoom,N=[];if(!T){const Z=f.getSource().maxzoom;if(a.canonical.z>=Z){const te=a.canonical.z-Z;f.getSource().reparseOverscaled?(O=Math.max(a.canonical.z+2,f.transform.tileZoom),M=new o.OverscaledTileID(O,a.wrap,Z,a.canonical.x>>te,a.canonical.y>>te)):te!==0&&(O=Z,M=new o.OverscaledTileID(O,a.wrap,Z,a.canonical.x>>te,a.canonical.y>>te))}M.key!==a.key&&(N.push(M.key),y=f.getTile(M))}const U=Z=>{N.forEach(te=>{b[te]=Z}),N.length=0};for(O-=1;O>=L&&(!y||!y.hasData());O--){y&&U(y.tileID.key);const Z=M.calculateScaledKey(O);if(y=f.getTileByID(Z),y&&y.hasData())break;const te=b[Z];if(te===null)break;te===void 0?N.push(Z):y=f.getTileByID(te)}return U(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,f){let y=this._tilesDirty[a];y||(y=this._tilesDirty[a]={}),y[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const a=function(f){let y=0;const b=new o.StructArrayLayout2ui4,T=131;for(let M=1;M<129;M++){for(let O=1;O<129;O++)y=M*T+O,b.emplaceBack(y,y+1),b.emplaceBack(y,y+T),b.emplaceBack(y+1,y+T),M===128&&b.emplaceBack(y+T,y+T+1);b.emplaceBack(y+1,y+1+T)}return b}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(a),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,a.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Mu(m){const a=[];for(let f=0;f<m.length;f++){if(m[f]===null)continue;const y=m[f].split(" ");a.push(y.pop())}return a}class Ou{static cacheKey(a,f,y){let b=`${a}${y?y.cacheKey:""}`;for(const T of f)b+=`/${T}`;return b}constructor(a,f,y,b,T,M){const O=a.gl;this.program=O.createProgram();const L=Mu(y.staticAttributes),N=b?b.getBinderAttributes():[],U=L.concat(N),Z=y.staticUniforms?Mu(y.staticUniforms):[],te=b?b.getBinderUniforms():[],ae=Z.concat(te),le=[];for(const _e of ae)le.indexOf(_e)<0&&le.push(_e);let ie=b?b.defines():[];ie=ie.concat(M.map(_e=>`#define ${_e}`));const ve=ie.concat(a.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(ja):ja,ja,Na,Eu.fragmentSource,Js.fragmentSource,y.fragmentSource).join(`
`),oe=ie.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Na,Eu.vertexSource,Js.vertexSource,Jl.vertexSource,y.vertexSource).join(`
`),he=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(he,ve),O.compileShader(he),O.attachShader(this.program,he);const de=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(de,oe),O.compileShader(de),O.attachShader(this.program,de),this.attributes={};const Ae={};this.numAttributes=U.length;for(let _e=0;_e<this.numAttributes;_e++)U[_e]&&(O.bindAttribLocation(this.program,_e,U[_e]),this.attributes[U[_e]]=_e);O.linkProgram(this.program),O.deleteShader(de),O.deleteShader(he);for(let _e=0;_e<le.length;_e++){const be=le[_e];if(be&&!Ae[be]){const Re=O.getUniformLocation(this.program,be);Re&&(Ae[be]=Re)}}this.fixedUniforms=T(a,Ae),this.binderUniforms=b?b.getUniforms(a,Ae):[],M.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((_e,be)=>({u_dem:new o.Uniform1i(_e,be.u_dem),u_dem_prev:new o.Uniform1i(_e,be.u_dem_prev),u_dem_unpack:new o.Uniform4f(_e,be.u_dem_unpack),u_dem_tl:new o.Uniform2f(_e,be.u_dem_tl),u_dem_scale:new o.Uniform1f(_e,be.u_dem_scale),u_dem_tl_prev:new o.Uniform2f(_e,be.u_dem_tl_prev),u_dem_scale_prev:new o.Uniform1f(_e,be.u_dem_scale_prev),u_dem_size:new o.Uniform1f(_e,be.u_dem_size),u_dem_lerp:new o.Uniform1f(_e,be.u_dem_lerp),u_exaggeration:new o.Uniform1f(_e,be.u_exaggeration),u_depth:new o.Uniform1i(_e,be.u_depth),u_depth_size_inv:new o.Uniform2f(_e,be.u_depth_size_inv),u_meter_to_dem:new o.Uniform1f(_e,be.u_meter_to_dem),u_label_plane_matrix_inv:new o.UniformMatrix4f(_e,be.u_label_plane_matrix_inv),u_tile_tl_up:new o.Uniform3f(_e,be.u_tile_tl_up),u_tile_tr_up:new o.Uniform3f(_e,be.u_tile_tr_up),u_tile_br_up:new o.Uniform3f(_e,be.u_tile_br_up),u_tile_bl_up:new o.Uniform3f(_e,be.u_tile_bl_up),u_tile_up_scale:new o.Uniform1f(_e,be.u_tile_up_scale)}))(a,Ae)),M.indexOf("FOG")!==-1&&(this.fogUniforms=((_e,be)=>({u_fog_matrix:new o.UniformMatrix4f(_e,be.u_fog_matrix),u_fog_range:new o.Uniform2f(_e,be.u_fog_range),u_fog_color:new o.Uniform4f(_e,be.u_fog_color),u_fog_horizon_blend:new o.Uniform1f(_e,be.u_fog_horizon_blend),u_fog_temporal_offset:new o.Uniform1f(_e,be.u_fog_temporal_offset),u_frustum_tl:new o.Uniform3f(_e,be.u_frustum_tl),u_frustum_tr:new o.Uniform3f(_e,be.u_frustum_tr),u_frustum_br:new o.Uniform3f(_e,be.u_frustum_br),u_frustum_bl:new o.Uniform3f(_e,be.u_frustum_bl),u_globe_pos:new o.Uniform3f(_e,be.u_globe_pos),u_globe_radius:new o.Uniform1f(_e,be.u_globe_radius),u_globe_transition:new o.Uniform1f(_e,be.u_globe_transition),u_is_globe:new o.Uniform1i(_e,be.u_is_globe),u_viewport:new o.Uniform2f(_e,be.u_viewport)}))(a,Ae))}setTerrainUniformValues(a,f){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const b in f)y[b].set(f[b])}}setFogUniformValues(a,f){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const b in f)y[b].location&&y[b].set(f[b])}}draw(a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie,ve,oe){const he=a.gl;if(this.failedToCreate)return;a.program.set(this.program),a.setDepthMode(y),a.setStencilMode(b),a.setColorMode(T),a.setCullFace(M);for(const Ae of Object.keys(this.fixedUniforms))this.fixedUniforms[Ae].set(O[Ae]);le&&le.setUniforms(a,this.binderUniforms,te,{zoom:ae});const de={[he.LINES]:2,[he.TRIANGLES]:3,[he.LINE_STRIP]:1}[f];for(const Ae of Z.get()){const _e=Ae.vaos||(Ae.vaos={});(_e[L]||(_e[L]=new cm)).bind(a,this,N,le?le.getPaintVertexBuffers():[],U,Ae.vertexOffset,ie,ve,oe),he.drawElements(f,Ae.primitiveLength*de,he.UNSIGNED_SHORT,Ae.primitiveOffset*de*2)}}}function Rd(m,a,f){const y=1/et(f,1,a.transform.tileZoom),b=Math.pow(2,f.tileID.overscaledZ),T=f.tileSize*Math.pow(2,a.transform.tileZoom)/b,M=T*(f.tileID.canonical.x+f.tileID.wrap*b),O=T*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[y,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[M>>16,O>>16],u_pixel_coord_lower:[65535&M,65535&O]}}const dm=o.create(),fm=(m,a,f,y,b,T,M,O,L)=>{const N=a.style.light,U=N.properties.get("position"),Z=[U.x,U.y,U.z],te=o.create$1();N.properties.get("anchor")==="viewport"&&(o.fromRotation(te,-a.transform.angle),o.transformMat3(Z,Z,te));const ae=N.properties.get("color"),le=a.transform,ie={u_matrix:m,u_lightpos:Z,u_lightintensity:N.properties.get("intensity"),u_lightcolor:[ae.r,ae.g,ae.b],u_vertical_gradient:+f,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:dm,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return le.projection.name==="globe"&&(ie.u_tile_id=[b.canonical.x,b.canonical.y,1<<b.canonical.z],ie.u_zoom_transition=M,ie.u_inv_rot_matrix=L,ie.u_merc_center=O,ie.u_up_dir=le.projection.upVector(new o.CanonicalTileID(0,0,0),O[0]*o.EXTENT,O[1]*o.EXTENT),ie.u_height_lift=T),ie},rc=(m,a,f,y,b,T,M,O,L,N,U)=>{const Z=fm(m,a,f,y,b,O,L,N,U),te={u_height_factor:-Math.pow(2,b.overscaledZ)/M.tileSize/8};return o.extend(Z,Rd(T,a,M),te)},$a=m=>({u_matrix:m}),Ld=(m,a,f,y)=>o.extend($a(m),Rd(f,a,y)),Du=(m,a)=>({u_matrix:m,u_world:a}),kd=(m,a,f,y,b)=>o.extend(Ld(m,a,f,y),{u_world:b}),Ms=o.create(),zd=(m,a,f,y,b,T)=>{const M=m.transform,O=M.projection.name==="globe";let L;if(T.paint.get("circle-pitch-alignment")==="map")if(O){const U=o.globePixelsToTileUnits(M.zoom,a.canonical)*M._projectionScaler;L=Float32Array.from([U,0,0,U])}else L=M.calculatePixelsToTileUnitsMatrix(f);else L=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const N={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:m.translatePosMatrix(a.projMatrix,f,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:L,u_inv_rot_matrix:Ms,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){N.u_inv_rot_matrix=y,N.u_merc_center=b,N.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],N.u_zoom_transition=o.globeToMercatorTransition(M.zoom);const U=b[0]*o.EXTENT,Z=b[1]*o.EXTENT;N.u_up_dir=M.projection.upVector(new o.CanonicalTileID(0,0,0),U,Z)}return N},pm=m=>{const a=[];return m.paint.get("circle-pitch-alignment")==="map"&&a.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&a.push("SCALE_WITH_MAP"),a},Fd=(m,a,f,y)=>{const b=o.EXTENT/f.tileSize;return{u_matrix:m,u_camera_to_center_distance:a.getCameraToCenterDistance(y),u_extrude_scale:[a.pixelsToGLUnits[0]/b,a.pixelsToGLUnits[1]/b]}},Bd=(m,a,f=1)=>({u_matrix:m,u_color:a,u_overlay:0,u_overlay_scale:f}),Nd=o.create(),Mv=(m,a,f,y,b,T,M)=>{const O=m.transform,L=O.projection.name==="globe",N=L?o.globePixelsToTileUnits(O.zoom,a.canonical)*O._projectionScaler:et(f,1,T),U={u_matrix:a.projMatrix,u_extrude_scale:N,u_intensity:M,u_inv_rot_matrix:Nd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){U.u_inv_rot_matrix=y,U.u_merc_center=b,U.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],U.u_zoom_transition=o.globeToMercatorTransition(O.zoom);const Z=b[0]*o.EXTENT,te=b[1]*o.EXTENT;U.u_up_dir=O.projection.upVector(new o.CanonicalTileID(0,0,0),Z,te)}return U},jd=(m,a,f,y,b,T,M,O)=>{const L=m.transform,N=L.calculatePixelsToTileUnitsMatrix(a),U={u_matrix:mm(m,a,f,b),u_pixels_to_tile_units:N,u_device_pixel_ratio:M,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:O};if(Ru(f)){const Z=ic(a,m.transform);U.u_texsize=a.lineAtlasTexture.size,U.u_scale=[Z,y.fromScale,y.toScale],U.u_mix=y.t}return U},Ov=(m,a,f,y,b,T)=>{const M=m.transform,O=ic(a,M);return{u_matrix:mm(m,a,f,b),u_texsize:a.imageAtlasTexture.size,u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(a),u_device_pixel_ratio:T,u_image:0,u_scale:[O,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ic(m,a){return 1/et(m,1,a.tileZoom)}function mm(m,a,f,y){return m.translatePosMatrix(y||a.tileID.projMatrix,a,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function Ru(m){const a=m.paint.get("line-dasharray").value;return a.value||a.kind!=="constant"}const Dv=(m,a,f,y,b,T)=>{return{u_matrix:m,u_tl_parent:a,u_scale_parent:f,u_fade_t:y.mix,u_opacity:y.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(O=b.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(M=b.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:$d(b.paint.get("raster-hue-rotate")),u_perspective_transform:T};var M,O};function $d(m){m*=Math.PI/180;const a=Math.sin(m),f=Math.cos(m);return[(2*f+1)/3,(-Math.sqrt(3)*a-f+1)/3,(Math.sqrt(3)*a-f+1)/3]}const gm=o.create(),nc=(m,a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie)=>{const ve=b.transform,oe={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:ve.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:ve.width/ve.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:M,u_coord_matrix:O,u_is_text:+L,u_pitch_with_map:+y,u_texsize:N,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gm,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:gm,u_up_vector:[0,-1,0]};return ie.name==="globe"&&(oe.u_tile_id=[U.canonical.x,U.canonical.y,1<<U.canonical.z],oe.u_zoom_transition=Z,oe.u_inv_rot_matrix=ae,oe.u_merc_center=te,oe.u_camera_forward=ve._camera.forward(),oe.u_ecef_origin=o.globeECEFOrigin(ve.globeMatrix,U.toUnwrapped()),oe.u_tile_matrix=Float32Array.from(ve.globeMatrix),oe.u_up_vector=le),oe},_m=(m,a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie,ve)=>o.extend(nc(m,a,f,y,b,T,M,O,L,N,Z,te,ae,le,ie,ve),{u_gamma_scale:y?b.transform.cameraToCenterDistance*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+U}),ym=(m,a,f,y,b,T,M,O,L,N,U,Z,te,ae,le,ie)=>o.extend(_m(m,a,f,y,b,T,M,O,!0,L,!0,U,Z,te,ae,le,ie),{u_texsize_icon:N,u_texture_icon:1}),vm=(m,a,f)=>({u_matrix:m,u_opacity:a,u_color:f}),Va=(m,a,f,y,b,T)=>o.extend(function(M,O,L,N){const U=L.imageManager.getPattern(M.from.toString()),Z=L.imageManager.getPattern(M.to.toString()),{width:te,height:ae}=L.imageManager.getPixelSize(),le=Math.pow(2,N.tileID.overscaledZ),ie=N.tileSize*Math.pow(2,L.transform.tileZoom)/le,ve=ie*(N.tileID.canonical.x+N.tileID.wrap*le),oe=ie*N.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[te,ae],u_mix:O.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:O.fromScale,u_scale_b:O.toScale,u_tile_units_to_pixels:1/et(N,1,L.transform.tileZoom),u_pixel_coord_upper:[ve>>16,oe>>16],u_pixel_coord_lower:[65535&ve,65535&oe]}}(y,T,f,b),{u_matrix:m,u_opacity:a}),Rv={fillExtrusion:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_lightpos:new o.Uniform3f(m,a.u_lightpos),u_lightintensity:new o.Uniform1f(m,a.u_lightintensity),u_lightcolor:new o.Uniform3f(m,a.u_lightcolor),u_vertical_gradient:new o.Uniform1f(m,a.u_vertical_gradient),u_opacity:new o.Uniform1f(m,a.u_opacity),u_tile_id:new o.Uniform3f(m,a.u_tile_id),u_zoom_transition:new o.Uniform1f(m,a.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(m,a.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(m,a.u_merc_center),u_up_dir:new o.Uniform3f(m,a.u_up_dir),u_height_lift:new o.Uniform1f(m,a.u_height_lift)}),fillExtrusionPattern:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_lightpos:new o.Uniform3f(m,a.u_lightpos),u_lightintensity:new o.Uniform1f(m,a.u_lightintensity),u_lightcolor:new o.Uniform3f(m,a.u_lightcolor),u_vertical_gradient:new o.Uniform1f(m,a.u_vertical_gradient),u_height_factor:new o.Uniform1f(m,a.u_height_factor),u_tile_id:new o.Uniform3f(m,a.u_tile_id),u_zoom_transition:new o.Uniform1f(m,a.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(m,a.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(m,a.u_merc_center),u_up_dir:new o.Uniform3f(m,a.u_up_dir),u_height_lift:new o.Uniform1f(m,a.u_height_lift),u_image:new o.Uniform1i(m,a.u_image),u_texsize:new o.Uniform2f(m,a.u_texsize),u_pixel_coord_upper:new o.Uniform2f(m,a.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(m,a.u_pixel_coord_lower),u_scale:new o.Uniform3f(m,a.u_scale),u_fade:new o.Uniform1f(m,a.u_fade),u_opacity:new o.Uniform1f(m,a.u_opacity)}),fill:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix)}),fillPattern:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_image:new o.Uniform1i(m,a.u_image),u_texsize:new o.Uniform2f(m,a.u_texsize),u_pixel_coord_upper:new o.Uniform2f(m,a.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(m,a.u_pixel_coord_lower),u_scale:new o.Uniform3f(m,a.u_scale),u_fade:new o.Uniform1f(m,a.u_fade)}),fillOutline:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_world:new o.Uniform2f(m,a.u_world)}),fillOutlinePattern:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_world:new o.Uniform2f(m,a.u_world),u_image:new o.Uniform1i(m,a.u_image),u_texsize:new o.Uniform2f(m,a.u_texsize),u_pixel_coord_upper:new o.Uniform2f(m,a.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(m,a.u_pixel_coord_lower),u_scale:new o.Uniform3f(m,a.u_scale),u_fade:new o.Uniform1f(m,a.u_fade)}),circle:(m,a)=>({u_camera_to_center_distance:new o.Uniform1f(m,a.u_camera_to_center_distance),u_extrude_scale:new o.UniformMatrix2f(m,a.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(m,a.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(m,a.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(m,a.u_merc_center),u_tile_id:new o.Uniform3f(m,a.u_tile_id),u_zoom_transition:new o.Uniform1f(m,a.u_zoom_transition),u_up_dir:new o.Uniform3f(m,a.u_up_dir)}),collisionBox:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_camera_to_center_distance:new o.Uniform1f(m,a.u_camera_to_center_distance),u_extrude_scale:new o.Uniform2f(m,a.u_extrude_scale)}),collisionCircle:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_inv_matrix:new o.UniformMatrix4f(m,a.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(m,a.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(m,a.u_viewport_size)}),debug:(m,a)=>({u_color:new o.UniformColor(m,a.u_color),u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_overlay:new o.Uniform1i(m,a.u_overlay),u_overlay_scale:new o.Uniform1f(m,a.u_overlay_scale)}),clippingMask:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix)}),heatmap:(m,a)=>({u_extrude_scale:new o.Uniform1f(m,a.u_extrude_scale),u_intensity:new o.Uniform1f(m,a.u_intensity),u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(m,a.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(m,a.u_merc_center),u_tile_id:new o.Uniform3f(m,a.u_tile_id),u_zoom_transition:new o.Uniform1f(m,a.u_zoom_transition),u_up_dir:new o.Uniform3f(m,a.u_up_dir)}),heatmapTexture:(m,a)=>({u_image:new o.Uniform1i(m,a.u_image),u_color_ramp:new o.Uniform1i(m,a.u_color_ramp),u_opacity:new o.Uniform1f(m,a.u_opacity)}),hillshade:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_image:new o.Uniform1i(m,a.u_image),u_latrange:new o.Uniform2f(m,a.u_latrange),u_light:new o.Uniform2f(m,a.u_light),u_shadow:new o.UniformColor(m,a.u_shadow),u_highlight:new o.UniformColor(m,a.u_highlight),u_accent:new o.UniformColor(m,a.u_accent)}),hillshadePrepare:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_image:new o.Uniform1i(m,a.u_image),u_dimension:new o.Uniform2f(m,a.u_dimension),u_zoom:new o.Uniform1f(m,a.u_zoom),u_unpack:new o.Uniform4f(m,a.u_unpack)}),line:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_pixels_to_tile_units:new o.UniformMatrix2f(m,a.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(m,a.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(m,a.u_units_to_pixels),u_dash_image:new o.Uniform1i(m,a.u_dash_image),u_gradient_image:new o.Uniform1i(m,a.u_gradient_image),u_image_height:new o.Uniform1f(m,a.u_image_height),u_texsize:new o.Uniform2f(m,a.u_texsize),u_scale:new o.Uniform3f(m,a.u_scale),u_mix:new o.Uniform1f(m,a.u_mix),u_alpha_discard_threshold:new o.Uniform1f(m,a.u_alpha_discard_threshold),u_trim_offset:new o.Uniform2f(m,a.u_trim_offset)}),linePattern:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_texsize:new o.Uniform2f(m,a.u_texsize),u_pixels_to_tile_units:new o.UniformMatrix2f(m,a.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(m,a.u_device_pixel_ratio),u_image:new o.Uniform1i(m,a.u_image),u_units_to_pixels:new o.Uniform2f(m,a.u_units_to_pixels),u_scale:new o.Uniform3f(m,a.u_scale),u_fade:new o.Uniform1f(m,a.u_fade),u_alpha_discard_threshold:new o.Uniform1f(m,a.u_alpha_discard_threshold)}),raster:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_tl_parent:new o.Uniform2f(m,a.u_tl_parent),u_scale_parent:new o.Uniform1f(m,a.u_scale_parent),u_fade_t:new o.Uniform1f(m,a.u_fade_t),u_opacity:new o.Uniform1f(m,a.u_opacity),u_image0:new o.Uniform1i(m,a.u_image0),u_image1:new o.Uniform1i(m,a.u_image1),u_brightness_low:new o.Uniform1f(m,a.u_brightness_low),u_brightness_high:new o.Uniform1f(m,a.u_brightness_high),u_saturation_factor:new o.Uniform1f(m,a.u_saturation_factor),u_contrast_factor:new o.Uniform1f(m,a.u_contrast_factor),u_spin_weights:new o.Uniform3f(m,a.u_spin_weights),u_perspective_transform:new o.Uniform2f(m,a.u_perspective_transform)}),symbolIcon:(m,a)=>({u_is_size_zoom_constant:new o.Uniform1i(m,a.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(m,a.u_is_size_feature_constant),u_size_t:new o.Uniform1f(m,a.u_size_t),u_size:new o.Uniform1f(m,a.u_size),u_camera_to_center_distance:new o.Uniform1f(m,a.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(m,a.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(m,a.u_aspect_ratio),u_fade_change:new o.Uniform1f(m,a.u_fade_change),u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(m,a.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(m,a.u_coord_matrix),u_is_text:new o.Uniform1i(m,a.u_is_text),u_pitch_with_map:new o.Uniform1i(m,a.u_pitch_with_map),u_texsize:new o.Uniform2f(m,a.u_texsize),u_tile_id:new o.Uniform3f(m,a.u_tile_id),u_zoom_transition:new o.Uniform1f(m,a.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(m,a.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(m,a.u_merc_center),u_camera_forward:new o.Uniform3f(m,a.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(m,a.u_tile_matrix),u_up_vector:new o.Uniform3f(m,a.u_up_vector),u_ecef_origin:new o.Uniform3f(m,a.u_ecef_origin),u_texture:new o.Uniform1i(m,a.u_texture)}),symbolSDF:(m,a)=>({u_is_size_zoom_constant:new o.Uniform1i(m,a.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(m,a.u_is_size_feature_constant),u_size_t:new o.Uniform1f(m,a.u_size_t),u_size:new o.Uniform1f(m,a.u_size),u_camera_to_center_distance:new o.Uniform1f(m,a.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(m,a.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(m,a.u_aspect_ratio),u_fade_change:new o.Uniform1f(m,a.u_fade_change),u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(m,a.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(m,a.u_coord_matrix),u_is_text:new o.Uniform1i(m,a.u_is_text),u_pitch_with_map:new o.Uniform1i(m,a.u_pitch_with_map),u_texsize:new o.Uniform2f(m,a.u_texsize),u_texture:new o.Uniform1i(m,a.u_texture),u_gamma_scale:new o.Uniform1f(m,a.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(m,a.u_device_pixel_ratio),u_tile_id:new o.Uniform3f(m,a.u_tile_id),u_zoom_transition:new o.Uniform1f(m,a.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(m,a.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(m,a.u_merc_center),u_camera_forward:new o.Uniform3f(m,a.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(m,a.u_tile_matrix),u_up_vector:new o.Uniform3f(m,a.u_up_vector),u_ecef_origin:new o.Uniform3f(m,a.u_ecef_origin),u_is_halo:new o.Uniform1i(m,a.u_is_halo)}),symbolTextAndIcon:(m,a)=>({u_is_size_zoom_constant:new o.Uniform1i(m,a.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(m,a.u_is_size_feature_constant),u_size_t:new o.Uniform1f(m,a.u_size_t),u_size:new o.Uniform1f(m,a.u_size),u_camera_to_center_distance:new o.Uniform1f(m,a.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(m,a.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(m,a.u_aspect_ratio),u_fade_change:new o.Uniform1f(m,a.u_fade_change),u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(m,a.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(m,a.u_coord_matrix),u_is_text:new o.Uniform1i(m,a.u_is_text),u_pitch_with_map:new o.Uniform1i(m,a.u_pitch_with_map),u_texsize:new o.Uniform2f(m,a.u_texsize),u_texsize_icon:new o.Uniform2f(m,a.u_texsize_icon),u_texture:new o.Uniform1i(m,a.u_texture),u_texture_icon:new o.Uniform1i(m,a.u_texture_icon),u_gamma_scale:new o.Uniform1f(m,a.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(m,a.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(m,a.u_is_halo)}),background:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_opacity:new o.Uniform1f(m,a.u_opacity),u_color:new o.UniformColor(m,a.u_color)}),backgroundPattern:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_opacity:new o.Uniform1f(m,a.u_opacity),u_image:new o.Uniform1i(m,a.u_image),u_pattern_tl_a:new o.Uniform2f(m,a.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(m,a.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(m,a.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(m,a.u_pattern_br_b),u_texsize:new o.Uniform2f(m,a.u_texsize),u_mix:new o.Uniform1f(m,a.u_mix),u_pattern_size_a:new o.Uniform2f(m,a.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(m,a.u_pattern_size_b),u_scale_a:new o.Uniform1f(m,a.u_scale_a),u_scale_b:new o.Uniform1f(m,a.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(m,a.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(m,a.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(m,a.u_tile_units_to_pixels)}),terrainRaster:Pu,terrainDepth:Pu,skybox:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_sun_direction:new o.Uniform3f(m,a.u_sun_direction),u_cubemap:new o.Uniform1i(m,a.u_cubemap),u_opacity:new o.Uniform1f(m,a.u_opacity),u_temporal_offset:new o.Uniform1f(m,a.u_temporal_offset)}),skyboxGradient:(m,a)=>({u_matrix:new o.UniformMatrix4f(m,a.u_matrix),u_color_ramp:new o.Uniform1i(m,a.u_color_ramp),u_center_direction:new o.Uniform3f(m,a.u_center_direction),u_radius:new o.Uniform1f(m,a.u_radius),u_opacity:new o.Uniform1f(m,a.u_opacity),u_temporal_offset:new o.Uniform1f(m,a.u_temporal_offset)}),skyboxCapture:(m,a)=>({u_matrix_3f:new o.UniformMatrix3f(m,a.u_matrix_3f),u_sun_direction:new o.Uniform3f(m,a.u_sun_direction),u_sun_intensity:new o.Uniform1f(m,a.u_sun_intensity),u_color_tint_r:new o.Uniform4f(m,a.u_color_tint_r),u_color_tint_m:new o.Uniform4f(m,a.u_color_tint_m),u_luminance:new o.Uniform1f(m,a.u_luminance)}),globeRaster:(m,a)=>({u_proj_matrix:new o.UniformMatrix4f(m,a.u_proj_matrix),u_globe_matrix:new o.UniformMatrix4f(m,a.u_globe_matrix),u_normalize_matrix:new o.UniformMatrix4f(m,a.u_normalize_matrix),u_merc_matrix:new o.UniformMatrix4f(m,a.u_merc_matrix),u_zoom_transition:new o.Uniform1f(m,a.u_zoom_transition),u_merc_center:new o.Uniform2f(m,a.u_merc_center),u_image0:new o.Uniform1i(m,a.u_image0),u_grid_matrix:new o.UniformMatrix3f(m,a.u_grid_matrix),u_frustum_tl:new o.Uniform3f(m,a.u_frustum_tl),u_frustum_tr:new o.Uniform3f(m,a.u_frustum_tr),u_frustum_br:new o.Uniform3f(m,a.u_frustum_br),u_frustum_bl:new o.Uniform3f(m,a.u_frustum_bl),u_globe_pos:new o.Uniform3f(m,a.u_globe_pos),u_globe_radius:new o.Uniform1f(m,a.u_globe_radius),u_viewport:new o.Uniform2f(m,a.u_viewport)}),globeAtmosphere:(m,a)=>({u_frustum_tl:new o.Uniform3f(m,a.u_frustum_tl),u_frustum_tr:new o.Uniform3f(m,a.u_frustum_tr),u_frustum_br:new o.Uniform3f(m,a.u_frustum_br),u_frustum_bl:new o.Uniform3f(m,a.u_frustum_bl),u_horizon:new o.Uniform1f(m,a.u_horizon),u_transition:new o.Uniform1f(m,a.u_transition),u_fadeout_range:new o.Uniform1f(m,a.u_fadeout_range),u_color:new o.Uniform4f(m,a.u_color),u_high_color:new o.Uniform4f(m,a.u_high_color),u_space_color:new o.Uniform4f(m,a.u_space_color),u_star_intensity:new o.Uniform1f(m,a.u_star_intensity),u_star_density:new o.Uniform1f(m,a.u_star_density),u_star_size:new o.Uniform1f(m,a.u_star_size),u_temporal_offset:new o.Uniform1f(m,a.u_temporal_offset),u_horizon_angle:new o.Uniform1f(m,a.u_horizon_angle),u_rotation_matrix:new o.UniformMatrix4f(m,a.u_rotation_matrix)})};let Lu;function xm(m,a,f,y,b,T,M){const O=m.context,L=O.gl,N=m.transform,U=m.useProgram("collisionBox"),Z=[];let te=0,ae=0;for(let Ae=0;Ae<y.length;Ae++){const _e=y[Ae],be=a.getTile(_e),Re=be.getBucket(f);if(!Re)continue;const We=qn(_e,Re,N);let Ke=We;b[0]===0&&b[1]===0||(Ke=m.translatePosMatrix(We,be,b,T));const Ze=M?Re.textCollisionBox:Re.iconCollisionBox,Ge=Re.collisionCircleArray;if(Ge.length>0){const Se=o.create(),dt=Ke;o.mul(Se,Re.placementInvProjMatrix,N.glCoordMatrix),o.mul(Se,Se,Re.placementViewportMatrix),Z.push({circleArray:Ge,circleOffset:ae,transform:dt,invTransform:Se,projection:Re.getProjection()}),te+=Ge.length/4,ae=te}Ze&&(m.terrain&&m.terrain.setupElevationDraw(be,U),U.draw(O,L.LINES,o.DepthMode.disabled,o.StencilMode.disabled,m.colorModeForRenderPass(),o.CullFaceMode.disabled,Fd(Ke,N,be,Re.getProjection()),f.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,null,N.zoom,null,Ze.collisionVertexBuffer,Ze.collisionVertexBufferExt))}if(!M||!Z.length)return;const le=m.useProgram("collisionCircle"),ie=new o.StructArrayLayout2f1f2i16;ie.resize(4*te),ie._trim();let ve=0;for(const Ae of Z)for(let _e=0;_e<Ae.circleArray.length/4;_e++){const be=4*_e,Re=Ae.circleArray[be+0],We=Ae.circleArray[be+1],Ke=Ae.circleArray[be+2],Ze=Ae.circleArray[be+3];ie.emplace(ve++,Re,We,Ke,Ze,0),ie.emplace(ve++,Re,We,Ke,Ze,1),ie.emplace(ve++,Re,We,Ke,Ze,2),ie.emplace(ve++,Re,We,Ke,Ze,3)}(!Lu||Lu.length<2*te)&&(Lu=function(Ae){const _e=2*Ae,be=new o.StructArrayLayout3ui6;be.resize(_e),be._trim();for(let Re=0;Re<_e;Re++){const We=6*Re;be.uint16[We+0]=4*Re+0,be.uint16[We+1]=4*Re+1,be.uint16[We+2]=4*Re+2,be.uint16[We+3]=4*Re+2,be.uint16[We+4]=4*Re+3,be.uint16[We+5]=4*Re+0}return be}(te));const oe=O.createIndexBuffer(Lu,!0),he=O.createVertexBuffer(ie,o.collisionCircleLayout.members,!0);for(const Ae of Z){const _e={u_matrix:Ae.transform,u_inv_matrix:Ae.invTransform,u_camera_to_center_distance:(de=N).getCameraToCenterDistance(Ae.projection),u_viewport_size:[de.width,de.height]};le.draw(O,L.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,m.colorModeForRenderPass(),o.CullFaceMode.disabled,_e,f.id,he,oe,o.SegmentVector.simpleSegment(0,2*Ae.circleOffset,Ae.circleArray.length,Ae.circleArray.length/2),null,N.zoom)}var de;he.destroy(),oe.destroy()}const bm=o.create();function Lv(m,a,f,y,b,T){const{horizontalAlign:M,verticalAlign:O}=o.getAnchorAlignment(m),L=-(M-.5)*a,N=-(O-.5)*f,U=o.evaluateVariableOffset(m,y);return new o.pointGeometry((L/b+U[0])*T,(N/b+U[1])*T)}function kv(m,a,f,y,b,T,M,O,L,N,U){const Z=m.text.placedSymbolArray,te=m.text.dynamicLayoutVertexArray,ae=m.icon.dynamicLayoutVertexArray,le={},ie=vu(O,m.getProjection(),T),ve=T.elevation,oe=m.getProjection().upVectorScale(O.canonical,T.center.lat,T.worldSize);te.clear();for(let he=0;he<Z.length;he++){const de=Z.get(he),Ae=m.allowVerticalPlacement&&!de.placedOrientation,_e=de.hidden||!de.crossTileID||Ae?null:y[de.crossTileID];if(_e){const be=new o.pointGeometry(de.tileAnchorX,de.tileAnchorY),Re=m.getProjection().upVector(O.canonical,be.x,be.y),We=ve?ve.getAtTileOffset(O,be.x,be.y):0,Ke=xn([de.projectedAnchorX+We*Re[0]*oe.metersToTile,de.projectedAnchorY+We*Re[1]*oe.metersToTile,de.projectedAnchorZ+We*Re[2]*oe.metersToTile],f?ie:M),Ze=us(T.getCameraToCenterDistance(m.getProjection()),Ke.signedDistanceFromCamera);let Ge=b.evaluateSizeForFeature(m.textSizeData,N,de)*Ze/o.ONE_EM;f&&(Ge*=m.tilePixelRatio/L);const{width:Se,height:dt,anchor:ct,textOffset:Rt,textScale:Qe}=_e,Jt=Lv(ct,Se,dt,Rt,Qe,Ge);let Mt;if(f){const wt=be.add(Jt),{x:Pt,y:cr,z:tr}=m.getProjection().projectTilePoint(wt.x,wt.y,O.canonical);Mt=xn([Pt+We*Re[0]*oe.metersToTile,cr+We*Re[1]*oe.metersToTile,tr+We*Re[2]*oe.metersToTile],M).point}else{const wt=a?Jt.rotate(-T.angle):Jt;Mt=[Ke.point[0]+wt.x,Ke.point[1]+wt.y,0]}const It=m.allowVerticalPlacement&&de.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let wt=0;wt<de.numGlyphs;wt++)o.addDynamicAttributes(te,Mt[0],Mt[1],Mt[2],It);U&&de.associatedIconIndex>=0&&(le[de.associatedIconIndex]={shiftedAnchor:Mt,angle:It})}else zi(de.numGlyphs,te)}if(U){ae.clear();const he=m.icon.placedSymbolArray;for(let de=0;de<he.length;de++){const Ae=he.get(de);if(Ae.hidden)zi(Ae.numGlyphs,ae);else{const _e=le[de];if(_e)for(let be=0;be<Ae.numGlyphs;be++)o.addDynamicAttributes(ae,_e.shiftedAnchor[0],_e.shiftedAnchor[1],_e.shiftedAnchor[2],_e.angle);else zi(Ae.numGlyphs,ae)}}m.icon.dynamicLayoutVertexBuffer.updateData(ae)}m.text.dynamicLayoutVertexBuffer.updateData(te)}function Vd(m,a,f){return f.iconsInText&&a?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function ku(m,a,f,y,b,T,M,O,L,N,U,Z){const te=m.context,ae=te.gl,le=m.transform,ie=O==="map",ve=L==="map",oe=ie&&f.layout.get("symbol-placement")!=="point",he=ie&&!ve&&!oe,de=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ae=!1;const _e=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),be=[o.mercatorXfromLng(le.center.lng),o.mercatorYfromLat(le.center.lat)],Re=f.layout.get("text-variable-anchor"),We=le.projection.name==="globe",Ke=[],Ze=[0,-1,0];let Ge=Ze;!We&&!le.mercatorFromTransition||ie||(Ge=function(Se){const dt=Se._camera.getWorldToCamera(Se.worldSize,1),ct=o.multiply([],dt,Se.globeMatrix);o.invert(ct,ct);const Rt=[0,0,0],Qe=[0,1,0,0];return o.transformMat4$1(Qe,Qe,ct),Rt[0]=Qe[0],Rt[1]=Qe[1],Rt[2]=Qe[2],o.normalize(Rt,Rt),Rt}(le));for(const Se of y){const dt=a.getTile(Se),ct=dt.getBucket(f);if(!ct||ct.projection.name==="mercator"&&We)continue;const Rt=b?ct.text:ct.icon;if(!Rt||ct.fullyClipped||!Rt.segments.get().length)continue;const Qe=Rt.programConfigurations.get(f.id),Jt=b||ct.sdfIcons,Mt=b?ct.textSizeData:ct.iconSizeData,It=ve||le.pitch!==0,wt=o.evaluateSizeForZoom(Mt,le.zoom);let Pt,cr,tr,_r,Xt=[0,0],mr=null;if(b){if(cr=dt.glyphAtlasTexture,tr=ae.LINEAR,Pt=dt.glyphAtlasTexture.size,ct.iconsInText){Xt=dt.imageAtlasTexture.size,mr=dt.imageAtlasTexture;const Oi=Mt.kind==="composite"||Mt.kind==="camera";_r=It||m.options.rotating||m.options.zooming||Oi?ae.LINEAR:ae.NEAREST}}else{const Oi=f.layout.get("icon-size").constantOr(0)!==1||ct.iconsNeedLinear;cr=dt.imageAtlasTexture,tr=Jt||m.options.rotating||m.options.zooming||Oi||It?ae.LINEAR:ae.NEAREST,Pt=dt.imageAtlasTexture.size}const Br=ct.projection.name==="globe",Gr=Br?Ge:Ze,Ti=Br?o.globeToMercatorTransition(le.zoom):0,Yr=vu(Se,ct.getProjection(),le),kn=le.calculatePixelsToTileUnitsMatrix(dt),Ds=dr(Yr,dt.tileID.canonical,ve,ie,le,ct.getProjection(),kn),Qs=m.terrain&&ve&&oe?o.invert(o.create(),Ds):bm,ii=Is(Yr,dt.tileID.canonical,ve,ie,le,ct.getProjection(),kn),ai=Re&&ct.hasTextData(),$r=f.layout.get("icon-text-fit")!=="none"&&ai&&ct.hasIconData();if(oe){const Oi=le.elevation,Rs=Oi?Oi.getAtTileOffsetFunc(Se,le.center.lat,le.worldSize,ct.getProjection()):gc=>[0,0,0],eo=vn(Yr,dt.tileID.canonical,ve,ie,le,ct.getProjection(),kn);dn(ct,Yr,m,b,eo,ii,ve,N,Rs,Se)}const Mi=oe||b&&Re||$r,Ki=m.translatePosMatrix(Yr,dt,T,M),Mr=Mi?bm:Ds,bn=m.translatePosMatrix(ii,dt,T,M,!0),ra=ct.getProjection().createInversionMatrix(le,Se.canonical),fs=[];m.terrain&&ve&&fs.push("PITCH_WITH_MAP_TERRAIN"),Br&&fs.push("PROJECTION_GLOBE_VIEW"),Mi&&fs.push("PROJECTED_POS_ON_VIEWPORT");const Xa=Jt&&f.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ya;Ya=Jt?ct.iconsInText?ym(Mt.kind,wt,he,ve,m,Ki,Mr,bn,Pt,Xt,Se,Ti,be,ra,Gr,ct.getProjection()):_m(Mt.kind,wt,he,ve,m,Ki,Mr,bn,b,Pt,!0,Se,Ti,be,ra,Gr,ct.getProjection()):nc(Mt.kind,wt,he,ve,m,Ki,Mr,bn,b,Pt,Se,Ti,be,ra,Gr,ct.getProjection());const xo={program:m.useProgram(Vd(Jt,b,ct),Qe,fs),buffers:Rt,uniformValues:Ya,atlasTexture:cr,atlasTextureIcon:mr,atlasInterpolation:tr,atlasInterpolationIcon:_r,isSDF:Jt,hasHalo:Xa,tile:dt,labelPlaneMatrixInv:Qs};if(de&&ct.canOverlap){Ae=!0;const Oi=Rt.segments.get();for(const Rs of Oi)Ke.push({segments:new o.SegmentVector([Rs]),sortKey:Rs.sortKey,state:xo})}else Ke.push({segments:Rt.segments,sortKey:0,state:xo})}Ae&&Ke.sort((Se,dt)=>Se.sortKey-dt.sortKey);for(const Se of Ke){const dt=Se.state;if(m.terrain&&m.terrain.setupElevationDraw(dt.tile,dt.program,{useDepthForOcclusion:!We,labelPlaneMatrixInv:dt.labelPlaneMatrixInv}),te.activeTexture.set(ae.TEXTURE0),dt.atlasTexture.bind(dt.atlasInterpolation,ae.CLAMP_TO_EDGE),dt.atlasTextureIcon&&(te.activeTexture.set(ae.TEXTURE1),dt.atlasTextureIcon&&dt.atlasTextureIcon.bind(dt.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),dt.isSDF){const ct=dt.uniformValues;dt.hasHalo&&(ct.u_is_halo=1,Ud(dt.buffers,Se.segments,f,m,dt.program,_e,U,Z,ct)),ct.u_is_halo=0}Ud(dt.buffers,Se.segments,f,m,dt.program,_e,U,Z,dt.uniformValues)}}function Ud(m,a,f,y,b,T,M,O,L){const N=y.context;b.draw(N,N.gl.TRIANGLES,T,M,O,o.CullFaceMode.disabled,L,f.id,m.layoutVertexBuffer,m.indexBuffer,a,f.paint,y.transform.zoom,m.programConfigurations.get(f.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer)}function Gd(m,a,f,y,b,T,M){const O=m.context.gl,L=f.paint.get("fill-pattern"),N=L&&L.constantOr(1),U=f.getCrossfadeParameters();let Z,te,ae,le,ie;M?(te=N&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=O.LINES):(te=N?"fillPattern":"fill",Z=O.TRIANGLES);for(const ve of y){const oe=a.getTile(ve);if(N&&!oe.patternsLoaded())continue;const he=oe.getBucket(f);if(!he)continue;m.prepareDrawTile();const de=he.programConfigurations.get(f.id),Ae=m.useProgram(te,de);N&&(m.context.activeTexture.set(O.TEXTURE0),oe.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),de.updatePaintBuffers(U));const _e=L.constantOr(null);if(_e&&oe.imageAtlas){const Re=oe.imageAtlas,We=Re.patternPositions[_e.to.toString()],Ke=Re.patternPositions[_e.from.toString()];We&&Ke&&de.setConstantPatternPositions(We,Ke)}const be=m.translatePosMatrix(ve.projMatrix,oe,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(M){le=he.indexBuffer2,ie=he.segments2;const Re=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];ae=te==="fillOutlinePattern"&&N?kd(be,m,U,oe,Re):Du(be,Re)}else le=he.indexBuffer,ie=he.segments,ae=N?Ld(be,m,U,oe):$a(be);m.prepareDrawProgram(m.context,Ae,ve.toUnwrapped()),Ae.draw(m.context,Z,b,m.stencilModeForClipping(ve),T,o.CullFaceMode.disabled,ae,f.id,he.layoutVertexBuffer,le,ie,f.paint,m.transform.zoom,de)}}function zu(m,a,f,y,b,T,M){const O=m.context,L=O.gl,N=m.transform,U=f.paint.get("fill-extrusion-pattern"),Z=U.constantOr(1),te=f.getCrossfadeParameters(),ae=f.paint.get("fill-extrusion-opacity"),le=N.projection.name==="globe"?o.fillExtrusionHeightLift():0,ie=N.projection.name==="globe",ve=ie?o.globeToMercatorTransition(N.zoom):0,oe=[o.mercatorXfromLng(N.center.lng),o.mercatorYfromLat(N.center.lat)],he=[];ie&&he.push("PROJECTION_GLOBE_VIEW");for(const de of y){const Ae=a.getTile(de),_e=Ae.getBucket(f);if(!_e||_e.projection.name!==N.projection.name)continue;const be=_e.programConfigurations.get(f.id),Re=m.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",be,he);if(m.terrain){const dt=m.terrain;if(m.style.terrainSetForDrapingOnly())dt.setupElevationDraw(Ae,Re,{useMeterToDem:!0});else{if(!_e.enableTerrain)continue;if(dt.setupElevationDraw(Ae,Re,{useMeterToDem:!0}),Hd(O,a,de,_e,f,dt),!_e.centroidVertexBuffer){const ct=Re.attributes.a_centroid_pos;ct!==void 0&&L.vertexAttrib2f(ct,0,0)}}}Z&&(m.context.activeTexture.set(L.TEXTURE0),Ae.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),be.updatePaintBuffers(te));const We=U.constantOr(null);if(We&&Ae.imageAtlas){const dt=Ae.imageAtlas,ct=dt.patternPositions[We.to.toString()],Rt=dt.patternPositions[We.from.toString()];ct&&Rt&&be.setConstantPatternPositions(ct,Rt)}const Ke=m.translatePosMatrix(de.projMatrix,Ae,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),Ze=N.projection.createInversionMatrix(N,de.canonical),Ge=f.paint.get("fill-extrusion-vertical-gradient"),Se=Z?rc(Ke,m,Ge,ae,de,te,Ae,le,ve,oe,Ze):fm(Ke,m,Ge,ae,de,le,ve,oe,Ze);m.prepareDrawProgram(O,Re,de.toUnwrapped()),Re.draw(O,O.gl.TRIANGLES,b,T,M,o.CullFaceMode.backCCW,Se,f.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,f.paint,m.transform.zoom,be,m.terrain?_e.centroidVertexBuffer:null,ie?_e.layoutVertexExtBuffer:null)}}function Hd(m,a,f,y,b,T){const M=[oe=>{let he=oe.canonical.x-1,de=oe.wrap;return he<0&&(he=(1<<oe.canonical.z)-1,de--),new o.OverscaledTileID(oe.overscaledZ,de,oe.canonical.z,he,oe.canonical.y)},oe=>{let he=oe.canonical.x+1,de=oe.wrap;return he===1<<oe.canonical.z&&(he=0,de++),new o.OverscaledTileID(oe.overscaledZ,de,oe.canonical.z,he,oe.canonical.y)},oe=>new o.OverscaledTileID(oe.overscaledZ,oe.wrap,oe.canonical.z,oe.canonical.x,(oe.canonical.y===0?1<<oe.canonical.z:oe.canonical.y)-1),oe=>new o.OverscaledTileID(oe.overscaledZ,oe.wrap,oe.canonical.z,oe.canonical.x,oe.canonical.y===(1<<oe.canonical.z)-1?0:oe.canonical.y+1)],O=oe=>{const he=a.getSource().minzoom,de=_e=>{const be=a.getTileByID(_e);if(be&&be.hasData())return be.getBucket(b)},Ae=[0,-1,1];for(const _e of Ae){if(oe.overscaledZ+_e<he)continue;const be=de(oe.calculateScaledKey(oe.overscaledZ+_e));if(be)return be}},L=[0,0,0],N=(oe,he)=>(L[0]=Math.min(oe.min.y,he.min.y),L[1]=Math.max(oe.max.y,he.max.y),L[2]=o.EXTENT-he.min.x>oe.max.x?he.min.x-o.EXTENT:oe.max.x,L),U=(oe,he)=>(L[0]=Math.min(oe.min.x,he.min.x),L[1]=Math.max(oe.max.x,he.max.x),L[2]=o.EXTENT-he.min.y>oe.max.y?he.min.y-o.EXTENT:oe.max.y,L),Z=[(oe,he)=>N(oe,he),(oe,he)=>N(he,oe),(oe,he)=>U(oe,he),(oe,he)=>U(he,oe)],te=new o.pointGeometry(0,0);let ae,le,ie;const ve=(oe,he,de,Ae,_e)=>{const be=[[Ae?de:oe,Ae?oe:de,0],[Ae?de:he,Ae?he:de,0]],Re=_e<0?o.EXTENT+_e:_e,We=[Ae?Re:(oe+he)/2,Ae?(oe+he)/2:Re,0];return de===0&&_e<0||de!==0&&_e>0?T.getForTilePoints(ie,[We],!0,le):be.push(We),T.getForTilePoints(f,be,!0,ae),Math.max(be[0][2],be[1][2],We[2])/T.exaggeration()};for(let oe=0;oe<4;oe++){const he=(oe<2?1:5)-oe,de=y.borders[oe];if(de.length===0)continue;const Ae=ie=M[oe](f),_e=O(Ae);if(!(_e&&_e instanceof o.FillExtrusionBucket&&_e.enableTerrain)||y.borderDoneWithNeighborZ[oe]===_e.canonical.z&&_e.borderDoneWithNeighborZ[he]===y.canonical.z||(le=T.findDEMTileFor(Ae),!le||!le.dem))continue;if(!ae){const Ke=T.findDEMTileFor(f);if(!Ke||!Ke.dem)return;ae=Ke}const be=_e.borders[he];let Re=0;const We=_e.borderDoneWithNeighborZ[he]!==y.canonical.z;if(y.canonical.z===_e.canonical.z){for(let Ke=0;Ke<de.length;Ke++){const Ze=y.featuresOnBorder[de[Ke]],Ge=Ze.borders[oe];let Se;for(;Re<be.length&&(Se=_e.featuresOnBorder[be[Re]],!(Se.borders[he][1]>Ge[0]+3));)We&&_e.encodeCentroid(void 0,Se,!1),Re++;if(Se&&Re<be.length){const dt=Re;let ct=0;for(;!(Se.borders[he][0]>Ge[1]-3)&&(ct++,++Re!==be.length);)Se=_e.featuresOnBorder[be[Re]];if(Se=_e.featuresOnBorder[be[dt]],Ze.intersectsCount()>1||Se.intersectsCount()>1||ct!==1){ct!==1&&(Re=dt),y.encodeCentroid(void 0,Ze,!1),We&&_e.encodeCentroid(void 0,Se,!1);continue}const Rt=Z[oe](Ze,Se),Qe=oe%2?o.EXTENT-1:0;te.x=ve(Rt[0],Math.min(o.EXTENT-1,Rt[1]),Qe,oe<2,Rt[2]),te.y=0,y.encodeCentroid(te,Ze,!1),We&&_e.encodeCentroid(te,Se,!1)}else y.encodeCentroid(void 0,Ze,!1)}y.borderDoneWithNeighborZ[oe]=_e.canonical.z,y.needsCentroidUpdate=!0,We&&(_e.borderDoneWithNeighborZ[he]=y.canonical.z,_e.needsCentroidUpdate=!0)}else{for(const Ke of de)y.encodeCentroid(void 0,y.featuresOnBorder[Ke],!1);if(We){for(const Ke of be)_e.encodeCentroid(void 0,_e.featuresOnBorder[Ke],!1);_e.borderDoneWithNeighborZ[he]=y.canonical.z,_e.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[oe]=_e.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(m)}const Xo=new o.Color(1,0,0,1),sc=new o.Color(0,1,0,1),wm=new o.Color(0,0,1,1),Ua=new o.Color(1,0,1,1),Ga=new o.Color(0,1,1,1);function Wd(m,a,f,y){Rr(m,0,a+f/2,m.transform.width,f,y)}function Fu(m,a,f,y){Rr(m,a-f/2,0,f,m.transform.height,y)}function Rr(m,a,f,y,b,T){const M=m.context,O=M.gl;O.enable(O.SCISSOR_TEST),O.scissor(a*o.exported.devicePixelRatio,f*o.exported.devicePixelRatio,y*o.exported.devicePixelRatio,b*o.exported.devicePixelRatio),M.clear({color:T}),O.disable(O.SCISSOR_TEST)}function Bu(m,a,f){const y=m.context,b=y.gl,T=m.transform.projection.name==="globe",M=f.projMatrix,O=m.useProgram("debug",null,T?["PROJECTION_GLOBE_VIEW"]:null),L=a.getTileByID(f.key);m.terrain&&m.terrain.setupElevationDraw(L,O);const N=o.DepthMode.disabled,U=o.StencilMode.disabled,Z=m.colorModeForRenderPass(),te="$debug";y.activeTexture.set(b.TEXTURE0),m.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),T?L._makeGlobeTileDebugBuffers(m.context,m.transform.projection):L._makeDebugTileBoundsBuffers(m.context,m.transform.projection);const ae=L._tileDebugBuffer||m.debugBuffer,le=L._tileDebugIndexBuffer||m.debugIndexBuffer,ie=L._tileDebugSegments||m.debugSegments;O.draw(y,b.LINE_STRIP,N,U,Z,o.CullFaceMode.disabled,Bd(M,o.Color.red),te,ae,le,ie,null,null,null,L._globeTileDebugBorderBuffer);const ve=L.latestRawTileData,oe=Math.floor((ve&&ve.byteLength||0)/1024),he=a.getTile(f).tileSize,de=512/Math.min(he,512)*(f.overscaledZ/m.transform.zoom)*.5;let Ae=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Ae+=` => ${f.overscaledZ}`),function(We,Ke){We.initDebugOverlayCanvas();const Ze=We.debugOverlayCanvas,Ge=We.context.gl,Se=We.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,Ze.width,Ze.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(Ke,5,5),Se.strokeText(Ke,5,5),We.debugOverlayTexture.update(Ze),We.debugOverlayTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}(m,`${Ae} ${oe}kb`);const _e=L._tileDebugTextBuffer||m.debugBuffer,be=L._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Re=L._tileDebugTextSegments||m.debugSegments;O.draw(y,b.TRIANGLES,N,U,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,Bd(M,o.Color.transparent,de),te,_e,be,Re,null,null,null,L._globeTileDebugTextBuffer)}const zv=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Em}=zv;function Kn(m,a,f,y){m.emplaceBack(a,f,y)}class Tm{constructor(a){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Kn(this.vertexArray,-1,-1,1),Kn(this.vertexArray,1,-1,1),Kn(this.vertexArray,-1,1,1),Kn(this.vertexArray,1,1,1),Kn(this.vertexArray,-1,-1,-1),Kn(this.vertexArray,1,-1,-1),Kn(this.vertexArray,-1,1,-1),Kn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,Em),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function Ha(m,a,f,y,b,T){const M=m.gl,O=a.paint.get("sky-atmosphere-color"),L=a.paint.get("sky-atmosphere-halo-color"),N=a.paint.get("sky-atmosphere-sun-intensity"),U=((Z,te,ae,le,ie)=>({u_matrix_3f:Z,u_sun_direction:te,u_sun_intensity:ae,u_color_tint_r:[le.r,le.g,le.b,le.a],u_color_tint_m:[ie.r,ie.g,ie.b,ie.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),y),b,N,O,L);M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+T,a.skyboxTexture,0),f.draw(m,M.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,U,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}const Sm=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Fv{constructor(a){const f=new o.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const y=new o.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(f,Sm.members),this.indexBuffer=a.createIndexBuffer(y),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Nu={symbol:function(m,a,f,y,b){if(m.renderPass!=="translucent")return;const T=o.StencilMode.disabled,M=m.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(O,L,N,U,Z,te,ae){const le=L.transform,ie=Z==="map",ve=te==="map";for(const oe of O){const he=U.getTile(oe),de=he.getBucket(N);if(!de||!de.text||!de.text.segments.get().length)continue;const Ae=o.evaluateSizeForZoom(de.textSizeData,le.zoom),_e=vu(oe,de.getProjection(),le),be=le.calculatePixelsToTileUnitsMatrix(he),Re=dr(_e,he.tileID.canonical,ve,ie,le,de.getProjection(),be),We=N.layout.get("icon-text-fit")!=="none"&&de.hasIconData();if(Ae){const Ke=Math.pow(2,le.zoom-he.tileID.overscaledZ);kv(de,ie,ve,ae,o.symbolSize,le,Re,oe,Ke,Ae,We)}}}(y,m,f,a,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),b),f.paint.get("icon-opacity").constantOr(1)!==0&&ku(m,a,f,y,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),T,M),f.paint.get("text-opacity").constantOr(1)!==0&&ku(m,a,f,y,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),T,M),a.map.showCollisionBoxes&&(xm(m,a,f,y,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),xm(m,a,f,y,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(m,a,f,y){if(m.renderPass!=="translucent")return;const b=f.paint.get("circle-opacity"),T=f.paint.get("circle-stroke-width"),M=f.paint.get("circle-stroke-opacity"),O=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(b.constantOr(1)===0&&(T.constantOr(1)===0||M.constantOr(1)===0))return;const L=m.context,N=L.gl,U=m.transform,Z=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),te=o.StencilMode.disabled,ae=m.colorModeForRenderPass(),le=U.projection.name==="globe",ie=[o.mercatorXfromLng(U.center.lng),o.mercatorYfromLat(U.center.lat)],ve=[];for(let he=0;he<y.length;he++){const de=y[he],Ae=a.getTile(de),_e=Ae.getBucket(f);if(!_e||_e.projection.name!==U.projection.name)continue;const be=_e.programConfigurations.get(f.id),Re=pm(f);le&&Re.push("PROJECTION_GLOBE_VIEW");const We=m.useProgram("circle",be,Re),Ke=_e.layoutVertexBuffer,Ze=_e.globeExtVertexBuffer,Ge=_e.indexBuffer,Se=U.projection.createInversionMatrix(U,de.canonical),dt={programConfiguration:be,program:We,layoutVertexBuffer:Ke,globeExtVertexBuffer:Ze,indexBuffer:Ge,uniformValues:zd(m,de,Ae,Se,ie,f),tile:Ae};if(O){const ct=_e.segments.get();for(const Rt of ct)ve.push({segments:new o.SegmentVector([Rt]),sortKey:Rt.sortKey,state:dt})}else ve.push({segments:_e.segments,sortKey:0,state:dt})}O&&ve.sort((he,de)=>he.sortKey-de.sortKey);const oe={useDepthForOcclusion:!le};for(const he of ve){const{programConfiguration:de,program:Ae,layoutVertexBuffer:_e,globeExtVertexBuffer:be,indexBuffer:Re,uniformValues:We,tile:Ke}=he.state,Ze=he.segments;m.terrain&&m.terrain.setupElevationDraw(Ke,Ae,oe),m.prepareDrawProgram(L,Ae,Ke.tileID.toUnwrapped()),Ae.draw(L,N.TRIANGLES,Z,te,ae,o.CullFaceMode.disabled,We,f.id,_e,Re,Ze,f.paint,U.zoom,de,le?be:null)}},heatmap:function(m,a,f,y){if(f.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const b=m.context,T=b.gl,M=o.StencilMode.disabled,O=new o.ColorMode([T.ONE,T.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(ae,le,ie,ve){const oe=ae.gl,he=le.width*ve,de=le.height*ve;ae.activeTexture.set(oe.TEXTURE1),ae.viewport.set([0,0,he,de]);let Ae=ie.heatmapFbo;if(!Ae||Ae&&(Ae.width!==he||Ae.height!==de)){Ae&&Ae.destroy();const _e=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,_e),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MAG_FILTER,oe.LINEAR),Ae=ie.heatmapFbo=ae.createFramebuffer(he,de,!1),function(be,Re,We,Ke,Ze,Ge){const Se=be.gl;Se.texImage2D(Se.TEXTURE_2D,0,Se.RGBA,Ze,Ge,0,Se.RGBA,be.extRenderToTextureHalfFloat?be.extTextureHalfFloat.HALF_FLOAT_OES:Se.UNSIGNED_BYTE,null),Ke.colorAttachment.set(We)}(ae,0,_e,Ae,he,de)}else oe.bindTexture(oe.TEXTURE_2D,Ae.colorAttachment.get()),ae.bindFramebuffer.set(Ae.framebuffer)})(b,m,f,m.transform.projection.name==="globe"?.5:.25),b.clear({color:o.Color.transparent});const L=m.transform,N=L.projection.name==="globe",U=N?["PROJECTION_GLOBE_VIEW"]:null,Z=N?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,te=[o.mercatorXfromLng(L.center.lng),o.mercatorYfromLat(L.center.lat)];for(let ae=0;ae<y.length;ae++){const le=y[ae];if(a.hasRenderableParent(le))continue;const ie=a.getTile(le),ve=ie.getBucket(f);if(!ve||ve.projection.name!==L.projection.name)continue;const oe=ve.programConfigurations.get(f.id),he=m.useProgram("heatmap",oe,U),{zoom:de}=m.transform;m.terrain&&m.terrain.setupElevationDraw(ie,he),m.prepareDrawProgram(b,he,le.toUnwrapped());const Ae=L.projection.createInversionMatrix(L,le.canonical);he.draw(b,T.TRIANGLES,o.DepthMode.disabled,M,O,Z,Mv(m,le,ie,Ae,te,de,f.paint.get("heatmap-intensity")),f.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,f.paint,m.transform.zoom,oe,N?ve.globeExtVertexBuffer:null)}b.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(b,T){const M=b.context,O=M.gl,L=T.heatmapFbo;if(!L)return;M.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,L.colorAttachment.get()),M.activeTexture.set(O.TEXTURE1);let N=T.colorRampTexture;N||(N=T.colorRampTexture=new o.Texture(M,T.colorRamp,O.RGBA)),N.bind(O.LINEAR,O.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(M,O.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,b.colorModeForRenderPass(),o.CullFaceMode.disabled,((U,Z,te,ae)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,T),T.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,T.paint,b.transform.zoom)}(m,f))},line:function(m,a,f,y){if(m.renderPass!=="translucent")return;const b=f.paint.get("line-opacity"),T=f.paint.get("line-width");if(b.constantOr(1)===0||T.constantOr(1)===0)return;const M=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),O=m.colorModeForRenderPass(),L=m.terrain&&m.terrain.renderingToTexture?1:o.exported.devicePixelRatio,N=f.paint.get("line-dasharray"),U=N.constantOr(1),Z=f.layout.get("line-cap"),te=f.paint.get("line-pattern"),ae=te.constantOr(1),le=f.paint.get("line-gradient"),ie=f.getCrossfadeParameters(),ve=ae?"linePattern":"line",oe=m.context,he=oe.gl,de=(_e=>{const be=[];Ru(_e)&&be.push("RENDER_LINE_DASH"),_e.paint.get("line-gradient")&&be.push("RENDER_LINE_GRADIENT");const Re=_e.paint.get("line-trim-offset");Re[0]===0&&Re[1]===0||be.push("RENDER_LINE_TRIM_OFFSET");const We=_e.paint.get("line-pattern").constantOr(1),Ke=_e.paint.get("line-opacity").constantOr(1)!==1;return!We&&Ke&&be.push("RENDER_LINE_ALPHA_DISCARD"),be})(f);let Ae=de.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Ae=!1);for(const _e of y){const be=a.getTile(_e);if(ae&&!be.patternsLoaded())continue;const Re=be.getBucket(f);if(!Re)continue;m.prepareDrawTile();const We=Re.programConfigurations.get(f.id),Ke=m.useProgram(ve,We,de),Ze=te.constantOr(null);if(Ze&&be.imageAtlas){const Mt=be.imageAtlas,It=Mt.patternPositions[Ze.to.toString()],wt=Mt.patternPositions[Ze.from.toString()];It&&wt&&We.setConstantPatternPositions(It,wt)}const Ge=N.constantOr(null),Se=Z.constantOr(null);if(!ae&&Ge&&Se&&be.lineAtlas){const Mt=be.lineAtlas,It=Mt.getDash(Ge.to,Se),wt=Mt.getDash(Ge.from,Se);It&&wt&&We.setConstantPatternPositions(It,wt)}let[dt,ct]=f.paint.get("line-trim-offset");(Se==="round"||Se==="square")&&dt!==ct&&(dt===0&&(dt-=1),ct===1&&(ct+=1));const Rt=m.terrain?_e.projMatrix:null,Qe=ae?Ov(m,be,f,ie,Rt,L):jd(m,be,f,ie,Rt,Re.lineClipsArray.length,L,[dt,ct]);if(le){const Mt=Re.gradients[f.id];let It=Mt.texture;if(f.gradientVersion!==Mt.version){let wt=256;if(f.stepInterpolant){const Pt=a.getSource().maxzoom,cr=_e.canonical.z===Pt?Math.ceil(1<<m.transform.maxZoom-_e.canonical.z):1;wt=o.clamp(o.nextPowerOfTwo(Re.maxLineLength/o.EXTENT*1024*cr),256,oe.maxTextureSize)}Mt.gradient=o.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:wt,image:Mt.gradient||void 0,clips:Re.lineClipsArray}),Mt.texture?Mt.texture.update(Mt.gradient):Mt.texture=new o.Texture(oe,Mt.gradient,he.RGBA),Mt.version=f.gradientVersion,It=Mt.texture}oe.activeTexture.set(he.TEXTURE1),It.bind(f.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}U&&(oe.activeTexture.set(he.TEXTURE0),be.lineAtlasTexture.bind(he.LINEAR,he.REPEAT),We.updatePaintBuffers(ie)),ae&&(oe.activeTexture.set(he.TEXTURE0),be.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),We.updatePaintBuffers(ie)),m.prepareDrawProgram(oe,Ke,_e.toUnwrapped());const Jt=Mt=>{Ke.draw(oe,he.TRIANGLES,M,Mt,O,o.CullFaceMode.disabled,Qe,f.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,f.paint,m.transform.zoom,We,Re.layoutVertexBuffer2)};if(Ae){const Mt=m.stencilModeForClipping(_e).ref;Mt===0&&m.terrain&&oe.clear({stencil:0});const It={func:he.EQUAL,mask:255};Qe.u_alpha_discard_threshold=.8,Jt(new o.StencilMode(It,Mt,255,he.KEEP,he.KEEP,he.INVERT)),Qe.u_alpha_discard_threshold=0,Jt(new o.StencilMode(It,Mt,255,he.KEEP,he.KEEP,he.KEEP))}else Jt(m.stencilModeForClipping(_e))}Ae&&(m.resetStencilClippingMasks(),m.terrain&&oe.clear({stencil:0}))},fill:function(m,a,f,y){const b=f.paint.get("fill-color"),T=f.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const M=m.colorModeForRenderPass(),O=f.paint.get("fill-pattern"),L=m.opaquePassEnabledForLayer()&&!O.constantOr(1)&&b.constantOr(o.Color.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===L){const N=m.depthModeForSublayer(1,m.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);Gd(m,a,f,y,N,M,!1)}if(m.renderPass==="translucent"&&f.paint.get("fill-antialias")){const N=m.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);Gd(m,a,f,y,N,M,!0)}},"fill-extrusion":function(m,a,f,y){const b=f.paint.get("fill-extrusion-opacity");if(b!==0&&m.renderPass==="translucent"){const T=new o.DepthMode(m.context.gl.LEQUAL,o.DepthMode.ReadWrite,m.depthRangeFor3D);if(b!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))zu(m,a,f,y,T,o.StencilMode.disabled,o.ColorMode.disabled),zu(m,a,f,y,T,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const M=m.colorModeForRenderPass();zu(m,a,f,y,T,o.StencilMode.disabled,M)}}},hillshade:function(m,a,f,y){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const b=m.context,T=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),M=m.colorModeForRenderPass(),O=m.terrain&&m.terrain.renderingToTexture,[L,N]=m.renderPass!=="translucent"||O?[{},y]:m.stencilConfigForOverlap(y);for(const U of N){const Z=a.getTile(U);if(Z.needsHillshadePrepare&&m.renderPass==="offscreen")Au(m,Z,f,T,o.StencilMode.disabled,M);else if(m.renderPass==="translucent"){const te=O&&m.terrain?m.terrain.stencilModeForRTTOverlap(U):L[U.overscaledZ];um(m,U,Z,f,T,te,M)}}b.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,a,f,y,b,T){if(m.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!y.length)return;const M=m.context,O=M.gl,L=a.getSource(),N=m.useProgram("raster"),U=m.colorModeForRenderPass(),Z=m.terrain&&m.terrain.renderingToTexture,[te,ae]=L instanceof q||Z?[{},y]:m.stencilConfigForOverlap(y),le=ae[ae.length-1].overscaledZ,ie=!m.options.moving;for(const ve of ae){const oe=Z?o.DepthMode.disabled:m.depthModeForSublayer(ve.overscaledZ-le,f.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,O.LESS),he=ve.toUnwrapped(),de=a.getTile(ve);if(Z&&(!de||!de.hasData()))continue;const Ae=Z?ve.projMatrix:m.transform.calculateProjMatrix(he,ie),_e=m.terrain&&Z?m.terrain.stencilModeForRTTOverlap(ve):te[ve.overscaledZ],be=T?0:f.paint.get("raster-fade-duration");de.registerFadeDuration(be);const Re=a.findLoadedParent(ve,0),We=Od(de,Re,a,m.transform,be);let Ke,Ze;m.terrain&&m.terrain.prepareDrawTile();const Ge=f.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;M.activeTexture.set(O.TEXTURE0),de.texture.bind(Ge,O.CLAMP_TO_EDGE),M.activeTexture.set(O.TEXTURE1),Re?(Re.texture.bind(Ge,O.CLAMP_TO_EDGE),Ke=Math.pow(2,Re.tileID.overscaledZ-de.tileID.overscaledZ),Ze=[de.tileID.canonical.x*Ke%1,de.tileID.canonical.y*Ke%1]):de.texture.bind(Ge,O.CLAMP_TO_EDGE);const Se=Dv(Ae,Ze||[0,0],Ke||1,We,f,L instanceof q?L.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(M,N,he),L instanceof q)L.boundsBuffer&&L.boundsSegments&&N.draw(M,O.TRIANGLES,oe,o.StencilMode.disabled,U,o.CullFaceMode.disabled,Se,f.id,L.boundsBuffer,m.quadTriangleIndexBuffer,L.boundsSegments);else{const{tileBoundsBuffer:dt,tileBoundsIndexBuffer:ct,tileBoundsSegments:Rt}=m.getTileBoundsBuffers(de);N.draw(M,O.TRIANGLES,oe,_e,U,o.CullFaceMode.disabled,Se,f.id,dt,ct,Rt)}}m.resetStencilClippingMasks()},background:function(m,a,f,y){const b=f.paint.get("background-color"),T=f.paint.get("background-opacity");if(T===0)return;const M=m.context,O=M.gl,L=m.transform,N=L.tileSize,U=f.paint.get("background-pattern");if(m.isPatternMissing(U))return;const Z=!U&&b.a===1&&T===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==Z)return;const te=o.StencilMode.disabled,ae=m.depthModeForSublayer(0,Z==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),le=m.colorModeForRenderPass(),ie=m.useProgram(U?"backgroundPattern":"background");let ve,oe=y;oe||(ve=m.getBackgroundTiles(),oe=Object.values(ve).map(de=>de.tileID)),U&&(M.activeTexture.set(O.TEXTURE0),m.imageManager.bind(m.context));const he=f.getCrossfadeParameters();for(const de of oe){const Ae=de.toUnwrapped(),_e=y?de.projMatrix:m.transform.calculateProjMatrix(Ae);m.prepareDrawTile();const be=a?a.getTile(de):ve?ve[de.key]:new o.Tile(de,N,L.zoom,m),Re=U?Va(_e,T,m,U,{tileID:de,tileSize:N},he):vm(_e,T,b);m.prepareDrawProgram(M,ie,Ae);const{tileBoundsBuffer:We,tileBoundsIndexBuffer:Ke,tileBoundsSegments:Ze}=m.getTileBoundsBuffers(be);ie.draw(M,O.TRIANGLES,ae,te,le,o.CullFaceMode.disabled,Re,f.id,We,Ke,Ze)}},sky:function(m,a,f){const y=m.transform,b=y.projection.name==="mercator"||y.projection.name==="globe"?1:o.smoothstep(7,8,y.zoom),T=f.paint.get("sky-opacity")*b;if(T===0)return;const M=m.context,O=f.paint.get("sky-type"),L=new o.DepthMode(M.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),N=m.frameCounter/1e3%1;O==="atmosphere"?m.renderPass==="offscreen"?f.needsSkyboxCapture(m)&&(function(U,Z,te,ae){const le=U.context,ie=le.gl;let ve=Z.skyboxFbo;if(!ve){ve=Z.skyboxFbo=le.createFramebuffer(32,32,!1),Z.skyboxGeometry=new Tm(le),Z.skyboxTexture=le.gl.createTexture(),ie.bindTexture(ie.TEXTURE_CUBE_MAP,Z.skyboxTexture),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MAG_FILTER,ie.LINEAR);for(let Ae=0;Ae<6;++Ae)ie.texImage2D(ie.TEXTURE_CUBE_MAP_POSITIVE_X+Ae,0,ie.RGBA,32,32,0,ie.RGBA,ie.UNSIGNED_BYTE,null)}le.bindFramebuffer.set(ve.framebuffer),le.viewport.set([0,0,32,32]);const oe=Z.getCenter(U,!0),he=U.useProgram("skyboxCapture"),de=new Float64Array(16);o.identity(de),o.rotateY(de,de,.5*-Math.PI),Ha(le,Z,he,de,oe,0),o.identity(de),o.rotateY(de,de,.5*Math.PI),Ha(le,Z,he,de,oe,1),o.identity(de),o.rotateX(de,de,.5*-Math.PI),Ha(le,Z,he,de,oe,2),o.identity(de),o.rotateX(de,de,.5*Math.PI),Ha(le,Z,he,de,oe,3),o.identity(de),Ha(le,Z,he,de,oe,4),o.identity(de),o.rotateY(de,de,Math.PI),Ha(le,Z,he,de,oe,5),le.viewport.set([0,0,U.width,U.height])}(m,f),f.markSkyboxValid(m)):m.renderPass==="sky"&&function(U,Z,te,ae,le){const ie=U.context,ve=ie.gl,oe=U.transform,he=U.useProgram("skybox");ie.activeTexture.set(ve.TEXTURE0),ve.bindTexture(ve.TEXTURE_CUBE_MAP,Z.skyboxTexture);const de=((Ae,_e,be,Re,We)=>({u_matrix:Ae,u_sun_direction:_e,u_cubemap:0,u_opacity:Re,u_temporal_offset:We}))(oe.skyboxMatrix,Z.getCenter(U,!1),0,ae,le);U.prepareDrawProgram(ie,he),he.draw(ie,ve.TRIANGLES,te,o.StencilMode.disabled,U.colorModeForRenderPass(),o.CullFaceMode.backCW,de,"skybox",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(m,f,L,T,N):O==="gradient"&&m.renderPass==="sky"&&function(U,Z,te,ae,le){const ie=U.context,ve=ie.gl,oe=U.transform,he=U.useProgram("skyboxGradient");Z.skyboxGeometry||(Z.skyboxGeometry=new Tm(ie)),ie.activeTexture.set(ve.TEXTURE0);let de=Z.colorRampTexture;de||(de=Z.colorRampTexture=new o.Texture(ie,Z.colorRamp,ve.RGBA)),de.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);const Ae=((_e,be,Re,We,Ke)=>({u_matrix:_e,u_color_ramp:0,u_center_direction:be,u_radius:o.degToRad(Re),u_opacity:We,u_temporal_offset:Ke}))(oe.skyboxMatrix,Z.getCenter(U,!1),Z.paint.get("sky-gradient-radius"),ae,le);U.prepareDrawProgram(ie,he),he.draw(ie,ve.TRIANGLES,te,o.StencilMode.disabled,U.colorModeForRenderPass(),o.CullFaceMode.backCW,Ae,"skyboxGradient",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(m,f,L,T,N)},debug:function(m,a,f){for(let y=0;y<f.length;y++)Bu(m,a,f[y])},custom:function(m,a,f){const y=m.context,b=f.implementation;if(m.transform.projection.unsupportedLayers&&m.transform.projection.unsupportedLayers.includes("custom"))o.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(m.renderPass==="offscreen"){const T=b.prerender;T&&(m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),T.call(b,y.gl,m.transform.customLayerMatrix()),y.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),y.setStencilMode(o.StencilMode.disabled);const T=b.renderingMode==="3d"?new o.DepthMode(m.context.gl.LEQUAL,o.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,o.DepthMode.ReadOnly);y.setDepthMode(T),b.render(y.gl,m.transform.customLayerMatrix()),y.setDirty(),m.setBaseState(),y.bindFramebuffer.set(null)}}};class ju{constructor(a,f){this.context=new pe(a),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new am,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(a,f){const y=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Dd(this,a));const b=this._terrain;this.transform.elevation=y?b:null,b.update(a,this.transform,f)}_updateFog(a){const f=a.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,b]=f.getFovAdjustedRange(this.transform._fov);if(y>b)return void(this.transform.fogCullDistSq=null);const T=y+.78*(b-y);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(a,f){if(this.width=a*o.exported.devicePixelRatio,this.height=f*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const a=this.context,f=new o.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(o.EXTENT,0),f.emplaceBack(0,o.EXTENT),f.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(f,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const y=new o.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(o.EXTENT,0),y.emplaceBack(0,o.EXTENT),y.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=a.createVertexBuffer(y,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const b=new o.StructArrayLayout2i4;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(b,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const T=new o.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(o.EXTENT,0,o.EXTENT,0),T.emplaceBack(0,o.EXTENT,0,o.EXTENT),T.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=a.createVertexBuffer(T,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const M=new o.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(M);const O=new o.StructArrayLayout1ui2;for(const N of[0,1,3,2,0])O.emplaceBack(N);this.debugIndexBuffer=a.createIndexBuffer(O),this.emptyTexture=new o.Texture(a,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA),this.identityMat=o.create();const L=this.context.gl;this.stencilClearMode=new o.StencilMode({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new Fv(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const a=this.context,f=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(a,f.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,tc(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,f,y){if(!f||this.currentStencilSource===f.id||!a.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const L of y)if(this._tileClippingMaskIDs[L.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=f.id;const b=this.context,T=b.gl;this.nextStencilID+y.length>256&&this.clearStencil(),b.setColorMode(o.ColorMode.disabled),b.setDepthMode(o.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of y){const L=f.getTile(O),N=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:U,tileBoundsIndexBuffer:Z,tileBoundsSegments:te}=this.getTileBoundsBuffers(L);M.draw(b,T.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:T.ALWAYS,mask:0},N,255,T.KEEP,T.KEEP,T.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,tc(O.projMatrix),"$clipping",U,Z,te)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,f=this.context.gl;return new o.StencilMode({func:f.NOTEQUAL,mask:255},a,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);const f=this.context.gl;return new o.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(a){const f=this.context.gl,y=a.sort((M,O)=>O.overscaledZ-M.overscaledZ),b=y[y.length-1].overscaledZ,T=y[0].overscaledZ-b+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const M={};for(let O=0;O<T;O++)M[O+b]=new o.StencilMode({func:f.GEQUAL,mask:255},O+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=T,[M,y]}return[{[b]:o.StencilMode.disabled},y]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([a.CONSTANT_COLOR,a.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(a,f,y){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new o.DepthMode(y||this.context.gl.LEQUAL,f,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,f){this.style=a,this.options=f,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const y=this.style.order,b=this.style._sourceCaches;for(const L in b){const N=b[L];N.used&&N.prepare(this.context)}const T={},M={},O={};for(const L in b){const N=b[L];T[L]=N.getVisibleCoordinates(),M[L]=T[L].slice().reverse(),O[L]=N.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<y.length;L++)if(this.style._layers[y[L]].is3D()){this.opaquePassCutoff=L;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),o.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const L of y){const N=this.style._layers[L],U=a._getLayerSourceCache(N);if(!N.hasOffscreenPass()||N.isHidden(this.transform.zoom))continue;const Z=U?M[U.id]:void 0;(N.type==="custom"||N.isSky()||Z&&Z.length)&&this.renderLayer(this,U,N,Z)}if(this.depthRangeFor3D=[0,1-(a.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[y[this.currentLayer]],N=a._getLayerSourceCache(L);if(L.isSky())continue;const U=N?M[N.id]:void 0;this._renderTileClippingMasks(L,N,U),this.renderLayer(this,N,L,U)}if(this.style.fog&&this.transform.projection.supportsFog&&function(L,N){const U=L.context,Z=U.gl,te=L.transform,ae=new o.DepthMode(Z.LEQUAL,o.DepthMode.ReadOnly,[0,1]),le=L.useProgram("globeAtmosphere",null,te.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ie=o.globeToMercatorTransition(te.zoom),ve=N.properties.get("color").toArray01(),oe=N.properties.get("high-color").toArray01(),he=N.properties.get("space-color").toArray01PremultipliedAlpha(),de=o.identity$1([]);o.rotateY$1(de,de,-o.degToRad(te._center.lng)),o.rotateX$1(de,de,o.degToRad(te._center.lat)),o.rotateZ$1(de,de,te.angle),o.rotateX$1(de,de,-te._pitch);const Ae=o.fromQuat(new Float32Array(16),de),_e=o.mapValue(N.properties.get("star-intensity"),0,1,0,.25),be=5e-4,Re=o.mapValue(N.properties.get("horizon-blend"),0,1,be,.25),We=o.globeUseCustomAntiAliasing(L,U,te)&&Re===be?te.worldSize/(2*Math.PI*1.025)-1:te.globeRadius,Ke=L.frameCounter/1e3%1,Ze=o.length(te.globeCenterInViewSpace),Ge=Math.sqrt(Math.pow(Ze,2)-Math.pow(We,2)),Se=Math.acos(Ge/Ze),dt=((Rt,Qe,Jt,Mt,It,wt,Pt,cr,tr,_r,Xt,mr,Br,Gr)=>({u_frustum_tl:Rt,u_frustum_tr:Qe,u_frustum_br:Jt,u_frustum_bl:Mt,u_horizon:It,u_transition:wt,u_fadeout_range:Pt,u_color:cr,u_high_color:tr,u_space_color:_r,u_star_intensity:Xt,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:mr,u_horizon_angle:Br,u_rotation_matrix:Gr}))(te.frustumCorners.TL,te.frustumCorners.TR,te.frustumCorners.BR,te.frustumCorners.BL,te.frustumCorners.horizon,ie,Re,ve,oe,he,_e,Ke,Se,Ae);L.prepareDrawProgram(U,le);const ct=L.atmosphereBuffer;ct&&le.draw(U,Z.TRIANGLES,ae,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,dt,"skybox",ct.vertexBuffer,ct.indexBuffer,ct.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const L=this.style._layers[y[this.currentLayer]],N=a._getLayerSourceCache(L);L.isSky()&&this.renderLayer(this,N,L,N?M[N.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const L=this.style._layers[y[this.currentLayer]],N=a._getLayerSourceCache(L);if(L.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(L)){if(L.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const U=N?(L.type==="symbol"?O:M)[N.id]:void 0;this._renderTileClippingMasks(L,N,N?T[N.id]:void 0),this.renderLayer(this,N,L,U),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let L=null;o.values(this.style._layers).forEach(N=>{const U=a._getLayerSourceCache(N);U&&!N.isHidden(this.transform.zoom)&&(!L||L.getSource().maxzoom<U.getSource().maxzoom)&&(L=U)}),L&&this.options.showTileBoundaries&&Nu.debug(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const N=L.transform.padding;Wd(L,L.transform.height-(N.top||0),3,Xo),Wd(L,N.bottom||0,3,sc),Fu(L,N.left||0,3,wm),Fu(L,L.transform.width-(N.right||0),3,Ua);const U=L.transform.centerPoint;(function(Z,te,ae,le){Rr(Z,te-1,ae-10,2,20,le),Rr(Z,te-10,ae-1,20,2,le)})(L,U.x,L.transform.height-U.y,Ga)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}}renderLayer(a,f,y,b){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||b&&b.length)&&(this.id=y.id,this.gpuTimingStart(y),a.transform.projection.unsupportedLayers&&a.transform.projection.unsupportedLayers.includes(y.type)||Nu[y.type](a,f,y,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let y=this.gpuTimers[a.id];y||(y=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),y.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const a=this.context.extTimerQuery,f=a.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),a.beginQueryEXT(a.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){const a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){const f={};for(const y in a){const b=a[y],T=this.context.extTimerQuery,M=T.getQueryObjectEXT(b.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(b.query),f[y]=M}return f}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let y=0;for(const b of a)y+=f.getQueryObjectEXT(b,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(b);return y}translatePosMatrix(a,f,y,b,T){if(!y[0]&&!y[1])return a;const M=T?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(M){const N=Math.sin(M),U=Math.cos(M);y=[y[0]*U-y[1]*N,y[0]*N+y[1]*U]}const O=[T?y[0]:et(f,y[0],this.transform.zoom),T?y[1]:et(f,y[1],this.transform.zoom),0],L=new Float32Array(16);return o.translate(L,a,O),L}saveTileTexture(a){const f=this._tileTextures[a.size[0]];f?f.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const f=this._tileTextures[a];return f&&f.length>0?f.pop():null}isPatternMissing(a){if(!a)return!1;if(!a.from||!a.to)return!0;const f=this.imageManager.getPattern(a.from.toString()),y=this.imageManager.getPattern(a.to.toString());return!f||!y}currentGlobalDefines(){const a=this.terrain&&this.terrain.renderingToTexture,f=this.style&&this.style.fog,y=[];return this.terrain&&!this.terrain.renderingToTexture&&y.push("TERRAIN"),f&&!a&&f.getOpacity(this.transform.pitch)!==0&&y.push("FOG"),a&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(a,f,y){this.cache=this.cache||{};const b=y||[],T=this.currentGlobalDefines().concat(b),M=Ou.cacheKey(a,T,f);return this.cache[M]||(this.cache[M]=new Ou(this.context,a,Tu[a],f,Rv[a],T)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(a,f,y){if(this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const T=b.getOpacity(this.transform.pitch),M=((O,L,N,U,Z,te,ae,le,ie,ve,oe)=>{const he=O.transform,de=L.properties.get("color").toArray01();de[3]=U;const Ae=O.frameCounter/1e3%1;return{u_fog_matrix:N?he.calculateFogTileMatrix(N):O.identityMat,u_fog_range:L.getFovAdjustedRange(he._fov),u_fog_color:de,u_fog_horizon_blend:L.properties.get("horizon-blend"),u_fog_temporal_offset:Ae,u_frustum_tl:Z,u_frustum_tr:te,u_frustum_br:ae,u_frustum_bl:le,u_globe_pos:ie,u_globe_radius:ve,u_viewport:oe,u_globe_transition:o.globeToMercatorTransition(he.zoom),u_is_globe:+(he.projection.name==="globe")}})(this,b,y,T,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);f.setFogUniformValues(a,M)}}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const a=this.context.gl,f=a.createTexture();return a.bindTexture(a.TEXTURE_2D,f),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const a=this.style&&this.style.fog;return!!a&&a.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const a=this._backgroundTiles,f=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const b of y)f[b.key]=a[b.key]||new o.Tile(b,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class Yo{constructor(a=0,f=0,y=0,b=0){if(isNaN(a)||a<0||isNaN(f)||f<0||isNaN(y)||y<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=f,this.left=y,this.right=b}interpolate(a,f,y){return f.top!=null&&a.top!=null&&(this.top=o.number(a.top,f.top,y)),f.bottom!=null&&a.bottom!=null&&(this.bottom=o.number(a.bottom,f.bottom,y)),f.left!=null&&a.left!=null&&(this.left=o.number(a.left,f.left,y)),f.right!=null&&a.right!=null&&(this.right=o.number(a.right,f.right,y)),this}getCenter(a,f){const y=o.clamp((this.left+a-this.right)/2,0,a),b=o.clamp((this.top+f-this.bottom)/2,0,f);return new o.pointGeometry(y,b)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Yo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function $u(m,a){const f=o.getColumn(m,3);o.fromQuat(m,a),o.setColumn(m,3,f)}function oc(m,a){const f=o.identity$1([]);return o.rotateZ$1(f,f,-a),o.rotateX$1(f,f,-m),f}function Vu(m,a){const f=[m[0],m[1],0],y=[a[0],a[1],0];if(o.length(f)>=1e-15){const M=o.normalize([],f);o.scale$2(y,M,o.dot(y,M)),a[0]=y[0],a[1]=y[1]}const b=o.cross([],a,m);if(o.len(b)<1e-15)return null;const T=Math.atan2(-b[1],b[0]);return oc(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),T)}class ac{constructor(a,f){this.position=a,this.orientation=f}get position(){return this._position}set position(a){if(a){const f=a instanceof o.MercatorCoordinate?a:new o.MercatorCoordinate(a[0],a[1],a[2]);this._renderWorldCopies&&(f.x=o.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(a,f){if(this.orientation=null,!this.position)return;const y=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(a)):0,b=this.position,T=o.MercatorCoordinate.fromLngLat(a,y),M=[T.x-b.x,T.y-b.y,T.z-b.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Vu(M,f)}setPitchBearing(a,f){this.orientation=oc(o.degToRad(a),o.degToRad(-f))}}class Wa{constructor(a,f){this._transform=o.identity([]),this.orientation=f,this.position=a}get mercatorPosition(){const a=this.position;return new o.MercatorCoordinate(a[0],a[1],a[2])}get position(){const a=o.getColumn(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var f;a&&o.setColumn(this._transform,3,[(f=a)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||o.identity$1([]),a&&$u(this._transform,this._orientation)}getPitchBearing(){const a=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,f){this._orientation=oc(a,f),$u(this._transform,this._orientation)}forward(){const a=o.getColumn(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){const a=o.getColumn(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){const a=o.getColumn(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,f){const y=new Float64Array(16);return o.invert(y,this.getWorldToCamera(a,f)),y}getWorldToCameraPosition(a,f,y){const b=this.position;o.scale$2(b,b,-a);const T=new Float64Array(16);return o.fromScaling(T,[y,y,y]),o.translate(T,T,b),T[10]*=f,T}getWorldToCamera(a,f){const y=new Float64Array(16),b=new Float64Array(4),T=this.position;return o.conjugate(b,this._orientation),o.scale$2(T,T,-a),o.fromQuat(y,b),o.translate(y,y,T),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=f,y[9]*=f,y[10]*=f,y[11]*=f,y}getCameraToClipPerspective(a,f,y,b){const T=new Float64Array(16);return o.perspective(T,a,f,y,b),T}getDistanceToElevation(a){const f=a===0?0:o.mercatorZfromAltitude(a,this.position[1]),y=this.forward();return(f-this.position[2])/y[2]}clone(){return new Wa([...this.position],[...this.orientation])}}function $t(m,a){const f=lc(m.projection,m.zoom,m.width,m.height),y=function(T,M,O,L,N){const U=new o.LngLat(O.lng-180*Jo,O.lat),Z=new o.LngLat(O.lng+180*Jo,O.lat),te=T.project(U.lng,U.lat),ae=T.project(Z.lng,Z.lat),le=-Math.atan2(ae.y-te.y,ae.x-te.x),ie=o.MercatorCoordinate.fromLngLat(O);ie.y=o.clamp(ie.y,-.999975,.999975);const ve=ie.toLngLat(),oe=T.project(ve.lng,ve.lat),he=o.MercatorCoordinate.fromLngLat(ve);he.x+=Jo;const de=he.toLngLat(),Ae=T.project(de.lng,de.lat),_e=Qo(Ae.x-oe.x,Ae.y-oe.y,le),be=o.MercatorCoordinate.fromLngLat(ve);be.y+=Jo;const Re=be.toLngLat(),We=T.project(Re.lng,Re.lat),Ke=Qo(We.x-oe.x,We.y-oe.y,le),Ze=Math.abs(_e.x)/Math.abs(Ke.y),Ge=o.identity([]);o.rotateZ(Ge,Ge,-le*(1-(N?0:L)));const Se=o.identity([]);return o.scale(Se,Se,[1,1-(1-Ze)*L,1]),Se[4]=-Ke.x/Ke.y*L,o.rotateZ(Se,Se,le),o.multiply(Se,Ge,Se),Se}(m.projection,0,m.center,f,a),b=Xn(m);return o.scale(y,y,[b,b,1]),y}function Xn(m){const a=m.projection,f=lc(m.projection,m.zoom,m.width,m.height),y=Zd(a,m.center),b=Zd(a,o.LngLat.convert(a.center));return Math.pow(2,y*f+(1-f)*b)}function lc(m,a,f,y,b=1/0){const T=m.range;if(!T)return 0;const M=Math.min(b,Math.max(f,y)),O=Math.log(M/1024)/Math.LN2;return o.smoothstep(T[0]+O,T[1]+O,a)}const Jo=1/4e4;function Zd(m,a){const f=o.clamp(a.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),y=new o.LngLat(a.lng-180*Jo,f),b=new o.LngLat(a.lng+180*Jo,f),T=m.project(y.lng,f),M=m.project(b.lng,f),O=o.MercatorCoordinate.fromLngLat(y),L=o.MercatorCoordinate.fromLngLat(b),N=M.x-T.x,U=M.y-T.y,Z=L.x-O.x,te=L.y-O.y,ae=Math.sqrt((Z*Z+te*te)/(N*N+U*U));return Math.log(ae)/Math.LN2}function Qo(m,a,f){const y=Math.cos(f),b=Math.sin(f);return{x:m*y-a*b,y:m*b+a*y}}class Uu{constructor(a,f,y,b,T,M,O){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=a||0,this._maxZoom=f||22,this._minPitch=y==null?0:y,this._maxPitch=b==null?60:b,this.setProjection(M),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Yo,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Wa,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const a=new Uu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(a){const f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(a||f)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const y=!g(f,this.getProjection());return y&&this._calcMatrices(),y}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){const f=-a*Math.PI/180;var y;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(y=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(b,T,M){var O=T[0],L=T[1],N=T[2],U=T[3],Z=Math.sin(M),te=Math.cos(M);b[0]=O*te+N*Z,b[1]=L*te+U*Z,b[2]=O*-Z+N*te,b[3]=L*-Z+U*te}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const f=o.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){const f=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const a=this._elevation;this._centerAltitude=a.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=a.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const a=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let b=0,T=0;for(let M=0;M<f.length;M++){const O=new o.pointGeometry(f[M][0]*this.width,y+f[M][1]*(this.height-y)),L=a.pointCoordinate(O);if(!L)continue;const N=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);b+=L[3]*N,T+=N}return T===0?NaN:b/T}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const a=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*f,b=this._mercatorZfromZoom(a),T=this._mercatorZfromZoom(this._maxZoom),M=Math.max(b-y,T);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude()));let y;y=a.z<this._camera.position[2]?[f.x,f.y,f.z]:[a.x,a.y,a.z];const b=o.length(o.sub([],this._camera.position,y));return o.clamp(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let f=!1;if(a.orientation&&!o.exactEquals(a.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(a.orientation)),a.position){const y=[a.position.x,a.position.y,a.position.z];o.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const a=this._camera.position,f=new ac;return f.position=new o.MercatorCoordinate(a[0],a[1],a[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(a){if(!o.length$1(a))return!1;o.normalize$1(a,a);const f=o.transformQuat([],[0,0,-1],a),y=o.transformQuat([],[0,-1,0],a);if(y[2]<0)return!1;const b=Vu(f,y);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(a){const f=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;a[2]=o.clamp(a[2],b/y,b/f),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,f,y){this._unmodified=!1,this._edgeInsets.interpolate(a,f,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const f=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(a){const f=[new o.UnwrappedTileID(0,a)];if(this.renderWorldCopies){const y=this.pointCoordinate(new o.pointGeometry(0,0)),b=this.pointCoordinate(new o.pointGeometry(this.width,0)),T=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),M=this.pointCoordinate(new o.pointGeometry(0,this.height)),O=Math.floor(Math.min(y.x,b.x,T.x,M.x)),L=Math.floor(Math.max(y.x,b.x,T.x,M.x)),N=1;for(let U=O-N;U<=L+N;U++)U!==0&&f.push(new o.UnwrappedTileID(U,a))}return f}coveringTiles(a){let f=this.coveringZoomLevel(a);const y=f,b=this.elevation&&!a.isTerrainDEM,T=this.projection.name==="mercator";if(a.minzoom!==void 0&&f<a.minzoom)return[];a.maxzoom!==void 0&&f>a.maxzoom&&(f=a.maxzoom);const M=this.locationCoordinate(this.center),O=this.center.lat,L=1<<f,N=[L*M.x,L*M.y,0],U=this.projection.name==="globe",Z=!U,te=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,Z),ae=U?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=L*o.mercatorZfromAltitude(1,this.center.lat),ie=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),ve=[L*ae.x,L*ae.y,ie*(Z?1:le)],oe=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),he=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,de=a.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ae=a.isTerrainDEM?-de:this._elevation?this._elevation.getMinElevationBelowMSL():0,_e=this.projection.isReprojectedInTileSpace?Xn(this):1,be=Qe=>{const Mt=new o.MercatorCoordinate(Qe.x+25e-6,Qe.y,Qe.z),It=new o.MercatorCoordinate(Qe.x,Qe.y+25e-6,Qe.z),wt=Qe.toLngLat(),Pt=Mt.toLngLat(),cr=It.toLngLat(),tr=this.locationCoordinate(wt),_r=this.locationCoordinate(Pt),Xt=this.locationCoordinate(cr),mr=Math.hypot(_r.x-tr.x,_r.y-tr.y),Br=Math.hypot(Xt.x-tr.x,Xt.y-tr.y);return Math.sqrt(mr*Br)*_e/25e-6},Re=Qe=>{const Jt=de,Mt=Ae;return{aabb:o.tileAABB(this,L,0,0,0,Qe,Mt,Jt,this.projection),zoom:0,x:0,y:0,minZ:Mt,maxZ:Jt,wrap:Qe,fullyVisible:!1}},We=[];let Ke=[];const Ze=f,Ge=a.reparseOverscaled?y:f,Se=Qe=>Qe*Qe,dt=Se((ie-this._centerAltitude)*le),ct=Qe=>{if(!this._elevation||!Qe.tileID||!T)return;const Jt=this._elevation.getMinMaxForTile(Qe.tileID),Mt=Qe.aabb;Jt?(Mt.min[2]=Jt.min,Mt.max[2]=Jt.max,Mt.center[2]=(Mt.min[2]+Mt.max[2])/2):(Qe.shouldSplit=Rt(Qe),Qe.shouldSplit||(Mt.min[2]=Mt.max[2]=Mt.center[2]=this._centerAltitude))},Rt=Qe=>{if(Qe.zoom<he)return!0;if(Qe.zoom===Ze)return!1;if(Qe.shouldSplit!=null)return Qe.shouldSplit;const Jt=Qe.aabb.distanceX(ve),Mt=Qe.aabb.distanceY(ve);let It=dt,wt=1;if(U){It=Se(Qe.aabb.distanceZ(ve));const cr=Math.pow(2,Qe.zoom),tr=o.latFromMercatorY((Qe.y+1)/cr),_r=o.latFromMercatorY(Qe.y/cr),Xt=Math.min(Math.max(O,tr),_r),mr=o.circumferenceAtLatitude(Xt)/o.circumferenceAtLatitude(O);if(wt=Xt===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,mr/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&Qe.zoom===Ze-1&&mr>=.9)return!0}else if(b&&(It=Se(Qe.aabb.distanceZ(ve)*le)),this.projection.isReprojectedInTileSpace&&y<=5){const cr=Math.pow(2,Qe.zoom),tr=be(new o.MercatorCoordinate((Qe.x+.5)/cr,(Qe.y+.5)/cr));wt=tr>.85?1:tr}const Pt=Jt*Jt+Mt*Mt+It;return Pt<Se((1<<Ze-Qe.zoom)*oe*wt*((cr,tr)=>{if(tr*Se(.707)<cr)return 1;const _r=Math.sqrt(tr/cr);return _r/(1.4144271570014144+(Math.pow(1.1,_r-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(It,dt),Pt))};if(this.renderWorldCopies)for(let Qe=1;Qe<=3;Qe++)We.push(Re(-Qe)),We.push(Re(Qe));for(We.push(Re(0));We.length>0;){const Qe=We.pop(),Jt=Qe.x,Mt=Qe.y;let It=Qe.fullyVisible;if(!It){const wt=Qe.aabb.intersects(te);if(wt===0)continue;It=wt===2}if(Qe.zoom!==Ze&&Rt(Qe))for(let wt=0;wt<4;wt++){const Pt=(Jt<<1)+wt%2,cr=(Mt<<1)+(wt>>1),tr={aabb:T?Qe.aabb.quadrant(wt):o.tileAABB(this,L,Qe.zoom+1,Pt,cr,Qe.wrap,Qe.minZ,Qe.maxZ,this.projection),zoom:Qe.zoom+1,x:Pt,y:cr,wrap:Qe.wrap,fullyVisible:It,tileID:void 0,shouldSplit:void 0,minZ:Qe.minZ,maxZ:Qe.maxZ};b&&!U&&(tr.tileID=new o.OverscaledTileID(Qe.zoom+1===Ze?Ge:Qe.zoom+1,Qe.wrap,Qe.zoom+1,Pt,cr),ct(tr)),We.push(tr)}else{const wt=Qe.zoom===Ze?Ge:Qe.zoom;if(a.minzoom&&a.minzoom>wt)continue;const Pt=N[0]-(.5+Jt+(Qe.wrap<<Qe.zoom))*(1<<f-Qe.zoom),cr=N[1]-.5-Mt,tr=Qe.tileID?Qe.tileID:new o.OverscaledTileID(wt,Qe.wrap,Qe.zoom,Jt,Mt);Ke.push({tileID:tr,distanceSq:Pt*Pt+cr*cr})}}if(this.fogCullDistSq){const Qe=this.fogCullDistSq,Jt=this.horizonLineFromTop();Ke=Ke.filter(Mt=>{const It=[0,0,0,1],wt=[o.EXTENT,o.EXTENT,0,1],Pt=this.calculateFogTileMatrix(Mt.tileID.toUnwrapped());o.transformMat4$1(It,It,Pt),o.transformMat4$1(wt,wt,Pt);const cr=o.getAABBPointSquareDist(It,wt);if(cr===0)return!0;let tr=!1;const _r=this._elevation;if(_r&&cr>Qe&&Jt!==0){const Xt=this.calculateProjMatrix(Mt.tileID.toUnwrapped());let mr;a.isTerrainDEM||(mr=_r.getMinMaxForTile(Mt.tileID)),mr||(mr={min:Ae,max:de});const Br=o.furthestTileCorner(this.rotation),Gr=[Br[0]*o.EXTENT,Br[1]*o.EXTENT,mr.max];o.transformMat4(Gr,Gr,Xt),tr=(1-Gr[1])*this.height*.5<Jt}return cr<Qe||tr})}return Ke.sort((Qe,Jt)=>Qe.distanceSq-Jt.distanceSq).map(Qe=>Qe.tileID)}resize(a,f){this.width=a,this.height=f,this.pixelsToGLUnits=[2/a,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const f=o.clamp(a.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),y=this.projection.project(a.lng,f);return new o.pointGeometry(y.x*this.worldSize,y.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(a,f){let y,b;const T=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;y=(f.x-T.x)/O,b=(f.y-T.y)/O}else{const O=this.pointCoordinate(f),L=this.pointCoordinate(T);y=O.x-L.x,b=O.y-L.y}const M=this.locationCoordinate(a);this.setLocation(new o.MercatorCoordinate(M.x-y,M.y-b))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a){return this.projection.locationPoint(this,a)}locationPoint3D(a){return this.projection.locationPoint(this,a,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a){return this.coordinateLocation(this.pointCoordinate3D(a))}locationCoordinate(a,f){const y=f?o.mercatorZfromAltitude(f,a.lat):void 0,b=this.projection.project(a.lng,a.lat);return new o.MercatorCoordinate(b.x,b.y,y)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,f){const y=f!=null?f:this._centerAltitude,b=[a.x,a.y,0,1],T=[a.x,a.y,1,1];o.transformMat4$1(b,b,this.pixelMatrixInverse),o.transformMat4$1(T,T,this.pixelMatrixInverse);const M=T[3];o.scale$1(b,b,1/b[3]),o.scale$1(T,T,1/M);const O=b[2],L=T[2];return{p0:b,p1:T,t:O===L?0:(y-O)/(L-O)}}screenPointToMercatorRay(a){const f=[a.x,a.y,0,1],y=[a.x,a.y,1,1];return o.transformMat4$1(f,f,this.pixelMatrixInverse),o.transformMat4$1(y,y,this.pixelMatrixInverse),o.scale$1(f,f,1/f[3]),o.scale$1(y,y,1/y[3]),f[2]=o.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,y[2]=o.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,o.scale$1(f,f,1/this.worldSize),o.scale$1(y,y,1/this.worldSize),new o.Ray([f[0],f[1],f[2]],o.normalize([],o.sub([],y,f)))}rayIntersectionCoordinate(a){const{p0:f,p1:y,t:b}=a,T=o.mercatorZfromAltitude(f[2],this._center.lat),M=o.mercatorZfromAltitude(y[2],this._center.lat);return new o.MercatorCoordinate(o.number(f[0],y[0],b)/this.worldSize,o.number(f[1],y[1],b)/this.worldSize,o.number(T,M,b))}pointCoordinate(a,f=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,f)}pointCoordinate3D(a){if(!this.elevation)return this.pointCoordinate(a);let f=this.projection.pointCoordinate3D(this,a.x,a.y);if(f)return new o.MercatorCoordinate(f[0],f[1],f[2]);let y=0,b=this.horizonLineFromTop();if(a.y>b)return this.pointCoordinate(a);const T=.02*b,M=a.clone();for(let O=0;O<10&&b-y>T;O++){M.y=o.number(y,b,.66);const L=this.projection.pointCoordinate3D(this,M.x,M.y);L?(b=M.y,f=L):y=M.y}return f?new o.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}_coordinatePoint(a,f){const y=f&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,b=[a.x*this.worldSize,a.y*this.worldSize,y+a.toAltitude(),1];return o.transformMat4$1(b,b,this.pixelMatrix),b[3]>0?new o.pointGeometry(b[0]/b[3],b[1]/b[3]):new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(a,f){const y=new o.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),b=new o.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),T=new o.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),M=new o.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let O=this.pointCoordinate(y,a),L=this.pointCoordinate(b,a);const N=this.pointCoordinate(T,f),U=this.pointCoordinate(M,f),Z=(te,ae)=>(ae.y-te.y)/(ae.x-te.x);return O.y>1&&L.y>=0?O=new o.MercatorCoordinate((1-U.y)/Z(U,O)+U.x,1):O.y<0&&L.y<=1&&(O=new o.MercatorCoordinate(-U.y/Z(U,O)+U.x,0)),L.y>1&&O.y>=0?L=new o.MercatorCoordinate((1-N.y)/Z(N,L)+N.x,1):L.y<0&&O.y<=1&&(L=new o.MercatorCoordinate(-N.y/Z(N,L)+N.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(O)).extend(this.coordinateLocation(L)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(N))}_getBounds3D(){const a=this.elevation;if(!a.visibleDemTiles.length)return this._getBounds(0,0);const f=a.visibleDemTiles.reduce((y,b)=>{if(b.dem){const T=b.dem.tree;y.min=Math.min(y.min,T.minimums[0]),y.max=Math.max(y.max,T.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBounds(f.min*a.exaggeration(),f.max*a.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(a=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-f*(1-this._horizonShift);return a?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,f){return this.projection.createTileMatrix(this,f,a)}calculateDistanceTileData(a){const f=a.key,y=this._distanceTileDataCache;if(y[f])return y[f];const b=a.canonical,T=1/this.height,M=this.cameraWorldSize/this.zoomScale(b.z),O=(b.x+Math.pow(2,b.z)*a.wrap)*M,L=b.y*M,N=this.point,U=this.angle,Z=Math.sin(-U),te=-Math.cos(-U);return y[f]={bearing:[Z,te],center:[(N.x-O)*T,(N.y-L)*T],scale:M/o.EXTENT*T},y[f]}calculateFogTileMatrix(a){const f=a.key,y=this._fogTileMatrixCache;if(y[f])return y[f];const b=this.projection.createTileMatrix(this,this.cameraWorldSize,a);return o.multiply(b,this.worldToFogMatrix,b),y[f]=new Float32Array(b),y[f]}calculateProjMatrix(a,f=!1){const y=a.key,b=f?this._alignedProjMatrixCache:this._projMatrixCache;if(b[y])return b[y];const T=this.calculatePosMatrix(a,this.worldSize);return o.multiply(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,T),b[y]=new Float32Array(T),b[y]}calculatePixelsToTileUnitsMatrix(a){const f=a.tileID.key,y=this._pixelsToTileUnitsCache;if(y[f])return y[f];const b=function(T,M){const{scale:O}=T.tileTransform,L=O*o.EXTENT/(T.tileSize*Math.pow(2,M.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return N=new Float32Array(4),te=(U=M.inverseAdjustmentMatrix)[1],ae=U[2],le=U[3],ve=(Z=[L,L])[1],N[0]=U[0]*(ie=Z[0]),N[1]=te*ie,N[2]=ae*ve,N[3]=le*ve,N;var N,U,Z,te,ae,le,ie,ve}(a,this);return y[f]=b,y[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const a=this._elevation;this._updateCameraState();const f=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),b=this._camera.forward(),T=o.mercatorZfromAltitude(1,this._center.lat);y[2]/=T,b[2]/=T,o.normalize(b,b);const M=a.raycast(y,b,a.exaggeration());if(M){const O=o.scaleAndAdd([],y,b,M),L=new o.MercatorCoordinate(O[0],O[1],o.mercatorZfromAltitude(O[2],o.latFromMercatorY(O[1]))),N=(L.z+o.length([L.x-y[0],L.y-y[1],L.z-y[2]*T]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(N),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const a=this._elevation;this._updateCameraState();const f=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),b=a.getAtPointOrZero(new o.MercatorCoordinate(...y)),T=this._minimumHeightOverTerrain()*Math.cos(o.degToRad(this._maxPitch)),M=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*b;if(M<T){const O=this.locationCoordinate(this._center,this._centerAltitude),L=[O.x-y[0],O.y-y[1],O.z-y[2]],N=o.length(L);L[2]-=(T-M)/this._projectionScaler;const U=o.length(L);if(U===0)return;o.scale$2(L,L,N/U*this._projectionScaler),this._camera.position=[O.x-L[0],O.y-L[1],O.z*this._projectionScaler-L[2]],this._camera.orientation=Vu(L,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const Z=this.center;return Z.lat=o.clamp(Z.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(Z.lng=o.clamp(Z.lng,this.minLng,this.maxLng)),this.center=Z,void(this._constraining=!1)}const a=this._unmodified,{x:f,y}=this.point;let b=0,T=f,M=y;const O=this.width/2,L=this.height/2,N=this.worldMinY*this.scale,U=this.worldMaxY*this.scale;if(y-L<N&&(M=N+L),y+L>U&&(M=U-L),U-N<this.height&&(b=Math.max(b,this.height/(U-N)),M=(U+N)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Z=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,ae=this.worldSize/2-(Z+te)/2;T=(f+ae+this.worldSize)%this.worldSize-ae,T-O<Z&&(T=Z+O),T+O>te&&(T=te-O),te-Z<this.width&&(b=Math.max(b,this.width/(te-Z)),T=(te+Z)/2)}T===f&&M===y||(this.center=this.unproject(new o.pointGeometry(T,M))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCameraAltitude(),this._unmodified=a,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,f=this.pixelsPerMeter;if(this.projection.name==="globe"){const _e=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,be=o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE)*this.worldSize;this._mercatorScaleRatio=_e/be}const y=lc(this.projection,this.zoom,this.width,this.height,1024);this._projectionScaler=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=this.getCameraToCenterDistance(this.projection),this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?f:1),T=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);T[8]=2*-a.x/this.width,T[9]=2*a.y/this.height;let M=o.mul([],T,b);if(this.projection.isReprojectedInTileSpace){const _e=this.locationCoordinate(this.center),be=o.identity([]);o.translate(be,be,[_e.x*this.worldSize,_e.y*this.worldSize,0]),o.multiply(be,be,$t(this)),o.translate(be,be,[-_e.x*this.worldSize,-_e.y*this.worldSize,0]),o.multiply(M,M,be),this.inverseAdjustmentMatrix=function(Re){const We=$t(Re,!0);return we([],[We[0],We[1],We[4],We[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],M,[this.worldSize,this.worldSize,this.worldSize/f,1]),this.projMatrix=M,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const O=o.invert([],T);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(O,this.horizonLineFromTop(),this.height);const L=new Float32Array(16);o.identity(L),o.scale(L,L,[1,-1,1]),o.rotateX(L,L,this._pitch),o.rotateZ(L,L,this.angle);const N=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),U=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;N[8]=2*-a.x/this.width,N[9]=2*(a.y+U)/this.height,this.skyboxMatrix=o.multiply(L,N,L);const Z=this.point,te=Z.x,ae=Z.y,le=this.width%2/2,ie=this.height%2/2,ve=Math.cos(this.angle),oe=Math.sin(this.angle),he=te-Math.round(te)+ve*le+oe*ie,de=ae-Math.round(ae)+ve*ie+oe*le,Ae=new Float64Array(M);if(o.translate(Ae,Ae,[he>.5?he-1:he,de>.5?de-1:de,0]),this.alignedProjMatrix=Ae,M=o.create(),o.scale(M,M,[this.width/2,-this.height/2,1]),o.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=o.create(),o.scale(M,M,[1,-1,1]),o.translate(M,M,[-1,-1,0]),o.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},M=o.invert(new Float64Array(16),this.pixelMatrix),!M)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=M,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const _e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(_e,_e,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=M;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const a=this.cameraWorldSize,f=this.cameraPixelsPerMeter,y=this._camera.position,b=1/this.height/this._projectionScaler,T=[a,a,f];o.scale$2(T,T,b),o.scale$2(y,y,-1),o.multiply$2(y,y,T);const M=o.create();o.translate(M,M,y),o.scale(M,M,T),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,f,b)}_computeCameraPosition(a){const f=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),b=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-a/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-y[0]*T,b.y/this.worldSize-y[1]*T,a/this.worldSize*this._centerAltitude-y[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=a[2];let b=1;y>0&&(b=Math.min((f-this._camera.position[2])/y,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,a,b),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const a=this._camera.position,f=this._camera.forward(),{pitch:y,bearing:b}=this._camera.getPitchBearing(),T=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),O=Math.max((a[2]-T)/Math.cos(y),M),L=this._zoomFromMercatorZ(O);o.scaleAndAdd(a,a,f,O),this._pitch=o.clamp(y,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(b,-Math.PI,Math.PI),this._setZoom(o.clamp(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){const a=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(a*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,f){const y=Math.min(a.x,f.x),b=Math.max(a.x,f.x),T=Math.min(a.y,f.y),M=Math.max(a.y,f.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new o.pointGeometry(y,T),new o.pointGeometry(b,M),new o.pointGeometry(y,M),new o.pointGeometry(b,T)],L=this.renderWorldCopies?-3:0,N=this.renderWorldCopies?4:1;for(const U of O){const Z=this.pointRayIntersection(U);if(Z.t<0)return!0;const te=this.rayIntersectionCoordinate(Z);if(te.x<L||te.y<0||te.x>N||te.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.pointGeometry(0,0),new o.pointGeometry(this.width,this.height))}zoomDeltaToMovement(a,f){const y=o.length(o.sub([],this._camera.position,a)),b=this._zoomFromMercatorZ(y)+f;return y-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const a=function(f,y){const b=[f[0],f[1],f[2],1];o.transformMat4$1(b,b,y);const T=Math.max(b[3],1e-6);return[b[0]/T,b[1]/T,b[2]/T,T]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.pointGeometry(a[0],a[1])}{const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,a))}}getCameraToCenterDistance(a){const f=lc(a,this.zoom,this.width,this.height,1024),y=a.pixelSpaceConversion(this.center.lat,this.worldSize,f);return .5/Math.tan(.5*this._fov)*this.height*y}}function cc(m,a){let f=!1,y=null;const b=()=>{y=null,f&&(m(),y=setTimeout(b,a),f=!1)};return()=>(f=!0,y||b(),y)}class qd{constructor(a){this._hashName=a&&encodeURIComponent(a),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=cc(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,o.window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(a){const f=this._map;if(!f)return"";const y=f.getCenter(),b=Math.round(100*f.getZoom())/100,T=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,T),O=Math.round(y.lng*M)/M,L=Math.round(y.lat*M)/M,N=f.getBearing(),U=f.getPitch();let Z="";if(Z+=a?`/${O}/${L}/${b}`:`${b}/${L}/${O}`,(N||U)&&(Z+="/"+Math.round(10*N)/10),U&&(Z+=`/${Math.round(U)}`),this._hashName){const te=this._hashName;let ae=!1;const le=o.window.location.hash.slice(1).split("&").map(ie=>{const ve=ie.split("=")[0];return ve===te?(ae=!0,`${ve}=${Z}`):ie}).filter(ie=>ie);return ae||le.push(`${te}=${Z}`),`#${le.join("&")}`}return`#${Z}`}_getCurrentHash(){const a=o.window.location.hash.replace("#","");if(this._hashName){let f;return a.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._map;if(!a)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(y=>isNaN(y))){const y=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(f[3]||0):a.getBearing();return a.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:y,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const a=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,a)}}const ea={linearity:.3,easing:o.bezier(0,0,.3,1)},Am=o.extend({deceleration:2500,maxSpeed:1400},ea),Pm=o.extend({deceleration:20,maxSpeed:1400},ea),Za=o.extend({deceleration:1e3,maxSpeed:360},ea),Bv=o.extend({deceleration:1e3,maxSpeed:90},ea);class Nv{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,f=o.exported.now();for(;a.length>0&&f-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)f.zoom+=T.zoomDelta||0,f.bearing+=T.bearingDelta||0,f.pitch+=T.pitchDelta||0,T.panDelta&&f.pan._add(T.panDelta),T.around&&(f.around=T.around),T.pinchAround&&(f.pinchAround=T.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(f.pan.mag()){const T=ta(f.pan.mag(),y,o.extend({},Am,a||{}));b.offset=f.pan.mult(T.amount/f.pan.mag()),b.center=this._map.transform.center,uc(b,T)}if(f.zoom){const T=ta(f.zoom,y,Pm);b.zoom=this._map.transform.zoom+T.amount,uc(b,T)}if(f.bearing){const T=ta(f.bearing,y,Za);b.bearing=this._map.transform.bearing+o.clamp(T.amount,-179,179),uc(b,T)}if(f.pitch){const T=ta(f.pitch,y,Bv);b.pitch=this._map.transform.pitch+T.amount,uc(b,T)}if(b.zoom||b.bearing){const T=f.pinchAround===void 0?f.around:f.pinchAround;b.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function uc(m,a){(!m.duration||m.duration<a.duration)&&(m.duration=a.duration,m.easing=a.easing)}function ta(m,a,f){const{maxSpeed:y,linearity:b,deceleration:T}=f,M=o.clamp(m*b/(a/1e3),-y,y),O=Math.abs(M)/(T*b);return{easing:f.easing,duration:1e3*O,amount:M*(O/2)}}class fn extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,f,y,b={}){const T=X(f.getCanvasContainer(),y),M=f.unproject(T);super(a,o.extend({point:T,lngLat:M,originalEvent:y},b)),this._defaultPrevented=!1,this.target=f}}class hc extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,f,y){const b=a==="touchend"?y.changedTouches:y.touches,T=re(f.getCanvasContainer(),b),M=T.map(L=>f.unproject(L)),O=T.reduce((L,N,U,Z)=>L.add(N.div(Z.length)),new o.pointGeometry(0,0));super(a,{points:T,point:O,lngLats:M,lngLat:f.unproject(O),originalEvent:y}),this._defaultPrevented=!1}}class Cm extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,f,y){super(a,{originalEvent:y}),this._defaultPrevented=!1}}class Gu{constructor(a,f){this._map=a,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new Cm(a.type,this._map,a))}mousedown(a,f){return this._mousedownPos=f,this._firePreventable(new fn(a.type,this._map,a))}mouseup(a){this._map.fire(new fn(a.type,this._map,a))}preclick(a){const f=o.extend({},a);f.type="preclick",this._map.fire(new fn(f.type,this._map,f))}click(a,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(a),this._map.fire(new fn(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new fn(a.type,this._map,a))}mouseover(a){this._map.fire(new fn(a.type,this._map,a))}mouseout(a){this._map.fire(new fn(a.type,this._map,a))}touchstart(a){return this._firePreventable(new hc(a.type,this._map,a))}touchmove(a){this._map.fire(new hc(a.type,this._map,a))}touchend(a){this._map.fire(new hc(a.type,this._map,a))}touchcancel(a){this._map.fire(new hc(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Kd{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new fn(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new fn(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Im{constructor(a,f){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,f){this.isEnabled()&&a.shiftKey&&a.button===0&&($(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(a,f){if(!this._active)return;const y=f;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;const b=this._startPos;this._lastPos=y,this._box||(this._box=P("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const T=Math.min(b.x,y.x),M=Math.max(b.x,y.x),O=Math.min(b.y,y.y),L=Math.max(b.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${O}px)`,this._box.style.width=M-T+"px",this._box.style.height=L-O+"px")})}mouseupWindow(a,f){if(!this._active||a.button!==0)return;const y=this._startPos,b=f;if(this.reset(),K(),y.x!==b.x||y.y!==b.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:T=>T.fitScreenCoordinates(y,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),j(),delete this._startPos,delete this._lastPos}_fireEvent(a,f){return this._map.fire(new o.Event(a,{originalEvent:f}))}}function Hu(m,a){const f={};for(let y=0;y<m.length;y++)f[m[y].identifier]=a[y];return f}class Mm{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,f,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=a.timeStamp),y.length===this.numTouches&&(this.centroid=function(b){const T=new o.pointGeometry(0,0);for(const M of b)T._add(M);return T.div(b.length)}(f),this.touches=Hu(y,f)))}touchmove(a,f,y){if(this.aborted||!this.centroid)return;const b=Hu(y,f);for(const T in this.touches){const M=this.touches[T],O=b[T];(!O||O.dist(M)>30)&&(this.aborted=!0)}}touchend(a,f,y){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Wu{constructor(a){this.singleTap=new Mm(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,f,y){this.singleTap.touchstart(a,f,y)}touchmove(a,f,y){this.singleTap.touchmove(a,f,y)}touchend(a,f,y){const b=this.singleTap.touchend(a,f,y);if(b){const T=a.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(b)<30;if(T&&M||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Om{constructor(){this._zoomIn=new Wu({numTouches:1,numTaps:2}),this._zoomOut=new Wu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,f,y){this._zoomIn.touchstart(a,f,y),this._zoomOut.touchstart(a,f,y)}touchmove(a,f,y){this._zoomIn.touchmove(a,f,y),this._zoomOut.touchmove(a,f,y)}touchend(a,f,y){const b=this._zoomIn.touchend(a,f,y),T=this._zoomOut.touchend(a,f,y);return b?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(b)},{originalEvent:a})}):T?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(T)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const qa={0:1,2:2};class Zu{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,f){return!1}_move(a,f){return{}}mousedown(a,f){if(this._lastPoint)return;const y=ue(a);this._correctButton(a,y)&&(this._lastPoint=f,this._eventButton=y)}mousemoveWindow(a,f){const y=this._lastPoint;if(y){if(a.preventDefault(),this._eventButton!=null&&function(b,T){const M=qa[T];return b.buttons===void 0||(b.buttons&M)!==M}(a,this._eventButton))this.reset();else if(this._moved||!(f.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(y,f)}}mouseupWindow(a){this._lastPoint&&ue(a)===this._eventButton&&(this._moved&&K(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dm extends Zu{mousedown(a,f){super.mousedown(a,f),this._lastPoint&&(this._active=!0)}_correctButton(a,f){return f===0&&!a.ctrlKey}_move(a,f){return{around:f,panDelta:f.sub(a)}}}class Xd extends Zu{_correctButton(a,f){return f===0&&a.ctrlKey||f===2}_move(a,f){const y=.8*(f.x-a.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(a){a.preventDefault()}}class Yd extends Zu{_correctButton(a,f){return f===0&&a.ctrlKey||f===2}_move(a,f){const y=-.5*(f.y-a.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(a){a.preventDefault()}}class Rm{constructor(a,f){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0)}touchstart(a,f,y){return this._calculateTransform(a,f,y)}touchmove(a,f,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.preventDefault(),this._calculateTransform(a,f,y)}}touchend(a,f,y){this._calculateTransform(a,f,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,f,y){y.length>0&&(this._active=!0);const b=Hu(y,f),T=new o.pointGeometry(0,0),M=new o.pointGeometry(0,0);let O=0;for(const N in b){const U=b[N],Z=this._touches[N];Z&&(T._add(U),M._add(U.sub(Z)),O++,b[N]=U)}if(this._touches=b,O<this._minTouches||!M.mag())return;const L=M.div(O);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(O),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class qu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,f,y){return{}}touchstart(a,f,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([f[0],f[1]]))}touchmove(a,f,y){const b=this._firstTwoTouches;if(!b)return;a.preventDefault();const[T,M]=b,O=Ui(y,f,T),L=Ui(y,f,M);if(!O||!L)return;const N=this._aroundCenter?null:O.add(L).div(2);return this._move([O,L],N,a)}touchend(a,f,y){if(!this._firstTwoTouches)return;const[b,T]=this._firstTwoTouches,M=Ui(y,f,b),O=Ui(y,f,T);M&&O||(this._active&&K(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ui(m,a,f){for(let y=0;y<m.length;y++)if(m[y].identifier===f)return a[y]}function Lm(m,a){return Math.log(m/a)/Math.LN2}class km extends qu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,f){const y=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Lm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Lm(this._distance,y),pinchAround:f}}}function zm(m,a){return 180*m.angleWith(a)/Math.PI}class jv extends qu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,f){const y=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zm(this._vector,y),pinchAround:f}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const f=25/(Math.PI*this._minDiameter)*360,y=zm(a,this._startVector);return Math.abs(y)<f}}function ds(m){return Math.abs(m.y)>Math.abs(m.x)}class Fm extends qu{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,ds(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,f,y){const b=this._lastPoints;if(!b)return;const T=a[0].sub(b[0]),M=a[1].sub(b[1]);return this._map._cooperativeGestures&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(T,M,y.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(T.y+M.y)/2*-.5})}gestureBeginsVertically(a,f,y){if(this._valid!==void 0)return this._valid;const b=a.mag()>=2,T=f.mag()>=2;if(!b&&!T)return;if(!b||!T)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const M=a.y>0==f.y>0;return ds(a)&&ds(f)&&M}}const Ka={panStep:100,bearingStep:15,pitchStep:10};class Os{constructor(){const a=Ka;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let f=0,y=0,b=0,T=0,M=0;switch(a.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:a.shiftKey?y=-1:(a.preventDefault(),T=-1);break;case 39:a.shiftKey?y=1:(a.preventDefault(),T=1);break;case 38:a.shiftKey?b=1:(a.preventDefault(),M=-1);break;case 40:a.shiftKey?b=-1:(a.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(y=0,b=0),{cameraAnimation:O=>{const L=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:Ku,zoom:f?Math.round(L)+f*(a.shiftKey?2:1):L,bearing:O.getBearing()+y*this._bearingStep,pitch:O.getPitch()+b*this._pitchStep,offset:[-T*this._panStep,-M*this._panStep],center:O.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ku(m){return m*(2-m)}const Vt=4.000244140625;class Bm{constructor(a,f){this._map=a,this._el=a.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=a.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const y=o.exported.now(),b=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,f!==0&&f%Vt==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(b*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),a.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=a,this._delta-=f,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=X(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform,f=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(this._delta!==0){const L=this._type==="wheel"&&Math.abs(this._delta)>Vt?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&N!==0&&(N=1/N);const U=f(),Z=Math.pow(2,U),te=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):Z;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(te*N))),this._type==="wheel"&&(this._startZoom=f(),this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:f(),b=this._startZoom,T=this._easing;let M,O=!1;if(this._type==="wheel"&&b&&T){const L=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),N=T(L);M=o.number(b,y,N),L<1?this._frameId||(this._frameId=!0):O=!0}else M=y,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:M-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let f=o.ease;if(this._prevEase){const y=this._prevEase,b=(o.exported.now()-y.start)/y.duration,T=y.easing(b+.01)-y.easing(b),M=.27/Math.sqrt(T*T+1e-4)*.01,O=Math.sqrt(.0729-M*M);f=o.bezier(M,O,.25,1)}return this._prevEase={start:o.exported.now(),duration:a,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!o.window.document.fullscreenElement||!!o.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Nm{constructor(a,f){this._clickZoom=a,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class dc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,f){return a.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(a.shiftKey?-1:1),around:y.unproject(f)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fc{constructor(){this._tap=new Wu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,f,y){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=f[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(a,f,y))}touchmove(a,f,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const b=f[0],T=b.y-this._swipePoint.y;return this._swipePoint=b,a.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(a,f,y)}touchend(a,f,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(a,f,y)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jm{constructor(a,f,y){this._el=a,this._mousePan=f,this._touchPan=y}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $m{constructor(a,f,y){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=f,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Vm{constructor(a,f,y,b){this._el=a,this._touchZoom=f,this._touchRotate=y,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const pc=m=>m.zoom||m.drag||m.pitch||m.rotate;class Um extends o.Event{}class Gm{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,f){const y=o.sub([],f,a);this.radius=o.length(y[2]<0?o.div([],y,this.constants):[y[0],y[1],0])}projectRay(a){o.div(a,a,this.constants),o.normalize(a,a),o.mul$1(a,a,this.constants);const f=o.scale$2([],a,this.radius);if(f[2]>0){const y=o.scale$2([],[0,0,1],o.dot(f,[0,0,1])),b=o.scale$2([],o.normalize([],[f[0],f[1],0]),this.radius),T=o.add([],f,o.scale$2([],o.sub([],o.add([],b,y),f),2));f[0]=T[0],f[1]=T[1]}return f}}function mc(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Xu{constructor(a,f){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Nv(a),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Gm,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),o.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[b,T,M]of this._listeners)b.addEventListener(T,b===o.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[a,f,y]of this._listeners)a.removeEventListener(f,a===o.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(a){const f=this._map,y=f.getCanvasContainer();this._add("mapEvent",new Gu(f,a));const b=f.boxZoom=new Im(f,a);this._add("boxZoom",b);const T=new Om,M=new dc;f.doubleClickZoom=new Nm(M,T),this._add("tapZoom",T),this._add("clickZoom",M);const O=new fc;this._add("tapDragZoom",O);const L=f.touchPitch=new Fm(f);this._add("touchPitch",L);const N=new Xd(a),U=new Yd(a);f.dragRotate=new $m(a,N,U),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]);const Z=new Dm(a),te=new Rm(f,a);f.dragPan=new jm(y,Z,te),this._add("mousePan",Z),this._add("touchPan",te,["touchZoom","touchRotate"]);const ae=new jv,le=new km;f.touchZoomRotate=new Vm(y,le,ae,O),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Kd(f));const ie=f.scrollZoom=new Bm(f,this);this._add("scrollZoom",ie,["mousePan"]);const ve=f.keyboard=new Os;this._add("keyboard",ve);for(const oe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[oe]&&f[oe].enable(a[oe])}_add(a,f,y){this._handlers.push({handlerName:a,handler:f,allowed:y}),this._handlersById[a]=f}stop(a){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pc(this._eventsInProgress)||this.isZooming()}_blockedByActive(a,f,y){for(const b in a)if(b!==y&&(!f||f.indexOf(b)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const f=[];for(const y of a)this._el.contains(y.target)&&f.push(y);return f}handleEvent(a,f){this._updatingCamera=!0;const y=a.type==="renderFrame",b=y?void 0:a,T={needsRenderFrame:!1},M={},O={},L=a.touches?this._getMapTouches(a.touches):void 0,N=L?re(this._el,L):y?void 0:X(this._el,a);for(const{handlerName:te,handler:ae,allowed:le}of this._handlers){if(!ae.isEnabled())continue;let ie;this._blockedByActive(O,le,te)?ae.reset():ae[f||a.type]&&(ie=ae[f||a.type](a,N,L),this.mergeHandlerResult(T,M,ie,te,b),ie&&ie.needsRenderFrame&&this._triggerRenderFrame()),(ie||ae.isActive())&&(O[te]=ae)}const U={};for(const te in this._previousActiveHandlers)O[te]||(U[te]=b);this._previousActiveHandlers=O,(Object.keys(U).length||mc(T))&&(this._changes.push([T,M,U]),this._triggerRenderFrame()),(Object.keys(O).length||mc(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=T;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(a,f,y,b,T){if(!y)return;o.extend(a,y);const M={handlerName:b,originalEvent:y.originalEvent||T};y.zoomDelta!==void 0&&(f.zoom=M),y.panDelta!==void 0&&(f.drag=M),y.pitchDelta!==void 0&&(f.pitch=M),y.bearingDelta!==void 0&&(f.rotate=M)}_applyChanges(){const a={},f={},y={};for(const[b,T,M]of this._changes)b.panDelta&&(a.panDelta=(a.panDelta||new o.pointGeometry(0,0))._add(b.panDelta)),b.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(a.around=b.around),b.aroundCoord!==void 0&&(a.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(a.pinchAround=b.pinchAround),b.noInertia&&(a.noInertia=b.noInertia),o.extend(f,T),o.extend(y,M);this._updateMapTransform(a,f,y),this._changes=[]}_updateMapTransform(a,f,y){const b=this._map,T=b.transform,M=he=>[he.x,he.y,he.z];if((he=>{const de=this._eventsInProgress.drag;return de&&!this._handlersById[de.handlerName].isActive()})()&&!mc(a)){const he=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",he!==T.zoom&&this._map._update(!0)}if(!mc(a))return void this._fireEvents(f,y,!0);let{panDelta:O,zoomDelta:L,bearingDelta:N,pitchDelta:U,around:Z,aroundCoord:te,pinchAround:ae}=a;ae!==void 0&&(Z=ae),(he=>f.drag&&!this._eventsInProgress.drag)()&&Z&&(this._dragOrigin=M(T.pointCoordinate3D(Z)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",b._stop(!0),Z=Z||b.transform.centerPoint,N&&(T.bearing+=N),U&&(T.pitch+=U),T._updateCameraState();const le=[0,0,0];if(O){const he=T.pointCoordinate(Z);if(T.projection.name==="globe"){const de=o.latFromMercatorY(he.y),Ae=T.center.lat,_e=Math.min(o.mercatorZfromAltitude(1,de)/o.mercatorZfromAltitude(1,Ae),2);O=O.rotate(-T.angle),le[0]=-O.x/T.worldSize*_e,le[1]=-O.y/T.worldSize*_e}else{const de=T.pointCoordinate(Z.sub(O));he&&de&&(le[0]=de.x-he.x,le[1]=de.y-he.y)}}const ie=T.zoom,ve=[0,0,0];if(L){const he=M(te||T.pointCoordinate3D(Z)),de={dir:o.normalize([],o.sub([],he,T._camera.position))};if(de.dir[2]<0){const Ae=T.zoomDeltaToMovement(he,L);o.scale$2(ve,de.dir,Ae)}}const oe=o.add(le,le,ve);T._translateCameraConstrained(oe),L&&Math.abs(T.zoom-ie)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(f,y,!0)}_fireEvents(a,f,y){const b=pc(this._eventsInProgress),T=pc(a),M={};for(const U in a){const{originalEvent:Z}=a[U];this._eventsInProgress[U]||(M[`${U}start`]=Z),this._eventsInProgress[U]=a[U]}!b&&T&&this._fireEvent("movestart",T.originalEvent);for(const U in M)this._fireEvent(U,M[U]);T&&this._fireEvent("move",T.originalEvent);for(const U in a){const{originalEvent:Z}=a[U];this._fireEvent(U,Z)}const O={};let L;for(const U in this._eventsInProgress){const{handlerName:Z,originalEvent:te}=this._eventsInProgress[U];this._handlersById[Z].isActive()||(delete this._eventsInProgress[U],L=f[Z]||te,O[`${U}end`]=L)}for(const U in O)this._fireEvent(U,O[U]);const N=pc(this._eventsInProgress);if(y&&(b||T)&&!N){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=te=>te!==0&&-this._bearingSnap<te&&te<this._bearingSnap;U?(Z(U.bearing||this._map.getBearing())&&(U.bearing=0),this._map.easeTo(U,{originalEvent:L})):(this._map.fire(new o.Event("moveend",{originalEvent:L})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,f){this._map.fire(new o.Event(a,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{this._frameId=void 0,this.handleEvent(new Um("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Yu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ju extends o.Evented{constructor(a,f){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=f.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,f){return this.jumpTo({center:a},f)}panBy(a,f,y){return a=o.pointGeometry.convert(a).mult(-1),this.panTo(this.transform.center,o.extend({offset:a},f),y)}panTo(a,f,y){return this.easeTo(o.extend({center:a},f),y)}getZoom(){return this.transform.zoom}setZoom(a,f){return this.jumpTo({zoom:a},f),this}zoomTo(a,f,y){return this.easeTo(o.extend({zoom:a},f),y)}zoomIn(a,f){return this.zoomTo(this.getZoom()+1,a,f),this}zoomOut(a,f){return this.zoomTo(this.getZoom()-1,a,f),this}getBearing(){return this.transform.bearing}setBearing(a,f){return this.jumpTo({bearing:a},f),this}getPadding(){return this.transform.padding}setPadding(a,f){return this.jumpTo({padding:a},f),this}rotateTo(a,f,y){return this.easeTo(o.extend({bearing:a},f),y)}resetNorth(a,f){return this.rotateTo(0,o.extend({duration:1e3},a),f),this}resetNorthPitch(a,f){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},a),f),this}snapToNorth(a,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,f):this}getPitch(){return this.transform.pitch}setPitch(a,f){return this.jumpTo({pitch:a},f),this}cameraForBounds(a,f){this.transform.projection.name==="globe"&&o.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),a=o.LngLatBounds.convert(a);const y=f&&f.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),y,f)}_extendCameraOptions(a){const f={top:0,bottom:0,right:0,left:0};if(typeof(a=o.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding=="number"){const y=a.padding;a.padding={top:y,bottom:y,right:y,left:y}}return a.padding=o.extend(f,a.padding),a}_cameraForBoxAndBearing(a,f,y,b){const T=this._extendCameraOptions(b),M=this.transform,O=M.padding,L=M.project(o.LngLat.convert(a)),N=M.project(o.LngLat.convert(f)),U=new o.pointGeometry(L.x,N.y),Z=new o.pointGeometry(N.x,L.y),te=-o.degToRad(y),ae=L.rotate(te),le=N.rotate(te),ie=U.rotate(te),ve=Z.rotate(te),oe=new o.pointGeometry(Math.max(ae.x,le.x,ie.x,ve.x),Math.max(ae.y,le.y,ie.y,ve.y)),he=new o.pointGeometry(Math.min(ae.x,le.x,ie.x,ve.x),Math.min(ae.y,le.y,ie.y,ve.y)),de=oe.sub(he),Ae=(M.width-((O.left||0)+(O.right||0)+T.padding.left+T.padding.right))/de.x,_e=(M.height-((O.top||0)+(O.bottom||0)+T.padding.top+T.padding.bottom))/de.y;if(_e<0||Ae<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const be=Math.min(M.scaleZoom(M.scale*Math.min(Ae,_e)),T.maxZoom),Re=typeof T.offset.x=="number"&&typeof T.offset.y=="number"?new o.pointGeometry(T.offset.x,T.offset.y):o.pointGeometry.convert(T.offset),We=new o.pointGeometry((T.padding.left-T.padding.right)/2,(T.padding.top-T.padding.bottom)/2).rotate(y*Math.PI/180),Ke=Re.add(We).mult(M.scale/M.zoomScale(be));return{center:M.unproject(L.add(N).div(2).sub(Ke)),zoom:be,bearing:y}}_cameraForBox(a,f,y,b,T){const M=this._extendCameraOptions(T);y=y||0,b=b||0,a=o.LngLat.convert(a),f=o.LngLat.convert(f);const O=this.transform.clone();O.padding=M.padding;const L=this.getFreeCameraOptions(),N=new o.LngLat(.5*(a.lng+f.lng),.5*(a.lat+f.lat)),U=.5*(y+b);if(O._camera.position[2]<o.mercatorZfromAltitude(U,N.lat))return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");L.lookAtPoint(N),O.setFreeCameraOptions(L);const Z=o.MercatorCoordinate.fromLngLat(a),te=o.MercatorCoordinate.fromLngLat(f),ae=O.pointRayIntersection(O.centerPoint,U),le=[(ie=O.rayIntersectionCoordinate(ae)).x,ie.y,ie.z];var ie;const ve=O.screenPointToMercatorRay(O.centerPoint),oe=O.projection.name!=="globe";let he,de=0;do{const Ae=Math.floor(O.zoom),_e=1<<Ae,be=Math.min(_e*Z.x,_e*te.x),Re=Math.min(_e*Z.y,_e*te.y),We=Math.max(_e*Z.x,_e*te.x),Ke=Math.max(_e*Z.y,_e*te.y),Ze=new o.Aabb([be,Re,y],[We,Ke,b]),Ge=o.Frustum.fromInvProjectionMatrix(O.invProjMatrix,O.worldSize,Ae,oe);if(Ze.intersects(Ge)!==2){he&&(O._camera.position=o.scaleAndAdd([],O._camera.position,ve.dir,-he),O._updateStateFromCamera());break}const Se=o.sub([],O._camera.position,le);he=.5*o.length(Se),O._camera.position=o.scaleAndAdd([],O._camera.position,ve.dir,he);try{O._updateStateFromCamera()}catch{return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++de<10);return{center:O.center,zoom:O.zoom,bearing:O.bearing,pitch:O.pitch}}fitBounds(a,f,y){return this.transform.projection.name==="globe"&&o.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(a,f),f,y)}_raycastElevationBox(a,f){const y=this.transform.elevation;if(!y)return;const b=new o.pointGeometry(a.x,f.y),T=new o.pointGeometry(f.x,a.y),M=y.pointCoordinate(a);if(!M)return;const O=y.pointCoordinate(f);if(!O)return;const L=y.pointCoordinate(b);if(!L)return;const N=y.pointCoordinate(T);if(!N)return;const U=new o.MercatorCoordinate(M[0],M[1]).toLngLat(),Z=new o.MercatorCoordinate(O[0],O[1]).toLngLat(),te=new o.MercatorCoordinate(L[0],L[1]).toLngLat(),ae=new o.MercatorCoordinate(N[0],N[1]).toLngLat(),le=Math.min(U.lng,Math.min(Z.lng,Math.min(te.lng,ae.lng))),ie=Math.min(U.lat,Math.min(Z.lat,Math.min(te.lat,ae.lat))),ve=Math.max(U.lng,Math.max(Z.lng,Math.max(te.lng,ae.lng))),oe=Math.max(U.lat,Math.max(Z.lat,Math.max(te.lat,ae.lat))),he=Math.min(M[3],Math.min(O[3],Math.min(L[3],N[3]))),de=Math.max(M[3],Math.max(O[3],Math.max(L[3],N[3])));return{minLngLat:new o.LngLat(le,ie),maxLngLat:new o.LngLat(ve,oe),minAltitude:he,maxAltitude:de}}fitScreenCoordinates(a,f,y,b,T){let M,O,L,N;this.transform.projection.name==="globe"&&o.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const U=o.pointGeometry.convert(a),Z=o.pointGeometry.convert(f),te=this._raycastElevationBox(U,Z);if(te)M=te.minLngLat,O=te.maxLngLat,L=te.minAltitude,N=te.maxAltitude;else{if(this.transform.anyCornerOffEdge(U,Z))return this;M=this.transform.pointLocation(U),O=this.transform.pointLocation(Z)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(a)),this.transform.pointLocation(o.pointGeometry.convert(f)),y,b):this._cameraForBox(M,O,L,N,b),b,T)}_fitInternal(a,f,y){return a?(delete(f=o.extend(a,f)).padding,f.linear?this.easeTo(f,y):this.flyTo(f,y)):this}jumpTo(a,f){this.stop();const y=a.preloadOnly?this.transform.clone():this.transform;let b=!1,T=!1,M=!1;return"zoom"in a&&y.zoom!==+a.zoom&&(b=!0,y.zoom=+a.zoom),a.center!==void 0&&(y.center=o.LngLat.convert(a.center)),"bearing"in a&&y.bearing!==+a.bearing&&(T=!0,y.bearing=+a.bearing),"pitch"in a&&y.pitch!==+a.pitch&&(M=!0,y.pitch=+a.pitch),a.padding==null||y.isPaddingEqual(a.padding)||(y.padding=a.padding),a.preloadOnly?(this._preloadTiles(y),this):(this.fire(new o.Event("movestart",f)).fire(new o.Event("move",f)),b&&this.fire(new o.Event("zoomstart",f)).fire(new o.Event("zoom",f)).fire(new o.Event("zoomend",f)),T&&this.fire(new o.Event("rotatestart",f)).fire(new o.Event("rotate",f)).fire(new o.Event("rotateend",f)),M&&this.fire(new o.Event("pitchstart",f)).fire(new o.Event("pitch",f)).fire(new o.Event("pitchend",f)),this.fire(new o.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Yu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,f){const y=this.transform;if(!y.projection.supportsFreeCamera)return o.warnOnce(Yu),this;this.stop();const b=y.zoom,T=y.pitch,M=y.bearing;y.setFreeCameraOptions(a);const O=b!==y.zoom,L=T!==y.pitch,N=M!==y.bearing;return this.fire(new o.Event("movestart",f)).fire(new o.Event("move",f)),O&&this.fire(new o.Event("zoomstart",f)).fire(new o.Event("zoom",f)).fire(new o.Event("zoomend",f)),N&&this.fire(new o.Event("rotatestart",f)).fire(new o.Event("rotate",f)).fire(new o.Event("rotateend",f)),L&&this.fire(new o.Event("pitchstart",f)).fire(new o.Event("pitch",f)).fire(new o.Event("pitchend",f)),this.fire(new o.Event("moveend",f)),this}easeTo(a,f){this._stop(!1,a.easeId),((a=o.extend({offset:[0,0],duration:500,easing:o.ease},a)).animate===!1||!a.essential&&o.exported.prefersReducedMotion)&&(a.duration=0);const y=this.transform,b=this.getZoom(),T=this.getBearing(),M=this.getPitch(),O=this.getPadding(),L="zoom"in a?+a.zoom:b,N="bearing"in a?this._normalizeBearing(a.bearing,T):T,U="pitch"in a?+a.pitch:M,Z="padding"in a?a.padding:y.padding,te=o.pointGeometry.convert(a.offset);let ae,le,ie;if(y.projection.name==="globe"){const Ke=o.MercatorCoordinate.fromLngLat(y.center),Ze=te.rotate(-y.angle);Ke.x+=Ze.x/y.worldSize,Ke.y+=Ze.y/y.worldSize;const Ge=Ke.toLngLat(),Se=o.LngLat.convert(a.center||Ge);this._normalizeCenter(Se),ae=y.centerPoint.add(Ze),le=new o.pointGeometry(Ke.x,Ke.y).mult(y.worldSize),ie=new o.pointGeometry(o.mercatorXfromLng(Se.lng),o.mercatorYfromLat(Se.lat)).mult(y.worldSize).sub(le)}else{ae=y.centerPoint.add(te);const Ke=y.pointLocation(ae),Ze=o.LngLat.convert(a.center||Ke);this._normalizeCenter(Ze),le=y.project(Ke),ie=y.project(Ze).sub(le)}const ve=y.zoomScale(L-b);let oe,he;a.around&&(oe=o.LngLat.convert(a.around),he=y.locationPoint(oe));const de=this._zooming||L!==b,Ae=this._rotating||T!==N,_e=this._pitching||U!==M,be=!y.isPaddingEqual(Z),Re=Ke=>Ze=>{if(de&&(Ke.zoom=o.number(b,L,Ze)),Ae&&(Ke.bearing=o.number(T,N,Ze)),_e&&(Ke.pitch=o.number(M,U,Ze)),be&&(Ke.interpolatePadding(O,Z,Ze),ae=Ke.centerPoint.add(te)),oe)Ke.setLocationAtPoint(oe,he);else{const Ge=Ke.zoomScale(Ke.zoom-b),Se=L>b?Math.min(2,ve):Math.max(.5,ve),dt=Math.pow(Se,1-Ze),ct=Ke.unproject(le.add(ie.mult(Ze*dt)).mult(Ge));Ke.setLocationAtPoint(Ke.renderWorldCopies?ct.wrap():ct,ae)}return a.preloadOnly||this._fireMoveEvents(f),Ke};if(a.preloadOnly){const Ke=this._emulate(Re,a.duration,y);return this._preloadTiles(Ke),this}const We={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=de,this._rotating=Ae,this._pitching=_e,this._padding=be,this._easeId=a.easeId,this._prepareEase(f,a.noMoveStart,We),this._ease(Re(y),Ke=>{y.recenterOnTerrain(),this._afterEase(f,Ke)},a),this}_prepareEase(a,f,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||y.moving||this.fire(new o.Event("movestart",a)),this._zooming&&!y.zooming&&this.fire(new o.Event("zoomstart",a)),this._rotating&&!y.rotating&&this.fire(new o.Event("rotatestart",a)),this._pitching&&!y.pitching&&this.fire(new o.Event("pitchstart",a))}_fireMoveEvents(a){this.fire(new o.Event("move",a)),this._zooming&&this.fire(new o.Event("zoom",a)),this._rotating&&this.fire(new o.Event("rotate",a)),this._pitching&&this.fire(new o.Event("pitch",a))}_afterEase(a,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,b=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new o.Event("zoomend",a)),b&&this.fire(new o.Event("rotateend",a)),T&&this.fire(new o.Event("pitchend",a)),this.fire(new o.Event("moveend",a))}flyTo(a,f){if(!a.essential&&o.exported.prefersReducedMotion){const It=o.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(It,f)}this.stop(),a=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},a);const y=this.transform,b=this.getZoom(),T=this.getBearing(),M=this.getPitch(),O=this.getPadding(),L="zoom"in a?o.clamp(+a.zoom,y.minZoom,y.maxZoom):b,N="bearing"in a?this._normalizeBearing(a.bearing,T):T,U="pitch"in a?+a.pitch:M,Z="padding"in a?a.padding:y.padding,te=y.zoomScale(L-b),ae=o.pointGeometry.convert(a.offset);let le=y.centerPoint.add(ae);const ie=y.pointLocation(le),ve=o.LngLat.convert(a.center||ie);this._normalizeCenter(ve);const oe=y.project(ie),he=y.project(ve).sub(oe);let de=a.curve;const Ae=Math.max(y.width,y.height),_e=Ae/te,be=he.mag();if("minZoom"in a){const It=o.clamp(Math.min(a.minZoom,b,L),y.minZoom,y.maxZoom),wt=Ae/y.zoomScale(It-b);de=Math.sqrt(wt/be*2)}const Re=de*de;function We(It){const wt=(_e*_e-Ae*Ae+(It?-1:1)*Re*Re*be*be)/(2*(It?_e:Ae)*Re*be);return Math.log(Math.sqrt(wt*wt+1)-wt)}function Ke(It){return(Math.exp(It)-Math.exp(-It))/2}function Ze(It){return(Math.exp(It)+Math.exp(-It))/2}const Ge=We(0);let Se=function(It){return Ze(Ge)/Ze(Ge+de*It)},dt=function(It){return Ae*((Ze(Ge)*(Ke(wt=Ge+de*It)/Ze(wt))-Ke(Ge))/Re)/be;var wt},ct=(We(1)-Ge)/de;if(Math.abs(be)<1e-6||!isFinite(ct)){if(Math.abs(Ae-_e)<1e-6)return this.easeTo(a,f);const It=_e<Ae?-1:1;ct=Math.abs(Math.log(_e/Ae))/de,dt=function(){return 0},Se=function(wt){return Math.exp(It*de*wt)}}a.duration="duration"in a?+a.duration:1e3*ct/("screenSpeed"in a?+a.screenSpeed/de:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);const Rt=T!==N,Qe=U!==M,Jt=!y.isPaddingEqual(Z),Mt=It=>wt=>{const Pt=wt*ct,cr=1/Se(Pt);It.zoom=wt===1?L:b+It.scaleZoom(cr),Rt&&(It.bearing=o.number(T,N,wt)),Qe&&(It.pitch=o.number(M,U,wt)),Jt&&(It.interpolatePadding(O,Z,wt),le=It.centerPoint.add(ae));const tr=wt===1?ve:It.unproject(oe.add(he.mult(dt(Pt))).mult(cr));return It.setLocationAtPoint(It.renderWorldCopies?tr.wrap():tr,le),It._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(f),It};if(a.preloadOnly){const It=this._emulate(Mt,a.duration,y);return this._preloadTiles(It),this}return this._zooming=!0,this._rotating=Rt,this._pitching=Qe,this._padding=Jt,this._prepareEase(f,!1),this._ease(Mt(y),()=>this._afterEase(f),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,f)}if(!a){const y=this.handlers;y&&y.stop(!1)}return this}_ease(a,f,y){y.animate===!1||y.duration===0?(a(1),f()):(this._easeStart=o.exported.now(),this._easeOptions=y,this._onEaseFrame=a,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,f){a=o.wrap(a,-180,180);const y=Math.abs(a-f);return Math.abs(a-360-f)<y&&(a-=360),Math.abs(a+360-f)<y&&(a+=360),a}_normalizeCenter(a){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const y=a.lng-f.center.lng;a.lng+=y>180?-360:y<-180?360:0}_emulate(a,f,y){const b=Math.ceil(15*f/1e3),T=[],M=a(y.clone());for(let O=0;O<=b;O++){const L=M(O/b);T.push(L.clone())}return T}}class Jd{constructor(a={}){this.options=a,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){const f=this.options&&this.options.compact;return this._map=a,this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=P("button","mapboxgl-ctrl-attrib-button",this._container),P("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=P("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(a,f){const y=this._map._getUIString(`AttributionControl.${f}`);a.setAttribute("aria-label",y),a.removeAttribute("title"),a.firstElementChild&&a.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(a){const y=f.reduce((b,T,M)=>(T.value&&(b+=`${T.key}=${T.value}${M<f.length-1?"&":""}`),b),"?");a.href=`${o.config.FEEDBACK_URL}/${y}${this._map._hash?this._map._hash.getHashString(!0):""}`,a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}}_updateData(a){!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const f=this._map.style._sourceCaches;for(const b in f){const T=f[b];if(T.used){const M=T.getSource();M.attribution&&a.indexOf(M.attribution)<0&&a.push(M.attribution)}}a.sort((b,T)=>b.length-T.length),a=a.filter((b,T)=>{for(let M=T+1;M<a.length;M++)if(a[M].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));const y=a.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,a.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Qd{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=P("div","mapboxgl-ctrl");const f=P("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&a.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const a=this._map.style._sourceCaches;if(Object.entries(a).length===0)return!0;for(const f in a){const y=a[f].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const a=this._container.children;if(a.length){const f=a[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class ef{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const f=++this._id;return this._queue.push({callback:a,id:f,cancelled:!1}),f}remove(a){const f=this._currentlyRunning,y=f?this._queue.concat(f):this._queue;for(const b of y)if(b.id===a)return void(b.cancelled=!0)}run(a=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const y of f)if(!y.cancelled&&(y.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function tf(m,a,f){if(m=new o.LngLat(m.lng,m.lat),a){const y=new o.LngLat(m.lng-360,m.lat),b=new o.LngLat(m.lng+360,m.lat),T=360*Math.ceil(Math.abs(m.lng-f.center.lng)/360),M=f.locationPoint(m).distSqr(a),O=a.x<0||a.y<0||a.x>f.width||a.y>f.height;f.locationPoint(y).distSqr(a)<M&&(O||Math.abs(y.lng-f.center.lng)<T)?m=y:f.locationPoint(b).distSqr(a)<M&&(O||Math.abs(b.lng-f.center.lng)<T)&&(m=b)}for(;Math.abs(m.lng-f.center.lng)>180;){const y=f.locationPoint(m);if(y.x>=0&&y.y>=0&&y.x<=f.width&&y.y<=f.height)break;m.lng>f.center.lng?m.lng-=360:m.lng+=360}return m}const Qu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class eh extends o.Evented{constructor(a,f){if(super(),(a instanceof o.window.HTMLElement||f)&&(a=o.extend({element:a},f)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),a&&a.element)this._element=a.element,this._offset=o.pointGeometry.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=P("div");const b=41,T=27,M=I("svg",{display:"block",height:b*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${b}`},this._element),O=I("radialGradient",{id:"shadowGradient"},I("defs",{},M));I("stop",{offset:"10%","stop-opacity":.4},O),I("stop",{offset:"100%","stop-opacity":.05},O),I("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),I("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),I("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),I("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=o.pointGeometry.convert(a&&a.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const y=this._element.classList;for(const b in Qu)y.remove(`mapboxgl-marker-anchor-${b}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){const a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=o.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,a._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){const f=a.code,y=a.charCode||a.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(a){const f=a.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const a=this._map;if(!a)return!1;const f=a.unproject(this._pos),y=a.getFreeCameraOptions();if(!y.position)return!1;const b=y.position.toLngLat();return b.distanceTo(f)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const a=this._map;if(!a)return;const f=this._pos;if(!f||f.x<0||f.x>a.transform.width||f.y<0||f.y>a.transform.height)return void this._clearFadeTimer();const y=a.unproject(f);let b;a._usingGlobe()&&o.isLngLatBehindGlobe(a.transform,this._lngLat)?b=0:(b=1-a._queryFogOpacity(y),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(b*=.2)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const a=this._pos;if(!a||!this._map)return;const f=this._calculateXYTransform()+this._calculateZTransform(),y=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${a.x}px,${a.y}px) ${Qu[this._anchor]}
            ${f}
            translate(${y.x}px,${y.y}px)
        `}_calculateXYTransform(){const a=this._pos,f=this._map;if(this.getPitchAlignment()!=="map"||!f||!a)return"";if(!f._usingGlobe()){const L=f.getPitch();return L?`rotateX(${L}deg)`:""}const y=o.radToDeg(o.globeTiltAtLngLat(f.transform,this._lngLat)),b=a.sub(o.globeCenterToScreenPoint(f.transform)),T=y/(Math.abs(b.x)+Math.abs(b.y)),M=b.x*T,O=-b.y*T;return O||M?`rotateX(${O}deg) rotateY(${M}deg)`:""}_calculateZTransform(){const a=this._calculateRotation();return a?`rotateZ(${a}deg)`:""}_calculateRotation(){if(this._rotationAlignment==="viewport"||this._rotationAlignment==="auto")return this._rotation;if(this._map&&this._rotationAlignment==="map"){const a=this._map;if(this._pos&&a&&a._usingGlobe()){const f=a.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),y=a.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(f);return this._rotation+o.radToDeg(Math.atan2(y.y,y.x))-90}return this._rotation-this._map.getBearing()}return 0}_update(a){o.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=tf(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),a===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._usingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(a){return this._offset=o.pointGeometry.convert(a),this._update(),this}_onMove(a){const f=this._map;if(f){if(!this._isDragging){const y=this._clickTolerance||f._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(a){const f=this._map;f&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos),this._pointerdownPos=a.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;const f=this._map;return f&&(a?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}}class Hm{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;const f=o.easeCubicInOut((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,f,y){this._start=this.getValue(f),this._end=a,this._startTime=f,this._endTime=f+y}}const rf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Wm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function th(m){m.parentNode&&m.parentNode.removeChild(m)}const Zm={showCompass:!0,showZoom:!0,visualizePitch:!1};class qm{constructor(a,f,y=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new Xd({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,y&&(this.mousePitch=new Yd({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(a,f){this.mouseRotate.mousedown(a,f),this.mousePitch&&this.mousePitch.mousedown(a,f),$()}move(a,f){const y=this.map,b=this.mouseRotate.mousemoveWindow(a,f),T=b&&b.bearingDelta;if(T&&y.setBearing(y.getBearing()+T),this.mousePitch){const M=this.mousePitch.mousemoveWindow(a,f),O=M&&M.pitchDelta;O&&y.setPitch(y.getPitch()+O)}}off(){const a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart,{passive:!1}),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){j(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(o.extend({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),X(this.element,a)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,X(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){a.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=re(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){a.targetTouches.length!==1?this.reset():(this._lastPos=re(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){a.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const nf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Km={maxWidth:100,unit:"metric"};function sf(m,a,f){const y=of(a),b=y/a,T={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[f];this._map._requestDomTask(()=>{this._container.style.width=m*b+"px",this._container.innerHTML=`${y}&nbsp;${T}`})}function of(m){const a=Math.pow(10,`${Math.floor(m)}`.length-1);let f=m/a;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:f>=1?1:function(y){const b=Math.pow(10,Math.ceil(-Math.log(y)/Math.LN10));return Math.round(y*b)/b}(f),a*f}const af={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},lf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function rh(m=new o.pointGeometry(0,0),a="bottom"){if(typeof m=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(a){case"top":return new o.pointGeometry(0,m);case"top-left":return new o.pointGeometry(f,f);case"top-right":return new o.pointGeometry(-f,f);case"bottom":return new o.pointGeometry(0,-m);case"bottom-left":return new o.pointGeometry(f,-f);case"bottom-right":return new o.pointGeometry(-f,-f);case"left":return new o.pointGeometry(m,0);case"right":return new o.pointGeometry(-m,0)}return new o.pointGeometry(0,0)}return m instanceof o.pointGeometry||Array.isArray(m)?o.pointGeometry.convert(m):o.pointGeometry.convert(m[a]||[0,0])}const ih={version:o.version,supported:x,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Ju{constructor(m){if((m=o.extend({},Wm,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(m.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Uu(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=m.language==="auto"?o.window.navigator.language:m.language,this._worldview=m.worldview,this._renderTaskQueue=new ef,this._domRenderTaskQueue=new ef,this._controls=[],this._markers=[],this._mapId=o.uniqueId(),this._locale=o.extend({},rf,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Hm(0),this._explicitProjection=null,this._requestManager=new o.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=o.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Xu(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new qd(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,o.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new Jd({customAttribution:m.customAttribution})),this._logoControl=new Qd,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new o.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new o.Event(`${a.dataType}dataloading`,a))})}_getMapId(){return this._mapId}addControl(m,a){if(a===void 0&&(a=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=m.onAdd(this);this._controls.push(m);const y=this._controlPositions[a];return a.indexOf("bottom")!==-1?y.insertBefore(f,y.firstChild):y.appendChild(f),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(m);return a>-1&&this._controls.splice(a,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const a=!this._moving;return a&&this.fire(new o.Event("movestart",m)).fire(new o.Event("move",m)),this.fire(new o.Event("resize",m)),a&&this.fire(new o.Event("moveend",m)),this}getBounds(){return this.transform.projection.name==="globe"&&o.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(o.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m==null?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m==null?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m==null?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m==null?85:m)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}getLanguage(){return this._language}setLanguage(m){if(this._language=m==="auto"?o.window.navigator.language:m,this.style)for(const a in this.style._sourceCaches){const f=this.style._sourceCaches[a]._source;f._setLanguage&&f._setLanguage(this._language)}for(const a of this._controls)a._setLanguage&&a._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){if(this._worldview=m,this.style)for(const a in this.style._sourceCaches){const f=this.style._sourceCaches[a]._source;f._setWorldview&&f._setWorldview(m)}return this}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}_usingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._updateProjection(m)}_updateProjection(m){const a=this.getProjection();m===null&&(this._explicitProjection=null);const f=m||this.getProjection();let y;if(f&&f.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(y=this.transform.setProjection({name:"mercator"}),this.transform.mercatorFromTransition=!0):(y=this.transform.setProjection(f),this.transform.mercatorFromTransition=!1),m&&(this._explicitProjection=m.name==="globe"?{name:"globe",center:[0,0]}:this.transform.getProjection()),this.style.applyProjectionUpdate(),y){if(a.name==="globe"&&this.getProjection().name==="globe")this.style._forceSymbolLayerUpdate();else{this.painter.clearBackgroundTiles();for(const b in this.style._sourceCaches)this.style._sourceCaches[b].clearTiles()}this._update(!0)}return this}project(m){return this.transform.locationPoint3D(o.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(o.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(m,a,f){if(m==="mouseenter"||m==="mouseover"){let y=!1;const b=M=>{const O=a.filter(N=>this.getLayer(N)),L=O.length?this.queryRenderedFeatures(M.point,{layers:O}):[];L.length?y||(y=!0,f.call(this,new fn(m,this,M.originalEvent,{features:L}))):y=!1},T=()=>{y=!1};return{layers:new Set(a),listener:f,delegates:{mousemove:b,mouseout:T}}}if(m==="mouseleave"||m==="mouseout"){let y=!1;const b=M=>{const O=a.filter(L=>this.getLayer(L));(O.length?this.queryRenderedFeatures(M.point,{layers:O}):[]).length?y=!0:y&&(y=!1,f.call(this,new fn(m,this,M.originalEvent)))},T=M=>{y&&(y=!1,f.call(this,new fn(m,this,M.originalEvent)))};return{layers:new Set(a),listener:f,delegates:{mousemove:b,mouseout:T}}}{const y=b=>{const T=a.filter(O=>this.getLayer(O)),M=T.length?this.queryRenderedFeatures(b.point,{layers:T}):[];M.length&&(b.features=M,f.call(this,b),delete b.features)};return{layers:new Set(a),listener:f,delegates:{[m]:y}}}}on(m,a,f){if(f===void 0)return super.on(m,a);Array.isArray(a)||(a=[a]);const y=this._createDelegatedListener(m,a,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(y);for(const b in y.delegates)this.on(b,y.delegates[b]);return this}once(m,a,f){if(f===void 0)return super.once(m,a);Array.isArray(a)||(a=[a]);const y=this._createDelegatedListener(m,a,f);for(const b in y.delegates)this.once(b,y.delegates[b]);return this}off(m,a,f){if(f===void 0)return super.off(m,a);a=new Set(Array.isArray(a)?a:[a]);const y=(T,M)=>{if(T.size!==M.size)return!1;for(const O of T)if(!M.has(O))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[m]:void 0;return b&&(T=>{for(let M=0;M<T.length;M++){const O=T[M];if(O.listener===f&&y(O.layers,a)){for(const L in O.delegates)this.off(L,O.delegates[L]);return T.splice(M,1),this}}})(b),this}queryRenderedFeatures(m,a){return this.style?(a!==void 0||m===void 0||m instanceof o.pointGeometry||Array.isArray(m)||(a=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],a=a||{},this.transform)):[]}querySourceFeatures(m,a){return this.style.querySourceFeatures(m,a)}queryTerrainElevation(m,a){const f=this.transform.elevation;return f?(a=o.extend({},{exaggerated:!0},a),f.getAtPoint(o.MercatorCoordinate.fromLngLat(m),null,a.exaggerated)):null}setStyle(m,a){return(a=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a)).diff!==!1&&a.localIdeographFontFamily===this._localIdeographFontFamily&&a.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(m,a))}_getUIString(m){const a=this._locale[m];if(a==null)throw new Error(`Missing UI string '${m}'`);return a}_updateStyle(m,a){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new hs(this,a||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new hs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,a){if(typeof m=="string"){const f=this._requestManager.normalizeStyleURL(m),y=this._requestManager.transformRequest(f,o.ResourceType.Style);o.getJSON(y,(b,T)=>{b?this.fire(new o.ErrorEvent(b)):T&&this._updateDiff(T,a)})}else typeof m=="object"&&this._updateDiff(m,a)}_updateDiff(m,a){try{this.style.setState(m)&&this._update(!0)}catch(f){o.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(m,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(m,a){return this._lazyInitEmptyStyle(),this.style.addSource(m,a),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const a in m){const f=m[a]._tiles;for(const y in f){const b=f[y];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}addSourceType(m,a,f){this._lazyInitEmptyStyle(),this.style.addSourceType(m,a,f)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,a,{pixelRatio:f=1,sdf:y=!1,stretchX:b,stretchY:T,content:M}={}){if(this._lazyInitEmptyStyle(),a instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&a instanceof o.window.ImageBitmap){const{width:O,height:L,data:N}=o.exported.getImageData(a);this.style.addImage(m,{data:new o.RGBAImage({width:O,height:L},N),pixelRatio:f,stretchX:b,stretchY:T,content:M,sdf:y,version:0})}else if(a.width===void 0||a.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:L}=a,N=a;this.style.addImage(m,{data:new o.RGBAImage({width:O,height:L},new Uint8Array(N.data)),pixelRatio:f,stretchX:b,stretchY:T,content:M,sdf:y,version:0,userImage:N}),N.onAdd&&N.onAdd(this,m)}}updateImage(m,a){const f=this.style.getImage(m);if(!f)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=a instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&a instanceof o.window.ImageBitmap?o.exported.getImageData(a):a,{width:b,height:T}=y;b!==void 0&&T!==void 0?b===f.data.width&&T===f.data.height?(f.data.replace(y.data,!(a instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&a instanceof o.window.ImageBitmap)),this.style.updateImage(m,f)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${b}, ${T})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,a){o.getImage(this._requestManager.transformRequest(m,o.ResourceType.Image),(f,y)=>{a(f,y instanceof o.window.HTMLImageElement?o.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(m,a){return this._lazyInitEmptyStyle(),this.style.addLayer(m,a),this._update(!0)}moveLayer(m,a){return this.style.moveLayer(m,a),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,a,f){return this.style.setLayerZoomRange(m,a,f),this._update(!0)}setFilter(m,a,f={}){return this.style.setFilter(m,a,f),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,a,f,y={}){return this.style.setPaintProperty(m,a,f,y),this._update(!0)}getPaintProperty(m,a){return this.style.getPaintProperty(m,a)}setLayoutProperty(m,a,f,y={}){return this.style.setLayoutProperty(m,a,f,y),this._update(!0)}getLayoutProperty(m,a){return this.style.getLayoutProperty(m,a)}setLight(m,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,a),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(m),this.transform):0}setFeatureState(m,a){return this.style.setFeatureState(m,a),this._update()}removeFeatureState(m,a){return this.style.removeFeatureState(m,a),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300;let f,y,b,T=this._container;for(;T&&(!y||!b);){const M=o.window.getComputedStyle(T).transform;M&&M!=="none"&&(f=M.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(y=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(b=f[3])),T=T.parentElement}this._containerWidth=y?Math.abs(m/y):m,this._containerHeight=b?Math.abs(a/b):a}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=P("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const a=this._canvasContainer=P("div","mapboxgl-canvas-container",m);this._interactive&&a.classList.add("mapboxgl-interactive"),this._canvas=P("canvas","mapboxgl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=P("div","mapboxgl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{y[b]=P("div",`mapboxgl-ctrl-${b}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,a){const f=o.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(m),this._canvas.height=f*Math.ceil(a),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${a}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const a=this._markers.indexOf(m);a!==-1&&this._markers.splice(a,1)}_setupPainter(){const m=o.extend({},x.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);a?(o.storeAuthState(a,!0),this.painter=new ju(a,this.transform),this.on("data",f=>{f.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(a)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let a;const f=this.painter.context.extTimerQuery,y=o.exported.now();if(this.listens("gpu-timing-frame")&&(a=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this.getProjection().name==="globe"&&(this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.projection.name==="globe"&&this._updateProjection():this.transform.projection.name==="mercator"&&this._updateProjection());let b=!1;const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const L=this.transform.zoom,N=this.transform.pitch,U=o.exported.now();this.style.zoomHistory.update(L,U);const Z=new o.EvaluationParameters(L,{now:U,fadeDuration:T,pitch:N,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),te=Z.crossFadingFactor();te===1&&te===this._crossFadingFactor||(b=!0,this._crossFadingFactor=te),this.style.update(Z)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let M=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),M=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerUpdate()):M=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||b)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){const L=o.exported.now()-y;f.endQueryEXT(f.TIME_ELAPSED_EXT,a),setTimeout(()=>{const N=f.getQueryObjectEXT(a,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(a),this.fire(new o.Event("gpu-timing-frame",{cpuTime:L,gpuTime:N})),o.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:N}})},50)}if(this.listens("gpu-timing-layer")){const L=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(L);this.fire(new o.Event("gpu-timing-layer",{layerTimes:N}))},50)}if(this.listens("gpu-timing-deferred-render")){const L=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const N=this.painter.queryGpuTimeDeferredRender(L);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:N}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||M;if(O||this._repaint)this.triggerRepaint();else{const L=!this.isMoving()&&this.loaded();if(L&&(M=this._updateAverageElevation(y,!0)),M)this.triggerRepaint();else if(this._triggerFrame(!1),L&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const N=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:N})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const m of this._markers)m._update()}_updateAverageElevation(m,a=!1){const f=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((a||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const y=this.transform.averageElevation;let b=this.transform.sampleAverageElevation(),T=!1;this.transform.elevation&&(T=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=m;const M=Math.abs(y-b);if(M>1){if(this._isInitialLoad||T)return this._averageElevation.jumpTo(b),f(b);this._averageElevation.easeTo(b,m,300)}else if(M>1e-4)return this._averageElevation.jumpTo(b),f(b)}return!!this._averageElevation.isEasing(m)&&f(this._averageElevation.getValue(m))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===o.AUTH_ERR_MSG||m.status===401)){const a=this.painter.context.gl;o.storeAuthState(a,!1),this._logoControl instanceof Qd&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());const f=this.painter.context.gl,y=f.createFramebuffer();function b(T){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,T,0);const M=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,M),M}return f.bindFramebuffer(f.FRAMEBUFFER,y),this._canvasPixelComparison(b(m),a.canvasCopies.map(b),a.timeStamps)}_canvasPixelComparison(m,a,f){let y=f[1]-f[0];const b=m.length/4;for(let T=0;T<a.length;T++){const M=a[T];let O=0;for(let L=0;L<M.length;L+=4)M[L]===m[L]&&M[L+1]===m[L+1]&&M[L+2]===m[L+2]&&M[L+3]===m[L+3]&&(O+=1);y+=(f[T+2]-f[T+1])*(1-O/b)}return y}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),th(this._canvasContainer),th(this._controlContainer),th(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=o.exported.frame(a=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(a)}))}_preloadTiles(m){const a=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(a,(f,y)=>f._preloadTiles(m,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}_setCacheLimits(m,a){o.setCacheLimits(m,a)}get version(){return o.version}},NavigationControl:class{constructor(m){this.options=o.extend({},Zm,m),this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",a=>{this._map&&this._map.zoomIn({},{originalEvent:a})}),P("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",a=>{this._map&&this._map.zoomOut({},{originalEvent:a})}),P("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",a=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:a}):f.resetNorth({},{originalEvent:a}))}),this._compassIcon=P("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const a=m.getZoom(),f=a===m.getMaxZoom(),y=a===m.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=a)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qm(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,a){const f=P("button",m,this._container);return f.type="button",f.addEventListener("click",a),f}_setButtonTitle(m,a){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${a}`);m.setAttribute("aria-label",f),m.firstElementChild&&m.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends o.Evented{constructor(m){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},nf,m),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=cc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){this._supportsGeolocation!==void 0?m(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(a=>{this._supportsGeolocation=a.state!=="denied",m(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.options.geolocation,m(this._supportsGeolocation))}_isOutOfMapMaxBounds(m){const a=this._map.getMaxBounds(),f=m.coords;return!!a&&(f.longitude<a.getWest()||f.longitude>a.getEast()||f.latitude<a.getSouth()||f.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",m)),this._finish()}}_updateCamera(m){const a=new o.LngLat(m.coords.longitude,m.coords.latitude),f=m.coords.accuracy,y=this._map.getBearing(),b=o.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(f),b,{geolocateSource:!0})}_updateMarker(m){if(m){const a=new o.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,a=o.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,f=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=P("button","mapboxgl-ctrl-geolocate",this._container),P("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=P("div","mapboxgl-user-location"),this._dotElement.appendChild(P("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(P("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new eh({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=P("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new eh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(a=>{a==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Jd,ScaleControl:class{constructor(m){this.options=o.extend({},Km,m),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=sf.bind(this)),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,a=this._map,f=a._containerHeight/2,y=a._containerWidth/2-m/2,b=a.unproject([y,f]),T=a.unproject([y+m,f]),M=b.distanceTo(T);if(this.options.unit==="imperial"){const O=3.2808*M;O>5280?this._setScale(m,O/5280,"mile"):this._setScale(m,O,"foot")}else this.options.unit==="nautical"?this._setScale(m,M/1852,"nautical-mile"):M>=1e3?this._setScale(m,M/1e3,"kilometer"):this._setScale(m,M,"meter")}_setScale(m,a,f){const y=of(a),b=y/a;this._map._requestDomTask(()=>{this._container.style.width=m*b+"px",this._container.innerHTML=f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:f}).format(y):`${y}&nbsp;nm`})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof o.window.HTMLElement?this._container=m.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=P("button","mapboxgl-ctrl-fullscreen",this._controlContainer);P("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(m){super(),this.options=o.extend(Object.create(af),m),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=o.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(o.window.document.createTextNode(m))}setHTML(m){const a=o.window.document.createDocumentFragment(),f=o.window.document.createElement("body");let y;for(f.innerHTML=m;y=f.firstChild,y;)a.appendChild(y);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=P("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(m),this.options.closeButton){const f=this._closeButton=P("button","mapboxgl-popup-close-button",a);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let a;return this._classList.delete(m)?a=!1:(this._classList.add(m),a=!0),this._updateClassList(),a}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const a=this._map,f=this._container,y=this._pos;if(!a||!f||!y)return"bottom";const b=f.offsetWidth,T=f.offsetHeight,M=y.x<b/2,O=y.x>a.transform.width-b/2;if(y.y+m<T)return M?"top-left":O?"top-right":"top";if(y.y>a.transform.height-T){if(M)return"bottom-left";if(O)return"bottom-right"}return M?"left":O?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),m.className=a.join(" ")}_update(m){const a=this._map,f=this._content;if(!a||!this._lngLat&&!this._trackPointer||!f)return;let y=this._container;if(y||(y=this._container=P("div","mapboxgl-popup",a.getContainer()),this._tip=P("div","mapboxgl-popup-tip",y),y.appendChild(f)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=tf(this._lngLat,this._pos,a.transform)),!this._trackPointer||m){const b=this._pos=this._trackPointer&&m?m:a.project(this._lngLat),T=rh(this.options.offset),M=this._anchor=this._getAnchor(T.y),O=rh(this.options.offset,M),L=b.add(O).round();a._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${Qu[M]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&a._usingGlobe()){const b=o.isLngLatBehindGlobe(a.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(lf);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:eh,Style:hs,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:ac,Evented:o.Evented,config:o.config,prewarm:function(){lr().acquire(jt)},clearPrewarmedResources:function(){const m=qt;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(jt),qt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(m){o.config.ACCESS_TOKEN=m},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(m){o.config.API_URL=m},get workerCount(){return Ot.workerCount},set workerCount(m){Ot.workerCount=m},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){o.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){o.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return ih});var d=s;return d})})(LI);var qS=LI.exports;const g4={components:{},data(){return{accessToken:"pk.eyJ1Ijoiam9haGVycmVyYW1hIiwiYSI6ImNsM2ZsOXZuejBibmYzam4wbGtra3h4Y2EifQ.vBdQwpdDOBPUu6muBho6jQ"}},async mounted(){qS.accessToken=this.accessToken;const t=new qS.Map({container:"map-div",hash:!1,center:[10.4515,51.1657],zoom:6,maxZoom:17});t.setStyle("mapbox://styles/mapbox/dark-v11"),t.on("load",()=>{this.map=t})}},_4={id:"map-div"};function y4(t,e,r,n,s,u){return kr(),xi("div",_4)}var v4=Hp(g4,[["render",y4]]);/*!
 * Chart.js v4.0.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */function ha(){}const x4=(()=>{let t=0;return()=>t++})();function Kr(t){return t===null||typeof t=="undefined"}function bi(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ur(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Ni(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function vs(t,e){return Ni(t)?t:e}function Ar(t,e){return typeof t=="undefined"?e:t}const b4=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,zI=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function mi(t,e,r){if(t&&typeof t.call=="function")return t.apply(r,e)}function oi(t,e,r,n){let s,u,d;if(bi(t))if(u=t.length,n)for(s=u-1;s>=0;s--)e.call(r,t[s],s);else for(s=0;s<u;s++)e.call(r,t[s],s);else if(Ur(t))for(d=Object.keys(t),u=d.length,s=0;s<u;s++)e.call(r,t[d[s]],d[s])}function K_(t,e){let r,n,s,u;if(!t||!e||t.length!==e.length)return!1;for(r=0,n=t.length;r<n;++r)if(s=t[r],u=e[r],s.datasetIndex!==u.datasetIndex||s.index!==u.index)return!1;return!0}function X_(t){if(bi(t))return t.map(X_);if(Ur(t)){const e=Object.create(null),r=Object.keys(t),n=r.length;let s=0;for(;s<n;++s)e[r[s]]=X_(t[r[s]]);return e}return t}function FI(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function w4(t,e,r,n){if(!FI(t))return;const s=e[t],u=r[t];Ur(s)&&Ur(u)?Ap(s,u,n):e[t]=X_(u)}function Ap(t,e,r){const n=bi(e)?e:[e],s=n.length;if(!Ur(t))return t;r=r||{};const u=r.merger||w4;let d;for(let o=0;o<s;++o){if(d=n[o],!Ur(d))continue;const g=Object.keys(d);for(let x=0,E=g.length;x<E;++x)u(g[x],t,d,r)}return t}function dp(t,e){return Ap(t,e,{merger:E4})}function E4(t,e,r){if(!FI(t))return;const n=e[t],s=r[t];Ur(n)&&Ur(s)?dp(n,s):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=X_(s))}const KS={"":t=>t,x:t=>t.x,y:t=>t.y};function T4(t){const e=t.split("."),r=[];let n="";for(const s of e)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function S4(t){const e=T4(t);return r=>{for(const n of e){if(n==="")break;r=r&&r[n]}return r}}function Fl(t,e){return(KS[e]||(KS[e]=S4(e)))(t)}function _1(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Hs=t=>typeof t!="undefined",Bl=t=>typeof t=="function",XS=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0};function A4(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Ci=Math.PI,wi=2*Ci,P4=wi+Ci,Y_=Number.POSITIVE_INFINITY,C4=Ci/180,ji=Ci/2,Dc=Ci/4,YS=Ci*2/3,wl=Math.log10,jo=Math.sign;function fp(t,e,r){return Math.abs(t-e)<r}function JS(t){const e=Math.round(t);t=fp(t,e,t/1e3)?e:t;const r=Math.pow(10,Math.floor(wl(t))),n=t/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function I4(t){const e=[],r=Math.sqrt(t);let n;for(n=1;n<r;n++)t%n===0&&(e.push(n),e.push(t/n));return r===(r|0)&&e.push(r),e.sort((s,u)=>s-u).pop(),e}function Qh(t){return!isNaN(parseFloat(t))&&isFinite(t)}function M4(t,e){const r=Math.round(t);return r-e<=t&&r+e>=t}function BI(t,e,r){let n,s,u;for(n=0,s=t.length;n<s;n++)u=t[n][r],isNaN(u)||(e.min=Math.min(e.min,u),e.max=Math.max(e.max,u))}function ao(t){return t*(Ci/180)}function y1(t){return t*(180/Ci)}function QS(t){if(!Ni(t))return;let e=1,r=0;for(;Math.round(t*e)/e!==t;)e*=10,r++;return r}function NI(t,e){const r=e.x-t.x,n=e.y-t.y,s=Math.sqrt(r*r+n*n);let u=Math.atan2(n,r);return u<-.5*Ci&&(u+=wi),{angle:u,distance:s}}function lb(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function O4(t,e){return(t-e+P4)%wi-Ci}function ws(t){return(t%wi+wi)%wi}function Pp(t,e,r,n){const s=ws(t),u=ws(e),d=ws(r),o=ws(u-s),g=ws(d-s),x=ws(s-u),E=ws(s-d);return s===u||s===d||n&&u===d||o>g&&x<E}function un(t,e,r){return Math.max(e,Math.min(r,t))}function D4(t){return un(t,-32768,32767)}function wa(t,e,r,n=1e-6){return t>=Math.min(e,r)-n&&t<=Math.max(e,r)+n}function v1(t,e,r){r=r||(d=>t[d]<e);let n=t.length-1,s=0,u;for(;n-s>1;)u=s+n>>1,r(u)?s=u:n=u;return{lo:s,hi:n}}const Ea=(t,e,r,n)=>v1(t,r,n?s=>{const u=t[s][e];return u<r||u===r&&t[s+1][e]===r}:s=>t[s][e]<r),R4=(t,e,r)=>v1(t,r,n=>t[n][e]>=r);function L4(t,e,r){let n=0,s=t.length;for(;n<s&&t[n]<e;)n++;for(;s>n&&t[s-1]>r;)s--;return n>0||s<t.length?t.slice(n,s):t}const jI=["push","pop","shift","splice","unshift"];function k4(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),jI.forEach(r=>{const n="_onData"+_1(r),s=t[r];Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value(...u){const d=s.apply(this,u);return t._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...u)}),d}})})}function e2(t,e){const r=t._chartjs;if(!r)return;const n=r.listeners,s=n.indexOf(e);s!==-1&&n.splice(s,1),!(n.length>0)&&(jI.forEach(u=>{delete t[u]}),delete t._chartjs)}function $I(t){const e=new Set;let r,n;for(r=0,n=t.length;r<n;++r)e.add(t[r]);return e.size===n?t:Array.from(e)}const VI=function(){return typeof window=="undefined"?function(t){return t()}:window.requestAnimationFrame}();function UI(t,e){let r=!1;return function(...n){r||(r=!0,VI.call(window,()=>{r=!1,t.apply(e,n)}))}}function z4(t,e){let r;return function(...n){return e?(clearTimeout(r),r=setTimeout(t,e,n)):t.apply(this,n),e}}const x1=t=>t==="start"?"left":t==="end"?"right":"center",In=(t,e,r)=>t==="start"?e:t==="end"?r:(e+r)/2,F4=(t,e,r,n)=>t===(n?"left":"right")?r:t==="center"?(e+r)/2:e;function GI(t,e,r){const n=e.length;let s=0,u=n;if(t._sorted){const{iScale:d,_parsed:o}=t,g=d.axis,{min:x,max:E,minDefined:S,maxDefined:P}=d.getUserBounds();S&&(s=un(Math.min(Ea(o,d.axis,x).lo,r?n:Ea(e,g,d.getPixelForValue(x)).lo),0,n-1)),P?u=un(Math.max(Ea(o,d.axis,E,!0).hi+1,r?0:Ea(e,g,d.getPixelForValue(E),!0).hi+1),s,n)-s:u=n-s}return{start:s,count:u}}function HI(t){const{xScale:e,yScale:r,_scaleRanges:n}=t,s={xmin:e.min,xmax:e.max,ymin:r.min,ymax:r.max};if(!n)return t._scaleRanges=s,!0;const u=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==r.min||n.ymax!==r.max;return Object.assign(n,s),u}const Zg=t=>t===0||t===1,t2=(t,e,r)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*wi/r)),r2=(t,e,r)=>Math.pow(2,-10*t)*Math.sin((t-e)*wi/r)+1,T_={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*ji)+1,easeOutSine:t=>Math.sin(t*ji),easeInOutSine:t=>-.5*(Math.cos(Ci*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Zg(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Zg(t)?t:t2(t,.075,.3),easeOutElastic:t=>Zg(t)?t:r2(t,.075,.3),easeInOutElastic(t){return Zg(t)?t:t<.5?.5*t2(t*2,.1125,.45):.5+.5*r2(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-T_.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?T_.easeInBounce(t*2)*.5:T_.easeOutBounce(t*2-1)*.5+.5};var i2=T_;/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function Wp(t){return t+.5|0}const El=(t,e,r)=>Math.max(Math.min(t,r),e);function Yf(t){return El(Wp(t*2.55),0,255)}function Il(t){return El(Wp(t*255),0,255)}function va(t){return El(Wp(t/2.55)/100,0,1)}function n2(t){return El(Wp(t*100),0,100)}const Ns={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},cb=[..."0123456789ABCDEF"],B4=t=>cb[t&15],N4=t=>cb[(t&240)>>4]+cb[t&15],qg=t=>(t&240)>>4===(t&15),j4=t=>qg(t.r)&&qg(t.g)&&qg(t.b)&&qg(t.a);function $4(t){var e=t.length,r;return t[0]==="#"&&(e===4||e===5?r={r:255&Ns[t[1]]*17,g:255&Ns[t[2]]*17,b:255&Ns[t[3]]*17,a:e===5?Ns[t[4]]*17:255}:(e===7||e===9)&&(r={r:Ns[t[1]]<<4|Ns[t[2]],g:Ns[t[3]]<<4|Ns[t[4]],b:Ns[t[5]]<<4|Ns[t[6]],a:e===9?Ns[t[7]]<<4|Ns[t[8]]:255})),r}const V4=(t,e)=>t<255?e(t):"";function U4(t){var e=j4(t)?B4:N4;return t?"#"+e(t.r)+e(t.g)+e(t.b)+V4(t.a,e):void 0}const G4=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function WI(t,e,r){const n=e*Math.min(r,1-r),s=(u,d=(u+t/30)%12)=>r-n*Math.max(Math.min(d-3,9-d,1),-1);return[s(0),s(8),s(4)]}function H4(t,e,r){const n=(s,u=(s+t/60)%6)=>r-r*e*Math.max(Math.min(u,4-u,1),0);return[n(5),n(3),n(1)]}function W4(t,e,r){const n=WI(t,1,.5);let s;for(e+r>1&&(s=1/(e+r),e*=s,r*=s),s=0;s<3;s++)n[s]*=1-e-r,n[s]+=e;return n}function Z4(t,e,r,n,s){return t===s?(e-r)/n+(e<r?6:0):e===s?(r-t)/n+2:(t-e)/n+4}function b1(t){const r=t.r/255,n=t.g/255,s=t.b/255,u=Math.max(r,n,s),d=Math.min(r,n,s),o=(u+d)/2;let g,x,E;return u!==d&&(E=u-d,x=o>.5?E/(2-u-d):E/(u+d),g=Z4(r,n,s,E,u),g=g*60+.5),[g|0,x||0,o]}function w1(t,e,r,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,r,n)).map(Il)}function E1(t,e,r){return w1(WI,t,e,r)}function q4(t,e,r){return w1(W4,t,e,r)}function K4(t,e,r){return w1(H4,t,e,r)}function ZI(t){return(t%360+360)%360}function X4(t){const e=G4.exec(t);let r=255,n;if(!e)return;e[5]!==n&&(r=e[6]?Yf(+e[5]):Il(+e[5]));const s=ZI(+e[2]),u=+e[3]/100,d=+e[4]/100;return e[1]==="hwb"?n=q4(s,u,d):e[1]==="hsv"?n=K4(s,u,d):n=E1(s,u,d),{r:n[0],g:n[1],b:n[2],a:r}}function Y4(t,e){var r=b1(t);r[0]=ZI(r[0]+e),r=E1(r),t.r=r[0],t.g=r[1],t.b=r[2]}function J4(t){if(!t)return;const e=b1(t),r=e[0],n=n2(e[1]),s=n2(e[2]);return t.a<255?`hsla(${r}, ${n}%, ${s}%, ${va(t.a)})`:`hsl(${r}, ${n}%, ${s}%)`}const s2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},o2={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Q4(){const t={},e=Object.keys(o2),r=Object.keys(s2);let n,s,u,d,o;for(n=0;n<e.length;n++){for(d=o=e[n],s=0;s<r.length;s++)u=r[s],o=o.replace(u,s2[u]);u=parseInt(o2[d],16),t[o]=[u>>16&255,u>>8&255,u&255]}return t}let Kg;function eN(t){Kg||(Kg=Q4(),Kg.transparent=[0,0,0,0]);const e=Kg[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const tN=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rN(t){const e=tN.exec(t);let r=255,n,s,u;if(!!e){if(e[7]!==n){const d=+e[7];r=e[8]?Yf(d):El(d*255,0,255)}return n=+e[1],s=+e[3],u=+e[5],n=255&(e[2]?Yf(n):El(n,0,255)),s=255&(e[4]?Yf(s):El(s,0,255)),u=255&(e[6]?Yf(u):El(u,0,255)),{r:n,g:s,b:u,a:r}}}function iN(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${va(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const tx=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,bh=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function nN(t,e,r){const n=bh(va(t.r)),s=bh(va(t.g)),u=bh(va(t.b));return{r:Il(tx(n+r*(bh(va(e.r))-n))),g:Il(tx(s+r*(bh(va(e.g))-s))),b:Il(tx(u+r*(bh(va(e.b))-u))),a:t.a+r*(e.a-t.a)}}function Xg(t,e,r){if(t){let n=b1(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*r,e===0?360:1)),n=E1(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function qI(t,e){return t&&Object.assign(e||{},t)}function a2(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Il(t[3]))):(e=qI(t,{r:0,g:0,b:0,a:1}),e.a=Il(e.a)),e}function sN(t){return t.charAt(0)==="r"?rN(t):X4(t)}class J_{constructor(e){if(e instanceof J_)return e;const r=typeof e;let n;r==="object"?n=a2(e):r==="string"&&(n=$4(e)||eN(e)||sN(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=qI(this._rgb);return e&&(e.a=va(e.a)),e}set rgb(e){this._rgb=a2(e)}rgbString(){return this._valid?iN(this._rgb):void 0}hexString(){return this._valid?U4(this._rgb):void 0}hslString(){return this._valid?J4(this._rgb):void 0}mix(e,r){if(e){const n=this.rgb,s=e.rgb;let u;const d=r===u?.5:r,o=2*d-1,g=n.a-s.a,x=((o*g===-1?o:(o+g)/(1+o*g))+1)/2;u=1-x,n.r=255&x*n.r+u*s.r+.5,n.g=255&x*n.g+u*s.g+.5,n.b=255&x*n.b+u*s.b+.5,n.a=d*n.a+(1-d)*s.a,this.rgb=n}return this}interpolate(e,r){return e&&(this._rgb=nN(this._rgb,e._rgb,r)),this}clone(){return new J_(this.rgb)}alpha(e){return this._rgb.a=Il(e),this}clearer(e){const r=this._rgb;return r.a*=1-e,this}greyscale(){const e=this._rgb,r=Wp(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=r,this}opaquer(e){const r=this._rgb;return r.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Xg(this._rgb,2,e),this}darken(e){return Xg(this._rgb,2,-e),this}saturate(e){return Xg(this._rgb,1,e),this}desaturate(e){return Xg(this._rgb,1,-e),this}rotate(e){return Y4(this._rgb,e),this}}function KI(t){return new J_(t)}function XI(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function l2(t){return XI(t)?t:KI(t)}function rx(t){return XI(t)?t:KI(t).saturate(.5).darken(.1).hexString()}const oN=["x","y","borderWidth","radius","tension"],aN=["color","borderColor","backgroundColor"];function lN(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:aN},numbers:{type:"number",properties:oN}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function cN(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const c2=new Map;function uN(t,e){e=e||{};const r=t+JSON.stringify(e);let n=c2.get(r);return n||(n=new Intl.NumberFormat(t,e),c2.set(r,n)),n}function Zp(t,e,r){return uN(e,r).format(t)}const YI={values(t){return bi(t)?t:""+t},numeric(t,e,r){if(t===0)return"0";const n=this.chart.options.locale;let s,u=t;if(r.length>1){const x=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(x<1e-4||x>1e15)&&(s="scientific"),u=hN(t,r)}const d=wl(Math.abs(u)),o=Math.max(Math.min(-1*Math.floor(d),20),0),g={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(g,this.options.ticks.format),Zp(t,n,g)},logarithmic(t,e,r){if(t===0)return"0";const n=r[e].significand||t/Math.pow(10,Math.floor(wl(t)));return[1,2,3,5,10,15].includes(n)||e>.8*r.length?YI.numeric.call(this,t,e,r):""}};function hN(t,e){let r=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(r)>=1&&t!==Math.floor(t)&&(r=t-Math.floor(t)),r}var Qy={formatters:YI};function dN(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,r)=>r.lineWidth,tickColor:(e,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Qy.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const lu=Object.create(null),ub=Object.create(null);function pp(t,e){if(!e)return t;const r=e.split(".");for(let n=0,s=r.length;n<s;++n){const u=r[n];t=t[u]||(t[u]=Object.create(null))}return t}function ix(t,e,r){return typeof e=="string"?Ap(pp(t,e),r):Ap(pp(t,""),e)}class fN{constructor(e,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>rx(s.backgroundColor),this.hoverBorderColor=(n,s)=>rx(s.borderColor),this.hoverColor=(n,s)=>rx(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(r)}set(e,r){return ix(this,e,r)}get(e){return pp(this,e)}describe(e,r){return ix(ub,e,r)}override(e,r){return ix(lu,e,r)}route(e,r,n,s){const u=pp(this,e),d=pp(this,n),o="_"+r;Object.defineProperties(u,{[o]:{value:u[r],writable:!0},[r]:{enumerable:!0,get(){const g=this[o],x=d[s];return Ur(g)?Object.assign({},x,g):Ar(g,x)},set(g){this[o]=g}}})}apply(e){e.forEach(r=>r(this))}}var Gi=new fN({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[lN,cN,dN]);function pN(t){return!t||Kr(t.size)||Kr(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Q_(t,e,r,n,s){let u=e[s];return u||(u=e[s]=t.measureText(s).width,r.push(s)),u>n&&(n=u),n}function mN(t,e,r,n){n=n||{};let s=n.data=n.data||{},u=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(s=n.data={},u=n.garbageCollect=[],n.font=e),t.save(),t.font=e;let d=0;const o=r.length;let g,x,E,S,P;for(g=0;g<o;g++)if(S=r[g],S!=null&&bi(S)!==!0)d=Q_(t,s,u,d,S);else if(bi(S))for(x=0,E=S.length;x<E;x++)P=S[x],P!=null&&!bi(P)&&(d=Q_(t,s,u,d,P));t.restore();const I=u.length/2;if(I>r.length){for(g=0;g<I;g++)delete s[u[g]];u.splice(0,I)}return d}function Rc(t,e,r){const n=t.currentDevicePixelRatio,s=r!==0?Math.max(r/2,.5):0;return Math.round((e-s)*n)/n+s}function u2(t,e){e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function hb(t,e,r,n){JI(t,e,r,n,null)}function JI(t,e,r,n,s){let u,d,o,g,x,E,S,P;const I=e.pointStyle,R=e.rotation,z=e.radius;let B=(R||0)*C4;if(I&&typeof I=="object"&&(u=I.toString(),u==="[object HTMLImageElement]"||u==="[object HTMLCanvasElement]")){t.save(),t.translate(r,n),t.rotate(B),t.drawImage(I,-I.width/2,-I.height/2,I.width,I.height),t.restore();return}if(!(isNaN(z)||z<=0)){switch(t.beginPath(),I){default:s?t.ellipse(r,n,s/2,z,0,0,wi):t.arc(r,n,z,0,wi),t.closePath();break;case"triangle":E=s?s/2:z,t.moveTo(r+Math.sin(B)*E,n-Math.cos(B)*z),B+=YS,t.lineTo(r+Math.sin(B)*E,n-Math.cos(B)*z),B+=YS,t.lineTo(r+Math.sin(B)*E,n-Math.cos(B)*z),t.closePath();break;case"rectRounded":x=z*.516,g=z-x,d=Math.cos(B+Dc)*g,S=Math.cos(B+Dc)*(s?s/2-x:g),o=Math.sin(B+Dc)*g,P=Math.sin(B+Dc)*(s?s/2-x:g),t.arc(r-S,n-o,x,B-Ci,B-ji),t.arc(r+P,n-d,x,B-ji,B),t.arc(r+S,n+o,x,B,B+ji),t.arc(r-P,n+d,x,B+ji,B+Ci),t.closePath();break;case"rect":if(!R){g=Math.SQRT1_2*z,E=s?s/2:g,t.rect(r-E,n-g,2*E,2*g);break}B+=Dc;case"rectRot":S=Math.cos(B)*(s?s/2:z),d=Math.cos(B)*z,o=Math.sin(B)*z,P=Math.sin(B)*(s?s/2:z),t.moveTo(r-S,n-o),t.lineTo(r+P,n-d),t.lineTo(r+S,n+o),t.lineTo(r-P,n+d),t.closePath();break;case"crossRot":B+=Dc;case"cross":S=Math.cos(B)*(s?s/2:z),d=Math.cos(B)*z,o=Math.sin(B)*z,P=Math.sin(B)*(s?s/2:z),t.moveTo(r-S,n-o),t.lineTo(r+S,n+o),t.moveTo(r+P,n-d),t.lineTo(r-P,n+d);break;case"star":S=Math.cos(B)*(s?s/2:z),d=Math.cos(B)*z,o=Math.sin(B)*z,P=Math.sin(B)*(s?s/2:z),t.moveTo(r-S,n-o),t.lineTo(r+S,n+o),t.moveTo(r+P,n-d),t.lineTo(r-P,n+d),B+=Dc,S=Math.cos(B)*(s?s/2:z),d=Math.cos(B)*z,o=Math.sin(B)*z,P=Math.sin(B)*(s?s/2:z),t.moveTo(r-S,n-o),t.lineTo(r+S,n+o),t.moveTo(r+P,n-d),t.lineTo(r-P,n+d);break;case"line":d=s?s/2:Math.cos(B)*z,o=Math.sin(B)*z,t.moveTo(r-d,n-o),t.lineTo(r+d,n+o);break;case"dash":t.moveTo(r,n),t.lineTo(r+Math.cos(B)*(s?s/2:z),n+Math.sin(B)*z);break}t.fill(),e.borderWidth>0&&t.stroke()}}function Cp(t,e,r){return r=r||.5,!e||t&&t.x>e.left-r&&t.x<e.right+r&&t.y>e.top-r&&t.y<e.bottom+r}function ev(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function tv(t){t.restore()}function gN(t,e,r,n,s){if(!e)return t.lineTo(r.x,r.y);if(s==="middle"){const u=(e.x+r.x)/2;t.lineTo(u,e.y),t.lineTo(u,r.y)}else s==="after"!=!!n?t.lineTo(e.x,r.y):t.lineTo(r.x,e.y);t.lineTo(r.x,r.y)}function _N(t,e,r,n){if(!e)return t.lineTo(r.x,r.y);t.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function cu(t,e,r,n,s,u={}){const d=bi(e)?e:[e],o=u.strokeWidth>0&&u.strokeColor!=="";let g,x;for(t.save(),t.font=s.string,yN(t,u),g=0;g<d.length;++g)x=d[g],u.backdrop&&xN(t,u.backdrop),o&&(u.strokeColor&&(t.strokeStyle=u.strokeColor),Kr(u.strokeWidth)||(t.lineWidth=u.strokeWidth),t.strokeText(x,r,n,u.maxWidth)),t.fillText(x,r,n,u.maxWidth),vN(t,r,n,x,u),n+=s.lineHeight;t.restore()}function yN(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Kr(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function vN(t,e,r,n,s){if(s.strikethrough||s.underline){const u=t.measureText(n),d=e-u.actualBoundingBoxLeft,o=e+u.actualBoundingBoxRight,g=r-u.actualBoundingBoxAscent,x=r+u.actualBoundingBoxDescent,E=s.strikethrough?(g+x)/2:x;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=s.decorationWidth||2,t.moveTo(d,E),t.lineTo(o,E),t.stroke()}}function xN(t,e){const r=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=r}function Ip(t,e){const{x:r,y:n,w:s,h:u,radius:d}=e;t.arc(r+d.topLeft,n+d.topLeft,d.topLeft,-ji,Ci,!0),t.lineTo(r,n+u-d.bottomLeft),t.arc(r+d.bottomLeft,n+u-d.bottomLeft,d.bottomLeft,Ci,ji,!0),t.lineTo(r+s-d.bottomRight,n+u),t.arc(r+s-d.bottomRight,n+u-d.bottomRight,d.bottomRight,ji,0,!0),t.lineTo(r+s,n+d.topRight),t.arc(r+s-d.topRight,n+d.topRight,d.topRight,0,-ji,!0),t.lineTo(r+d.topLeft,n)}const bN=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,wN=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function EN(t,e){const r=(""+t).match(bN);if(!r||r[1]==="normal")return e*1.2;switch(t=+r[2],r[3]){case"px":return t;case"%":t/=100;break}return e*t}const TN=t=>+t||0;function T1(t,e){const r={},n=Ur(e),s=n?Object.keys(e):e,u=Ur(t)?n?d=>Ar(t[d],t[e[d]]):d=>t[d]:()=>t;for(const d of s)r[d]=TN(u(d));return r}function QI(t){return T1(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Qc(t){return T1(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Rn(t){const e=QI(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function tn(t,e){t=t||{},e=e||Gi.font;let r=Ar(t.size,e.size);typeof r=="string"&&(r=parseInt(r,10));let n=Ar(t.style,e.style);n&&!(""+n).match(wN)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:Ar(t.family,e.family),lineHeight:EN(Ar(t.lineHeight,e.lineHeight),r),size:r,style:n,weight:Ar(t.weight,e.weight),string:""};return s.string=pN(s),s}function Jf(t,e,r,n){let s=!0,u,d,o;for(u=0,d=t.length;u<d;++u)if(o=t[u],o!==void 0&&(e!==void 0&&typeof o=="function"&&(o=o(e),s=!1),r!==void 0&&bi(o)&&(o=o[r%o.length],s=!1),o!==void 0))return n&&!s&&(n.cacheable=!1),o}function SN(t,e,r){const{min:n,max:s}=t,u=zI(e,(s-n)/2),d=(o,g)=>r&&o===0?0:o+g;return{min:d(n,-Math.abs(u)),max:d(s,u)}}function Ul(t,e){return Object.assign(Object.create(t),e)}function S1(t,e=[""],r=t,n,s=()=>t[0]){Hs(n)||(n=iM("_fallback",t));const u={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:r,_fallback:n,_getTarget:s,override:d=>S1([d,...t],e,r,n)};return new Proxy(u,{deleteProperty(d,o){return delete d[o],delete d._keys,delete t[0][o],!0},get(d,o){return tM(d,o,()=>RN(o,e,t,d))},getOwnPropertyDescriptor(d,o){return Reflect.getOwnPropertyDescriptor(d._scopes[0],o)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(d,o){return d2(d).includes(o)},ownKeys(d){return d2(d)},set(d,o,g){const x=d._storage||(d._storage=s());return d[o]=x[o]=g,delete d._keys,!0}})}function ed(t,e,r,n){const s={_cacheable:!1,_proxy:t,_context:e,_subProxy:r,_stack:new Set,_descriptors:eM(t,n),setContext:u=>ed(t,u,r,n),override:u=>ed(t.override(u),e,r,n)};return new Proxy(s,{deleteProperty(u,d){return delete u[d],delete t[d],!0},get(u,d,o){return tM(u,d,()=>PN(u,d,o))},getOwnPropertyDescriptor(u,d){return u._descriptors.allKeys?Reflect.has(t,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,d)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(u,d){return Reflect.has(t,d)},ownKeys(){return Reflect.ownKeys(t)},set(u,d,o){return t[d]=o,delete u[d],!0}})}function eM(t,e={scriptable:!0,indexable:!0}){const{_scriptable:r=e.scriptable,_indexable:n=e.indexable,_allKeys:s=e.allKeys}=t;return{allKeys:s,scriptable:r,indexable:n,isScriptable:Bl(r)?r:()=>r,isIndexable:Bl(n)?n:()=>n}}const AN=(t,e)=>t?t+_1(e):e,A1=(t,e)=>Ur(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function tM(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const n=r();return t[e]=n,n}function PN(t,e,r){const{_proxy:n,_context:s,_subProxy:u,_descriptors:d}=t;let o=n[e];return Bl(o)&&d.isScriptable(e)&&(o=CN(e,o,t,r)),bi(o)&&o.length&&(o=IN(e,o,t,d.isIndexable)),A1(e,o)&&(o=ed(o,s,u&&u[e],d)),o}function CN(t,e,r,n){const{_proxy:s,_context:u,_subProxy:d,_stack:o}=r;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);return o.add(t),e=e(u,d||n),o.delete(t),A1(t,e)&&(e=P1(s._scopes,s,t,e)),e}function IN(t,e,r,n){const{_proxy:s,_context:u,_subProxy:d,_descriptors:o}=r;if(Hs(u.index)&&n(t))e=e[u.index%e.length];else if(Ur(e[0])){const g=e,x=s._scopes.filter(E=>E!==g);e=[];for(const E of g){const S=P1(x,s,t,E);e.push(ed(S,u,d&&d[t],o))}}return e}function rM(t,e,r){return Bl(t)?t(e,r):t}const MN=(t,e)=>t===!0?e:typeof t=="string"?Fl(e,t):void 0;function ON(t,e,r,n,s){for(const u of e){const d=MN(r,u);if(d){t.add(d);const o=rM(d._fallback,r,s);if(Hs(o)&&o!==r&&o!==n)return o}else if(d===!1&&Hs(n)&&r!==n)return null}return!1}function P1(t,e,r,n){const s=e._rootScopes,u=rM(e._fallback,r,n),d=[...t,...s],o=new Set;o.add(n);let g=h2(o,d,r,u||r,n);return g===null||Hs(u)&&u!==r&&(g=h2(o,d,u,g,n),g===null)?!1:S1(Array.from(o),[""],s,u,()=>DN(e,r,n))}function h2(t,e,r,n,s){for(;r;)r=ON(t,e,r,n,s);return r}function DN(t,e,r){const n=t._getTarget();e in n||(n[e]={});const s=n[e];return bi(s)&&Ur(r)?r:s||{}}function RN(t,e,r,n){let s;for(const u of e)if(s=iM(AN(u,t),r),Hs(s))return A1(t,s)?P1(r,n,t,s):s}function iM(t,e){for(const r of e){if(!r)continue;const n=r[t];if(Hs(n))return n}}function d2(t){let e=t._keys;return e||(e=t._keys=LN(t._scopes)),e}function LN(t){const e=new Set;for(const r of t)for(const n of Object.keys(r).filter(s=>!s.startsWith("_")))e.add(n);return Array.from(e)}function nM(t,e,r,n){const{iScale:s}=t,{key:u="r"}=this._parsing,d=new Array(n);let o,g,x,E;for(o=0,g=n;o<g;++o)x=o+r,E=e[x],d[o]={r:s.parse(Fl(E,u),x)};return d}const kN=Number.EPSILON||1e-14,td=(t,e)=>e<t.length&&!t[e].skip&&t[e],sM=t=>t==="x"?"y":"x";function zN(t,e,r,n){const s=t.skip?e:t,u=e,d=r.skip?e:r,o=lb(u,s),g=lb(d,u);let x=o/(o+g),E=g/(o+g);x=isNaN(x)?0:x,E=isNaN(E)?0:E;const S=n*x,P=n*E;return{previous:{x:u.x-S*(d.x-s.x),y:u.y-S*(d.y-s.y)},next:{x:u.x+P*(d.x-s.x),y:u.y+P*(d.y-s.y)}}}function FN(t,e,r){const n=t.length;let s,u,d,o,g,x=td(t,0);for(let E=0;E<n-1;++E)if(g=x,x=td(t,E+1),!(!g||!x)){if(fp(e[E],0,kN)){r[E]=r[E+1]=0;continue}s=r[E]/e[E],u=r[E+1]/e[E],o=Math.pow(s,2)+Math.pow(u,2),!(o<=9)&&(d=3/Math.sqrt(o),r[E]=s*d*e[E],r[E+1]=u*d*e[E])}}function BN(t,e,r="x"){const n=sM(r),s=t.length;let u,d,o,g=td(t,0);for(let x=0;x<s;++x){if(d=o,o=g,g=td(t,x+1),!o)continue;const E=o[r],S=o[n];d&&(u=(E-d[r])/3,o[`cp1${r}`]=E-u,o[`cp1${n}`]=S-u*e[x]),g&&(u=(g[r]-E)/3,o[`cp2${r}`]=E+u,o[`cp2${n}`]=S+u*e[x])}}function NN(t,e="x"){const r=sM(e),n=t.length,s=Array(n).fill(0),u=Array(n);let d,o,g,x=td(t,0);for(d=0;d<n;++d)if(o=g,g=x,x=td(t,d+1),!!g){if(x){const E=x[e]-g[e];s[d]=E!==0?(x[r]-g[r])/E:0}u[d]=o?x?jo(s[d-1])!==jo(s[d])?0:(s[d-1]+s[d])/2:s[d-1]:s[d]}FN(t,s,u),BN(t,u,e)}function Yg(t,e,r){return Math.max(Math.min(t,r),e)}function jN(t,e){let r,n,s,u,d,o=Cp(t[0],e);for(r=0,n=t.length;r<n;++r)d=u,u=o,o=r<n-1&&Cp(t[r+1],e),u&&(s=t[r],d&&(s.cp1x=Yg(s.cp1x,e.left,e.right),s.cp1y=Yg(s.cp1y,e.top,e.bottom)),o&&(s.cp2x=Yg(s.cp2x,e.left,e.right),s.cp2y=Yg(s.cp2y,e.top,e.bottom)))}function $N(t,e,r,n,s){let u,d,o,g;if(e.spanGaps&&(t=t.filter(x=>!x.skip)),e.cubicInterpolationMode==="monotone")NN(t,s);else{let x=n?t[t.length-1]:t[0];for(u=0,d=t.length;u<d;++u)o=t[u],g=zN(x,o,t[Math.min(u+1,d-(n?0:1))%d],e.tension),o.cp1x=g.previous.x,o.cp1y=g.previous.y,o.cp2x=g.next.x,o.cp2y=g.next.y,x=o}e.capBezierPoints&&jN(t,r)}function oM(){return typeof window!="undefined"&&typeof document!="undefined"}function C1(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function ey(t,e,r){let n;return typeof t=="string"?(n=parseInt(t,10),t.indexOf("%")!==-1&&(n=n/100*e.parentNode[r])):n=t,n}const rv=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function VN(t,e){return rv(t).getPropertyValue(e)}const UN=["top","right","bottom","left"];function eu(t,e,r){const n={};r=r?"-"+r:"";for(let s=0;s<4;s++){const u=UN[s];n[u]=parseFloat(t[e+"-"+u+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const GN=(t,e,r)=>(t>0||e>0)&&(!r||!r.shadowRoot);function HN(t,e){const r=t.touches,n=r&&r.length?r[0]:t,{offsetX:s,offsetY:u}=n;let d=!1,o,g;if(GN(s,u,t.target))o=s,g=u;else{const x=e.getBoundingClientRect();o=n.clientX-x.left,g=n.clientY-x.top,d=!0}return{x:o,y:g,box:d}}function Nc(t,e){if("native"in t)return t;const{canvas:r,currentDevicePixelRatio:n}=e,s=rv(r),u=s.boxSizing==="border-box",d=eu(s,"padding"),o=eu(s,"border","width"),{x:g,y:x,box:E}=HN(t,r),S=d.left+(E&&o.left),P=d.top+(E&&o.top);let{width:I,height:R}=e;return u&&(I-=d.width+o.width,R-=d.height+o.height),{x:Math.round((g-S)/I*r.width/n),y:Math.round((x-P)/R*r.height/n)}}function WN(t,e,r){let n,s;if(e===void 0||r===void 0){const u=C1(t);if(!u)e=t.clientWidth,r=t.clientHeight;else{const d=u.getBoundingClientRect(),o=rv(u),g=eu(o,"border","width"),x=eu(o,"padding");e=d.width-x.width-g.width,r=d.height-x.height-g.height,n=ey(o.maxWidth,u,"clientWidth"),s=ey(o.maxHeight,u,"clientHeight")}}return{width:e,height:r,maxWidth:n||Y_,maxHeight:s||Y_}}const Jg=t=>Math.round(t*10)/10;function ZN(t,e,r,n){const s=rv(t),u=eu(s,"margin"),d=ey(s.maxWidth,t,"clientWidth")||Y_,o=ey(s.maxHeight,t,"clientHeight")||Y_,g=WN(t,e,r);let{width:x,height:E}=g;if(s.boxSizing==="content-box"){const P=eu(s,"border","width"),I=eu(s,"padding");x-=I.width+P.width,E-=I.height+P.height}return x=Math.max(0,x-u.width),E=Math.max(0,n?Math.floor(x/n):E-u.height),x=Jg(Math.min(x,d,g.maxWidth)),E=Jg(Math.min(E,o,g.maxHeight)),x&&!E&&(E=Jg(x/2)),(e!==void 0||r!==void 0)&&n&&g.height&&E>g.height&&(E=g.height,x=Jg(Math.floor(E*n))),{width:x,height:E}}function f2(t,e,r){const n=e||1,s=Math.floor(t.height*n),u=Math.floor(t.width*n);t.height=s/n,t.width=u/n;const d=t.canvas;return d.style&&(r||!d.style.height&&!d.style.width)&&(d.style.height=`${t.height}px`,d.style.width=`${t.width}px`),t.currentDevicePixelRatio!==n||d.height!==s||d.width!==u?(t.currentDevicePixelRatio=n,d.height=s,d.width=u,t.ctx.setTransform(n,0,0,n,0,0),!0):!1}const qN=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return t}();function p2(t,e){const r=VN(t,e),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function jc(t,e,r,n){return{x:t.x+r*(e.x-t.x),y:t.y+r*(e.y-t.y)}}function KN(t,e,r,n){return{x:t.x+r*(e.x-t.x),y:n==="middle"?r<.5?t.y:e.y:n==="after"?r<1?t.y:e.y:r>0?e.y:t.y}}function XN(t,e,r,n){const s={x:t.cp2x,y:t.cp2y},u={x:e.cp1x,y:e.cp1y},d=jc(t,s,r),o=jc(s,u,r),g=jc(u,e,r),x=jc(d,o,r),E=jc(o,g,r);return jc(x,E,r)}const YN=function(t,e){return{x(r){return t+t+e-r},setWidth(r){e=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},JN=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Uh(t,e,r){return t?YN(e,r):JN()}function aM(t,e){let r,n;(e==="ltr"||e==="rtl")&&(r=t.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",e,"important"),t.prevTextDirection=n)}function lM(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function cM(t){return t==="angle"?{between:Pp,compare:O4,normalize:ws}:{between:wa,compare:(e,r)=>e-r,normalize:e=>e}}function m2({start:t,end:e,count:r,loop:n,style:s}){return{start:t%r,end:e%r,loop:n&&(e-t+1)%r===0,style:s}}function QN(t,e,r){const{property:n,start:s,end:u}=r,{between:d,normalize:o}=cM(n),g=e.length;let{start:x,end:E,loop:S}=t,P,I;if(S){for(x+=g,E+=g,P=0,I=g;P<I&&d(o(e[x%g][n]),s,u);++P)x--,E--;x%=g,E%=g}return E<x&&(E+=g),{start:x,end:E,loop:S,style:t.style}}function uM(t,e,r){if(!r)return[t];const{property:n,start:s,end:u}=r,d=e.length,{compare:o,between:g,normalize:x}=cM(n),{start:E,end:S,loop:P,style:I}=QN(t,e,r),R=[];let z=!1,B=null,$,j,G;const K=()=>g(s,G,$)&&o(s,G)!==0,X=()=>o(u,$)===0||g(u,G,$),re=()=>z||K(),ue=()=>!z||X();for(let ne=E,we=E;ne<=S;++ne)j=e[ne%d],!j.skip&&($=x(j[n]),$!==G&&(z=g($,s,u),B===null&&re()&&(B=o($,s)===0?ne:we),B!==null&&ue()&&(R.push(m2({start:B,end:ne,loop:P,count:d,style:I})),B=null),we=ne,G=$));return B!==null&&R.push(m2({start:B,end:S,loop:P,count:d,style:I})),R}function hM(t,e){const r=[],n=t.segments;for(let s=0;s<n.length;s++){const u=uM(n[s],t.points,e);u.length&&r.push(...u)}return r}function e5(t,e,r,n){let s=0,u=e-1;if(r&&!n)for(;s<e&&!t[s].skip;)s++;for(;s<e&&t[s].skip;)s++;for(s%=e,r&&(u+=s);u>s&&t[u%e].skip;)u--;return u%=e,{start:s,end:u}}function t5(t,e,r,n){const s=t.length,u=[];let d=e,o=t[e],g;for(g=e+1;g<=r;++g){const x=t[g%s];x.skip||x.stop?o.skip||(n=!1,u.push({start:e%s,end:(g-1)%s,loop:n}),e=d=x.stop?g:null):(d=g,o.skip&&(e=g)),o=x}return d!==null&&u.push({start:e%s,end:d%s,loop:n}),u}function r5(t,e){const r=t.points,n=t.options.spanGaps,s=r.length;if(!s)return[];const u=!!t._loop,{start:d,end:o}=e5(r,s,u,n);if(n===!0)return g2(t,[{start:d,end:o,loop:u}],r,e);const g=o<d?o+s:o,x=!!t._fullLoop&&d===0&&o===s-1;return g2(t,t5(r,d,g,x),r,e)}function g2(t,e,r,n){return!n||!n.setContext||!r?e:i5(t,e,r,n)}function i5(t,e,r,n){const s=t._chart.getContext(),u=_2(t.options),{_datasetIndex:d,options:{spanGaps:o}}=t,g=r.length,x=[];let E=u,S=e[0].start,P=S;function I(R,z,B,$){const j=o?-1:1;if(R!==z){for(R+=g;r[R%g].skip;)R-=j;for(;r[z%g].skip;)z+=j;R%g!==z%g&&(x.push({start:R%g,end:z%g,loop:B,style:$}),E=$,S=z%g)}}for(const R of e){S=o?S:R.start;let z=r[S%g],B;for(P=S+1;P<=R.end;P++){const $=r[P%g];B=_2(n.setContext(Ul(s,{type:"segment",p0:z,p1:$,p0DataIndex:(P-1)%g,p1DataIndex:P%g,datasetIndex:d}))),n5(B,E)&&I(S,P-1,R.loop,E),z=$,E=B}S<P-1&&I(S,P-1,R.loop,E)}return x}function _2(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function n5(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}/*!
 * Chart.js v4.0.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */class s5{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,r,n,s){const u=r.listeners[s],d=r.duration;u.forEach(o=>o({chart:e,initial:r.initial,numSteps:d,currentStep:Math.min(n-r.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=VI.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let r=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const u=n.items;let d=u.length-1,o=!1,g;for(;d>=0;--d)g=u[d],g._active?(g._total>n.duration&&(n.duration=g._total),g.tick(e),o=!0):(u[d]=u[u.length-1],u.pop());o&&(s.draw(),this._notify(s,n,e,"progress")),u.length||(n.running=!1,this._notify(s,n,e,"complete"),n.initial=!1),r+=u.length}),this._lastDate=e,r===0&&(this._running=!1)}_getAnims(e){const r=this._charts;let n=r.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(e,n)),n}listen(e,r,n){this._getAnims(e).listeners[r].push(n)}add(e,r){!r||!r.length||this._getAnims(e).items.push(...r)}has(e){return this._getAnims(e).items.length>0}start(e){const r=this._charts.get(e);!r||(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const r=this._charts.get(e);return!(!r||!r.running||!r.items.length)}stop(e){const r=this._charts.get(e);if(!r||!r.items.length)return;const n=r.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();r.items=[],this._notify(e,r,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var fa=new s5;const y2="transparent",o5={boolean(t,e,r){return r>.5?e:t},color(t,e,r){const n=l2(t||y2),s=n.valid&&l2(e||y2);return s&&s.valid?s.mix(n,r).hexString():e},number(t,e,r){return t+(e-t)*r}};class a5{constructor(e,r,n,s){const u=r[n];s=Jf([e.to,s,u,e.from]);const d=Jf([e.from,u,s]);this._active=!0,this._fn=e.fn||o5[e.type||typeof d],this._easing=i2[e.easing]||i2.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=r,this._prop=n,this._from=d,this._to=s,this._promises=void 0}active(){return this._active}update(e,r,n){if(this._active){this._notify(!1);const s=this._target[this._prop],u=n-this._start,d=this._duration-u;this._start=n,this._duration=Math.floor(Math.max(d,e.duration)),this._total+=u,this._loop=!!e.loop,this._to=Jf([e.to,r,s,e.from]),this._from=Jf([e.from,s,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const r=e-this._start,n=this._duration,s=this._prop,u=this._from,d=this._loop,o=this._to;let g;if(this._active=u!==o&&(d||r<n),!this._active){this._target[s]=o,this._notify(!0);return}if(r<0){this._target[s]=u;return}g=r/n%2,g=d&&g>1?2-g:g,g=this._easing(Math.min(1,Math.max(0,g))),this._target[s]=this._fn(u,o,g)}wait(){const e=this._promises||(this._promises=[]);return new Promise((r,n)=>{e.push({res:r,rej:n})})}_notify(e){const r=e?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][r]()}}class dM{constructor(e,r){this._chart=e,this._properties=new Map,this.configure(r)}configure(e){if(!Ur(e))return;const r=Object.keys(Gi.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const u=e[s];if(!Ur(u))return;const d={};for(const o of r)d[o]=u[o];(bi(u.properties)&&u.properties||[s]).forEach(o=>{(o===s||!n.has(o))&&n.set(o,d)})})}_animateOptions(e,r){const n=r.options,s=c5(e,n);if(!s)return[];const u=this._createAnimations(s,n);return n.$shared&&l5(e.options.$animations,n).then(()=>{e.options=n},()=>{}),u}_createAnimations(e,r){const n=this._properties,s=[],u=e.$animations||(e.$animations={}),d=Object.keys(r),o=Date.now();let g;for(g=d.length-1;g>=0;--g){const x=d[g];if(x.charAt(0)==="$")continue;if(x==="options"){s.push(...this._animateOptions(e,r));continue}const E=r[x];let S=u[x];const P=n.get(x);if(S)if(P&&S.active()){S.update(P,E,o);continue}else S.cancel();if(!P||!P.duration){e[x]=E;continue}u[x]=S=new a5(P,e,x,E),s.push(S)}return s}update(e,r){if(this._properties.size===0){Object.assign(e,r);return}const n=this._createAnimations(e,r);if(n.length)return fa.add(this._chart,n),!0}}function l5(t,e){const r=[],n=Object.keys(e);for(let s=0;s<n.length;s++){const u=t[n[s]];u&&u.active()&&r.push(u.wait())}return Promise.all(r)}function c5(t,e){if(!e)return;let r=t.options;if(!r){t.options=e;return}return r.$shared&&(t.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function v2(t,e){const r=t&&t.options||{},n=r.reverse,s=r.min===void 0?e:0,u=r.max===void 0?e:0;return{start:n?u:s,end:n?s:u}}function u5(t,e,r){if(r===!1)return!1;const n=v2(t,r),s=v2(e,r);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function h5(t){let e,r,n,s;return Ur(t)?(e=t.top,r=t.right,n=t.bottom,s=t.left):e=r=n=s=t,{top:e,right:r,bottom:n,left:s,disabled:t===!1}}function fM(t,e){const r=[],n=t._getSortedDatasetMetas(e);let s,u;for(s=0,u=n.length;s<u;++s)r.push(n[s].index);return r}function x2(t,e,r,n={}){const s=t.keys,u=n.mode==="single";let d,o,g,x;if(e!==null){for(d=0,o=s.length;d<o;++d){if(g=+s[d],g===r){if(n.all)continue;break}x=t.values[g],Ni(x)&&(u||e===0||jo(e)===jo(x))&&(e+=x)}return e}}function d5(t){const e=Object.keys(t),r=new Array(e.length);let n,s,u;for(n=0,s=e.length;n<s;++n)u=e[n],r[n]={x:u,y:t[u]};return r}function b2(t,e){const r=t&&t.options.stacked;return r||r===void 0&&e.stack!==void 0}function f5(t,e,r){return`${t.id}.${e.id}.${r.stack||r.type}`}function p5(t){const{min:e,max:r,minDefined:n,maxDefined:s}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:s?r:Number.POSITIVE_INFINITY}}function m5(t,e,r){const n=t[e]||(t[e]={});return n[r]||(n[r]={})}function w2(t,e,r,n){for(const s of e.getMatchingVisibleMetas(n).reverse()){const u=t[s.index];if(r&&u>0||!r&&u<0)return s.index}return null}function E2(t,e){const{chart:r,_cachedMeta:n}=t,s=r._stacks||(r._stacks={}),{iScale:u,vScale:d,index:o}=n,g=u.axis,x=d.axis,E=f5(u,d,n),S=e.length;let P;for(let I=0;I<S;++I){const R=e[I],{[g]:z,[x]:B}=R,$=R._stacks||(R._stacks={});P=$[x]=m5(s,E,z),P[o]=B,P._top=w2(P,d,!0,n.type),P._bottom=w2(P,d,!1,n.type)}}function nx(t,e){const r=t.scales;return Object.keys(r).filter(n=>r[n].axis===e).shift()}function g5(t,e){return Ul(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function _5(t,e,r){return Ul(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:r,index:e,mode:"default",type:"data"})}function jf(t,e){const r=t.controller.index,n=t.vScale&&t.vScale.axis;if(!!n){e=e||t._parsed;for(const s of e){const u=s._stacks;if(!u||u[n]===void 0||u[n][r]===void 0)return;delete u[n][r]}}}const sx=t=>t==="reset"||t==="none",T2=(t,e)=>e?t:Object.assign({},t),y5=(t,e,r)=>t&&!e.hidden&&e._stacked&&{keys:fM(r,!0),values:null};class uo{constructor(e,r){this.chart=e,this._ctx=e.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=b2(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&jf(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,r=this._cachedMeta,n=this.getDataset(),s=(S,P,I,R)=>S==="x"?P:S==="r"?R:I,u=r.xAxisID=Ar(n.xAxisID,nx(e,"x")),d=r.yAxisID=Ar(n.yAxisID,nx(e,"y")),o=r.rAxisID=Ar(n.rAxisID,nx(e,"r")),g=r.indexAxis,x=r.iAxisID=s(g,u,d,o),E=r.vAxisID=s(g,d,u,o);r.xScale=this.getScaleForId(u),r.yScale=this.getScaleForId(d),r.rScale=this.getScaleForId(o),r.iScale=this.getScaleForId(x),r.vScale=this.getScaleForId(E)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const r=this._cachedMeta;return e===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&e2(this._data,this),e._stacked&&jf(e)}_dataCheck(){const e=this.getDataset(),r=e.data||(e.data=[]),n=this._data;if(Ur(r))this._data=d5(r);else if(n!==r){if(n){e2(n,this);const s=this._cachedMeta;jf(s),s._parsed=[]}r&&Object.isExtensible(r)&&k4(r,this),this._syncList=[],this._data=r}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const r=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const u=r._stacked;r._stacked=b2(r.vScale,r),r.stack!==n.stack&&(s=!0,jf(r),r.stack=n.stack),this._resyncElements(e),(s||u!==r._stacked)&&E2(this,r._parsed)}configure(){const e=this.chart.config,r=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),r,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,r){const{_cachedMeta:n,_data:s}=this,{iScale:u,_stacked:d}=n,o=u.axis;let g=e===0&&r===s.length?!0:n._sorted,x=e>0&&n._parsed[e-1],E,S,P;if(this._parsing===!1)n._parsed=s,n._sorted=!0,P=s;else{bi(s[e])?P=this.parseArrayData(n,s,e,r):Ur(s[e])?P=this.parseObjectData(n,s,e,r):P=this.parsePrimitiveData(n,s,e,r);const I=()=>S[o]===null||x&&S[o]<x[o];for(E=0;E<r;++E)n._parsed[E+e]=S=P[E],g&&(I()&&(g=!1),x=S);n._sorted=g}d&&E2(this,P)}parsePrimitiveData(e,r,n,s){const{iScale:u,vScale:d}=e,o=u.axis,g=d.axis,x=u.getLabels(),E=u===d,S=new Array(s);let P,I,R;for(P=0,I=s;P<I;++P)R=P+n,S[P]={[o]:E||u.parse(x[R],R),[g]:d.parse(r[R],R)};return S}parseArrayData(e,r,n,s){const{xScale:u,yScale:d}=e,o=new Array(s);let g,x,E,S;for(g=0,x=s;g<x;++g)E=g+n,S=r[E],o[g]={x:u.parse(S[0],E),y:d.parse(S[1],E)};return o}parseObjectData(e,r,n,s){const{xScale:u,yScale:d}=e,{xAxisKey:o="x",yAxisKey:g="y"}=this._parsing,x=new Array(s);let E,S,P,I;for(E=0,S=s;E<S;++E)P=E+n,I=r[P],x[E]={x:u.parse(Fl(I,o),P),y:d.parse(Fl(I,g),P)};return x}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,r,n){const s=this.chart,u=this._cachedMeta,d=r[e.axis],o={keys:fM(s,!0),values:r._stacks[e.axis]};return x2(o,d,u.index,{mode:n})}updateRangeFromParsed(e,r,n,s){const u=n[r.axis];let d=u===null?NaN:u;const o=s&&n._stacks[r.axis];s&&o&&(s.values=o,d=x2(s,u,this._cachedMeta.index)),e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)}getMinMax(e,r){const n=this._cachedMeta,s=n._parsed,u=n._sorted&&e===n.iScale,d=s.length,o=this._getOtherScale(e),g=y5(r,n,this.chart),x={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:E,max:S}=p5(o);let P,I;function R(){I=s[P];const z=I[o.axis];return!Ni(I[e.axis])||E>z||S<z}for(P=0;P<d&&!(!R()&&(this.updateRangeFromParsed(x,e,I,g),u));++P);if(u){for(P=d-1;P>=0;--P)if(!R()){this.updateRangeFromParsed(x,e,I,g);break}}return x}getAllParsedValues(e){const r=this._cachedMeta._parsed,n=[];let s,u,d;for(s=0,u=r.length;s<u;++s)d=r[s][e.axis],Ni(d)&&n.push(d);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const r=this._cachedMeta,n=r.iScale,s=r.vScale,u=this.getParsed(e);return{label:n?""+n.getLabelForValue(u[n.axis]):"",value:s?""+s.getLabelForValue(u[s.axis]):""}}_update(e){const r=this._cachedMeta;this.update(e||"default"),r._clip=h5(Ar(this.options.clip,u5(r.xScale,r.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this.chart,n=this._cachedMeta,s=n.data||[],u=r.chartArea,d=[],o=this._drawStart||0,g=this._drawCount||s.length-o,x=this.options.drawActiveElementsOnTop;let E;for(n.dataset&&n.dataset.draw(e,u,o,g),E=o;E<o+g;++E){const S=s[E];S.hidden||(S.active&&x?d.push(S):S.draw(e,u))}for(E=0;E<d.length;++E)d[E].draw(e,u)}getStyle(e,r){const n=r?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,r,n){const s=this.getDataset();let u;if(e>=0&&e<this._cachedMeta.data.length){const d=this._cachedMeta.data[e];u=d.$context||(d.$context=_5(this.getContext(),e,d)),u.parsed=this.getParsed(e),u.raw=s.data[e],u.index=u.dataIndex=e}else u=this.$context||(this.$context=g5(this.chart.getContext(),this.index)),u.dataset=s,u.index=u.datasetIndex=this.index;return u.active=!!r,u.mode=n,u}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,r){return this._resolveElementOptions(this.dataElementType.id,r,e)}_resolveElementOptions(e,r="default",n){const s=r==="active",u=this._cachedDataOpts,d=e+"-"+r,o=u[d],g=this.enableOptionSharing&&Hs(n);if(o)return T2(o,g);const x=this.chart.config,E=x.datasetElementScopeKeys(this._type,e),S=s?[`${e}Hover`,"hover",e,""]:[e,""],P=x.getOptionScopes(this.getDataset(),E),I=Object.keys(Gi.elements[e]),R=()=>this.getContext(n,s),z=x.resolveNamedOptions(P,I,R,S);return z.$shared&&(z.$shared=g,u[d]=Object.freeze(T2(z,g))),z}_resolveAnimations(e,r,n){const s=this.chart,u=this._cachedDataOpts,d=`animation-${r}`,o=u[d];if(o)return o;let g;if(s.options.animation!==!1){const E=this.chart.config,S=E.datasetAnimationScopeKeys(this._type,r),P=E.getOptionScopes(this.getDataset(),S);g=E.createResolver(P,this.getContext(e,n,r))}const x=new dM(s,g&&g.animations);return g&&g._cacheable&&(u[d]=Object.freeze(x)),x}getSharedOptions(e){if(!!e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,r){return!r||sx(e)||this.chart._animationsDisabled}_getSharedOptions(e,r){const n=this.resolveDataElementOptions(e,r),s=this._sharedOptions,u=this.getSharedOptions(n),d=this.includeOptions(r,u)||u!==s;return this.updateSharedOptions(u,r,n),{sharedOptions:u,includeOptions:d}}updateElement(e,r,n,s){sx(s)?Object.assign(e,n):this._resolveAnimations(r,s).update(e,n)}updateSharedOptions(e,r,n){e&&!sx(r)&&this._resolveAnimations(void 0,r).update(e,n)}_setStyle(e,r,n,s){e.active=s;const u=this.getStyle(r,s);this._resolveAnimations(r,n,s).update(e,{options:!s&&this.getSharedOptions(u)||u})}removeHoverStyle(e,r,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,r,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const r=this._data,n=this._cachedMeta.data;for(const[o,g,x]of this._syncList)this[o](g,x);this._syncList=[];const s=n.length,u=r.length,d=Math.min(u,s);d&&this.parse(0,d),u>s?this._insertElements(s,u-s,e):u<s&&this._removeElements(u,s-u)}_insertElements(e,r,n=!0){const s=this._cachedMeta,u=s.data,d=e+r;let o;const g=x=>{for(x.length+=r,o=x.length-1;o>=d;o--)x[o]=x[o-r]};for(g(u),o=e;o<d;++o)u[o]=new this.dataElementType;this._parsing&&g(s._parsed),this.parse(e,r),n&&this.updateElements(u,e,r,"reset")}updateElements(e,r,n,s){}_removeElements(e,r){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(e,r);n._stacked&&jf(n,s)}n.data.splice(e,r)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[r,n,s]=e;this[r](n,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,r){r&&this._sync(["_removeElements",e,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ir(uo,"defaults",{}),ir(uo,"datasetElementType",null),ir(uo,"dataElementType",null);function v5(t,e){if(!t._cache.$bar){const r=t.getMatchingVisibleMetas(e);let n=[];for(let s=0,u=r.length;s<u;s++)n=n.concat(r[s].controller.getAllParsedValues(t));t._cache.$bar=$I(n.sort((s,u)=>s-u))}return t._cache.$bar}function x5(t){const e=t.iScale,r=v5(e,t.type);let n=e._length,s,u,d,o;const g=()=>{d===32767||d===-32768||(Hs(o)&&(n=Math.min(n,Math.abs(d-o)||n)),o=d)};for(s=0,u=r.length;s<u;++s)d=e.getPixelForValue(r[s]),g();for(o=void 0,s=0,u=e.ticks.length;s<u;++s)d=e.getPixelForTick(s),g();return n}function b5(t,e,r,n){const s=r.barThickness;let u,d;return Kr(s)?(u=e.min*r.categoryPercentage,d=r.barPercentage):(u=s*n,d=1),{chunk:u/n,ratio:d,start:e.pixels[t]-u/2}}function w5(t,e,r,n){const s=e.pixels,u=s[t];let d=t>0?s[t-1]:null,o=t<s.length-1?s[t+1]:null;const g=r.categoryPercentage;d===null&&(d=u-(o===null?e.end-e.start:o-u)),o===null&&(o=u+u-d);const x=u-(u-Math.min(d,o))/2*g;return{chunk:Math.abs(o-d)/2*g/n,ratio:r.barPercentage,start:x}}function E5(t,e,r,n){const s=r.parse(t[0],n),u=r.parse(t[1],n),d=Math.min(s,u),o=Math.max(s,u);let g=d,x=o;Math.abs(d)>Math.abs(o)&&(g=o,x=d),e[r.axis]=x,e._custom={barStart:g,barEnd:x,start:s,end:u,min:d,max:o}}function pM(t,e,r,n){return bi(t)?E5(t,e,r,n):e[r.axis]=r.parse(t,n),e}function S2(t,e,r,n){const s=t.iScale,u=t.vScale,d=s.getLabels(),o=s===u,g=[];let x,E,S,P;for(x=r,E=r+n;x<E;++x)P=e[x],S={},S[s.axis]=o||s.parse(d[x],x),g.push(pM(P,S,u,x));return g}function ox(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function T5(t,e,r){return t!==0?jo(t):(e.isHorizontal()?1:-1)*(e.min>=r?1:-1)}function S5(t){let e,r,n,s,u;return t.horizontal?(e=t.base>t.x,r="left",n="right"):(e=t.base<t.y,r="bottom",n="top"),e?(s="end",u="start"):(s="start",u="end"),{start:r,end:n,reverse:e,top:s,bottom:u}}function A5(t,e,r,n){let s=e.borderSkipped;const u={};if(!s){t.borderSkipped=u;return}if(s===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:d,end:o,reverse:g,top:x,bottom:E}=S5(t);s==="middle"&&r&&(t.enableBorderRadius=!0,(r._top||0)===n?s=x:(r._bottom||0)===n?s=E:(u[A2(E,d,o,g)]=!0,s=x)),u[A2(s,d,o,g)]=!0,t.borderSkipped=u}function A2(t,e,r,n){return n?(t=P5(t,e,r),t=P2(t,r,e)):t=P2(t,e,r),t}function P5(t,e,r){return t===e?r:t===r?e:t}function P2(t,e,r){return t==="start"?e:t==="end"?r:t}function C5(t,{inflateAmount:e},r){t.inflateAmount=e==="auto"?r===1?.33:0:e}class S_ extends uo{parsePrimitiveData(e,r,n,s){return S2(e,r,n,s)}parseArrayData(e,r,n,s){return S2(e,r,n,s)}parseObjectData(e,r,n,s){const{iScale:u,vScale:d}=e,{xAxisKey:o="x",yAxisKey:g="y"}=this._parsing,x=u.axis==="x"?o:g,E=d.axis==="x"?o:g,S=[];let P,I,R,z;for(P=n,I=n+s;P<I;++P)z=r[P],R={},R[u.axis]=u.parse(Fl(z,x),P),S.push(pM(Fl(z,E),R,d,P));return S}updateRangeFromParsed(e,r,n,s){super.updateRangeFromParsed(e,r,n,s);const u=n._custom;u&&r===this._cachedMeta.vScale&&(e.min=Math.min(e.min,u.min),e.max=Math.max(e.max,u.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const r=this._cachedMeta,{iScale:n,vScale:s}=r,u=this.getParsed(e),d=u._custom,o=ox(d)?"["+d.start+", "+d.end+"]":""+s.getLabelForValue(u[s.axis]);return{label:""+n.getLabelForValue(u[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const r=this._cachedMeta;this.updateElements(r.data,0,r.data.length,e)}updateElements(e,r,n,s){const u=s==="reset",{index:d,_cachedMeta:{vScale:o}}=this,g=o.getBasePixel(),x=o.isHorizontal(),E=this._getRuler(),{sharedOptions:S,includeOptions:P}=this._getSharedOptions(r,s);for(let I=r;I<r+n;I++){const R=this.getParsed(I),z=u||Kr(R[o.axis])?{base:g,head:g}:this._calculateBarValuePixels(I),B=this._calculateBarIndexPixels(I,E),$=(R._stacks||{})[o.axis],j={horizontal:x,base:z.base,enableBorderRadius:!$||ox(R._custom)||d===$._top||d===$._bottom,x:x?z.head:B.center,y:x?B.center:z.head,height:x?B.size:Math.abs(z.size),width:x?Math.abs(z.size):B.size};P&&(j.options=S||this.resolveDataElementOptions(I,e[I].active?"active":s));const G=j.options||e[I].options;A5(j,G,$,d),C5(j,G,E.ratio),this.updateElement(e[I],I,j,s)}}_getStacks(e,r){const{iScale:n}=this._cachedMeta,s=n.getMatchingVisibleMetas(this._type).filter(g=>g.controller.options.grouped),u=n.options.stacked,d=[],o=g=>{const x=g.controller.getParsed(r),E=x&&x[g.vScale.axis];if(Kr(E)||isNaN(E))return!0};for(const g of s)if(!(r!==void 0&&o(g))&&((u===!1||d.indexOf(g.stack)===-1||u===void 0&&g.stack===void 0)&&d.push(g.stack),g.index===e))break;return d.length||d.push(void 0),d}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,r,n){const s=this._getStacks(e,n),u=r!==void 0?s.indexOf(r):-1;return u===-1?s.length-1:u}_getRuler(){const e=this.options,r=this._cachedMeta,n=r.iScale,s=[];let u,d;for(u=0,d=r.data.length;u<d;++u)s.push(n.getPixelForValue(this.getParsed(u)[n.axis],u));const o=e.barThickness;return{min:o||x5(r),pixels:s,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:r,_stacked:n},options:{base:s,minBarLength:u}}=this,d=s||0,o=this.getParsed(e),g=o._custom,x=ox(g);let E=o[r.axis],S=0,P=n?this.applyStack(r,o,n):E,I,R;P!==E&&(S=P-E,P=E),x&&(E=g.barStart,P=g.barEnd-g.barStart,E!==0&&jo(E)!==jo(g.barEnd)&&(S=0),S+=E);const z=!Kr(s)&&!x?s:S;let B=r.getPixelForValue(z);if(this.chart.getDataVisibility(e)?I=r.getPixelForValue(S+P):I=B,R=I-B,Math.abs(R)<u){R=T5(R,r,d)*u,E===d&&(B-=R/2);const $=r.getPixelForDecimal(0),j=r.getPixelForDecimal(1),G=Math.min($,j),K=Math.max($,j);B=Math.max(Math.min(B,K),G),I=B+R}if(B===r.getPixelForValue(d)){const $=jo(R)*r.getLineWidthForValue(d)/2;B+=$,R-=$}return{size:R,base:B,head:I,center:I+R/2}}_calculateBarIndexPixels(e,r){const n=r.scale,s=this.options,u=s.skipNull,d=Ar(s.maxBarThickness,1/0);let o,g;if(r.grouped){const x=u?this._getStackCount(e):r.stackCount,E=s.barThickness==="flex"?w5(e,r,s,x):b5(e,r,s,x),S=this._getStackIndex(this.index,this._cachedMeta.stack,u?e:void 0);o=E.start+E.chunk*S+E.chunk/2,g=Math.min(d,E.chunk*E.ratio)}else o=n.getPixelForValue(this.getParsed(e)[n.axis],e),g=Math.min(d,r.min*r.ratio);return{base:o-g/2,head:o+g/2,center:o,size:g}}draw(){const e=this._cachedMeta,r=e.vScale,n=e.data,s=n.length;let u=0;for(;u<s;++u)this.getParsed(u)[r.axis]!==null&&n[u].draw(this._ctx)}}ir(S_,"id","bar"),ir(S_,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ir(S_,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class A_ extends uo{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,r,n,s){const u=super.parsePrimitiveData(e,r,n,s);for(let d=0;d<u.length;d++)u[d]._custom=this.resolveDataElementOptions(d+n).radius;return u}parseArrayData(e,r,n,s){const u=super.parseArrayData(e,r,n,s);for(let d=0;d<u.length;d++){const o=r[n+d];u[d]._custom=Ar(o[2],this.resolveDataElementOptions(d+n).radius)}return u}parseObjectData(e,r,n,s){const u=super.parseObjectData(e,r,n,s);for(let d=0;d<u.length;d++){const o=r[n+d];u[d]._custom=Ar(o&&o.r&&+o.r,this.resolveDataElementOptions(d+n).radius)}return u}getMaxOverflow(){const e=this._cachedMeta.data;let r=0;for(let n=e.length-1;n>=0;--n)r=Math.max(r,e[n].size(this.resolveDataElementOptions(n))/2);return r>0&&r}getLabelAndValue(e){const r=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:u}=r,d=this.getParsed(e),o=s.getLabelForValue(d.x),g=u.getLabelForValue(d.y),x=d._custom;return{label:n[e]||"",value:"("+o+", "+g+(x?", "+x:"")+")"}}update(e){const r=this._cachedMeta.data;this.updateElements(r,0,r.length,e)}updateElements(e,r,n,s){const u=s==="reset",{iScale:d,vScale:o}=this._cachedMeta,{sharedOptions:g,includeOptions:x}=this._getSharedOptions(r,s),E=d.axis,S=o.axis;for(let P=r;P<r+n;P++){const I=e[P],R=!u&&this.getParsed(P),z={},B=z[E]=u?d.getPixelForDecimal(.5):d.getPixelForValue(R[E]),$=z[S]=u?o.getBasePixel():o.getPixelForValue(R[S]);z.skip=isNaN(B)||isNaN($),x&&(z.options=g||this.resolveDataElementOptions(P,I.active?"active":s),u&&(z.options.radius=0)),this.updateElement(I,P,z,s)}}resolveDataElementOptions(e,r){const n=this.getParsed(e);let s=super.resolveDataElementOptions(e,r);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const u=s.radius;return r!=="active"&&(s.radius=0),s.radius+=Ar(n&&n._custom,u),s}}ir(A_,"id","bubble"),ir(A_,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),ir(A_,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function I5(t,e,r){let n=1,s=1,u=0,d=0;if(e<wi){const o=t,g=o+e,x=Math.cos(o),E=Math.sin(o),S=Math.cos(g),P=Math.sin(g),I=(G,K,X)=>Pp(G,o,g,!0)?1:Math.max(K,K*r,X,X*r),R=(G,K,X)=>Pp(G,o,g,!0)?-1:Math.min(K,K*r,X,X*r),z=I(0,x,S),B=I(ji,E,P),$=R(Ci,x,S),j=R(Ci+ji,E,P);n=(z-$)/2,s=(B-j)/2,u=-(z+$)/2,d=-(B+j)/2}return{ratioX:n,ratioY:s,offsetX:u,offsetY:d}}class Dh extends uo{constructor(e,r){super(e,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,r){const n=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=n;else{let u=g=>+n[g];if(Ur(n[e])){const{key:g="value"}=this._parsing;u=x=>+Fl(n[x],g)}let d,o;for(d=e,o=e+r;d<o;++d)s._parsed[d]=u(d)}}_getRotation(){return ao(this.options.rotation-90)}_getCircumference(){return ao(this.options.circumference)}_getRotationExtents(){let e=wi,r=-wi;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const s=this.chart.getDatasetMeta(n).controller,u=s._getRotation(),d=s._getCircumference();e=Math.min(e,u),r=Math.max(r,u+d)}return{rotation:e,circumference:r-e}}update(e){const r=this.chart,{chartArea:n}=r,s=this._cachedMeta,u=s.data,d=this.getMaxBorderWidth()+this.getMaxOffset(u)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-d)/2,0),g=Math.min(b4(this.options.cutout,o),1),x=this._getRingWeight(this.index),{circumference:E,rotation:S}=this._getRotationExtents(),{ratioX:P,ratioY:I,offsetX:R,offsetY:z}=I5(S,E,g),B=(n.width-d)/P,$=(n.height-d)/I,j=Math.max(Math.min(B,$)/2,0),G=zI(this.options.radius,j),K=Math.max(G*g,0),X=(G-K)/this._getVisibleDatasetWeightTotal();this.offsetX=R*G,this.offsetY=z*G,s.total=this.calculateTotal(),this.outerRadius=G-X*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-X*x,0),this.updateElements(u,0,u.length,e)}_circumference(e,r){const n=this.options,s=this._cachedMeta,u=this._getCircumference();return r&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*u/wi)}updateElements(e,r,n,s){const u=s==="reset",d=this.chart,o=d.chartArea,x=d.options.animation,E=(o.left+o.right)/2,S=(o.top+o.bottom)/2,P=u&&x.animateScale,I=P?0:this.innerRadius,R=P?0:this.outerRadius,{sharedOptions:z,includeOptions:B}=this._getSharedOptions(r,s);let $=this._getRotation(),j;for(j=0;j<r;++j)$+=this._circumference(j,u);for(j=r;j<r+n;++j){const G=this._circumference(j,u),K=e[j],X={x:E+this.offsetX,y:S+this.offsetY,startAngle:$,endAngle:$+G,circumference:G,outerRadius:R,innerRadius:I};B&&(X.options=z||this.resolveDataElementOptions(j,K.active?"active":s)),$+=G,this.updateElement(K,j,X,s)}}calculateTotal(){const e=this._cachedMeta,r=e.data;let n=0,s;for(s=0;s<r.length;s++){const u=e._parsed[s];u!==null&&!isNaN(u)&&this.chart.getDataVisibility(s)&&!r[s].hidden&&(n+=Math.abs(u))}return n}calculateCircumference(e){const r=this._cachedMeta.total;return r>0&&!isNaN(e)?wi*(Math.abs(e)/r):0}getLabelAndValue(e){const r=this._cachedMeta,n=this.chart,s=n.data.labels||[],u=Zp(r._parsed[e],n.options.locale);return{label:s[e]||"",value:u}}getMaxBorderWidth(e){let r=0;const n=this.chart;let s,u,d,o,g;if(!e){for(s=0,u=n.data.datasets.length;s<u;++s)if(n.isDatasetVisible(s)){d=n.getDatasetMeta(s),e=d.data,o=d.controller;break}}if(!e)return 0;for(s=0,u=e.length;s<u;++s)g=o.resolveDataElementOptions(s),g.borderAlign!=="inner"&&(r=Math.max(r,g.borderWidth||0,g.hoverBorderWidth||0));return r}getMaxOffset(e){let r=0;for(let n=0,s=e.length;n<s;++n){const u=this.resolveDataElementOptions(n);r=Math.max(r,u.offset||0,u.hoverOffset||0)}return r}_getRingWeightOffset(e){let r=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(r+=this._getRingWeight(n));return r}_getRingWeight(e){return Math.max(Ar(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ir(Dh,"id","doughnut"),ir(Dh,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ir(Dh,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"}),ir(Dh,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const r=e.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:n,color:s}}=e.legend.options;return r.labels.map((u,d)=>{const g=e.getDatasetMeta(0).controller.getStyle(d);return{text:u,fillStyle:g.backgroundColor,strokeStyle:g.borderColor,fontColor:s,lineWidth:g.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}}});class P_ extends uo{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const r=this._cachedMeta,{dataset:n,data:s=[],_dataset:u}=r,d=this.chart._animationsDisabled;let{start:o,count:g}=GI(r,s,d);this._drawStart=o,this._drawCount=g,HI(r)&&(o=0,g=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!u._decimated,n.points=s;const x=this.resolveDatasetElementOptions(e);this.options.showLine||(x.borderWidth=0),x.segment=this.options.segment,this.updateElement(n,void 0,{animated:!d,options:x},e),this.updateElements(s,o,g,e)}updateElements(e,r,n,s){const u=s==="reset",{iScale:d,vScale:o,_stacked:g,_dataset:x}=this._cachedMeta,{sharedOptions:E,includeOptions:S}=this._getSharedOptions(r,s),P=d.axis,I=o.axis,{spanGaps:R,segment:z}=this.options,B=Qh(R)?R:Number.POSITIVE_INFINITY,$=this.chart._animationsDisabled||u||s==="none",j=r+n,G=e.length;let K=r>0&&this.getParsed(r-1);for(let X=0;X<G;++X){const re=e[X],ue=$?re:{};if(X<r||X>=j){ue.skip=!0;continue}const ne=this.getParsed(X),we=Kr(ne[I]),xe=ue[P]=d.getPixelForValue(ne[P],X),ke=ue[I]=u||we?o.getBasePixel():o.getPixelForValue(g?this.applyStack(o,ne,g):ne[I],X);ue.skip=isNaN(xe)||isNaN(ke)||we,ue.stop=X>0&&Math.abs(ne[P]-K[P])>B,z&&(ue.parsed=ne,ue.raw=x.data[X]),S&&(ue.options=E||this.resolveDataElementOptions(X,re.active?"active":s)),$||this.updateElement(re,X,ue,s),K=ne}}getMaxOverflow(){const e=this._cachedMeta,r=e.dataset,n=r.options&&r.options.borderWidth||0,s=e.data||[];if(!s.length)return n;const u=s[0].size(this.resolveDataElementOptions(0)),d=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(n,u,d)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}ir(P_,"id","line"),ir(P_,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),ir(P_,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class C_ extends uo{constructor(e,r){super(e,r),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const r=this._cachedMeta,n=this.chart,s=n.data.labels||[],u=Zp(r._parsed[e].r,n.options.locale);return{label:s[e]||"",value:u}}parseObjectData(e,r,n,s){return nM.bind(this)(e,r,n,s)}update(e){const r=this._cachedMeta.data;this._updateRadius(),this.updateElements(r,0,r.length,e)}getMinMax(){const e=this._cachedMeta,r={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((n,s)=>{const u=this.getParsed(s).r;!isNaN(u)&&this.chart.getDataVisibility(s)&&(u<r.min&&(r.min=u),u>r.max&&(r.max=u))}),r}_updateRadius(){const e=this.chart,r=e.chartArea,n=e.options,s=Math.min(r.right-r.left,r.bottom-r.top),u=Math.max(s/2,0),d=Math.max(n.cutoutPercentage?u/100*n.cutoutPercentage:1,0),o=(u-d)/e.getVisibleDatasetCount();this.outerRadius=u-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(e,r,n,s){const u=s==="reset",d=this.chart,g=d.options.animation,x=this._cachedMeta.rScale,E=x.xCenter,S=x.yCenter,P=x.getIndexAngle(0)-.5*Ci;let I=P,R;const z=360/this.countVisibleElements();for(R=0;R<r;++R)I+=this._computeAngle(R,s,z);for(R=r;R<r+n;R++){const B=e[R];let $=I,j=I+this._computeAngle(R,s,z),G=d.getDataVisibility(R)?x.getDistanceFromCenterForValue(this.getParsed(R).r):0;I=j,u&&(g.animateScale&&(G=0),g.animateRotate&&($=j=P));const K={x:E,y:S,innerRadius:0,outerRadius:G,startAngle:$,endAngle:j,options:this.resolveDataElementOptions(R,B.active?"active":s)};this.updateElement(B,R,K,s)}}countVisibleElements(){const e=this._cachedMeta;let r=0;return e.data.forEach((n,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&r++}),r}_computeAngle(e,r,n){return this.chart.getDataVisibility(e)?ao(this.resolveDataElementOptions(e,r).angle||n):0}}ir(C_,"id","polarArea"),ir(C_,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),ir(C_,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const r=e.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:n,color:s}}=e.legend.options;return r.labels.map((u,d)=>{const g=e.getDatasetMeta(0).controller.getStyle(d);return{text:u,fillStyle:g.backgroundColor,strokeStyle:g.borderColor,fontColor:s,lineWidth:g.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,r,n){n.chart.toggleDataVisibility(r.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class db extends Dh{}ir(db,"id","pie"),ir(db,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class I_ extends uo{getLabelAndValue(e){const r=this._cachedMeta.vScale,n=this.getParsed(e);return{label:r.getLabels()[e],value:""+r.getLabelForValue(n[r.axis])}}parseObjectData(e,r,n,s){return nM.bind(this)(e,r,n,s)}update(e){const r=this._cachedMeta,n=r.dataset,s=r.data||[],u=r.iScale.getLabels();if(n.points=s,e!=="resize"){const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0);const o={_loop:!0,_fullLoop:u.length===s.length,options:d};this.updateElement(n,void 0,o,e)}this.updateElements(s,0,s.length,e)}updateElements(e,r,n,s){const u=this._cachedMeta.rScale,d=s==="reset";for(let o=r;o<r+n;o++){const g=e[o],x=this.resolveDataElementOptions(o,g.active?"active":s),E=u.getPointPositionForValue(o,this.getParsed(o).r),S=d?u.xCenter:E.x,P=d?u.yCenter:E.y,I={x:S,y:P,angle:E.angle,skip:isNaN(S)||isNaN(P),options:x};this.updateElement(g,o,I,s)}}}ir(I_,"id","radar"),ir(I_,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),ir(I_,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class M_ extends uo{getLabelAndValue(e){const r=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:u}=r,d=this.getParsed(e),o=s.getLabelForValue(d.x),g=u.getLabelForValue(d.y);return{label:n[e]||"",value:"("+o+", "+g+")"}}update(e){const r=this._cachedMeta,{data:n=[]}=r,s=this.chart._animationsDisabled;let{start:u,count:d}=GI(r,n,s);if(this._drawStart=u,this._drawCount=d,HI(r)&&(u=0,d=n.length),this.options.showLine){const{dataset:o,_dataset:g}=r;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!g._decimated,o.points=n;const x=this.resolveDatasetElementOptions(e);x.segment=this.options.segment,this.updateElement(o,void 0,{animated:!s,options:x},e)}this.updateElements(n,u,d,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,r,n,s){const u=s==="reset",{iScale:d,vScale:o,_stacked:g,_dataset:x}=this._cachedMeta,E=this.resolveDataElementOptions(r,s),S=this.getSharedOptions(E),P=this.includeOptions(s,S),I=d.axis,R=o.axis,{spanGaps:z,segment:B}=this.options,$=Qh(z)?z:Number.POSITIVE_INFINITY,j=this.chart._animationsDisabled||u||s==="none";let G=r>0&&this.getParsed(r-1);for(let K=r;K<r+n;++K){const X=e[K],re=this.getParsed(K),ue=j?X:{},ne=Kr(re[R]),we=ue[I]=d.getPixelForValue(re[I],K),xe=ue[R]=u||ne?o.getBasePixel():o.getPixelForValue(g?this.applyStack(o,re,g):re[R],K);ue.skip=isNaN(we)||isNaN(xe)||ne,ue.stop=K>0&&Math.abs(re[I]-G[I])>$,B&&(ue.parsed=re,ue.raw=x.data[K]),P&&(ue.options=S||this.resolveDataElementOptions(K,X.active?"active":s)),j||this.updateElement(X,K,ue,s),G=re}this.updateSharedOptions(S,s,E)}getMaxOverflow(){const e=this._cachedMeta,r=e.data||[];if(!this.options.showLine){let o=0;for(let g=r.length-1;g>=0;--g)o=Math.max(o,r[g].size(this.resolveDataElementOptions(g))/2);return o>0&&o}const n=e.dataset,s=n.options&&n.options.borderWidth||0;if(!r.length)return s;const u=r[0].size(this.resolveDataElementOptions(0)),d=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,u,d)/2}}ir(M_,"id","scatter"),ir(M_,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),ir(M_,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var M5=Object.freeze({__proto__:null,BarController:S_,BubbleController:A_,DoughnutController:Dh,LineController:P_,PolarAreaController:C_,PieController:db,RadarController:I_,ScatterController:M_});function Lc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class I1{static override(e){Object.assign(I1.prototype,e)}constructor(e){this.options=e||{}}init(){}formats(){return Lc()}parse(){return Lc()}format(){return Lc()}add(){return Lc()}diff(){return Lc()}startOf(){return Lc()}endOf(){return Lc()}}var O5={_date:I1};function D5(t,e,r,n){const{controller:s,data:u,_sorted:d}=t,o=s._cachedMeta.iScale;if(o&&e===o.axis&&e!=="r"&&d&&u.length){const g=o._reversePixels?R4:Ea;if(n){if(s._sharedOptions){const x=u[0],E=typeof x.getRange=="function"&&x.getRange(e);if(E){const S=g(u,e,r-E),P=g(u,e,r+E);return{lo:S.lo,hi:P.hi}}}}else return g(u,e,r)}return{lo:0,hi:u.length-1}}function qp(t,e,r,n,s){const u=t.getSortedVisibleDatasetMetas(),d=r[e];for(let o=0,g=u.length;o<g;++o){const{index:x,data:E}=u[o],{lo:S,hi:P}=D5(u[o],e,d,s);for(let I=S;I<=P;++I){const R=E[I];R.skip||n(R,x,I)}}}function R5(t){const e=t.indexOf("x")!==-1,r=t.indexOf("y")!==-1;return function(n,s){const u=e?Math.abs(n.x-s.x):0,d=r?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(u,2)+Math.pow(d,2))}}function ax(t,e,r,n,s){const u=[];return!s&&!t.isPointInArea(e)||qp(t,r,e,function(o,g,x){!s&&!Cp(o,t.chartArea,0)||o.inRange(e.x,e.y,n)&&u.push({element:o,datasetIndex:g,index:x})},!0),u}function L5(t,e,r,n){let s=[];function u(d,o,g){const{startAngle:x,endAngle:E}=d.getProps(["startAngle","endAngle"],n),{angle:S}=NI(d,{x:e.x,y:e.y});Pp(S,x,E)&&s.push({element:d,datasetIndex:o,index:g})}return qp(t,r,e,u),s}function k5(t,e,r,n,s,u){let d=[];const o=R5(r);let g=Number.POSITIVE_INFINITY;function x(E,S,P){const I=E.inRange(e.x,e.y,s);if(n&&!I)return;const R=E.getCenterPoint(s);if(!(!!u||t.isPointInArea(R))&&!I)return;const B=o(e,R);B<g?(d=[{element:E,datasetIndex:S,index:P}],g=B):B===g&&d.push({element:E,datasetIndex:S,index:P})}return qp(t,r,e,x),d}function lx(t,e,r,n,s,u){return!u&&!t.isPointInArea(e)?[]:r==="r"&&!n?L5(t,e,r,s):k5(t,e,r,n,s,u)}function C2(t,e,r,n,s){const u=[],d=r==="x"?"inXRange":"inYRange";let o=!1;return qp(t,r,e,(g,x,E)=>{g[d](e[r],s)&&(u.push({element:g,datasetIndex:x,index:E}),o=o||g.inRange(e.x,e.y,s))}),n&&!o?[]:u}var z5={evaluateInteractionItems:qp,modes:{index(t,e,r,n){const s=Nc(e,t),u=r.axis||"x",d=r.includeInvisible||!1,o=r.intersect?ax(t,s,u,n,d):lx(t,s,u,!1,n,d),g=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(x=>{const E=o[0].index,S=x.data[E];S&&!S.skip&&g.push({element:S,datasetIndex:x.index,index:E})}),g):[]},dataset(t,e,r,n){const s=Nc(e,t),u=r.axis||"xy",d=r.includeInvisible||!1;let o=r.intersect?ax(t,s,u,n,d):lx(t,s,u,!1,n,d);if(o.length>0){const g=o[0].datasetIndex,x=t.getDatasetMeta(g).data;o=[];for(let E=0;E<x.length;++E)o.push({element:x[E],datasetIndex:g,index:E})}return o},point(t,e,r,n){const s=Nc(e,t),u=r.axis||"xy",d=r.includeInvisible||!1;return ax(t,s,u,n,d)},nearest(t,e,r,n){const s=Nc(e,t),u=r.axis||"xy",d=r.includeInvisible||!1;return lx(t,s,u,r.intersect,n,d)},x(t,e,r,n){const s=Nc(e,t);return C2(t,s,"x",r.intersect,n)},y(t,e,r,n){const s=Nc(e,t);return C2(t,s,"y",r.intersect,n)}}};const mM=["left","top","right","bottom"];function $f(t,e){return t.filter(r=>r.pos===e)}function I2(t,e){return t.filter(r=>mM.indexOf(r.pos)===-1&&r.box.axis===e)}function Vf(t,e){return t.sort((r,n)=>{const s=e?n:r,u=e?r:n;return s.weight===u.weight?s.index-u.index:s.weight-u.weight})}function F5(t){const e=[];let r,n,s,u,d,o;for(r=0,n=(t||[]).length;r<n;++r)s=t[r],{position:u,options:{stack:d,stackWeight:o=1}}=s,e.push({index:r,box:s,pos:u,horizontal:s.isHorizontal(),weight:s.weight,stack:d&&u+d,stackWeight:o});return e}function B5(t){const e={};for(const r of t){const{stack:n,pos:s,stackWeight:u}=r;if(!n||!mM.includes(s))continue;const d=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=u}return e}function N5(t,e){const r=B5(t),{vBoxMaxWidth:n,hBoxMaxHeight:s}=e;let u,d,o;for(u=0,d=t.length;u<d;++u){o=t[u];const{fullSize:g}=o.box,x=r[o.stack],E=x&&o.stackWeight/x.weight;o.horizontal?(o.width=E?E*n:g&&e.availableWidth,o.height=s):(o.width=n,o.height=E?E*s:g&&e.availableHeight)}return r}function j5(t){const e=F5(t),r=Vf(e.filter(x=>x.box.fullSize),!0),n=Vf($f(e,"left"),!0),s=Vf($f(e,"right")),u=Vf($f(e,"top"),!0),d=Vf($f(e,"bottom")),o=I2(e,"x"),g=I2(e,"y");return{fullSize:r,leftAndTop:n.concat(u),rightAndBottom:s.concat(g).concat(d).concat(o),chartArea:$f(e,"chartArea"),vertical:n.concat(s).concat(g),horizontal:u.concat(d).concat(o)}}function M2(t,e,r,n){return Math.max(t[r],e[r])+Math.max(t[n],e[n])}function gM(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function $5(t,e,r,n){const{pos:s,box:u}=r,d=t.maxPadding;if(!Ur(s)){r.size&&(t[s]-=r.size);const S=n[r.stack]||{size:0,count:1};S.size=Math.max(S.size,r.horizontal?u.height:u.width),r.size=S.size/S.count,t[s]+=r.size}u.getPadding&&gM(d,u.getPadding());const o=Math.max(0,e.outerWidth-M2(d,t,"left","right")),g=Math.max(0,e.outerHeight-M2(d,t,"top","bottom")),x=o!==t.w,E=g!==t.h;return t.w=o,t.h=g,r.horizontal?{same:x,other:E}:{same:E,other:x}}function V5(t){const e=t.maxPadding;function r(n){const s=Math.max(e[n]-t[n],0);return t[n]+=s,s}t.y+=r("top"),t.x+=r("left"),r("right"),r("bottom")}function U5(t,e){const r=e.maxPadding;function n(s){const u={left:0,top:0,right:0,bottom:0};return s.forEach(d=>{u[d]=Math.max(e[d],r[d])}),u}return n(t?["left","right"]:["top","bottom"])}function Qf(t,e,r,n){const s=[];let u,d,o,g,x,E;for(u=0,d=t.length,x=0;u<d;++u){o=t[u],g=o.box,g.update(o.width||e.w,o.height||e.h,U5(o.horizontal,e));const{same:S,other:P}=$5(e,r,o,n);x|=S&&s.length,E=E||P,g.fullSize||s.push(o)}return x&&Qf(s,e,r,n)||E}function Qg(t,e,r,n,s){t.top=r,t.left=e,t.right=e+n,t.bottom=r+s,t.width=n,t.height=s}function O2(t,e,r,n){const s=r.padding;let{x:u,y:d}=e;for(const o of t){const g=o.box,x=n[o.stack]||{count:1,placed:0,weight:1},E=o.stackWeight/x.weight||1;if(o.horizontal){const S=e.w*E,P=x.size||g.height;Hs(x.start)&&(d=x.start),g.fullSize?Qg(g,s.left,d,r.outerWidth-s.right-s.left,P):Qg(g,e.left+x.placed,d,S,P),x.start=d,x.placed+=S,d=g.bottom}else{const S=e.h*E,P=x.size||g.width;Hs(x.start)&&(u=x.start),g.fullSize?Qg(g,u,s.top,P,r.outerHeight-s.bottom-s.top):Qg(g,u,e.top+x.placed,P,S),x.start=u,x.placed+=S,u=g.right}}e.x=u,e.y=d}var On={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(r){e.draw(r)}}]},t.boxes.push(e)},removeBox(t,e){const r=t.boxes?t.boxes.indexOf(e):-1;r!==-1&&t.boxes.splice(r,1)},configure(t,e,r){e.fullSize=r.fullSize,e.position=r.position,e.weight=r.weight},update(t,e,r,n){if(!t)return;const s=Rn(t.options.layout.padding),u=Math.max(e-s.width,0),d=Math.max(r-s.height,0),o=j5(t.boxes),g=o.vertical,x=o.horizontal;oi(t.boxes,z=>{typeof z.beforeLayout=="function"&&z.beforeLayout()});const E=g.reduce((z,B)=>B.box.options&&B.box.options.display===!1?z:z+1,0)||1,S=Object.freeze({outerWidth:e,outerHeight:r,padding:s,availableWidth:u,availableHeight:d,vBoxMaxWidth:u/2/E,hBoxMaxHeight:d/2}),P=Object.assign({},s);gM(P,Rn(n));const I=Object.assign({maxPadding:P,w:u,h:d,x:s.left,y:s.top},s),R=N5(g.concat(x),S);Qf(o.fullSize,I,S,R),Qf(g,I,S,R),Qf(x,I,S,R)&&Qf(g,I,S,R),V5(I),O2(o.leftAndTop,I,S,R),I.x+=I.w,I.y+=I.h,O2(o.rightAndBottom,I,S,R),t.chartArea={left:I.left,top:I.top,right:I.left+I.w,bottom:I.top+I.h,height:I.h,width:I.w},oi(o.chartArea,z=>{const B=z.box;Object.assign(B,t.chartArea),B.update(I.w,I.h,{left:0,top:0,right:0,bottom:0})})}};class _M{acquireContext(e,r){}releaseContext(e){return!1}addEventListener(e,r,n){}removeEventListener(e,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,r,n,s){return r=Math.max(0,r||e.width),n=n||e.height,{width:r,height:Math.max(0,s?Math.floor(r/s):n)}}isAttached(e){return!0}updateConfig(e){}}class G5 extends _M{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const O_="$chartjs",H5={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},D2=t=>t===null||t==="";function W5(t,e){const r=t.style,n=t.getAttribute("height"),s=t.getAttribute("width");if(t[O_]={initial:{height:n,width:s,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",D2(s)){const u=p2(t,"width");u!==void 0&&(t.width=u)}if(D2(n))if(t.style.height==="")t.height=t.width/(e||2);else{const u=p2(t,"height");u!==void 0&&(t.height=u)}return t}const yM=qN?{passive:!0}:!1;function Z5(t,e,r){t.addEventListener(e,r,yM)}function q5(t,e,r){t.canvas.removeEventListener(e,r,yM)}function K5(t,e){const r=H5[t.type]||t.type,{x:n,y:s}=Nc(t,e);return{type:r,chart:e,native:t,x:n!==void 0?n:null,y:s!==void 0?s:null}}function ty(t,e){for(const r of t)if(r===e||r.contains(e))return!0}function X5(t,e,r){const n=t.canvas,s=new MutationObserver(u=>{let d=!1;for(const o of u)d=d||ty(o.addedNodes,n),d=d&&!ty(o.removedNodes,n);d&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}function Y5(t,e,r){const n=t.canvas,s=new MutationObserver(u=>{let d=!1;for(const o of u)d=d||ty(o.removedNodes,n),d=d&&!ty(o.addedNodes,n);d&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}const Mp=new Map;let R2=0;function vM(){const t=window.devicePixelRatio;t!==R2&&(R2=t,Mp.forEach((e,r)=>{r.currentDevicePixelRatio!==t&&e()}))}function J5(t,e){Mp.size||window.addEventListener("resize",vM),Mp.set(t,e)}function Q5(t){Mp.delete(t),Mp.size||window.removeEventListener("resize",vM)}function ej(t,e,r){const n=t.canvas,s=n&&C1(n);if(!s)return;const u=UI((o,g)=>{const x=s.clientWidth;r(o,g),x<s.clientWidth&&r()},window),d=new ResizeObserver(o=>{const g=o[0],x=g.contentRect.width,E=g.contentRect.height;x===0&&E===0||u(x,E)});return d.observe(s),J5(t,u),d}function cx(t,e,r){r&&r.disconnect(),e==="resize"&&Q5(t)}function tj(t,e,r){const n=t.canvas,s=UI(u=>{t.ctx!==null&&r(K5(u,t))},t);return Z5(n,e,s),s}class rj extends _M{acquireContext(e,r){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(W5(e,r),n):null}releaseContext(e){const r=e.canvas;if(!r[O_])return!1;const n=r[O_].initial;["height","width"].forEach(u=>{const d=n[u];Kr(d)?r.removeAttribute(u):r.setAttribute(u,d)});const s=n.style||{};return Object.keys(s).forEach(u=>{r.style[u]=s[u]}),r.width=r.width,delete r[O_],!0}addEventListener(e,r,n){this.removeEventListener(e,r);const s=e.$proxies||(e.$proxies={}),d={attach:X5,detach:Y5,resize:ej}[r]||tj;s[r]=d(e,r,n)}removeEventListener(e,r){const n=e.$proxies||(e.$proxies={}),s=n[r];if(!s)return;({attach:cx,detach:cx,resize:cx}[r]||q5)(e,r,s),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,r,n,s){return ZN(e,r,n,s)}isAttached(e){const r=C1(e);return!!(r&&r.isConnected)}}function ij(t){return!oM()||typeof OffscreenCanvas!="undefined"&&t instanceof OffscreenCanvas?G5:rj}class fo{constructor(){ir(this,"active",!1)}tooltipPosition(e){const{x:r,y:n}=this.getProps(["x","y"],e);return{x:r,y:n}}hasValue(){return Qh(this.x)&&Qh(this.y)}getProps(e,r){const n=this.$animations;if(!r||!n)return this;const s={};return e.forEach(u=>{s[u]=n[u]&&n[u].active()?n[u]._to:this[u]}),s}}ir(fo,"defaults",{}),ir(fo,"defaultRoutes");function nj(t,e){const r=t.options.ticks,n=sj(t),s=Math.min(r.maxTicksLimit||n,n),u=r.major.enabled?aj(e):[],d=u.length,o=u[0],g=u[d-1],x=[];if(d>s)return lj(e,x,u,d/s),x;const E=oj(u,e,s);if(d>0){let S,P;const I=d>1?Math.round((g-o)/(d-1)):null;for(e_(e,x,E,Kr(I)?0:o-I,o),S=0,P=d-1;S<P;S++)e_(e,x,E,u[S],u[S+1]);return e_(e,x,E,g,Kr(I)?e.length:g+I),x}return e_(e,x,E),x}function sj(t){const e=t.options.offset,r=t._tickSize(),n=t._length/r+(e?0:1),s=t._maxLength/r;return Math.floor(Math.min(n,s))}function oj(t,e,r){const n=cj(t),s=e.length/r;if(!n)return Math.max(s,1);const u=I4(n);for(let d=0,o=u.length-1;d<o;d++){const g=u[d];if(g>s)return g}return Math.max(s,1)}function aj(t){const e=[];let r,n;for(r=0,n=t.length;r<n;r++)t[r].major&&e.push(r);return e}function lj(t,e,r,n){let s=0,u=r[0],d;for(n=Math.ceil(n),d=0;d<t.length;d++)d===u&&(e.push(t[d]),s++,u=r[s*n])}function e_(t,e,r,n,s){const u=Ar(n,0),d=Math.min(Ar(s,t.length),t.length);let o=0,g,x,E;for(r=Math.ceil(r),s&&(g=s-n,r=g/Math.floor(g/r)),E=u;E<0;)o++,E=Math.round(u+o*r);for(x=Math.max(u,0);x<d;x++)x===E&&(e.push(t[x]),o++,E=Math.round(u+o*r))}function cj(t){const e=t.length;let r,n;if(e<2)return!1;for(n=t[0],r=1;r<e;++r)if(t[r]-t[r-1]!==n)return!1;return n}const uj=t=>t==="left"?"right":t==="right"?"left":t,L2=(t,e,r)=>e==="top"||e==="left"?t[e]+r:t[e]-r;function k2(t,e){const r=[],n=t.length/e,s=t.length;let u=0;for(;u<s;u+=n)r.push(t[Math.floor(u)]);return r}function hj(t,e,r){const n=t.ticks.length,s=Math.min(e,n-1),u=t._startPixel,d=t._endPixel,o=1e-6;let g=t.getPixelForTick(s),x;if(!(r&&(n===1?x=Math.max(g-u,d-g):e===0?x=(t.getPixelForTick(1)-g)/2:x=(g-t.getPixelForTick(s-1))/2,g+=s<e?x:-x,g<u-o||g>d+o)))return g}function dj(t,e){oi(t,r=>{const n=r.gc,s=n.length/2;let u;if(s>e){for(u=0;u<s;++u)delete r.data[n[u]];n.splice(0,s)}})}function Uf(t){return t.drawTicks?t.tickLength:0}function z2(t,e){if(!t.display)return 0;const r=tn(t.font,e),n=Rn(t.padding);return(bi(t.text)?t.text.length:1)*r.lineHeight+n.height}function fj(t,e){return Ul(t,{scale:e,type:"scale"})}function pj(t,e,r){return Ul(t,{tick:r,index:e,type:"tick"})}function mj(t,e,r){let n=x1(t);return(r&&e!=="right"||!r&&e==="right")&&(n=uj(n)),n}function gj(t,e,r,n){const{top:s,left:u,bottom:d,right:o,chart:g}=t,{chartArea:x,scales:E}=g;let S=0,P,I,R;const z=d-s,B=o-u;if(t.isHorizontal()){if(I=In(n,u,o),Ur(r)){const $=Object.keys(r)[0],j=r[$];R=E[$].getPixelForValue(j)+z-e}else r==="center"?R=(x.bottom+x.top)/2+z-e:R=L2(t,r,e);P=o-u}else{if(Ur(r)){const $=Object.keys(r)[0],j=r[$];I=E[$].getPixelForValue(j)-B+e}else r==="center"?I=(x.left+x.right)/2-B+e:I=L2(t,r,e);R=In(n,d,s),S=r==="left"?-ji:ji}return{titleX:I,titleY:R,maxWidth:P,rotation:S}}class pu extends fo{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,r){return e}getUserBounds(){let{_userMin:e,_userMax:r,_suggestedMin:n,_suggestedMax:s}=this;return e=vs(e,Number.POSITIVE_INFINITY),r=vs(r,Number.NEGATIVE_INFINITY),n=vs(n,Number.POSITIVE_INFINITY),s=vs(s,Number.NEGATIVE_INFINITY),{min:vs(e,n),max:vs(r,s),minDefined:Ni(e),maxDefined:Ni(r)}}getMinMax(e){let{min:r,max:n,minDefined:s,maxDefined:u}=this.getUserBounds(),d;if(s&&u)return{min:r,max:n};const o=this.getMatchingVisibleMetas();for(let g=0,x=o.length;g<x;++g)d=o[g].controller.getMinMax(this,e),s||(r=Math.min(r,d.min)),u||(n=Math.max(n,d.max));return r=u&&r>n?n:r,n=s&&r>n?r:n,{min:vs(r,vs(n,r)),max:vs(n,vs(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){mi(this.options.beforeUpdate,[this])}update(e,r,n){const{beginAtZero:s,grace:u,ticks:d}=this.options,o=d.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=SN(this,u,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const g=o<this.ticks.length;this._convertTicksToLabels(g?k2(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=nj(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),g&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,e=!e),this._startPixel=r,this._endPixel=n,this._reversePixels=e,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){mi(this.options.afterUpdate,[this])}beforeSetDimensions(){mi(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){mi(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),mi(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){mi(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const r=this.options.ticks;let n,s,u;for(n=0,s=e.length;n<s;n++)u=e[n],u.label=mi(r.callback,[u.value,n,e],this)}afterTickToLabelConversion(){mi(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){mi(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,r=e.ticks,n=this.ticks.length,s=r.minRotation||0,u=r.maxRotation;let d=s,o,g,x;if(!this._isVisible()||!r.display||s>=u||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const E=this._getLabelSizes(),S=E.widest.width,P=E.highest.height,I=un(this.chart.width-S,0,this.maxWidth);o=e.offset?this.maxWidth/n:I/(n-1),S+6>o&&(o=I/(n-(e.offset?.5:1)),g=this.maxHeight-Uf(e.grid)-r.padding-z2(e.title,this.chart.options.font),x=Math.sqrt(S*S+P*P),d=y1(Math.min(Math.asin(un((E.highest.height+6)/o,-1,1)),Math.asin(un(g/x,-1,1))-Math.asin(un(P/x,-1,1)))),d=Math.max(s,Math.min(u,d))),this.labelRotation=d}afterCalculateLabelRotation(){mi(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){mi(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:r,options:{ticks:n,title:s,grid:u}}=this,d=this._isVisible(),o=this.isHorizontal();if(d){const g=z2(s,r.options.font);if(o?(e.width=this.maxWidth,e.height=Uf(u)+g):(e.height=this.maxHeight,e.width=Uf(u)+g),n.display&&this.ticks.length){const{first:x,last:E,widest:S,highest:P}=this._getLabelSizes(),I=n.padding*2,R=ao(this.labelRotation),z=Math.cos(R),B=Math.sin(R);if(o){const $=n.mirror?0:B*S.width+z*P.height;e.height=Math.min(this.maxHeight,e.height+$+I)}else{const $=n.mirror?0:z*S.width+B*P.height;e.width=Math.min(this.maxWidth,e.width+$+I)}this._calculatePadding(x,E,B,z)}}this._handleMargins(),o?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,r,n,s){const{ticks:{align:u,padding:d},position:o}=this.options,g=this.labelRotation!==0,x=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const E=this.getPixelForTick(0)-this.left,S=this.right-this.getPixelForTick(this.ticks.length-1);let P=0,I=0;g?x?(P=s*e.width,I=n*r.height):(P=n*e.height,I=s*r.width):u==="start"?I=r.width:u==="end"?P=e.width:u!=="inner"&&(P=e.width/2,I=r.width/2),this.paddingLeft=Math.max((P-E+d)*this.width/(this.width-E),0),this.paddingRight=Math.max((I-S+d)*this.width/(this.width-S),0)}else{let E=r.height/2,S=e.height/2;u==="start"?(E=0,S=e.height):u==="end"&&(E=r.height,S=0),this.paddingTop=E+d,this.paddingBottom=S+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){mi(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:r}=this.options;return r==="top"||r==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let r,n;for(r=0,n=e.length;r<n;r++)Kr(e[r].label)&&(e.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=k2(n,r)),this._labelSizes=e=this._computeLabelSizes(n,n.length)}return e}_computeLabelSizes(e,r){const{ctx:n,_longestTextCache:s}=this,u=[],d=[];let o=0,g=0,x,E,S,P,I,R,z,B,$,j,G;for(x=0;x<r;++x){if(P=e[x].label,I=this._resolveTickFontOptions(x),n.font=R=I.string,z=s[R]=s[R]||{data:{},gc:[]},B=I.lineHeight,$=j=0,!Kr(P)&&!bi(P))$=Q_(n,z.data,z.gc,$,P),j=B;else if(bi(P))for(E=0,S=P.length;E<S;++E)G=P[E],!Kr(G)&&!bi(G)&&($=Q_(n,z.data,z.gc,$,G),j+=B);u.push($),d.push(j),o=Math.max($,o),g=Math.max(j,g)}dj(s,r);const K=u.indexOf(o),X=d.indexOf(g),re=ue=>({width:u[ue]||0,height:d[ue]||0});return{first:re(0),last:re(r-1),widest:re(K),highest:re(X),widths:u,heights:d}}getLabelForValue(e){return e}getPixelForValue(e,r){return NaN}getValueForPixel(e){}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const r=this._startPixel+e*this._length;return D4(this._alignToPixels?Rc(this.chart,r,0):r)}getDecimalForPixel(e){const r=(e-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:r}=this;return e<0&&r<0?r:e>0&&r>0?e:0}getContext(e){const r=this.ticks||[];if(e>=0&&e<r.length){const n=r[e];return n.$context||(n.$context=pj(this.getContext(),e,n))}return this.$context||(this.$context=fj(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,r=ao(this.labelRotation),n=Math.abs(Math.cos(r)),s=Math.abs(Math.sin(r)),u=this._getLabelSizes(),d=e.autoSkipPadding||0,o=u?u.widest.width+d:0,g=u?u.highest.height+d:0;return this.isHorizontal()?g*n>o*s?o/n:g/s:g*s<o*n?g/n:o/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const r=this.axis,n=this.chart,s=this.options,{grid:u,position:d,border:o}=s,g=u.offset,x=this.isHorizontal(),S=this.ticks.length+(g?1:0),P=Uf(u),I=[],R=o.setContext(this.getContext()),z=R.display?R.width:0,B=z/2,$=function(Ve){return Rc(n,Ve,z)};let j,G,K,X,re,ue,ne,we,xe,ke,Ie,Fe;if(d==="top")j=$(this.bottom),ue=this.bottom-P,we=j-B,ke=$(e.top)+B,Fe=e.bottom;else if(d==="bottom")j=$(this.top),ke=e.top,Fe=$(e.bottom)-B,ue=j+B,we=this.top+P;else if(d==="left")j=$(this.right),re=this.right-P,ne=j-B,xe=$(e.left)+B,Ie=e.right;else if(d==="right")j=$(this.left),xe=e.left,Ie=$(e.right)-B,re=j+B,ne=this.left+P;else if(r==="x"){if(d==="center")j=$((e.top+e.bottom)/2+.5);else if(Ur(d)){const Ve=Object.keys(d)[0],Je=d[Ve];j=$(this.chart.scales[Ve].getPixelForValue(Je))}ke=e.top,Fe=e.bottom,ue=j+B,we=ue+P}else if(r==="y"){if(d==="center")j=$((e.left+e.right)/2);else if(Ur(d)){const Ve=Object.keys(d)[0],Je=d[Ve];j=$(this.chart.scales[Ve].getPixelForValue(Je))}re=j-B,ne=re-P,xe=e.left,Ie=e.right}const se=Ar(s.ticks.maxTicksLimit,S),Be=Math.max(1,Math.ceil(S/se));for(G=0;G<S;G+=Be){const Ve=this.getContext(G),Je=u.setContext(Ve),ut=o.setContext(Ve),ht=Je.lineWidth,Et=Je.color,Qt=ut.dash||[],Nt=ut.dashOffset,yt=Je.tickWidth,et=Je.tickColor,Ne=Je.tickBorderDash||[],tt=Je.tickBorderDashOffset;K=hj(this,G,g),K!==void 0&&(X=Rc(n,K,ht),x?re=ne=xe=Ie=X:ue=we=ke=Fe=X,I.push({tx1:re,ty1:ue,tx2:ne,ty2:we,x1:xe,y1:ke,x2:Ie,y2:Fe,width:ht,color:Et,borderDash:Qt,borderDashOffset:Nt,tickWidth:yt,tickColor:et,tickBorderDash:Ne,tickBorderDashOffset:tt}))}return this._ticksLength=S,this._borderValue=j,I}_computeLabelItems(e){const r=this.axis,n=this.options,{position:s,ticks:u}=n,d=this.isHorizontal(),o=this.ticks,{align:g,crossAlign:x,padding:E,mirror:S}=u,P=Uf(n.grid),I=P+E,R=S?-E:I,z=-ao(this.labelRotation),B=[];let $,j,G,K,X,re,ue,ne,we,xe,ke,Ie,Fe="middle";if(s==="top")re=this.bottom-R,ue=this._getXAxisLabelAlignment();else if(s==="bottom")re=this.top+R,ue=this._getXAxisLabelAlignment();else if(s==="left"){const Be=this._getYAxisLabelAlignment(P);ue=Be.textAlign,X=Be.x}else if(s==="right"){const Be=this._getYAxisLabelAlignment(P);ue=Be.textAlign,X=Be.x}else if(r==="x"){if(s==="center")re=(e.top+e.bottom)/2+I;else if(Ur(s)){const Be=Object.keys(s)[0],Ve=s[Be];re=this.chart.scales[Be].getPixelForValue(Ve)+I}ue=this._getXAxisLabelAlignment()}else if(r==="y"){if(s==="center")X=(e.left+e.right)/2-I;else if(Ur(s)){const Be=Object.keys(s)[0],Ve=s[Be];X=this.chart.scales[Be].getPixelForValue(Ve)}ue=this._getYAxisLabelAlignment(P).textAlign}r==="y"&&(g==="start"?Fe="top":g==="end"&&(Fe="bottom"));const se=this._getLabelSizes();for($=0,j=o.length;$<j;++$){G=o[$],K=G.label;const Be=u.setContext(this.getContext($));ne=this.getPixelForTick($)+u.labelOffset,we=this._resolveTickFontOptions($),xe=we.lineHeight,ke=bi(K)?K.length:1;const Ve=ke/2,Je=Be.color,ut=Be.textStrokeColor,ht=Be.textStrokeWidth;let Et=ue;d?(X=ne,ue==="inner"&&($===j-1?Et=this.options.reverse?"left":"right":$===0?Et=this.options.reverse?"right":"left":Et="center"),s==="top"?x==="near"||z!==0?Ie=-ke*xe+xe/2:x==="center"?Ie=-se.highest.height/2-Ve*xe+xe:Ie=-se.highest.height+xe/2:x==="near"||z!==0?Ie=xe/2:x==="center"?Ie=se.highest.height/2-Ve*xe:Ie=se.highest.height-ke*xe,S&&(Ie*=-1),z!==0&&!Be.showLabelBackdrop&&(X+=xe/2*Math.sin(z))):(re=ne,Ie=(1-ke)*xe/2);let Qt;if(Be.showLabelBackdrop){const Nt=Rn(Be.backdropPadding),yt=se.heights[$],et=se.widths[$];let Ne=Ie-Nt.top,tt=0-Nt.left;switch(Fe){case"middle":Ne-=yt/2;break;case"bottom":Ne-=yt;break}switch(ue){case"center":tt-=et/2;break;case"right":tt-=et;break}Qt={left:tt,top:Ne,width:et+Nt.width,height:yt+Nt.height,color:Be.backdropColor}}B.push({rotation:z,label:K,font:we,color:Je,strokeColor:ut,strokeWidth:ht,textOffset:Ie,textAlign:Et,textBaseline:Fe,translation:[X,re],backdrop:Qt})}return B}_getXAxisLabelAlignment(){const{position:e,ticks:r}=this.options;if(-ao(this.labelRotation))return e==="top"?"left":"right";let s="center";return r.align==="start"?s="left":r.align==="end"?s="right":r.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:r,ticks:{crossAlign:n,mirror:s,padding:u}}=this.options,d=this._getLabelSizes(),o=e+u,g=d.widest.width;let x,E;return r==="left"?s?(E=this.right+u,n==="near"?x="left":n==="center"?(x="center",E+=g/2):(x="right",E+=g)):(E=this.right-o,n==="near"?x="right":n==="center"?(x="center",E-=g/2):(x="left",E=this.left)):r==="right"?s?(E=this.left+u,n==="near"?x="right":n==="center"?(x="center",E-=g/2):(x="left",E-=g)):(E=this.left+o,n==="near"?x="left":n==="center"?(x="center",E+=g/2):(x="right",E=this.right)):x="right",{textAlign:x,x:E}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:r},left:n,top:s,width:u,height:d}=this;r&&(e.save(),e.fillStyle=r,e.fillRect(n,s,u,d),e.restore())}getLineWidthForValue(e){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const s=this.ticks.findIndex(u=>u.value===e);return s>=0?r.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const r=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let u,d;const o=(g,x,E)=>{!E.width||!E.color||(n.save(),n.lineWidth=E.width,n.strokeStyle=E.color,n.setLineDash(E.borderDash||[]),n.lineDashOffset=E.borderDashOffset,n.beginPath(),n.moveTo(g.x,g.y),n.lineTo(x.x,x.y),n.stroke(),n.restore())};if(r.display)for(u=0,d=s.length;u<d;++u){const g=s[u];r.drawOnChartArea&&o({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},g),r.drawTicks&&o({x:g.tx1,y:g.ty1},{x:g.tx2,y:g.ty2},{color:g.tickColor,width:g.tickWidth,borderDash:g.tickBorderDash,borderDashOffset:g.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:r,options:{border:n,grid:s}}=this,u=n.setContext(this.getContext()),d=n.display?u.width:0;if(!d)return;const o=s.setContext(this.getContext(0)).lineWidth,g=this._borderValue;let x,E,S,P;this.isHorizontal()?(x=Rc(e,this.left,d)-d/2,E=Rc(e,this.right,o)+o/2,S=P=g):(S=Rc(e,this.top,d)-d/2,P=Rc(e,this.bottom,o)+o/2,x=E=g),r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.beginPath(),r.moveTo(x,S),r.lineTo(E,P),r.stroke(),r.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&ev(n,s);const u=this._labelItems||(this._labelItems=this._computeLabelItems(e));let d,o;for(d=0,o=u.length;d<o;++d){const g=u[d],x=g.font,E=g.label;let S=g.textOffset;cu(n,E,0,S,x,g)}s&&tv(n)}drawTitle(){const{ctx:e,options:{position:r,title:n,reverse:s}}=this;if(!n.display)return;const u=tn(n.font),d=Rn(n.padding),o=n.align;let g=u.lineHeight/2;r==="bottom"||r==="center"||Ur(r)?(g+=d.bottom,bi(n.text)&&(g+=u.lineHeight*(n.text.length-1))):g+=d.top;const{titleX:x,titleY:E,maxWidth:S,rotation:P}=gj(this,g,r,o);cu(e,n.text,0,0,u,{color:n.color,maxWidth:S,rotation:P,textAlign:mj(o,r,s),textBaseline:"middle",translation:[x,E]})}draw(e){!this._isVisible()||(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,r=e.ticks&&e.ticks.z||0,n=Ar(e.grid&&e.grid.z,-1),s=Ar(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==pu.prototype.draw?[{z:r,draw:u=>{this.draw(u)}}]:[{z:n,draw:u=>{this.drawBackground(),this.drawGrid(u),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:r,draw:u=>{this.drawLabels(u)}}]}getMatchingVisibleMetas(e){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let u,d;for(u=0,d=r.length;u<d;++u){const o=r[u];o[n]===this.id&&(!e||o.type===e)&&s.push(o)}return s}_resolveTickFontOptions(e){const r=this.options.ticks.setContext(this.getContext(e));return tn(r.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class t_{constructor(e,r,n){this.type=e,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const r=Object.getPrototypeOf(e);let n;vj(r)&&(n=this.register(r));const s=this.items,u=e.id,d=this.scope+"."+u;if(!u)throw new Error("class does not have id: "+e);return u in s||(s[u]=e,_j(e,d,n),this.override&&Gi.override(e.id,e.overrides)),d}get(e){return this.items[e]}unregister(e){const r=this.items,n=e.id,s=this.scope;n in r&&delete r[n],s&&n in Gi[s]&&(delete Gi[s][n],this.override&&delete lu[n])}}function _j(t,e,r){const n=Ap(Object.create(null),[r?Gi.get(r):{},Gi.get(e),t.defaults]);Gi.set(e,n),t.defaultRoutes&&yj(e,t.defaultRoutes),t.descriptors&&Gi.describe(e,t.descriptors)}function yj(t,e){Object.keys(e).forEach(r=>{const n=r.split("."),s=n.pop(),u=[t].concat(n).join("."),d=e[r].split("."),o=d.pop(),g=d.join(".");Gi.route(u,s,g,o)})}function vj(t){return"id"in t&&"defaults"in t}class xj{constructor(){this.controllers=new t_(uo,"datasets",!0),this.elements=new t_(fo,"elements"),this.plugins=new t_(Object,"plugins"),this.scales=new t_(pu,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,r,n){[...r].forEach(s=>{const u=n||this._getRegistryForType(s);n||u.isForType(s)||u===this.plugins&&s.id?this._exec(e,u,s):oi(s,d=>{const o=n||this._getRegistryForType(d);this._exec(e,o,d)})})}_exec(e,r,n){const s=_1(e);mi(n["before"+s],[],n),r[e](n),mi(n["after"+s],[],n)}_getRegistryForType(e){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(e))return n}return this.plugins}_get(e,r,n){const s=r.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return s}}var ko=new xj;class bj{constructor(){this._init=[]}notify(e,r,n,s){r==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const u=s?this._descriptors(e).filter(s):this._descriptors(e),d=this._notify(u,e,r,n);return r==="afterDestroy"&&(this._notify(u,e,"stop"),this._notify(this._init,e,"uninstall")),d}_notify(e,r,n,s){s=s||{};for(const u of e){const d=u.plugin,o=d[n],g=[r,s,u.options];if(mi(o,g,d)===!1&&s.cancelable)return!1}return!0}invalidate(){Kr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),r}_createDescriptors(e,r){const n=e&&e.config,s=Ar(n.options&&n.options.plugins,{}),u=wj(n);return s===!1&&!r?[]:Tj(e,u,s,r)}_notifyStateChanges(e){const r=this._oldCache||[],n=this._cache,s=(u,d)=>u.filter(o=>!d.some(g=>o.plugin.id===g.plugin.id));this._notify(s(r,n),e,"stop"),this._notify(s(n,r),e,"start")}}function wj(t){const e={},r=[],n=Object.keys(ko.plugins.items);for(let u=0;u<n.length;u++)r.push(ko.getPlugin(n[u]));const s=t.plugins||[];for(let u=0;u<s.length;u++){const d=s[u];r.indexOf(d)===-1&&(r.push(d),e[d.id]=!0)}return{plugins:r,localIds:e}}function Ej(t,e){return!e&&t===!1?null:t===!0?{}:t}function Tj(t,{plugins:e,localIds:r},n,s){const u=[],d=t.getContext();for(const o of e){const g=o.id,x=Ej(n[g],s);x!==null&&u.push({plugin:o,options:Sj(t.config,{plugin:o,local:r[g]},x,d)})}return u}function Sj(t,{plugin:e,local:r},n,s){const u=t.pluginScopeKeys(e),d=t.getOptionScopes(n,u);return r&&e.defaults&&d.push(e.defaults),t.createResolver(d,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function fb(t,e){const r=Gi.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||r.indexAxis||"x"}function Aj(t,e){let r=t;return t==="_index_"?r=e:t==="_value_"&&(r=e==="x"?"y":"x"),r}function Pj(t,e){return t===e?"_index_":"_value_"}function Cj(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function ry(t,e){if(t==="x"||t==="y"||t==="r"||(t=e.axis||Cj(e.position)||t.length>1&&ry(t[0].toLowerCase(),e),t))return t;throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`)}function Ij(t,e){const r=lu[t.type]||{scales:{}},n=e.scales||{},s=fb(t.type,e),u=Object.create(null);return Object.keys(n).forEach(d=>{const o=n[d];if(!Ur(o))return console.error(`Invalid scale configuration for scale: ${d}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const g=ry(d,o),x=Pj(g,s),E=r.scales||{};u[d]=dp(Object.create(null),[{axis:g},o,E[g],E[x]])}),t.data.datasets.forEach(d=>{const o=d.type||t.type,g=d.indexAxis||fb(o,e),E=(lu[o]||{}).scales||{};Object.keys(E).forEach(S=>{const P=Aj(S,g),I=d[P+"AxisID"]||P;u[I]=u[I]||Object.create(null),dp(u[I],[{axis:P},n[I],E[S]])})}),Object.keys(u).forEach(d=>{const o=u[d];dp(o,[Gi.scales[o.type],Gi.scale])}),u}function xM(t){const e=t.options||(t.options={});e.plugins=Ar(e.plugins,{}),e.scales=Ij(t,e)}function bM(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function Mj(t){return t=t||{},t.data=bM(t.data),xM(t),t}const F2=new Map,wM=new Set;function r_(t,e){let r=F2.get(t);return r||(r=e(),F2.set(t,r),wM.add(r)),r}const Gf=(t,e,r)=>{const n=Fl(e,r);n!==void 0&&t.add(n)};class Oj{constructor(e){this._config=Mj(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=bM(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),xM(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return r_(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,r){return r_(`${e}.transition.${r}`,()=>[[`datasets.${e}.transitions.${r}`,`transitions.${r}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,r){return r_(`${e}-${r}`,()=>[[`datasets.${e}.elements.${r}`,`datasets.${e}`,`elements.${r}`,""]])}pluginScopeKeys(e){const r=e.id,n=this.type;return r_(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,r){const n=this._scopeCache;let s=n.get(e);return(!s||r)&&(s=new Map,n.set(e,s)),s}getOptionScopes(e,r,n){const{options:s,type:u}=this,d=this._cachedScopes(e,n),o=d.get(r);if(o)return o;const g=new Set;r.forEach(E=>{e&&(g.add(e),E.forEach(S=>Gf(g,e,S))),E.forEach(S=>Gf(g,s,S)),E.forEach(S=>Gf(g,lu[u]||{},S)),E.forEach(S=>Gf(g,Gi,S)),E.forEach(S=>Gf(g,ub,S))});const x=Array.from(g);return x.length===0&&x.push(Object.create(null)),wM.has(r)&&d.set(r,x),x}chartOptionScopes(){const{options:e,type:r}=this;return[e,lu[r]||{},Gi.datasets[r]||{},{type:r},Gi,ub]}resolveNamedOptions(e,r,n,s=[""]){const u={$shared:!0},{resolver:d,subPrefixes:o}=B2(this._resolverCache,e,s);let g=d;if(Rj(d,r)){u.$shared=!1,n=Bl(n)?n():n;const x=this.createResolver(e,n,o);g=ed(d,n,x)}for(const x of r)u[x]=g[x];return u}createResolver(e,r,n=[""],s){const{resolver:u}=B2(this._resolverCache,e,n);return Ur(r)?ed(u,r,void 0,s):u}}function B2(t,e,r){let n=t.get(e);n||(n=new Map,t.set(e,n));const s=r.join();let u=n.get(s);return u||(u={resolver:S1(e,r),subPrefixes:r.filter(o=>!o.toLowerCase().includes("hover"))},n.set(s,u)),u}const Dj=t=>Ur(t)&&Object.getOwnPropertyNames(t).reduce((e,r)=>e||Bl(t[r]),!1);function Rj(t,e){const{isScriptable:r,isIndexable:n}=eM(t);for(const s of e){const u=r(s),d=n(s),o=(d||u)&&t[s];if(u&&(Bl(o)||Dj(o))||d&&bi(o))return!0}return!1}var Lj="4.0.1";const kj=["top","bottom","left","right","chartArea"];function N2(t,e){return t==="top"||t==="bottom"||kj.indexOf(t)===-1&&e==="x"}function j2(t,e){return function(r,n){return r[t]===n[t]?r[e]-n[e]:r[t]-n[t]}}function $2(t){const e=t.chart,r=e.options.animation;e.notifyPlugins("afterRender"),mi(r&&r.onComplete,[t],e)}function zj(t){const e=t.chart,r=e.options.animation;mi(r&&r.onProgress,[t],e)}function EM(t){return oM()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const D_={},V2=t=>{const e=EM(t);return Object.values(D_).filter(r=>r.canvas===e).pop()};function Fj(t,e,r){const n=Object.keys(t);for(const s of n){const u=+s;if(u>=e){const d=t[s];delete t[s],(r>0||u>e)&&(t[u+r]=d)}}}function Bj(t,e,r,n){return!r||t.type==="mouseout"?null:n?e:t}function Nj(t){const{xScale:e,yScale:r}=t;if(e&&r)return{left:e.left,right:e.right,top:r.top,bottom:r.bottom}}class xl{static register(...e){ko.add(...e),U2()}static unregister(...e){ko.remove(...e),U2()}constructor(e,r){const n=this.config=new Oj(r),s=EM(e),u=V2(s);if(u)throw new Error("Canvas is already in use. Chart with ID '"+u.id+"' must be destroyed before the canvas with ID '"+u.canvas.id+"' can be reused.");const d=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||ij(s)),this.platform.updateConfig(n);const o=this.platform.acquireContext(s,d.aspectRatio),g=o&&o.canvas,x=g&&g.height,E=g&&g.width;if(this.id=x4(),this.ctx=o,this.canvas=g,this.width=E,this.height=x,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new bj,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=z4(S=>this.update(S),d.resizeDelay||0),this._dataChanges=[],D_[this.id]=this,!o||!g){console.error("Failed to create chart: can't acquire context from the given item");return}fa.listen(this,"complete",$2),fa.listen(this,"progress",zj),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:r},width:n,height:s,_aspectRatio:u}=this;return Kr(e)?r&&u?u:s?n/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ko}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():f2(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return u2(this.canvas,this.ctx),this}stop(){return fa.stop(this),this}resize(e,r){fa.running(this)?this._resizeBeforeDraw={width:e,height:r}:this._resize(e,r)}_resize(e,r){const n=this.options,s=this.canvas,u=n.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(s,e,r,u),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),g=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,f2(this,o,!0)&&(this.notifyPlugins("resize",{size:d}),mi(n.onResize,[this,d],this),this.attached&&this._doResize(g)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};oi(r,(n,s)=>{n.id=s})}buildOrUpdateScales(){const e=this.options,r=e.scales,n=this.scales,s=Object.keys(n).reduce((d,o)=>(d[o]=!1,d),{});let u=[];r&&(u=u.concat(Object.keys(r).map(d=>{const o=r[d],g=ry(d,o),x=g==="r",E=g==="x";return{options:o,dposition:x?"chartArea":E?"bottom":"left",dtype:x?"radialLinear":E?"category":"linear"}}))),oi(u,d=>{const o=d.options,g=o.id,x=ry(g,o),E=Ar(o.type,d.dtype);(o.position===void 0||N2(o.position,x)!==N2(d.dposition))&&(o.position=d.dposition),s[g]=!0;let S=null;if(g in n&&n[g].type===E)S=n[g];else{const P=ko.getScale(E);S=new P({id:g,type:E,ctx:this.ctx,chart:this}),n[S.id]=S}S.init(o,e)}),oi(s,(d,o)=>{d||delete n[o]}),oi(n,d=>{On.configure(this,d,d.options),On.addBox(this,d)})}_updateMetasets(){const e=this._metasets,r=this.data.datasets.length,n=e.length;if(e.sort((s,u)=>s.index-u.index),n>r){for(let s=r;s<n;++s)this._destroyDatasetMeta(s);e.splice(r,n-r)}this._sortedMetasets=e.slice(0).sort(j2("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:r}}=this;e.length>r.length&&delete this._stacks,e.forEach((n,s)=>{r.filter(u=>u===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],r=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=r.length;n<s;n++){const u=r[n];let d=this.getDatasetMeta(n);const o=u.type||this.config.type;if(d.type&&d.type!==o&&(this._destroyDatasetMeta(n),d=this.getDatasetMeta(n)),d.type=o,d.indexAxis=u.indexAxis||fb(o,this.options),d.order=u.order||0,d.index=n,d.label=""+u.label,d.visible=this.isDatasetVisible(n),d.controller)d.controller.updateIndex(n),d.controller.linkScales();else{const g=ko.getController(o),{datasetElementType:x,dataElementType:E}=Gi.datasets[o];Object.assign(g,{dataElementType:ko.getElement(E),datasetElementType:x&&ko.getElement(x)}),d.controller=new g(this,n),e.push(d.controller)}}return this._updateMetasets(),e}_resetElements(){oi(this.data.datasets,(e,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const u=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let x=0,E=this.data.datasets.length;x<E;x++){const{controller:S}=this.getDatasetMeta(x),P=!s&&u.indexOf(S)===-1;S.buildOrUpdateElements(P),d=Math.max(+S.getMaxOverflow(),d)}d=this._minPadding=n.layout.autoPadding?d:0,this._updateLayout(d),s||oi(u,x=>{x.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(j2("z","_idx"));const{_active:o,_lastEvent:g}=this;g?this._eventHandler(g,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){oi(this.scales,e=>{On.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!XS(r,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:u}of r){const d=n==="_removeElements"?-u:u;Fj(e,s,d)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=u=>new Set(e.filter(d=>d[0]===u).map((d,o)=>o+","+d.splice(1).join(","))),s=n(0);for(let u=1;u<r;u++)if(!XS(s,n(u)))return;return Array.from(s).map(u=>u.split(",")).map(u=>({method:u[1],start:+u[2],count:+u[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;On.update(this,this.width,this.height,e);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],oi(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,u)=>{s._idx=u}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,Bl(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,r){const n=this.getDatasetMeta(e),s={meta:n,index:e,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(r),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(fa.has(this)?this.attached&&!fa.running(this)&&fa.start(this):(this.draw(),$2({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resize(n,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(e=0;e<r.length&&r[e].z<=0;++e)r[e].draw(this.chartArea);for(this._drawDatasets();e<r.length;++e)r[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const r=this._sortedMetasets,n=[];let s,u;for(s=0,u=r.length;s<u;++s){const d=r[s];(!e||d.visible)&&n.push(d)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let r=e.length-1;r>=0;--r)this._drawDataset(e[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const r=this.ctx,n=e._clip,s=!n.disabled,u=Nj(e)||this.chartArea,d={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(s&&ev(r,{left:n.left===!1?0:u.left-n.left,right:n.right===!1?this.width:u.right+n.right,top:n.top===!1?0:u.top-n.top,bottom:n.bottom===!1?this.height:u.bottom+n.bottom}),e.controller.draw(),s&&tv(r),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}isPointInArea(e){return Cp(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,r,n,s){const u=z5.modes[r];return typeof u=="function"?u(this,e,n,s):[]}getDatasetMeta(e){const r=this.data.datasets[e],n=this._metasets;let s=n.filter(u=>u&&u._dataset===r).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:e,_dataset:r,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=Ul(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const r=this.data.datasets[e];if(!r)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(e,r){const n=this.getDatasetMeta(e);n.hidden=!r}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,r,n){const s=n?"show":"hide",u=this.getDatasetMeta(e),d=u.controller._resolveAnimations(void 0,s);Hs(r)?(u.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),d.update(u,{visible:n}),this.update(o=>o.datasetIndex===e?s:void 0))}hide(e,r){this._updateVisibility(e,r,!1)}show(e,r){this._updateVisibility(e,r,!0)}_destroyDatasetMeta(e){const r=this._metasets[e];r&&r.controller&&r.controller._destroy(),delete this._metasets[e]}_stop(){let e,r;for(this.stop(),fa.remove(this),e=0,r=this.data.datasets.length;e<r;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:r}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),u2(e,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete D_[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,r=this.platform,n=(u,d)=>{r.addEventListener(this,u,d),e[u]=d},s=(u,d,o)=>{u.offsetX=d,u.offsetY=o,this._eventHandler(u)};oi(this.options.events,u=>n(u,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,r=this.platform,n=(g,x)=>{r.addEventListener(this,g,x),e[g]=x},s=(g,x)=>{e[g]&&(r.removeEventListener(this,g,x),delete e[g])},u=(g,x)=>{this.canvas&&this.resize(g,x)};let d;const o=()=>{s("attach",o),this.attached=!0,this.resize(),n("resize",u),n("detach",d)};d=()=>{this.attached=!1,s("resize",u),this._stop(),this._resize(0,0),n("attach",o)},r.isAttached(this.canvas)?o():d()}unbindEvents(){oi(this._listeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._listeners={},oi(this._responsiveListeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,r,n){const s=n?"set":"remove";let u,d,o,g;for(r==="dataset"&&(u=this.getDatasetMeta(e[0].datasetIndex),u.controller["_"+s+"DatasetHoverStyle"]()),o=0,g=e.length;o<g;++o){d=e[o];const x=d&&this.getDatasetMeta(d.datasetIndex).controller;x&&x[s+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const r=this._active||[],n=e.map(({datasetIndex:u,index:d})=>{const o=this.getDatasetMeta(u);if(!o)throw new Error("No dataset found at index "+u);return{datasetIndex:u,element:o.data[d],index:d}});!K_(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(e,r,n){return this._plugins.notify(this,e,r,n)}isPluginEnabled(e){return this._plugins._cache.filter(r=>r.plugin.id===e).length===1}_updateHoverStyles(e,r,n){const s=this.options.hover,u=(g,x)=>g.filter(E=>!x.some(S=>E.datasetIndex===S.datasetIndex&&E.index===S.index)),d=u(r,e),o=n?e:u(e,r);d.length&&this.updateHoverStyle(d,s.mode,!1),o.length&&s.mode&&this.updateHoverStyle(o,s.mode,!0)}_eventHandler(e,r){const n={event:e,replay:r,cancelable:!0,inChartArea:this.isPointInArea(e)},s=d=>(d.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const u=this._handleEvent(e,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(u||n.changed)&&this.render(),this}_handleEvent(e,r,n){const{_active:s=[],options:u}=this,d=r,o=this._getActiveElements(e,s,n,d),g=A4(e),x=Bj(e,this._lastEvent,n,g);n&&(this._lastEvent=null,mi(u.onHover,[e,o,this],this),g&&mi(u.onClick,[e,o,this],this));const E=!K_(o,s);return(E||r)&&(this._active=o,this._updateHoverStyles(o,s,r)),this._lastEvent=x,E}_getActiveElements(e,r,n,s){if(e.type==="mouseout")return[];if(!n)return r;const u=this.options.hover;return this.getElementsAtEventForMode(e,u.mode,u,s)}}ir(xl,"defaults",Gi),ir(xl,"instances",D_),ir(xl,"overrides",lu),ir(xl,"registry",ko),ir(xl,"version",Lj),ir(xl,"getChart",V2);function U2(){return oi(xl.instances,t=>t._plugins.invalidate())}var pb=xl;function jj(t,e,r){const{startAngle:n,pixelMargin:s,x:u,y:d,outerRadius:o,innerRadius:g}=e;let x=s/o;t.beginPath(),t.arc(u,d,o,n-x,r+x),g>s?(x=s/g,t.arc(u,d,g,r+x,n-x,!0)):t.arc(u,d,s,r+ji,n-ji),t.closePath(),t.clip()}function $j(t){return T1(t,["outerStart","outerEnd","innerStart","innerEnd"])}function Vj(t,e,r,n){const s=$j(t.options.borderRadius),u=(r-e)/2,d=Math.min(u,n*e/2),o=g=>{const x=(r-Math.min(u,g))*n/2;return un(g,0,Math.min(u,x))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:un(s.innerStart,0,d),innerEnd:un(s.innerEnd,0,d)}}function wh(t,e,r,n){return{x:r+t*Math.cos(e),y:n+t*Math.sin(e)}}function iy(t,e,r,n,s,u){const{x:d,y:o,startAngle:g,pixelMargin:x,innerRadius:E}=e,S=Math.max(e.outerRadius+n+r-x,0),P=E>0?E+n+r+x:0;let I=0;const R=s-g;if(n){const Be=E>0?E-n:0,Ve=S>0?S-n:0,Je=(Be+Ve)/2,ut=Je!==0?R*Je/(Je+n):R;I=(R-ut)/2}const z=Math.max(.001,R*S-r/Ci)/S,B=(R-z)/2,$=g+B+I,j=s-B-I,{outerStart:G,outerEnd:K,innerStart:X,innerEnd:re}=Vj(e,P,S,j-$),ue=S-G,ne=S-K,we=$+G/ue,xe=j-K/ne,ke=P+X,Ie=P+re,Fe=$+X/ke,se=j-re/Ie;if(t.beginPath(),u){const Be=(we+xe)/2;if(t.arc(d,o,S,we,Be),t.arc(d,o,S,Be,xe),K>0){const ht=wh(ne,xe,d,o);t.arc(ht.x,ht.y,K,xe,j+ji)}const Ve=wh(Ie,j,d,o);if(t.lineTo(Ve.x,Ve.y),re>0){const ht=wh(Ie,se,d,o);t.arc(ht.x,ht.y,re,j+ji,se+Math.PI)}const Je=(j-re/P+($+X/P))/2;if(t.arc(d,o,P,j-re/P,Je,!0),t.arc(d,o,P,Je,$+X/P,!0),X>0){const ht=wh(ke,Fe,d,o);t.arc(ht.x,ht.y,X,Fe+Math.PI,$-ji)}const ut=wh(ue,$,d,o);if(t.lineTo(ut.x,ut.y),G>0){const ht=wh(ue,we,d,o);t.arc(ht.x,ht.y,G,$-ji,we)}}else{t.moveTo(d,o);const Be=Math.cos(we)*S+d,Ve=Math.sin(we)*S+o;t.lineTo(Be,Ve);const Je=Math.cos(xe)*S+d,ut=Math.sin(xe)*S+o;t.lineTo(Je,ut)}t.closePath()}function Uj(t,e,r,n,s){const{fullCircles:u,startAngle:d,circumference:o}=e;let g=e.endAngle;if(u){iy(t,e,r,n,g,s);for(let x=0;x<u;++x)t.fill();isNaN(o)||(g=d+(o%wi||wi))}return iy(t,e,r,n,g,s),t.fill(),g}function Gj(t,e,r,n,s){const{fullCircles:u,startAngle:d,circumference:o,options:g}=e,{borderWidth:x,borderJoinStyle:E}=g,S=g.borderAlign==="inner";if(!x)return;S?(t.lineWidth=x*2,t.lineJoin=E||"round"):(t.lineWidth=x,t.lineJoin=E||"bevel");let P=e.endAngle;if(u){iy(t,e,r,n,P,s);for(let I=0;I<u;++I)t.stroke();isNaN(o)||(P=d+(o%wi||wi))}S&&jj(t,e,P),u||(iy(t,e,r,n,P,s),t.stroke())}class R_ extends fo{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,r,n){const s=this.getProps(["x","y"],n),{angle:u,distance:d}=NI(s,{x:e,y:r}),{startAngle:o,endAngle:g,innerRadius:x,outerRadius:E,circumference:S}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),P=this.options.spacing/2,R=Ar(S,g-o)>=wi||Pp(u,o,g),z=wa(d,x+P,E+P);return R&&z}getCenterPoint(e){const{x:r,y:n,startAngle:s,endAngle:u,innerRadius:d,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:g,spacing:x}=this.options,E=(s+u)/2,S=(d+o+x+g)/2;return{x:r+Math.cos(E)*S,y:n+Math.sin(E)*S}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:r,circumference:n}=this,s=(r.offset||0)/4,u=(r.spacing||0)/2,d=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=n>wi?Math.floor(n/wi):0,n===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const o=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(o)*s,Math.sin(o)*s);const g=1-Math.sin(Math.min(Ci,n||0)),x=s*g;e.fillStyle=r.backgroundColor,e.strokeStyle=r.borderColor,Uj(e,this,x,u,d),Gj(e,this,x,u,d),e.restore()}}ir(R_,"id","arc"),ir(R_,"defaults",{borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),ir(R_,"defaultRoutes",{backgroundColor:"backgroundColor"});function TM(t,e,r=e){t.lineCap=Ar(r.borderCapStyle,e.borderCapStyle),t.setLineDash(Ar(r.borderDash,e.borderDash)),t.lineDashOffset=Ar(r.borderDashOffset,e.borderDashOffset),t.lineJoin=Ar(r.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Ar(r.borderWidth,e.borderWidth),t.strokeStyle=Ar(r.borderColor,e.borderColor)}function Hj(t,e,r){t.lineTo(r.x,r.y)}function Wj(t){return t.stepped?gN:t.tension||t.cubicInterpolationMode==="monotone"?_N:Hj}function SM(t,e,r={}){const n=t.length,{start:s=0,end:u=n-1}=r,{start:d,end:o}=e,g=Math.max(s,d),x=Math.min(u,o),E=s<d&&u<d||s>o&&u>o;return{count:n,start:g,loop:e.loop,ilen:x<g&&!E?n+x-g:x-g}}function Zj(t,e,r,n){const{points:s,options:u}=e,{count:d,start:o,loop:g,ilen:x}=SM(s,r,n),E=Wj(u);let{move:S=!0,reverse:P}=n||{},I,R,z;for(I=0;I<=x;++I)R=s[(o+(P?x-I:I))%d],!R.skip&&(S?(t.moveTo(R.x,R.y),S=!1):E(t,z,R,P,u.stepped),z=R);return g&&(R=s[(o+(P?x:0))%d],E(t,z,R,P,u.stepped)),!!g}function qj(t,e,r,n){const s=e.points,{count:u,start:d,ilen:o}=SM(s,r,n),{move:g=!0,reverse:x}=n||{};let E=0,S=0,P,I,R,z,B,$;const j=K=>(d+(x?o-K:K))%u,G=()=>{z!==B&&(t.lineTo(E,B),t.lineTo(E,z),t.lineTo(E,$))};for(g&&(I=s[j(0)],t.moveTo(I.x,I.y)),P=0;P<=o;++P){if(I=s[j(P)],I.skip)continue;const K=I.x,X=I.y,re=K|0;re===R?(X<z?z=X:X>B&&(B=X),E=(S*E+K)/++S):(G(),t.lineTo(K,X),R=re,S=0,z=B=X),$=X}G()}function mb(t){const e=t.options,r=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!r?qj:Zj}function Kj(t){return t.stepped?KN:t.tension||t.cubicInterpolationMode==="monotone"?XN:jc}function Xj(t,e,r,n){let s=e._path;s||(s=e._path=new Path2D,e.path(s,r,n)&&s.closePath()),TM(t,e.options),t.stroke(s)}function Yj(t,e,r,n){const{segments:s,options:u}=e,d=mb(e);for(const o of s)TM(t,u,o.style),t.beginPath(),d(t,e,o,{start:r,end:r+n-1})&&t.closePath(),t.stroke()}const Jj=typeof Path2D=="function";function Qj(t,e,r,n){Jj&&!e.options.segment?Xj(t,e,r,n):Yj(t,e,r,n)}class Tl extends fo{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,r){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const s=n.spanGaps?this._loop:this._fullLoop;$N(this._points,n,e,s,r),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=r5(this,this.options.segment))}first(){const e=this.segments,r=this.points;return e.length&&r[e[0].start]}last(){const e=this.segments,r=this.points,n=e.length;return n&&r[e[n-1].end]}interpolate(e,r){const n=this.options,s=e[r],u=this.points,d=hM(this,{property:r,start:s,end:s});if(!d.length)return;const o=[],g=Kj(n);let x,E;for(x=0,E=d.length;x<E;++x){const{start:S,end:P}=d[x],I=u[S],R=u[P];if(I===R){o.push(I);continue}const z=Math.abs((s-I[r])/(R[r]-I[r])),B=g(I,R,z,n.stepped);B[r]=e[r],o.push(B)}return o.length===1?o[0]:o}pathSegment(e,r,n){return mb(this)(e,this,r,n)}path(e,r,n){const s=this.segments,u=mb(this);let d=this._loop;r=r||0,n=n||this.points.length-r;for(const o of s)d&=u(e,this,o,{start:r,end:r+n-1});return!!d}draw(e,r,n,s){const u=this.options||{};(this.points||[]).length&&u.borderWidth&&(e.save(),Qj(e,this,n,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}ir(Tl,"id","line"),ir(Tl,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),ir(Tl,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),ir(Tl,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function G2(t,e,r,n){const s=t.options,{[r]:u}=t.getProps([r],n);return Math.abs(e-u)<s.radius+s.hitRadius}class L_ extends fo{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,r,n){const s=this.options,{x:u,y:d}=this.getProps(["x","y"],n);return Math.pow(e-u,2)+Math.pow(r-d,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,r){return G2(this,e,"x",r)}inYRange(e,r){return G2(this,e,"y",r)}getCenterPoint(e){const{x:r,y:n}=this.getProps(["x","y"],e);return{x:r,y:n}}size(e){e=e||this.options||{};let r=e.radius||0;r=Math.max(r,r&&e.hoverRadius||0);const n=r&&e.borderWidth||0;return(r+n)*2}draw(e,r){const n=this.options;this.skip||n.radius<.1||!Cp(this,r,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,hb(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}ir(L_,"id","point"),ir(L_,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),ir(L_,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function AM(t,e){const{x:r,y:n,base:s,width:u,height:d}=t.getProps(["x","y","base","width","height"],e);let o,g,x,E,S;return t.horizontal?(S=d/2,o=Math.min(r,s),g=Math.max(r,s),x=n-S,E=n+S):(S=u/2,o=r-S,g=r+S,x=Math.min(n,s),E=Math.max(n,s)),{left:o,top:x,right:g,bottom:E}}function Sl(t,e,r,n){return t?0:un(e,r,n)}function e$(t,e,r){const n=t.options.borderWidth,s=t.borderSkipped,u=QI(n);return{t:Sl(s.top,u.top,0,r),r:Sl(s.right,u.right,0,e),b:Sl(s.bottom,u.bottom,0,r),l:Sl(s.left,u.left,0,e)}}function t$(t,e,r){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),s=t.options.borderRadius,u=Qc(s),d=Math.min(e,r),o=t.borderSkipped,g=n||Ur(s);return{topLeft:Sl(!g||o.top||o.left,u.topLeft,0,d),topRight:Sl(!g||o.top||o.right,u.topRight,0,d),bottomLeft:Sl(!g||o.bottom||o.left,u.bottomLeft,0,d),bottomRight:Sl(!g||o.bottom||o.right,u.bottomRight,0,d)}}function r$(t){const e=AM(t),r=e.right-e.left,n=e.bottom-e.top,s=e$(t,r/2,n/2),u=t$(t,r/2,n/2);return{outer:{x:e.left,y:e.top,w:r,h:n,radius:u},inner:{x:e.left+s.l,y:e.top+s.t,w:r-s.l-s.r,h:n-s.t-s.b,radius:{topLeft:Math.max(0,u.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,u.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,u.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,u.bottomRight-Math.max(s.b,s.r))}}}}function ux(t,e,r,n){const s=e===null,u=r===null,o=t&&!(s&&u)&&AM(t,n);return o&&(s||wa(e,o.left,o.right))&&(u||wa(r,o.top,o.bottom))}function i$(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function n$(t,e){t.rect(e.x,e.y,e.w,e.h)}function hx(t,e,r={}){const n=t.x!==r.x?-e:0,s=t.y!==r.y?-e:0,u=(t.x+t.w!==r.x+r.w?e:0)-n,d=(t.y+t.h!==r.y+r.h?e:0)-s;return{x:t.x+n,y:t.y+s,w:t.w+u,h:t.h+d,radius:t.radius}}class k_ extends fo{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:r,options:{borderColor:n,backgroundColor:s}}=this,{inner:u,outer:d}=r$(this),o=i$(d.radius)?Ip:n$;e.save(),(d.w!==u.w||d.h!==u.h)&&(e.beginPath(),o(e,hx(d,r,u)),e.clip(),o(e,hx(u,-r,d)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),o(e,hx(u,r)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,r,n){return ux(this,e,r,n)}inXRange(e,r){return ux(this,e,null,r)}inYRange(e,r){return ux(this,null,e,r)}getCenterPoint(e){const{x:r,y:n,base:s,horizontal:u}=this.getProps(["x","y","base","horizontal"],e);return{x:u?(r+s)/2:r,y:u?n:(n+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}ir(k_,"id","bar"),ir(k_,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ir(k_,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var s$=Object.freeze({__proto__:null,ArcElement:R_,LineElement:Tl,PointElement:L_,BarElement:k_});const gb=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],H2=gb.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function PM(t){return gb[t%gb.length]}function CM(t){return H2[t%H2.length]}function o$(){return(t,e)=>{t.borderColor=PM(e),t.backgroundColor=CM(e)}}function a$(){let t=0;return e=>{e.backgroundColor=e.data.map(()=>PM(t++))}}function l$(){let t=0;return e=>{e.backgroundColor=e.data.map(()=>CM(t++))}}function c$(t){return t==="doughnut"||t==="pie"?a$():t==="polarArea"?l$():o$()}function W2(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}var u$={id:"colors",defaults:{enabled:!0},beforeLayout(t,e,r){if(!r.enabled)return;const{type:n,options:{elements:s},data:{datasets:u}}=t.config;if(W2(u)||s&&W2(s))return;const d=c$(n);u.forEach(d)}};function h$(t,e,r,n,s){const u=s.samples||n;if(u>=r)return t.slice(e,e+r);const d=[],o=(r-2)/(u-2);let g=0;const x=e+r-1;let E=e,S,P,I,R,z;for(d[g++]=t[E],S=0;S<u-2;S++){let B=0,$=0,j;const G=Math.floor((S+1)*o)+1+e,K=Math.min(Math.floor((S+2)*o)+1,r)+e,X=K-G;for(j=G;j<K;j++)B+=t[j].x,$+=t[j].y;B/=X,$/=X;const re=Math.floor(S*o)+1+e,ue=Math.min(Math.floor((S+1)*o)+1,r)+e,{x:ne,y:we}=t[E];for(I=R=-1,j=re;j<ue;j++)R=.5*Math.abs((ne-B)*(t[j].y-we)-(ne-t[j].x)*($-we)),R>I&&(I=R,P=t[j],z=j);d[g++]=P,E=z}return d[g++]=t[x],d}function d$(t,e,r,n){let s=0,u=0,d,o,g,x,E,S,P,I,R,z;const B=[],$=e+r-1,j=t[e].x,K=t[$].x-j;for(d=e;d<e+r;++d){o=t[d],g=(o.x-j)/K*n,x=o.y;const X=g|0;if(X===E)x<R?(R=x,S=d):x>z&&(z=x,P=d),s=(u*s+o.x)/++u;else{const re=d-1;if(!Kr(S)&&!Kr(P)){const ue=Math.min(S,P),ne=Math.max(S,P);ue!==I&&ue!==re&&B.push({...t[ue],x:s}),ne!==I&&ne!==re&&B.push({...t[ne],x:s})}d>0&&re!==I&&B.push(t[re]),B.push(o),E=X,u=0,R=z=x,S=P=I=d}}return B}function IM(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{value:e})}}function Z2(t){t.data.datasets.forEach(e=>{IM(e)})}function f$(t,e){const r=e.length;let n=0,s;const{iScale:u}=t,{min:d,max:o,minDefined:g,maxDefined:x}=u.getUserBounds();return g&&(n=un(Ea(e,u.axis,d).lo,0,r-1)),x?s=un(Ea(e,u.axis,o).hi+1,n,r)-n:s=r-n,{start:n,count:s}}var p$={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,r)=>{if(!r.enabled){Z2(t);return}const n=t.width;t.data.datasets.forEach((s,u)=>{const{_data:d,indexAxis:o}=s,g=t.getDatasetMeta(u),x=d||s.data;if(Jf([o,t.options.indexAxis])==="y"||!g.controller.supportsDecimation)return;const E=t.scales[g.xAxisID];if(E.type!=="linear"&&E.type!=="time"||t.options.parsing)return;let{start:S,count:P}=f$(g,x);const I=r.threshold||4*n;if(P<=I){IM(s);return}Kr(d)&&(s._data=x,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(z){this._data=z}}));let R;switch(r.algorithm){case"lttb":R=h$(x,S,P,n,r);break;case"min-max":R=d$(x,S,P,n);break;default:throw new Error(`Unsupported decimation algorithm '${r.algorithm}'`)}s._decimated=R})},destroy(t){Z2(t)}};function m$(t,e,r){const n=t.segments,s=t.points,u=e.points,d=[];for(const o of n){let{start:g,end:x}=o;x=M1(g,x,s);const E=_b(r,s[g],s[x],o.loop);if(!e.segments){d.push({source:o,target:E,start:s[g],end:s[x]});continue}const S=hM(e,E);for(const P of S){const I=_b(r,u[P.start],u[P.end],P.loop),R=uM(o,s,I);for(const z of R)d.push({source:z,target:P,start:{[r]:q2(E,I,"start",Math.max)},end:{[r]:q2(E,I,"end",Math.min)}})}}return d}function _b(t,e,r,n){if(n)return;let s=e[t],u=r[t];return t==="angle"&&(s=ws(s),u=ws(u)),{property:t,start:s,end:u}}function g$(t,e){const{x:r=null,y:n=null}=t||{},s=e.points,u=[];return e.segments.forEach(({start:d,end:o})=>{o=M1(d,o,s);const g=s[d],x=s[o];n!==null?(u.push({x:g.x,y:n}),u.push({x:x.x,y:n})):r!==null&&(u.push({x:r,y:g.y}),u.push({x:r,y:x.y}))}),u}function M1(t,e,r){for(;e>t;e--){const n=r[e];if(!isNaN(n.x)&&!isNaN(n.y))break}return e}function q2(t,e,r,n){return t&&e?n(t[r],e[r]):t?t[r]:e?e[r]:0}function MM(t,e){let r=[],n=!1;return bi(t)?(n=!0,r=t):r=g$(t,e),r.length?new Tl({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function K2(t){return t&&t.fill!==!1}function _$(t,e,r){let s=t[e].fill;const u=[e];let d;if(!r)return s;for(;s!==!1&&u.indexOf(s)===-1;){if(!Ni(s))return s;if(d=t[s],!d)return!1;if(d.visible)return s;u.push(s),s=d.fill}return!1}function y$(t,e,r){const n=w$(t);if(Ur(n))return isNaN(n.value)?!1:n;let s=parseFloat(n);return Ni(s)&&Math.floor(s)===s?v$(n[0],e,s,r):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function v$(t,e,r,n){return(t==="-"||t==="+")&&(r=e+r),r===e||r<0||r>=n?!1:r}function x$(t,e){let r=null;return t==="start"?r=e.bottom:t==="end"?r=e.top:Ur(t)?r=e.getPixelForValue(t.value):e.getBasePixel&&(r=e.getBasePixel()),r}function b$(t,e,r){let n;return t==="start"?n=r:t==="end"?n=e.options.reverse?e.min:e.max:Ur(t)?n=t.value:n=e.getBaseValue(),n}function w$(t){const e=t.options,r=e.fill;let n=Ar(r&&r.target,r);return n===void 0&&(n=!!e.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function E$(t){const{scale:e,index:r,line:n}=t,s=[],u=n.segments,d=n.points,o=T$(e,r);o.push(MM({x:null,y:e.bottom},n));for(let g=0;g<u.length;g++){const x=u[g];for(let E=x.start;E<=x.end;E++)S$(s,d[E],o)}return new Tl({points:s,options:{}})}function T$(t,e){const r=[],n=t.getMatchingVisibleMetas("line");for(let s=0;s<n.length;s++){const u=n[s];if(u.index===e)break;u.hidden||r.unshift(u.dataset)}return r}function S$(t,e,r){const n=[];for(let s=0;s<r.length;s++){const u=r[s],{first:d,last:o,point:g}=A$(u,e,"x");if(!(!g||d&&o)){if(d)n.unshift(g);else if(t.push(g),!o)break}}t.push(...n)}function A$(t,e,r){const n=t.interpolate(e,r);if(!n)return{};const s=n[r],u=t.segments,d=t.points;let o=!1,g=!1;for(let x=0;x<u.length;x++){const E=u[x],S=d[E.start][r],P=d[E.end][r];if(wa(s,S,P)){o=s===S,g=s===P;break}}return{first:o,last:g,point:n}}class OM{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,r,n){const{x:s,y:u,radius:d}=this;return r=r||{start:0,end:wi},e.arc(s,u,d,r.end,r.start,!0),!n.bounds}interpolate(e){const{x:r,y:n,radius:s}=this,u=e.angle;return{x:r+Math.cos(u)*s,y:n+Math.sin(u)*s,angle:u}}}function P$(t){const{chart:e,fill:r,line:n}=t;if(Ni(r))return C$(e,r);if(r==="stack")return E$(t);if(r==="shape")return!0;const s=I$(t);return s instanceof OM?s:MM(s,n)}function C$(t,e){const r=t.getDatasetMeta(e);return r&&t.isDatasetVisible(e)?r.dataset:null}function I$(t){return(t.scale||{}).getPointPositionForValue?O$(t):M$(t)}function M$(t){const{scale:e={},fill:r}=t,n=x$(r,e);if(Ni(n)){const s=e.isHorizontal();return{x:s?n:null,y:s?null:n}}return null}function O$(t){const{scale:e,fill:r}=t,n=e.options,s=e.getLabels().length,u=n.reverse?e.max:e.min,d=b$(r,e,u),o=[];if(n.grid.circular){const g=e.getPointPositionForValue(0,u);return new OM({x:g.x,y:g.y,radius:e.getDistanceFromCenterForValue(d)})}for(let g=0;g<s;++g)o.push(e.getPointPositionForValue(g,d));return o}function dx(t,e,r){const n=P$(e),{line:s,scale:u,axis:d}=e,o=s.options,g=o.fill,x=o.backgroundColor,{above:E=x,below:S=x}=g||{};n&&s.points.length&&(ev(t,r),D$(t,{line:s,target:n,above:E,below:S,area:r,scale:u,axis:d}),tv(t))}function D$(t,e){const{line:r,target:n,above:s,below:u,area:d,scale:o}=e,g=r._loop?"angle":e.axis;t.save(),g==="x"&&u!==s&&(X2(t,n,d.top),Y2(t,{line:r,target:n,color:s,scale:o,property:g}),t.restore(),t.save(),X2(t,n,d.bottom)),Y2(t,{line:r,target:n,color:u,scale:o,property:g}),t.restore()}function X2(t,e,r){const{segments:n,points:s}=e;let u=!0,d=!1;t.beginPath();for(const o of n){const{start:g,end:x}=o,E=s[g],S=s[M1(g,x,s)];u?(t.moveTo(E.x,E.y),u=!1):(t.lineTo(E.x,r),t.lineTo(E.x,E.y)),d=!!e.pathSegment(t,o,{move:d}),d?t.closePath():t.lineTo(S.x,r)}t.lineTo(e.first().x,r),t.closePath(),t.clip()}function Y2(t,e){const{line:r,target:n,property:s,color:u,scale:d}=e,o=m$(r,n,s);for(const{source:g,target:x,start:E,end:S}of o){const{style:{backgroundColor:P=u}={}}=g,I=n!==!0;t.save(),t.fillStyle=P,R$(t,d,I&&_b(s,E,S)),t.beginPath();const R=!!r.pathSegment(t,g);let z;if(I){R?t.closePath():J2(t,n,S,s);const B=!!n.pathSegment(t,x,{move:R,reverse:!0});z=R&&B,z||J2(t,n,E,s)}t.closePath(),t.fill(z?"evenodd":"nonzero"),t.restore()}}function R$(t,e,r){const{top:n,bottom:s}=e.chart.chartArea,{property:u,start:d,end:o}=r||{};u==="x"&&(t.beginPath(),t.rect(d,n,o-d,s-n),t.clip())}function J2(t,e,r,n){const s=e.interpolate(r,n);s&&t.lineTo(s.x,s.y)}var L$={id:"filler",afterDatasetsUpdate(t,e,r){const n=(t.data.datasets||[]).length,s=[];let u,d,o,g;for(d=0;d<n;++d)u=t.getDatasetMeta(d),o=u.dataset,g=null,o&&o.options&&o instanceof Tl&&(g={visible:t.isDatasetVisible(d),index:d,fill:y$(o,d,n),chart:t,axis:u.controller.options.indexAxis,scale:u.vScale,line:o}),u.$filler=g,s.push(g);for(d=0;d<n;++d)g=s[d],!(!g||g.fill===!1)&&(g.fill=_$(s,d,r.propagate))},beforeDraw(t,e,r){const n=r.drawTime==="beforeDraw",s=t.getSortedVisibleDatasetMetas(),u=t.chartArea;for(let d=s.length-1;d>=0;--d){const o=s[d].$filler;!o||(o.line.updateControlPoints(u,o.axis),n&&o.fill&&dx(t.ctx,o,u))}},beforeDatasetsDraw(t,e,r){if(r.drawTime!=="beforeDatasetsDraw")return;const n=t.getSortedVisibleDatasetMetas();for(let s=n.length-1;s>=0;--s){const u=n[s].$filler;K2(u)&&dx(t.ctx,u,t.chartArea)}},beforeDatasetDraw(t,e,r){const n=e.meta.$filler;!K2(n)||r.drawTime!=="beforeDatasetDraw"||dx(t.ctx,n,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Q2=(t,e)=>{let{boxHeight:r=e,boxWidth:n=e}=t;return t.usePointStyle&&(r=Math.min(r,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(e,r)}},k$=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class eA extends fo{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r,n){this.maxWidth=e,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let r=mi(e.generateLabels,[this.chart],this)||[];e.filter&&(r=r.filter(n=>e.filter(n,this.chart.data))),e.sort&&(r=r.sort((n,s)=>e.sort(n,s,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:e,ctx:r}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,s=tn(n.font),u=s.size,d=this._computeTitleHeight(),{boxWidth:o,itemHeight:g}=Q2(n,u);let x,E;r.font=s.string,this.isHorizontal()?(x=this.maxWidth,E=this._fitRows(d,u,o,g)+10):(E=this.maxHeight,x=this._fitCols(d,s,o,g)+10),this.width=Math.min(x,e.maxWidth||this.maxWidth),this.height=Math.min(E,e.maxHeight||this.maxHeight)}_fitRows(e,r,n,s){const{ctx:u,maxWidth:d,options:{labels:{padding:o}}}=this,g=this.legendHitBoxes=[],x=this.lineWidths=[0],E=s+o;let S=e;u.textAlign="left",u.textBaseline="middle";let P=-1,I=-E;return this.legendItems.forEach((R,z)=>{const B=n+r/2+u.measureText(R.text).width;(z===0||x[x.length-1]+B+2*o>d)&&(S+=E,x[x.length-(z>0?0:1)]=0,I+=E,P++),g[z]={left:0,top:I,row:P,width:B,height:s},x[x.length-1]+=B+o}),S}_fitCols(e,r,n,s){const{ctx:u,maxHeight:d,options:{labels:{padding:o}}}=this,g=this.legendHitBoxes=[],x=this.columnSizes=[],E=d-e;let S=o,P=0,I=0,R=0,z=0;return this.legendItems.forEach((B,$)=>{const{itemWidth:j,itemHeight:G}=z$(n,r,u,B,s);$>0&&I+G+2*o>E&&(S+=P+o,x.push({width:P,height:I}),R+=P+o,z++,P=I=0),g[$]={left:R,top:I,col:z,width:j,height:G},P=Math.max(P,j),I+=G+o}),S+=P,x.push({width:P,height:I}),S}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:s},rtl:u}}=this,d=Uh(u,this.left,this.width);if(this.isHorizontal()){let o=0,g=In(n,this.left+s,this.right-this.lineWidths[o]);for(const x of r)o!==x.row&&(o=x.row,g=In(n,this.left+s,this.right-this.lineWidths[o])),x.top+=this.top+e+s,x.left=d.leftForLtr(d.x(g),x.width),g+=x.width+s}else{let o=0,g=In(n,this.top+e+s,this.bottom-this.columnSizes[o].height);for(const x of r)x.col!==o&&(o=x.col,g=In(n,this.top+e+s,this.bottom-this.columnSizes[o].height)),x.top=g,x.left+=this.left+s,x.left=d.leftForLtr(d.x(x.left),x.width),g+=x.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;ev(e,this),this._draw(),tv(e)}}_draw(){const{options:e,columnSizes:r,lineWidths:n,ctx:s}=this,{align:u,labels:d}=e,o=Gi.color,g=Uh(e.rtl,this.left,this.width),x=tn(d.font),{padding:E}=d,S=x.size,P=S/2;let I;this.drawTitle(),s.textAlign=g.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=x.string;const{boxWidth:R,boxHeight:z,itemHeight:B}=Q2(d,S),$=function(re,ue,ne){if(isNaN(R)||R<=0||isNaN(z)||z<0)return;s.save();const we=Ar(ne.lineWidth,1);if(s.fillStyle=Ar(ne.fillStyle,o),s.lineCap=Ar(ne.lineCap,"butt"),s.lineDashOffset=Ar(ne.lineDashOffset,0),s.lineJoin=Ar(ne.lineJoin,"miter"),s.lineWidth=we,s.strokeStyle=Ar(ne.strokeStyle,o),s.setLineDash(Ar(ne.lineDash,[])),d.usePointStyle){const xe={radius:z*Math.SQRT2/2,pointStyle:ne.pointStyle,rotation:ne.rotation,borderWidth:we},ke=g.xPlus(re,R/2),Ie=ue+P;JI(s,xe,ke,Ie,d.pointStyleWidth&&R)}else{const xe=ue+Math.max((S-z)/2,0),ke=g.leftForLtr(re,R),Ie=Qc(ne.borderRadius);s.beginPath(),Object.values(Ie).some(Fe=>Fe!==0)?Ip(s,{x:ke,y:xe,w:R,h:z,radius:Ie}):s.rect(ke,xe,R,z),s.fill(),we!==0&&s.stroke()}s.restore()},j=function(re,ue,ne){cu(s,ne.text,re,ue+B/2,x,{strikethrough:ne.hidden,textAlign:g.textAlign(ne.textAlign)})},G=this.isHorizontal(),K=this._computeTitleHeight();G?I={x:In(u,this.left+E,this.right-n[0]),y:this.top+E+K,line:0}:I={x:this.left+E,y:In(u,this.top+K+E,this.bottom-r[0].height),line:0},aM(this.ctx,e.textDirection);const X=B+E;this.legendItems.forEach((re,ue)=>{s.strokeStyle=re.fontColor,s.fillStyle=re.fontColor;const ne=s.measureText(re.text).width,we=g.textAlign(re.textAlign||(re.textAlign=d.textAlign)),xe=R+P+ne;let ke=I.x,Ie=I.y;g.setWidth(this.width),G?ue>0&&ke+xe+E>this.right&&(Ie=I.y+=X,I.line++,ke=I.x=In(u,this.left+E,this.right-n[I.line])):ue>0&&Ie+X>this.bottom&&(ke=I.x=ke+r[I.line].width+E,I.line++,Ie=I.y=In(u,this.top+K+E,this.bottom-r[I.line].height));const Fe=g.x(ke);if($(Fe,Ie,re),ke=F4(we,ke+R+P,G?ke+xe:this.right,e.rtl),j(g.x(ke),Ie,re),G)I.x+=xe+E;else if(typeof re.text!="string"){const se=x.lineHeight;I.y+=DM(re,se)}else I.y+=X}),lM(this.ctx,e.textDirection)}drawTitle(){const e=this.options,r=e.title,n=tn(r.font),s=Rn(r.padding);if(!r.display)return;const u=Uh(e.rtl,this.left,this.width),d=this.ctx,o=r.position,g=n.size/2,x=s.top+g;let E,S=this.left,P=this.width;if(this.isHorizontal())P=Math.max(...this.lineWidths),E=this.top+x,S=In(e.align,S,this.right-P);else{const R=this.columnSizes.reduce((z,B)=>Math.max(z,B.height),0);E=x+In(e.align,this.top,this.bottom-R-e.labels.padding-this._computeTitleHeight())}const I=In(o,S,S+P);d.textAlign=u.textAlign(x1(o)),d.textBaseline="middle",d.strokeStyle=r.color,d.fillStyle=r.color,d.font=n.string,cu(d,r.text,I,E,n)}_computeTitleHeight(){const e=this.options.title,r=tn(e.font),n=Rn(e.padding);return e.display?r.lineHeight+n.height:0}_getLegendItemAt(e,r){let n,s,u;if(wa(e,this.left,this.right)&&wa(r,this.top,this.bottom)){for(u=this.legendHitBoxes,n=0;n<u.length;++n)if(s=u[n],wa(e,s.left,s.left+s.width)&&wa(r,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(e){const r=this.options;if(!N$(e.type,r))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,u=k$(s,n);s&&!u&&mi(r.onLeave,[e,s,this],this),this._hoveredItem=n,n&&!u&&mi(r.onHover,[e,n,this],this)}else n&&mi(r.onClick,[e,n,this],this)}}function z$(t,e,r,n,s){const u=F$(n,t,e,r),d=B$(s,n,e.lineHeight);return{itemWidth:u,itemHeight:d}}function F$(t,e,r,n){let s=t.text;return s&&typeof s!="string"&&(s=s.reduce((u,d)=>u.length>d.length?u:d)),e+r.size/2+n.measureText(s).width}function B$(t,e,r){let n=t;return typeof e.text!="string"&&(n=DM(e,r)),n}function DM(t,e){const r=t.text?t.text.length+.5:0;return e*r}function N$(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var j$={id:"legend",_element:eA,start(t,e,r){const n=t.legend=new eA({ctx:t.ctx,options:r,chart:t});On.configure(t,n,r),On.addBox(t,n)},stop(t){On.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,r){const n=t.legend;On.configure(t,n,r),n.options=r},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,r){const n=e.datasetIndex,s=r.chart;s.isDatasetVisible(n)?(s.hide(n),e.hidden=!0):(s.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:s,color:u,useBorderRadius:d,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(g=>{const x=g.controller.getStyle(r?0:void 0),E=Rn(x.borderWidth);return{text:e[g.index].label,fillStyle:x.backgroundColor,fontColor:u,hidden:!g.visible,lineCap:x.borderCapStyle,lineDash:x.borderDash,lineDashOffset:x.borderDashOffset,lineJoin:x.borderJoinStyle,lineWidth:(E.width+E.height)/4,strokeStyle:x.borderColor,pointStyle:n||x.pointStyle,rotation:x.rotation,textAlign:s||x.textAlign,borderRadius:d&&(o||x.borderRadius),datasetIndex:g.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class O1 extends fo{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=r;const s=bi(n.text)?n.text.length:1;this._padding=Rn(n.padding);const u=s*tn(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=u:this.width=u}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:r,left:n,bottom:s,right:u,options:d}=this,o=d.align;let g=0,x,E,S;return this.isHorizontal()?(E=In(o,n,u),S=r+e,x=u-n):(d.position==="left"?(E=n+e,S=In(o,s,r),g=Ci*-.5):(E=u-e,S=In(o,r,s),g=Ci*.5),x=s-r),{titleX:E,titleY:S,maxWidth:x,rotation:g}}draw(){const e=this.ctx,r=this.options;if(!r.display)return;const n=tn(r.font),u=n.lineHeight/2+this._padding.top,{titleX:d,titleY:o,maxWidth:g,rotation:x}=this._drawArgs(u);cu(e,r.text,0,0,n,{color:r.color,maxWidth:g,rotation:x,textAlign:x1(r.align),textBaseline:"middle",translation:[d,o]})}}function $$(t,e){const r=new O1({ctx:t.ctx,options:e,chart:t});On.configure(t,r,e),On.addBox(t,r),t.titleBlock=r}var V$={id:"title",_element:O1,start(t,e,r){$$(t,r)},stop(t){const e=t.titleBlock;On.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,r){const n=t.titleBlock;On.configure(t,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const i_=new WeakMap;var U$={id:"subtitle",start(t,e,r){const n=new O1({ctx:t.ctx,options:r,chart:t});On.configure(t,n,r),On.addBox(t,n),i_.set(t,n)},stop(t){On.removeBox(t,i_.get(t)),i_.delete(t)},beforeUpdate(t,e,r){const n=i_.get(t);On.configure(t,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ep={average(t){if(!t.length)return!1;let e,r,n=0,s=0,u=0;for(e=0,r=t.length;e<r;++e){const d=t[e].element;if(d&&d.hasValue()){const o=d.tooltipPosition();n+=o.x,s+=o.y,++u}}return{x:n/u,y:s/u}},nearest(t,e){if(!t.length)return!1;let r=e.x,n=e.y,s=Number.POSITIVE_INFINITY,u,d,o;for(u=0,d=t.length;u<d;++u){const g=t[u].element;if(g&&g.hasValue()){const x=g.getCenterPoint(),E=lb(e,x);E<s&&(s=E,o=g)}}if(o){const g=o.tooltipPosition();r=g.x,n=g.y}return{x:r,y:n}}};function Ro(t,e){return e&&(bi(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function pa(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function G$(t,e){const{element:r,datasetIndex:n,index:s}=e,u=t.getDatasetMeta(n).controller,{label:d,value:o}=u.getLabelAndValue(s);return{chart:t,label:d,parsed:u.getParsed(s),raw:t.data.datasets[n].data[s],formattedValue:o,dataset:u.getDataset(),dataIndex:s,datasetIndex:n,element:r}}function tA(t,e){const r=t.chart.ctx,{body:n,footer:s,title:u}=t,{boxWidth:d,boxHeight:o}=e,g=tn(e.bodyFont),x=tn(e.titleFont),E=tn(e.footerFont),S=u.length,P=s.length,I=n.length,R=Rn(e.padding);let z=R.height,B=0,$=n.reduce((K,X)=>K+X.before.length+X.lines.length+X.after.length,0);if($+=t.beforeBody.length+t.afterBody.length,S&&(z+=S*x.lineHeight+(S-1)*e.titleSpacing+e.titleMarginBottom),$){const K=e.displayColors?Math.max(o,g.lineHeight):g.lineHeight;z+=I*K+($-I)*g.lineHeight+($-1)*e.bodySpacing}P&&(z+=e.footerMarginTop+P*E.lineHeight+(P-1)*e.footerSpacing);let j=0;const G=function(K){B=Math.max(B,r.measureText(K).width+j)};return r.save(),r.font=x.string,oi(t.title,G),r.font=g.string,oi(t.beforeBody.concat(t.afterBody),G),j=e.displayColors?d+2+e.boxPadding:0,oi(n,K=>{oi(K.before,G),oi(K.lines,G),oi(K.after,G)}),j=0,r.font=E.string,oi(t.footer,G),r.restore(),B+=R.width,{width:B,height:z}}function H$(t,e){const{y:r,height:n}=e;return r<n/2?"top":r>t.height-n/2?"bottom":"center"}function W$(t,e,r,n){const{x:s,width:u}=n,d=r.caretSize+r.caretPadding;if(t==="left"&&s+u+d>e.width||t==="right"&&s-u-d<0)return!0}function Z$(t,e,r,n){const{x:s,width:u}=r,{width:d,chartArea:{left:o,right:g}}=t;let x="center";return n==="center"?x=s<=(o+g)/2?"left":"right":s<=u/2?x="left":s>=d-u/2&&(x="right"),W$(x,t,e,r)&&(x="center"),x}function rA(t,e,r){const n=r.yAlign||e.yAlign||H$(t,r);return{xAlign:r.xAlign||e.xAlign||Z$(t,e,r,n),yAlign:n}}function q$(t,e){let{x:r,width:n}=t;return e==="right"?r-=n:e==="center"&&(r-=n/2),r}function K$(t,e,r){let{y:n,height:s}=t;return e==="top"?n+=r:e==="bottom"?n-=s+r:n-=s/2,n}function iA(t,e,r,n){const{caretSize:s,caretPadding:u,cornerRadius:d}=t,{xAlign:o,yAlign:g}=r,x=s+u,{topLeft:E,topRight:S,bottomLeft:P,bottomRight:I}=Qc(d);let R=q$(e,o);const z=K$(e,g,x);return g==="center"?o==="left"?R+=x:o==="right"&&(R-=x):o==="left"?R-=Math.max(E,P)+s:o==="right"&&(R+=Math.max(S,I)+s),{x:un(R,0,n.width-e.width),y:un(z,0,n.height-e.height)}}function n_(t,e,r){const n=Rn(r.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-n.right:t.x+n.left}function nA(t){return Ro([],pa(t))}function X$(t,e,r){return Ul(t,{tooltip:e,tooltipItems:r,type:"tooltip"})}function sA(t,e){const r=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return r?t.override(r):t}const RM={beforeTitle:ha,title(t){if(t.length>0){const e=t[0],r=e.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return r[e.dataIndex]}return""},afterTitle:ha,beforeBody:ha,beforeLabel:ha,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const r=t.formattedValue;return Kr(r)||(e+=r),e},labelColor(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:ha,afterBody:ha,beforeFooter:ha,footer:ha,afterFooter:ha};function ns(t,e,r,n){const s=t[e].call(r,n);return typeof s=="undefined"?RM[e].call(r,n):s}class yb extends fo{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const r=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&r.options.animation&&n.animations,u=new dM(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(u)),u}getContext(){return this.$context||(this.$context=X$(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,r){const{callbacks:n}=r,s=ns(n,"beforeTitle",this,e),u=ns(n,"title",this,e),d=ns(n,"afterTitle",this,e);let o=[];return o=Ro(o,pa(s)),o=Ro(o,pa(u)),o=Ro(o,pa(d)),o}getBeforeBody(e,r){return nA(ns(r.callbacks,"beforeBody",this,e))}getBody(e,r){const{callbacks:n}=r,s=[];return oi(e,u=>{const d={before:[],lines:[],after:[]},o=sA(n,u);Ro(d.before,pa(ns(o,"beforeLabel",this,u))),Ro(d.lines,ns(o,"label",this,u)),Ro(d.after,pa(ns(o,"afterLabel",this,u))),s.push(d)}),s}getAfterBody(e,r){return nA(ns(r.callbacks,"afterBody",this,e))}getFooter(e,r){const{callbacks:n}=r,s=ns(n,"beforeFooter",this,e),u=ns(n,"footer",this,e),d=ns(n,"afterFooter",this,e);let o=[];return o=Ro(o,pa(s)),o=Ro(o,pa(u)),o=Ro(o,pa(d)),o}_createItems(e){const r=this._active,n=this.chart.data,s=[],u=[],d=[];let o=[],g,x;for(g=0,x=r.length;g<x;++g)o.push(G$(this.chart,r[g]));return e.filter&&(o=o.filter((E,S,P)=>e.filter(E,S,P,n))),e.itemSort&&(o=o.sort((E,S)=>e.itemSort(E,S,n))),oi(o,E=>{const S=sA(e.callbacks,E);s.push(ns(S,"labelColor",this,E)),u.push(ns(S,"labelPointStyle",this,E)),d.push(ns(S,"labelTextColor",this,E))}),this.labelColors=s,this.labelPointStyles=u,this.labelTextColors=d,this.dataPoints=o,o}update(e,r){const n=this.options.setContext(this.getContext()),s=this._active;let u,d=[];if(!s.length)this.opacity!==0&&(u={opacity:0});else{const o=ep[n.position].call(this,s,this._eventPosition);d=this._createItems(n),this.title=this.getTitle(d,n),this.beforeBody=this.getBeforeBody(d,n),this.body=this.getBody(d,n),this.afterBody=this.getAfterBody(d,n),this.footer=this.getFooter(d,n);const g=this._size=tA(this,n),x=Object.assign({},o,g),E=rA(this.chart,n,x),S=iA(n,x,E,this.chart);this.xAlign=E.xAlign,this.yAlign=E.yAlign,u={opacity:1,x:S.x,y:S.y,width:g.width,height:g.height,caretX:o.x,caretY:o.y}}this._tooltipItems=d,this.$context=void 0,u&&this._resolveAnimations().update(this,u),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,r,n,s){const u=this.getCaretPosition(e,n,s);r.lineTo(u.x1,u.y1),r.lineTo(u.x2,u.y2),r.lineTo(u.x3,u.y3)}getCaretPosition(e,r,n){const{xAlign:s,yAlign:u}=this,{caretSize:d,cornerRadius:o}=n,{topLeft:g,topRight:x,bottomLeft:E,bottomRight:S}=Qc(o),{x:P,y:I}=e,{width:R,height:z}=r;let B,$,j,G,K,X;return u==="center"?(K=I+z/2,s==="left"?(B=P,$=B-d,G=K+d,X=K-d):(B=P+R,$=B+d,G=K-d,X=K+d),j=B):(s==="left"?$=P+Math.max(g,E)+d:s==="right"?$=P+R-Math.max(x,S)-d:$=this.caretX,u==="top"?(G=I,K=G-d,B=$-d,j=$+d):(G=I+z,K=G+d,B=$+d,j=$-d),X=G),{x1:B,x2:$,x3:j,y1:G,y2:K,y3:X}}drawTitle(e,r,n){const s=this.title,u=s.length;let d,o,g;if(u){const x=Uh(n.rtl,this.x,this.width);for(e.x=n_(this,n.titleAlign,n),r.textAlign=x.textAlign(n.titleAlign),r.textBaseline="middle",d=tn(n.titleFont),o=n.titleSpacing,r.fillStyle=n.titleColor,r.font=d.string,g=0;g<u;++g)r.fillText(s[g],x.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+o,g+1===u&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,r,n,s,u){const d=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:g,boxWidth:x,boxPadding:E}=u,S=tn(u.bodyFont),P=n_(this,"left",u),I=s.x(P),R=g<S.lineHeight?(S.lineHeight-g)/2:0,z=r.y+R;if(u.usePointStyle){const B={radius:Math.min(x,g)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},$=s.leftForLtr(I,x)+x/2,j=z+g/2;e.strokeStyle=u.multiKeyBackground,e.fillStyle=u.multiKeyBackground,hb(e,B,$,j),e.strokeStyle=d.borderColor,e.fillStyle=d.backgroundColor,hb(e,B,$,j)}else{e.lineWidth=Ur(d.borderWidth)?Math.max(...Object.values(d.borderWidth)):d.borderWidth||1,e.strokeStyle=d.borderColor,e.setLineDash(d.borderDash||[]),e.lineDashOffset=d.borderDashOffset||0;const B=s.leftForLtr(I,x-E),$=s.leftForLtr(s.xPlus(I,1),x-E-2),j=Qc(d.borderRadius);Object.values(j).some(G=>G!==0)?(e.beginPath(),e.fillStyle=u.multiKeyBackground,Ip(e,{x:B,y:z,w:x,h:g,radius:j}),e.fill(),e.stroke(),e.fillStyle=d.backgroundColor,e.beginPath(),Ip(e,{x:$,y:z+1,w:x-2,h:g-2,radius:j}),e.fill()):(e.fillStyle=u.multiKeyBackground,e.fillRect(B,z,x,g),e.strokeRect(B,z,x,g),e.fillStyle=d.backgroundColor,e.fillRect($,z+1,x-2,g-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,r,n){const{body:s}=this,{bodySpacing:u,bodyAlign:d,displayColors:o,boxHeight:g,boxWidth:x,boxPadding:E}=n,S=tn(n.bodyFont);let P=S.lineHeight,I=0;const R=Uh(n.rtl,this.x,this.width),z=function(ne){r.fillText(ne,R.x(e.x+I),e.y+P/2),e.y+=P+u},B=R.textAlign(d);let $,j,G,K,X,re,ue;for(r.textAlign=d,r.textBaseline="middle",r.font=S.string,e.x=n_(this,B,n),r.fillStyle=n.bodyColor,oi(this.beforeBody,z),I=o&&B!=="right"?d==="center"?x/2+E:x+2+E:0,K=0,re=s.length;K<re;++K){for($=s[K],j=this.labelTextColors[K],r.fillStyle=j,oi($.before,z),G=$.lines,o&&G.length&&(this._drawColorBox(r,e,K,R,n),P=Math.max(S.lineHeight,g)),X=0,ue=G.length;X<ue;++X)z(G[X]),P=S.lineHeight;oi($.after,z)}I=0,P=S.lineHeight,oi(this.afterBody,z),e.y-=u}drawFooter(e,r,n){const s=this.footer,u=s.length;let d,o;if(u){const g=Uh(n.rtl,this.x,this.width);for(e.x=n_(this,n.footerAlign,n),e.y+=n.footerMarginTop,r.textAlign=g.textAlign(n.footerAlign),r.textBaseline="middle",d=tn(n.footerFont),r.fillStyle=n.footerColor,r.font=d.string,o=0;o<u;++o)r.fillText(s[o],g.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+n.footerSpacing}}drawBackground(e,r,n,s){const{xAlign:u,yAlign:d}=this,{x:o,y:g}=e,{width:x,height:E}=n,{topLeft:S,topRight:P,bottomLeft:I,bottomRight:R}=Qc(s.cornerRadius);r.fillStyle=s.backgroundColor,r.strokeStyle=s.borderColor,r.lineWidth=s.borderWidth,r.beginPath(),r.moveTo(o+S,g),d==="top"&&this.drawCaret(e,r,n,s),r.lineTo(o+x-P,g),r.quadraticCurveTo(o+x,g,o+x,g+P),d==="center"&&u==="right"&&this.drawCaret(e,r,n,s),r.lineTo(o+x,g+E-R),r.quadraticCurveTo(o+x,g+E,o+x-R,g+E),d==="bottom"&&this.drawCaret(e,r,n,s),r.lineTo(o+I,g+E),r.quadraticCurveTo(o,g+E,o,g+E-I),d==="center"&&u==="left"&&this.drawCaret(e,r,n,s),r.lineTo(o,g+S),r.quadraticCurveTo(o,g,o+S,g),r.closePath(),r.fill(),s.borderWidth>0&&r.stroke()}_updateAnimationTarget(e){const r=this.chart,n=this.$animations,s=n&&n.x,u=n&&n.y;if(s||u){const d=ep[e.position].call(this,this._active,this._eventPosition);if(!d)return;const o=this._size=tA(this,e),g=Object.assign({},d,this._size),x=rA(r,e,g),E=iA(e,g,x,r);(s._to!==E.x||u._to!==E.y)&&(this.xAlign=x.xAlign,this.yAlign=x.yAlign,this.width=o.width,this.height=o.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,E))}}_willRender(){return!!this.opacity}draw(e){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const s={width:this.width,height:this.height},u={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const d=Rn(r.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(u,e,s,r),aM(e,r.textDirection),u.y+=d.top,this.drawTitle(u,e,r),this.drawBody(u,e,r),this.drawFooter(u,e,r),lM(e,r.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,r){const n=this._active,s=e.map(({datasetIndex:o,index:g})=>{const x=this.chart.getDatasetMeta(o);if(!x)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:x.data[g],index:g}}),u=!K_(n,s),d=this._positionChanged(s,r);(u||d)&&(this._active=s,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,u=this._active||[],d=this._getActiveElements(e,u,r,n),o=this._positionChanged(d,e),g=r||!K_(d,u)||o;return g&&(this._active=d,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,r))),g}_getActiveElements(e,r,n,s){const u=this.options;if(e.type==="mouseout")return[];if(!s)return r;const d=this.chart.getElementsAtEventForMode(e,u.mode,u,n);return u.reverse&&d.reverse(),d}_positionChanged(e,r){const{caretX:n,caretY:s,options:u}=this,d=ep[u.position].call(this,e,r);return d!==!1&&(n!==d.x||s!==d.y)}}ir(yb,"positioners",ep);var Y$={id:"tooltip",_element:yb,positioners:ep,afterInit(t,e,r){r&&(t.tooltip=new yb({chart:t,options:r}))},beforeUpdate(t,e,r){t.tooltip&&t.tooltip.initialize(r)},reset(t,e,r){t.tooltip&&t.tooltip.initialize(r)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const r={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",r)}},afterEvent(t,e){if(t.tooltip){const r=e.replay;t.tooltip.handleEvent(e.event,r,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:RM},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},J$=Object.freeze({__proto__:null,Colors:u$,Decimation:p$,Filler:L$,Legend:j$,SubTitle:U$,Title:V$,Tooltip:Y$});const Q$=(t,e,r,n)=>(typeof e=="string"?(r=t.push(e)-1,n.unshift({index:r,label:e})):isNaN(e)&&(r=null),r);function eV(t,e,r,n){const s=t.indexOf(e);if(s===-1)return Q$(t,e,r,n);const u=t.lastIndexOf(e);return s!==u?r:s}const tV=(t,e)=>t===null?null:un(Math.round(t),0,e);function oA(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class vb extends pu{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:s,label:u}of r)n[s]===u&&n.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,r){if(Kr(e))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===e?r:eV(n,e,Ar(r,e),this._addedLabels),tV(r,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:r}=this.getUserBounds();let{min:n,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),r||(s=this.getLabels().length-1)),this.min=n,this.max=s}buildTicks(){const e=this.min,r=this.max,n=this.options.offset,s=[];let u=this.getLabels();u=e===0&&r===u.length-1?u:u.slice(e,r+1),this._valueRange=Math.max(u.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let d=e;d<=r;d++)s.push({value:d});return s}getLabelForValue(e){return oA.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}ir(vb,"id","category"),ir(vb,"defaults",{ticks:{callback:oA}});function rV(t,e){const r=[],{bounds:s,step:u,min:d,max:o,precision:g,count:x,maxTicks:E,maxDigits:S,includeBounds:P}=t,I=u||1,R=E-1,{min:z,max:B}=e,$=!Kr(d),j=!Kr(o),G=!Kr(x),K=(B-z)/(S+1);let X=JS((B-z)/R/I)*I,re,ue,ne,we;if(X<1e-14&&!$&&!j)return[{value:z},{value:B}];we=Math.ceil(B/X)-Math.floor(z/X),we>R&&(X=JS(we*X/R/I)*I),Kr(g)||(re=Math.pow(10,g),X=Math.ceil(X*re)/re),s==="ticks"?(ue=Math.floor(z/X)*X,ne=Math.ceil(B/X)*X):(ue=z,ne=B),$&&j&&u&&M4((o-d)/u,X/1e3)?(we=Math.round(Math.min((o-d)/X,E)),X=(o-d)/we,ue=d,ne=o):G?(ue=$?d:ue,ne=j?o:ne,we=x-1,X=(ne-ue)/we):(we=(ne-ue)/X,fp(we,Math.round(we),X/1e3)?we=Math.round(we):we=Math.ceil(we));const xe=Math.max(QS(X),QS(ue));re=Math.pow(10,Kr(g)?xe:g),ue=Math.round(ue*re)/re,ne=Math.round(ne*re)/re;let ke=0;for($&&(P&&ue!==d?(r.push({value:d}),ue<d&&ke++,fp(Math.round((ue+ke*X)*re)/re,d,aA(d,K,t))&&ke++):ue<d&&ke++);ke<we;++ke)r.push({value:Math.round((ue+ke*X)*re)/re});return j&&P&&ne!==o?r.length&&fp(r[r.length-1].value,o,aA(o,K,t))?r[r.length-1].value=o:r.push({value:o}):(!j||ne===o)&&r.push({value:ne}),r}function aA(t,e,{horizontal:r,minRotation:n}){const s=ao(n),u=(r?Math.sin(s):Math.cos(s))||.001,d=.75*e*(""+t).length;return Math.min(e/u,d)}class ny extends pu{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,r){return Kr(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:s,max:u}=this;const d=g=>s=r?s:g,o=g=>u=n?u:g;if(e){const g=jo(s),x=jo(u);g<0&&x<0?o(0):g>0&&x>0&&d(0)}if(s===u){let g=u===0?1:Math.abs(u*.05);o(u+g),e||d(s-g)}this.min=s,this.max=u}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=e,s;return n?(s=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),r=r||11),r&&(s=Math.min(r,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,r=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const s={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},u=this._range||this,d=rV(s,u);return e.bounds==="ticks"&&BI(d,this,"value"),e.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const e=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const s=(n-r)/Math.max(e.length-1,1)/2;r-=s,n+=s}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(e){return Zp(e,this.chart.options.locale,this.options.ticks.format)}}class xb extends ny{determineDataLimits(){const{min:e,max:r}=this.getMinMax(!0);this.min=Ni(e)?e:0,this.max=Ni(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),r=e?this.width:this.height,n=ao(this.options.ticks.minRotation),s=(e?Math.sin(n):Math.cos(n))||.001,u=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,u.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}ir(xb,"id","linear"),ir(xb,"defaults",{ticks:{callback:Qy.formatters.numeric}});const Op=t=>Math.floor(wl(t)),kc=(t,e)=>Math.pow(10,Op(t)+e);function lA(t){return t/Math.pow(10,Op(t))===1}function cA(t,e,r){const n=Math.pow(10,r),s=Math.floor(t/n);return Math.ceil(e/n)-s}function iV(t,e){const r=e-t;let n=Op(r);for(;cA(t,e,n)>10;)n++;for(;cA(t,e,n)<10;)n--;return Math.min(n,Op(t))}function nV(t,{min:e,max:r}){e=vs(t.min,e);const n=[],s=Op(e);let u=iV(e,r),d=u<0?Math.pow(10,Math.abs(u)):1;const o=Math.pow(10,u),g=s>u?Math.pow(10,s):0,x=Math.round((e-g)*d)/d,E=Math.floor((e-g)/o/10)*o*10;let S=Math.floor((x-E)/Math.pow(10,u)),P=vs(t.min,Math.round((g+E+S*Math.pow(10,u))*d)/d);for(;P<r;)n.push({value:P,major:lA(P),significand:S}),S>=10?S=S<15?15:20:S++,S>=20&&(u++,S=2,d=u>=0?1:d),P=Math.round((g+E+S*Math.pow(10,u))*d)/d;const I=vs(t.max,P);return n.push({value:I,major:lA(I),significand:S}),n}class bb extends pu{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,r){const n=ny.prototype.parse.apply(this,[e,r]);if(n===0){this._zero=!0;return}return Ni(n)&&n>0?n:null}determineDataLimits(){const{min:e,max:r}=this.getMinMax(!0);this.min=Ni(e)?Math.max(0,e):null,this.max=Ni(r)?Math.max(0,r):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Ni(this._userMin)&&(this.min=e===kc(this.min,0)?kc(this.min,-1):kc(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:r}=this.getUserBounds();let n=this.min,s=this.max;const u=o=>n=e?n:o,d=o=>s=r?s:o;n===s&&(n<=0?(u(1),d(10)):(u(kc(n,-1)),d(kc(s,1)))),n<=0&&u(kc(s,-1)),s<=0&&d(kc(n,1)),this.min=n,this.max=s}buildTicks(){const e=this.options,r={min:this._userMin,max:this._userMax},n=nV(r,this);return e.bounds==="ticks"&&BI(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(e){return e===void 0?"0":Zp(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=wl(e),this._valueRange=wl(this.max)-wl(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(wl(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const r=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+r*this._valueRange)}}ir(bb,"id","logarithmic"),ir(bb,"defaults",{ticks:{callback:Qy.formatters.logarithmic,major:{enabled:!0}}});function wb(t){const e=t.ticks;if(e.display&&t.display){const r=Rn(e.backdropPadding);return Ar(e.font&&e.font.size,Gi.font.size)+r.height}return 0}function sV(t,e,r){return r=bi(r)?r:[r],{w:mN(t,e.string,r),h:r.length*e.lineHeight}}function uA(t,e,r,n,s){return t===n||t===s?{start:e-r/2,end:e+r/2}:t<n||t>s?{start:e-r,end:e}:{start:e,end:e+r}}function oV(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},r=Object.assign({},e),n=[],s=[],u=t._pointLabels.length,d=t.options.pointLabels,o=d.centerPointLabels?Ci/u:0;for(let g=0;g<u;g++){const x=d.setContext(t.getPointLabelContext(g));s[g]=x.padding;const E=t.getPointPosition(g,t.drawingArea+s[g],o),S=tn(x.font),P=sV(t.ctx,S,t._pointLabels[g]);n[g]=P;const I=ws(t.getIndexAngle(g)+o),R=Math.round(y1(I)),z=uA(R,E.x,P.w,0,180),B=uA(R,E.y,P.h,90,270);aV(r,e,I,z,B)}t.setCenterPoint(e.l-r.l,r.r-e.r,e.t-r.t,r.b-e.b),t._pointLabelItems=lV(t,n,s)}function aV(t,e,r,n,s){const u=Math.abs(Math.sin(r)),d=Math.abs(Math.cos(r));let o=0,g=0;n.start<e.l?(o=(e.l-n.start)/u,t.l=Math.min(t.l,e.l-o)):n.end>e.r&&(o=(n.end-e.r)/u,t.r=Math.max(t.r,e.r+o)),s.start<e.t?(g=(e.t-s.start)/d,t.t=Math.min(t.t,e.t-g)):s.end>e.b&&(g=(s.end-e.b)/d,t.b=Math.max(t.b,e.b+g))}function lV(t,e,r){const n=[],s=t._pointLabels.length,u=t.options,d=wb(u)/2,o=t.drawingArea,g=u.pointLabels.centerPointLabels?Ci/s:0;for(let x=0;x<s;x++){const E=t.getPointPosition(x,o+d+r[x],g),S=Math.round(y1(ws(E.angle+ji))),P=e[x],I=hV(E.y,P.h,S),R=cV(S),z=uV(E.x,P.w,R);n.push({x:E.x,y:I,textAlign:R,left:z,top:I,right:z+P.w,bottom:I+P.h})}return n}function cV(t){return t===0||t===180?"center":t<180?"left":"right"}function uV(t,e,r){return r==="right"?t-=e:r==="center"&&(t-=e/2),t}function hV(t,e,r){return r===90||r===270?t-=e/2:(r>270||r<90)&&(t-=e),t}function dV(t,e){const{ctx:r,options:{pointLabels:n}}=t;for(let s=e-1;s>=0;s--){const u=n.setContext(t.getPointLabelContext(s)),d=tn(u.font),{x:o,y:g,textAlign:x,left:E,top:S,right:P,bottom:I}=t._pointLabelItems[s],{backdropColor:R}=u;if(!Kr(R)){const z=Qc(u.borderRadius),B=Rn(u.backdropPadding);r.fillStyle=R;const $=E-B.left,j=S-B.top,G=P-E+B.width,K=I-S+B.height;Object.values(z).some(X=>X!==0)?(r.beginPath(),Ip(r,{x:$,y:j,w:G,h:K,radius:z}),r.fill()):r.fillRect($,j,G,K)}cu(r,t._pointLabels[s],o,g+d.lineHeight/2,d,{color:u.color,textAlign:x,textBaseline:"middle"})}}function LM(t,e,r,n){const{ctx:s}=t;if(r)s.arc(t.xCenter,t.yCenter,e,0,wi);else{let u=t.getPointPosition(0,e);s.moveTo(u.x,u.y);for(let d=1;d<n;d++)u=t.getPointPosition(d,e),s.lineTo(u.x,u.y)}}function fV(t,e,r,n,s){const u=t.ctx,d=e.circular,{color:o,lineWidth:g}=e;!d&&!n||!o||!g||r<0||(u.save(),u.strokeStyle=o,u.lineWidth=g,u.setLineDash(s.dash),u.lineDashOffset=s.dashOffset,u.beginPath(),LM(t,r,d,n),u.closePath(),u.stroke(),u.restore())}function pV(t,e,r){return Ul(t,{label:r,index:e,type:"pointLabel"})}class tp extends ny{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Rn(wb(this.options)/2),r=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+r/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(r,n)/2)}determineDataLimits(){const{min:e,max:r}=this.getMinMax(!1);this.min=Ni(e)&&!isNaN(e)?e:0,this.max=Ni(r)&&!isNaN(r)?r:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/wb(this.options))}generateTickLabels(e){ny.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((r,n)=>{const s=mi(this.options.pointLabels.callback,[r,n],this);return s||s===0?s:""}).filter((r,n)=>this.chart.getDataVisibility(n))}fit(){const e=this.options;e.display&&e.pointLabels.display?oV(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,r,n,s){this.xCenter+=Math.floor((e-r)/2),this.yCenter+=Math.floor((n-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,r,n,s))}getIndexAngle(e){const r=wi/(this._pointLabels.length||1),n=this.options.startAngle||0;return ws(e*r+ao(n))}getDistanceFromCenterForValue(e){if(Kr(e))return NaN;const r=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*r:(e-this.min)*r}getValueForDistanceFromCenter(e){if(Kr(e))return NaN;const r=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-r:this.min+r}getPointLabelContext(e){const r=this._pointLabels||[];if(e>=0&&e<r.length){const n=r[e];return pV(this.getContext(),e,n)}}getPointPosition(e,r,n=0){const s=this.getIndexAngle(e)-ji+n;return{x:Math.cos(s)*r+this.xCenter,y:Math.sin(s)*r+this.yCenter,angle:s}}getPointPositionForValue(e,r){return this.getPointPosition(e,this.getDistanceFromCenterForValue(r))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:r,top:n,right:s,bottom:u}=this._pointLabelItems[e];return{left:r,top:n,right:s,bottom:u}}drawBackground(){const{backgroundColor:e,grid:{circular:r}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),LM(this,this.getDistanceFromCenterForValue(this._endValue),r,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,r=this.options,{angleLines:n,grid:s,border:u}=r,d=this._pointLabels.length;let o,g,x;if(r.pointLabels.display&&dV(this,d),s.display&&this.ticks.forEach((E,S)=>{if(S!==0){g=this.getDistanceFromCenterForValue(E.value);const P=this.getContext(S),I=s.setContext(P),R=u.setContext(P);fV(this,I,g,d,R)}}),n.display){for(e.save(),o=d-1;o>=0;o--){const E=n.setContext(this.getPointLabelContext(o)),{color:S,lineWidth:P}=E;!P||!S||(e.lineWidth=P,e.strokeStyle=S,e.setLineDash(E.borderDash),e.lineDashOffset=E.borderDashOffset,g=this.getDistanceFromCenterForValue(r.ticks.reverse?this.min:this.max),x=this.getPointPosition(o,g),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(x.x,x.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,r=this.options,n=r.ticks;if(!n.display)return;const s=this.getIndexAngle(0);let u,d;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((o,g)=>{if(g===0&&!r.reverse)return;const x=n.setContext(this.getContext(g)),E=tn(x.font);if(u=this.getDistanceFromCenterForValue(this.ticks[g].value),x.showLabelBackdrop){e.font=E.string,d=e.measureText(o.label).width,e.fillStyle=x.backdropColor;const S=Rn(x.backdropPadding);e.fillRect(-d/2-S.left,-u-E.size/2-S.top,d+S.width,E.size+S.height)}cu(e,o.label,0,-u,E,{color:x.color})}),e.restore()}drawTitle(){}}ir(tp,"id","radialLinear"),ir(tp,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Qy.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),ir(tp,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),ir(tp,"descriptors",{angleLines:{_fallback:"grid"}});const iv={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},as=Object.keys(iv);function mV(t,e){return t-e}function hA(t,e){if(Kr(e))return null;const r=t._adapter,{parser:n,round:s,isoWeekday:u}=t._parseOpts;let d=e;return typeof n=="function"&&(d=n(d)),Ni(d)||(d=typeof n=="string"?r.parse(d,n):r.parse(d)),d===null?null:(s&&(d=s==="week"&&(Qh(u)||u===!0)?r.startOf(d,"isoWeek",u):r.startOf(d,s)),+d)}function dA(t,e,r,n){const s=as.length;for(let u=as.indexOf(t);u<s-1;++u){const d=iv[as[u]],o=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((r-e)/(o*d.size))<=n)return as[u]}return as[s-1]}function gV(t,e,r,n,s){for(let u=as.length-1;u>=as.indexOf(r);u--){const d=as[u];if(iv[d].common&&t._adapter.diff(s,n,d)>=e-1)return d}return as[r?as.indexOf(r):0]}function _V(t){for(let e=as.indexOf(t)+1,r=as.length;e<r;++e)if(iv[as[e]].common)return as[e]}function fA(t,e,r){if(!r)t[e]=!0;else if(r.length){const{lo:n,hi:s}=v1(r,e),u=r[n]>=e?r[n]:r[s];t[u]=!0}}function yV(t,e,r,n){const s=t._adapter,u=+s.startOf(e[0].value,n),d=e[e.length-1].value;let o,g;for(o=u;o<=d;o=+s.add(o,1,n))g=r[o],g>=0&&(e[g].major=!0);return e}function pA(t,e,r){const n=[],s={},u=e.length;let d,o;for(d=0;d<u;++d)o=e[d],s[o]=d,n.push({value:o,major:!1});return u===0||!r?n:yV(t,n,s,r)}class Dp extends pu{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,r={}){const n=e.time||(e.time={}),s=this._adapter=new O5._date(e.adapters.date);s.init(r),dp(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=r.normalized}parse(e,r){return e===void 0?null:hA(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,r=this._adapter,n=e.time.unit||"day";let{min:s,max:u,minDefined:d,maxDefined:o}=this.getUserBounds();function g(x){!d&&!isNaN(x.min)&&(s=Math.min(s,x.min)),!o&&!isNaN(x.max)&&(u=Math.max(u,x.max))}(!d||!o)&&(g(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&g(this.getMinMax(!1))),s=Ni(s)&&!isNaN(s)?s:+r.startOf(Date.now(),n),u=Ni(u)&&!isNaN(u)?u:+r.endOf(Date.now(),n)+1,this.min=Math.min(s,u-1),this.max=Math.max(s+1,u)}_getLabelBounds(){const e=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(r=e[0],n=e[e.length-1]),{min:r,max:n}}buildTicks(){const e=this.options,r=e.time,n=e.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const u=this.min,d=this.max,o=L4(s,u,d);return this._unit=r.unit||(n.autoSkip?dA(r.minUnit,this.min,this.max,this._getLabelCapacity(u)):gV(this,o.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:_V(this._unit),this.initOffsets(s),e.reverse&&o.reverse(),pA(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let r=0,n=0,s,u;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?r=1-s:r=(this.getDecimalForValue(e[1])-s)/2,u=this.getDecimalForValue(e[e.length-1]),e.length===1?n=u:n=(u-this.getDecimalForValue(e[e.length-2]))/2);const d=e.length<3?.5:.25;r=un(r,0,d),n=un(n,0,d),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const e=this._adapter,r=this.min,n=this.max,s=this.options,u=s.time,d=u.unit||dA(u.minUnit,r,n,this._getLabelCapacity(r)),o=Ar(s.ticks.stepSize,1),g=d==="week"?u.isoWeekday:!1,x=Qh(g)||g===!0,E={};let S=r,P,I;if(x&&(S=+e.startOf(S,"isoWeek",g)),S=+e.startOf(S,x?"day":d),e.diff(n,r,d)>1e5*o)throw new Error(r+" and "+n+" are too far apart with stepSize of "+o+" "+d);const R=s.ticks.source==="data"&&this.getDataTimestamps();for(P=S,I=0;P<n;P=+e.add(P,o,d),I++)fA(E,P,R);return(P===n||s.bounds==="ticks"||I===1)&&fA(E,P,R),Object.keys(E).sort((z,B)=>z-B).map(z=>+z)}getLabelForValue(e){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(e,n.tooltipFormat):r.format(e,n.displayFormats.datetime)}_tickFormatFunction(e,r,n,s){const u=this.options,d=u.ticks.callback;if(d)return mi(d,[e,r,n],this);const o=u.time.displayFormats,g=this._unit,x=this._majorUnit,E=g&&o[g],S=x&&o[x],P=n[r],I=x&&S&&P&&P.major;return this._adapter.format(e,s||(I?S:E))}generateTickLabels(e){let r,n,s;for(r=0,n=e.length;r<n;++r)s=e[r],s.label=this._tickFormatFunction(s.value,r,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const r=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const r=this.options.ticks,n=this.ctx.measureText(e).width,s=ao(this.isHorizontal()?r.maxRotation:r.minRotation),u=Math.cos(s),d=Math.sin(s),o=this._resolveTickFontOptions(0).size;return{w:n*u+o*d,h:n*d+o*u}}_getLabelCapacity(e){const r=this.options.time,n=r.displayFormats,s=n[r.unit]||n.millisecond,u=this._tickFormatFunction(e,0,pA(this,[e],this._majorUnit),s),d=this._getLabelSize(u),o=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],r,n;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(r=0,n=s.length;r<n;++r)e=e.concat(s[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let r,n;if(e.length)return e;const s=this.getLabels();for(r=0,n=s.length;r<n;++r)e.push(hA(this,s[r]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return $I(e.sort(mV))}}ir(Dp,"id","time"),ir(Dp,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function s_(t,e,r){let n=0,s=t.length-1,u,d,o,g;r?(e>=t[n].pos&&e<=t[s].pos&&({lo:n,hi:s}=Ea(t,"pos",e)),{pos:u,time:o}=t[n],{pos:d,time:g}=t[s]):(e>=t[n].time&&e<=t[s].time&&({lo:n,hi:s}=Ea(t,"time",e)),{time:u,pos:o}=t[n],{time:d,pos:g}=t[s]);const x=d-u;return x?o+(g-o)*(e-u)/x:o}class Eb extends Dp{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(e);this._minPos=s_(r,this.min),this._tableRange=s_(r,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:r,max:n}=this,s=[],u=[];let d,o,g,x,E;for(d=0,o=e.length;d<o;++d)x=e[d],x>=r&&x<=n&&s.push(x);if(s.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(d=0,o=s.length;d<o;++d)E=s[d+1],g=s[d-1],x=s[d],Math.round((E+g)/2)!==x&&u.push({time:x,pos:d/(o-1)});return u}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?e=this.normalize(r.concat(n)):e=r.length?r:n,e=this._cache.all=e,e}getDecimalForValue(e){return(s_(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return s_(this._table,n*this._tableRange+this._minPos,!0)}}ir(Eb,"id","timeseries"),ir(Eb,"defaults",Dp.defaults);var vV=Eb,xV=Object.freeze({__proto__:null,CategoryScale:vb,LinearScale:xb,LogarithmicScale:bb,RadialLinearScale:tp,TimeScale:Dp,TimeSeriesScale:vV});const bV=[M5,s$,J$,xV];pb.register(...bV);const wV={props:["id","labels","data","dataM"],components:{Chart:pb},setup(){},data(){return{}},mounted(){setTimeout(()=>{console.log(this.id),this.creategraph()},1e3)},methods:{creategraph(){const t=document.getElementById(this.id);new pb(t,{type:"line",data:{labels:this.labels,datasets:[{label:"time (ms)",data:this.data,fill:!1,borderColor:"black",tension:.5},{label:"memory (mega-bytes)",data:this.dataM,fill:!1,borderColor:"orange",tension:.5}]},options:{scales:{y:{beginAtZero:!1}}}})}}},EV=["id"];function TV(t,e,r,n,s,u){return kr(),xi("div",null,[Nr("canvas",{id:r.id},null,8,EV)])}var SV=Hp(wV,[["render",TV]]),rp={exports:{}},AV=m4(J3);(function(t){t.exports=function(e){var r={};function n(s){if(r[s])return r[s].exports;var u=r[s]={i:s,l:!1,exports:{}};return e[s].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=e,n.c=r,n.d=function(s,u,d){n.o(s,u)||Object.defineProperty(s,u,{enumerable:!0,get:d})},n.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},n.t=function(s,u){if(u&1&&(s=n(s)),u&8||u&4&&typeof s=="object"&&s&&s.__esModule)return s;var d=Object.create(null);if(n.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:s}),u&2&&typeof s!="string")for(var o in s)n.d(d,o,function(g){return s[g]}.bind(null,o));return d},n.n=function(s){var u=s&&s.__esModule?function(){return s.default}:function(){return s};return n.d(u,"a",u),u},n.o=function(s,u){return Object.prototype.hasOwnProperty.call(s,u)},n.p="",n(n.s="fb15")}({"00ee":function(e,r,n){var s=n("b622"),u=s("toStringTag"),d={};d[u]="z",e.exports=String(d)==="[object z]"},"0366":function(e,r,n){var s=n("1c0b");e.exports=function(u,d,o){if(s(u),d===void 0)return u;switch(o){case 0:return function(){return u.call(d)};case 1:return function(g){return u.call(d,g)};case 2:return function(g,x){return u.call(d,g,x)};case 3:return function(g,x,E){return u.call(d,g,x,E)}}return function(){return u.apply(d,arguments)}}},"04de":function(e,r,n){n("82c3")},"057f":function(e,r,n){var s=n("fc6a"),u=n("241c").f,d={}.toString,o=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],g=function(x){try{return u(x)}catch{return o.slice()}};e.exports.f=function(E){return o&&d.call(E)=="[object Window]"?g(E):u(s(E))}},"06cf":function(e,r,n){var s=n("83ab"),u=n("d1e7"),d=n("5c6c"),o=n("fc6a"),g=n("c04e"),x=n("5135"),E=n("0cfb"),S=Object.getOwnPropertyDescriptor;r.f=s?S:function(I,R){if(I=o(I),R=g(R,!0),E)try{return S(I,R)}catch{}if(x(I,R))return d(!u.f.call(I,R),I[R])}},"0cfb":function(e,r,n){var s=n("83ab"),u=n("d039"),d=n("cc12");e.exports=!s&&!u(function(){return Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a!=7})},"159b":function(e,r,n){var s=n("da84"),u=n("fdbc"),d=n("17c2"),o=n("9112");for(var g in u){var x=s[g],E=x&&x.prototype;if(E&&E.forEach!==d)try{o(E,"forEach",d)}catch{E.forEach=d}}},"17c2":function(e,r,n){var s=n("b727").forEach,u=n("a640"),d=n("ae40"),o=u("forEach"),g=d("forEach");e.exports=!o||!g?function(E){return s(this,E,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(e,r,n){var s=n("d066");e.exports=s("document","documentElement")},"1c0b":function(e,r){e.exports=function(n){if(typeof n!="function")throw TypeError(String(n)+" is not a function");return n}},"1c7e":function(e,r,n){var s=n("b622"),u=s("iterator"),d=!1;try{var o=0,g={next:function(){return{done:!!o++}},return:function(){d=!0}};g[u]=function(){return this},Array.from(g,function(){throw 2})}catch{}e.exports=function(x,E){if(!E&&!d)return!1;var S=!1;try{var P={};P[u]=function(){return{next:function(){return{done:S=!0}}}},x(P)}catch{}return S}},"1d80":function(e,r){e.exports=function(n){if(n==null)throw TypeError("Can't call method on "+n);return n}},"1dde":function(e,r,n){var s=n("d039"),u=n("b622"),d=n("2d00"),o=u("species");e.exports=function(g){return d>=51||!s(function(){var x=[],E=x.constructor={};return E[o]=function(){return{foo:1}},x[g](Boolean).foo!==1})}},"23cb":function(e,r,n){var s=n("a691"),u=Math.max,d=Math.min;e.exports=function(o,g){var x=s(o);return x<0?u(x+g,0):d(x,g)}},"23e7":function(e,r,n){var s=n("da84"),u=n("06cf").f,d=n("9112"),o=n("6eeb"),g=n("ce4e"),x=n("e893"),E=n("94ca");e.exports=function(S,P){var I=S.target,R=S.global,z=S.stat,B,$,j,G,K,X;if(R?$=s:z?$=s[I]||g(I,{}):$=(s[I]||{}).prototype,$)for(j in P){if(K=P[j],S.noTargetGet?(X=u($,j),G=X&&X.value):G=$[j],B=E(R?j:I+(z?".":"#")+j,S.forced),!B&&G!==void 0){if(typeof K==typeof G)continue;x(K,G)}(S.sham||G&&G.sham)&&d(K,"sham",!0),o($,j,K,S)}}},"241c":function(e,r,n){var s=n("ca84"),u=n("7839"),d=u.concat("length","prototype");r.f=Object.getOwnPropertyNames||function(g){return s(g,d)}},"24fb":function(e,r,n){e.exports=function(d){var o=[];return o.toString=function(){return this.map(function(x){var E=s(x,d);return x[2]?"@media ".concat(x[2]," {").concat(E,"}"):E}).join("")},o.i=function(g,x,E){typeof g=="string"&&(g=[[null,g,""]]);var S={};if(E)for(var P=0;P<this.length;P++){var I=this[P][0];I!=null&&(S[I]=!0)}for(var R=0;R<g.length;R++){var z=[].concat(g[R]);E&&S[z[0]]||(x&&(z[2]?z[2]="".concat(x," and ").concat(z[2]):z[2]=x),o.push(z))}},o};function s(d,o){var g=d[1]||"",x=d[3];if(!x)return g;if(o&&typeof btoa=="function"){var E=u(x),S=x.sources.map(function(P){return"/*# sourceURL=".concat(x.sourceRoot||"").concat(P," */")});return[g].concat(S).concat([E]).join(`
`)}return[g].join(`
`)}function u(d){var o=btoa(unescape(encodeURIComponent(JSON.stringify(d)))),g="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o);return"/*# ".concat(g," */")}},2532:function(e,r,n){var s=n("23e7"),u=n("5a34"),d=n("1d80"),o=n("ab13");s({target:"String",proto:!0,forced:!o("includes")},{includes:function(x){return!!~String(d(this)).indexOf(u(x),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(e,r,n){var s=n("6eeb"),u=n("825a"),d=n("d039"),o=n("ad6d"),g="toString",x=RegExp.prototype,E=x[g],S=d(function(){return E.call({source:"a",flags:"b"})!="/a/b"}),P=E.name!=g;(S||P)&&s(RegExp.prototype,g,function(){var R=u(this),z=String(R.source),B=R.flags,$=String(B===void 0&&R instanceof RegExp&&!("flags"in x)?o.call(R):B);return"/"+z+"/"+$},{unsafe:!0})},"2d00":function(e,r,n){var s=n("da84"),u=n("342f"),d=s.process,o=d&&d.versions,g=o&&o.v8,x,E;g?(x=g.split("."),E=x[0]+x[1]):u&&(x=u.match(/Edge\/(\d+)/),(!x||x[1]>=74)&&(x=u.match(/Chrome\/(\d+)/),x&&(E=x[1]))),e.exports=E&&+E},"342f":function(e,r,n){var s=n("d066");e.exports=s("navigator","userAgent")||""},"35a1":function(e,r,n){var s=n("f5df"),u=n("3f8c"),d=n("b622"),o=d("iterator");e.exports=function(g){if(g!=null)return g[o]||g["@@iterator"]||u[s(g)]}},"37e8":function(e,r,n){var s=n("83ab"),u=n("9bf2"),d=n("825a"),o=n("df75");e.exports=s?Object.defineProperties:function(x,E){d(x);for(var S=o(E),P=S.length,I=0,R;P>I;)u.f(x,R=S[I++],E[R]);return x}},"3bbe":function(e,r,n){var s=n("861d");e.exports=function(u){if(!s(u)&&u!==null)throw TypeError("Can't set "+String(u)+" as a prototype");return u}},"3ca3":function(e,r,n){var s=n("6547").charAt,u=n("69f3"),d=n("7dd0"),o="String Iterator",g=u.set,x=u.getterFor(o);d(String,"String",function(E){g(this,{type:o,string:String(E),index:0})},function(){var S=x(this),P=S.string,I=S.index,R;return I>=P.length?{value:void 0,done:!0}:(R=s(P,I),S.index+=R.length,{value:R,done:!1})})},"3f8c":function(e,r){e.exports={}},4160:function(e,r,n){var s=n("23e7"),u=n("17c2");s({target:"Array",proto:!0,forced:[].forEach!=u},{forEach:u})},"428f":function(e,r,n){var s=n("da84");e.exports=s},"44ad":function(e,r,n){var s=n("d039"),u=n("c6b6"),d="".split;e.exports=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(o){return u(o)=="String"?d.call(o,""):Object(o)}:Object},"44d2":function(e,r,n){var s=n("b622"),u=n("7c73"),d=n("9bf2"),o=s("unscopables"),g=Array.prototype;g[o]==null&&d.f(g,o,{configurable:!0,value:u(null)}),e.exports=function(x){g[o][x]=!0}},"44e7":function(e,r,n){var s=n("861d"),u=n("c6b6"),d=n("b622"),o=d("match");e.exports=function(g){var x;return s(g)&&((x=g[o])!==void 0?!!x:u(g)=="RegExp")}},4930:function(e,r,n){var s=n("d039");e.exports=!!Object.getOwnPropertySymbols&&!s(function(){return!String(Symbol())})},"499e":function(e,r,n){n.r(r),n.d(r,"default",function(){return z});function s(re,ue){for(var ne=[],we={},xe=0;xe<ue.length;xe++){var ke=ue[xe],Ie=ke[0],Fe=ke[1],se=ke[2],Be=ke[3],Ve={id:re+":"+xe,css:Fe,media:se,sourceMap:Be};we[Ie]?we[Ie].parts.push(Ve):ne.push(we[Ie]={id:Ie,parts:[Ve]})}return ne}var u=typeof document!="undefined";if(typeof DEBUG!="undefined"&&DEBUG&&!u)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var d={},o=u&&(document.head||document.getElementsByTagName("head")[0]),g=null,x=0,E=!1,S=function(){},P=null,I="data-vue-ssr-id",R=typeof navigator!="undefined"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function z(re,ue,ne,we){E=ne,P=we||{};var xe=s(re,ue);return B(xe),function(Ie){for(var Fe=[],se=0;se<xe.length;se++){var Be=xe[se],Ve=d[Be.id];Ve.refs--,Fe.push(Ve)}Ie?(xe=s(re,Ie),B(xe)):xe=[];for(var se=0;se<Fe.length;se++){var Ve=Fe[se];if(Ve.refs===0){for(var Je=0;Je<Ve.parts.length;Je++)Ve.parts[Je]();delete d[Ve.id]}}}}function B(re){for(var ue=0;ue<re.length;ue++){var ne=re[ue],we=d[ne.id];if(we){we.refs++;for(var xe=0;xe<we.parts.length;xe++)we.parts[xe](ne.parts[xe]);for(;xe<ne.parts.length;xe++)we.parts.push(j(ne.parts[xe]));we.parts.length>ne.parts.length&&(we.parts.length=ne.parts.length)}else{for(var ke=[],xe=0;xe<ne.parts.length;xe++)ke.push(j(ne.parts[xe]));d[ne.id]={id:ne.id,refs:1,parts:ke}}}}function $(){var re=document.createElement("style");return re.type="text/css",o.appendChild(re),re}function j(re){var ue,ne,we=document.querySelector("style["+I+'~="'+re.id+'"]');if(we){if(E)return S;we.parentNode.removeChild(we)}if(R){var xe=x++;we=g||(g=$()),ue=K.bind(null,we,xe,!1),ne=K.bind(null,we,xe,!0)}else we=$(),ue=X.bind(null,we),ne=function(){we.parentNode.removeChild(we)};return ue(re),function(Ie){if(Ie){if(Ie.css===re.css&&Ie.media===re.media&&Ie.sourceMap===re.sourceMap)return;ue(re=Ie)}else ne()}}var G=function(){var re=[];return function(ue,ne){return re[ue]=ne,re.filter(Boolean).join(`
`)}}();function K(re,ue,ne,we){var xe=ne?"":we.css;if(re.styleSheet)re.styleSheet.cssText=G(ue,xe);else{var ke=document.createTextNode(xe),Ie=re.childNodes;Ie[ue]&&re.removeChild(Ie[ue]),Ie.length?re.insertBefore(ke,Ie[ue]):re.appendChild(ke)}}function X(re,ue){var ne=ue.css,we=ue.media,xe=ue.sourceMap;if(we&&re.setAttribute("media",we),P.ssrId&&re.setAttribute(I,ue.id),xe&&(ne+=`
/*# sourceURL=`+xe.sources[0]+" */",ne+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(xe))))+" */"),re.styleSheet)re.styleSheet.cssText=ne;else{for(;re.firstChild;)re.removeChild(re.firstChild);re.appendChild(document.createTextNode(ne))}}},"4d64":function(e,r,n){var s=n("fc6a"),u=n("50c4"),d=n("23cb"),o=function(g){return function(x,E,S){var P=s(x),I=u(P.length),R=d(S,I),z;if(g&&E!=E){for(;I>R;)if(z=P[R++],z!=z)return!0}else for(;I>R;R++)if((g||R in P)&&P[R]===E)return g||R||0;return!g&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},"4de4":function(e,r,n){var s=n("23e7"),u=n("b727").filter,d=n("1dde"),o=n("ae40"),g=d("filter"),x=o("filter");s({target:"Array",proto:!0,forced:!g||!x},{filter:function(S){return u(this,S,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(e,r,n){var s=n("0366"),u=n("7b0b"),d=n("9bdd"),o=n("e95a"),g=n("50c4"),x=n("8418"),E=n("35a1");e.exports=function(P){var I=u(P),R=typeof this=="function"?this:Array,z=arguments.length,B=z>1?arguments[1]:void 0,$=B!==void 0,j=E(I),G=0,K,X,re,ue,ne,we;if($&&(B=s(B,z>2?arguments[2]:void 0,2)),j!=null&&!(R==Array&&o(j)))for(ue=j.call(I),ne=ue.next,X=new R;!(re=ne.call(ue)).done;G++)we=$?d(ue,B,[re.value,G],!0):re.value,x(X,G,we);else for(K=g(I.length),X=new R(K);K>G;G++)we=$?B(I[G],G):I[G],x(X,G,we);return X.length=G,X}},"50c4":function(e,r,n){var s=n("a691"),u=Math.min;e.exports=function(d){return d>0?u(s(d),9007199254740991):0}},5135:function(e,r){var n={}.hasOwnProperty;e.exports=function(s,u){return n.call(s,u)}},5692:function(e,r,n){var s=n("c430"),u=n("c6cd");(e.exports=function(d,o){return u[d]||(u[d]=o!==void 0?o:{})})("versions",[]).push({version:"3.6.5",mode:s?"pure":"global",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(e,r,n){var s=n("d066"),u=n("241c"),d=n("7418"),o=n("825a");e.exports=s("Reflect","ownKeys")||function(x){var E=u.f(o(x)),S=d.f;return S?E.concat(S(x)):E}},5899:function(e,r){e.exports=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`},"58a8":function(e,r,n){var s=n("1d80"),u=n("5899"),d="["+u+"]",o=RegExp("^"+d+d+"*"),g=RegExp(d+d+"*$"),x=function(E){return function(S){var P=String(s(S));return E&1&&(P=P.replace(o,"")),E&2&&(P=P.replace(g,"")),P}};e.exports={start:x(1),end:x(2),trim:x(3)}},"5a34":function(e,r,n){var s=n("44e7");e.exports=function(u){if(s(u))throw TypeError("The method doesn't accept regular expressions");return u}},"5c6c":function(e,r){e.exports=function(n,s){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:s}}},"5e61":function(e,r,n){var s=n("24fb");r=s(!1),r.push([e.i,".tab[data-v-90ee39a8]{padding:10px 20px}.active[data-v-90ee39a8]{border-width:0;border-bottom-width:2px;border-style:solid;border-color:#000}",""]),e.exports=r},6547:function(e,r,n){var s=n("a691"),u=n("1d80"),d=function(o){return function(g,x){var E=String(u(g)),S=s(x),P=E.length,I,R;return S<0||S>=P?o?"":void 0:(I=E.charCodeAt(S),I<55296||I>56319||S+1===P||(R=E.charCodeAt(S+1))<56320||R>57343?o?E.charAt(S):I:o?E.slice(S,S+2):(I-55296<<10)+(R-56320)+65536)}};e.exports={codeAt:d(!1),charAt:d(!0)}},"65f0":function(e,r,n){var s=n("861d"),u=n("e8b5"),d=n("b622"),o=d("species");e.exports=function(g,x){var E;return u(g)&&(E=g.constructor,typeof E=="function"&&(E===Array||u(E.prototype))?E=void 0:s(E)&&(E=E[o],E===null&&(E=void 0))),new(E===void 0?Array:E)(x===0?0:x)}},"69f3":function(e,r,n){var s=n("7f9a"),u=n("da84"),d=n("861d"),o=n("9112"),g=n("5135"),x=n("f772"),E=n("d012"),S=u.WeakMap,P,I,R,z=function(re){return R(re)?I(re):P(re,{})},B=function(re){return function(ue){var ne;if(!d(ue)||(ne=I(ue)).type!==re)throw TypeError("Incompatible receiver, "+re+" required");return ne}};if(s){var $=new S,j=$.get,G=$.has,K=$.set;P=function(re,ue){return K.call($,re,ue),ue},I=function(re){return j.call($,re)||{}},R=function(re){return G.call($,re)}}else{var X=x("state");E[X]=!0,P=function(re,ue){return o(re,X,ue),ue},I=function(re){return g(re,X)?re[X]:{}},R=function(re){return g(re,X)}}e.exports={set:P,get:I,has:R,enforce:z,getterFor:B}},"6eeb":function(e,r,n){var s=n("da84"),u=n("9112"),d=n("5135"),o=n("ce4e"),g=n("8925"),x=n("69f3"),E=x.get,S=x.enforce,P=String(String).split("String");(e.exports=function(I,R,z,B){var $=B?!!B.unsafe:!1,j=B?!!B.enumerable:!1,G=B?!!B.noTargetGet:!1;if(typeof z=="function"&&(typeof R=="string"&&!d(z,"name")&&u(z,"name",R),S(z).source=P.join(typeof R=="string"?R:"")),I===s){j?I[R]=z:o(R,z);return}else $?!G&&I[R]&&(j=!0):delete I[R];j?I[R]=z:u(I,R,z)})(Function.prototype,"toString",function(){return typeof this=="function"&&E(this).source||g(this)})},"70a4":function(e,r,n){n("cfa2")},7156:function(e,r,n){var s=n("861d"),u=n("d2bb");e.exports=function(d,o,g){var x,E;return u&&typeof(x=o.constructor)=="function"&&x!==g&&s(E=x.prototype)&&E!==g.prototype&&u(d,E),d}},7418:function(e,r){r.f=Object.getOwnPropertySymbols},"746f":function(e,r,n){var s=n("428f"),u=n("5135"),d=n("e538"),o=n("9bf2").f;e.exports=function(g){var x=s.Symbol||(s.Symbol={});u(x,g)||o(x,g,{value:d.f(g)})}},7839:function(e,r){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(e,r,n){var s=n("1d80");e.exports=function(u){return Object(s(u))}},"7c73":function(e,r,n){var s=n("825a"),u=n("37e8"),d=n("7839"),o=n("d012"),g=n("1be4"),x=n("cc12"),E=n("f772"),S=">",P="<",I="prototype",R="script",z=E("IE_PROTO"),B=function(){},$=function(re){return P+R+S+re+P+"/"+R+S},j=function(re){re.write($("")),re.close();var ue=re.parentWindow.Object;return re=null,ue},G=function(){var re=x("iframe"),ue="java"+R+":",ne;return re.style.display="none",g.appendChild(re),re.src=String(ue),ne=re.contentWindow.document,ne.open(),ne.write($("document.F=Object")),ne.close(),ne.F},K,X=function(){try{K=document.domain&&new ActiveXObject("htmlfile")}catch{}X=K?j(K):G();for(var re=d.length;re--;)delete X[I][d[re]];return X()};o[z]=!0,e.exports=Object.create||function(ue,ne){var we;return ue!==null?(B[I]=s(ue),we=new B,B[I]=null,we[z]=ue):we=X(),ne===void 0?we:u(we,ne)}},"7db0":function(e,r,n){var s=n("23e7"),u=n("b727").find,d=n("44d2"),o=n("ae40"),g="find",x=!0,E=o(g);g in[]&&Array(1)[g](function(){x=!1}),s({target:"Array",proto:!0,forced:x||!E},{find:function(P){return u(this,P,arguments.length>1?arguments[1]:void 0)}}),d(g)},"7dd0":function(e,r,n){var s=n("23e7"),u=n("9ed3"),d=n("e163"),o=n("d2bb"),g=n("d44e"),x=n("9112"),E=n("6eeb"),S=n("b622"),P=n("c430"),I=n("3f8c"),R=n("ae93"),z=R.IteratorPrototype,B=R.BUGGY_SAFARI_ITERATORS,$=S("iterator"),j="keys",G="values",K="entries",X=function(){return this};e.exports=function(re,ue,ne,we,xe,ke,Ie){u(ne,ue,we);var Fe=function(yt){if(yt===xe&&ut)return ut;if(!B&&yt in Ve)return Ve[yt];switch(yt){case j:return function(){return new ne(this,yt)};case G:return function(){return new ne(this,yt)};case K:return function(){return new ne(this,yt)}}return function(){return new ne(this)}},se=ue+" Iterator",Be=!1,Ve=re.prototype,Je=Ve[$]||Ve["@@iterator"]||xe&&Ve[xe],ut=!B&&Je||Fe(xe),ht=ue=="Array"&&Ve.entries||Je,Et,Qt,Nt;if(ht&&(Et=d(ht.call(new re)),z!==Object.prototype&&Et.next&&(!P&&d(Et)!==z&&(o?o(Et,z):typeof Et[$]!="function"&&x(Et,$,X)),g(Et,se,!0,!0),P&&(I[se]=X))),xe==G&&Je&&Je.name!==G&&(Be=!0,ut=function(){return Je.call(this)}),(!P||Ie)&&Ve[$]!==ut&&x(Ve,$,ut),I[ue]=ut,xe)if(Qt={values:Fe(G),keys:ke?ut:Fe(j),entries:Fe(K)},Ie)for(Nt in Qt)(B||Be||!(Nt in Ve))&&E(Ve,Nt,Qt[Nt]);else s({target:ue,proto:!0,forced:B||Be},Qt);return Qt}},"7f9a":function(e,r,n){var s=n("da84"),u=n("8925"),d=s.WeakMap;e.exports=typeof d=="function"&&/native code/.test(u(d))},"825a":function(e,r,n){var s=n("861d");e.exports=function(u){if(!s(u))throw TypeError(String(u)+" is not an object");return u}},"82c3":function(e,r,n){var s=n("b64b");typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var u=n("499e").default;u("3be4f088",s,!0,{sourceMap:!1,shadowMode:!1})},"83ab":function(e,r,n){var s=n("d039");e.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(e,r,n){var s=n("c04e"),u=n("9bf2"),d=n("5c6c");e.exports=function(o,g,x){var E=s(g);E in o?u.f(o,E,d(0,x)):o[E]=x}},"861d":function(e,r){e.exports=function(n){return typeof n=="object"?n!==null:typeof n=="function"}},8875:function(e,r,n){var s,u,d;(function(o,g){u=[],s=g,d=typeof s=="function"?s.apply(r,u):s,d!==void 0&&(e.exports=d)})(typeof self!="undefined"?self:this,function(){function o(){var g=Object.getOwnPropertyDescriptor(document,"currentScript");if(!g&&"currentScript"in document&&document.currentScript||g&&g.get!==o&&document.currentScript)return document.currentScript;try{throw new Error}catch(K){var x=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,E=/@([^@]*):(\d+):(\d+)\s*$/ig,S=x.exec(K.stack)||E.exec(K.stack),P=S&&S[1]||!1,I=S&&S[2]||!1,R=document.location.href.replace(document.location.hash,""),z,B,$,j=document.getElementsByTagName("script");P===R&&(z=document.documentElement.outerHTML,B=new RegExp("(?:[^\\n]+?\\n){0,"+(I-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),$=z.replace(B,"$1").trim());for(var G=0;G<j.length;G++)if(j[G].readyState==="interactive"||j[G].src===P||P===R&&j[G].innerHTML&&j[G].innerHTML.trim()===$)return j[G];return null}}return o})},8925:function(e,r,n){var s=n("c6cd"),u=Function.toString;typeof s.inspectSource!="function"&&(s.inspectSource=function(d){return u.call(d)}),e.exports=s.inspectSource},"8bbf":function(e,r){e.exports=AV},"90e3":function(e,r){var n=0,s=Math.random();e.exports=function(u){return"Symbol("+String(u===void 0?"":u)+")_"+(++n+s).toString(36)}},9112:function(e,r,n){var s=n("83ab"),u=n("9bf2"),d=n("5c6c");e.exports=s?function(o,g,x){return u.f(o,g,d(1,x))}:function(o,g,x){return o[g]=x,o}},"94ca":function(e,r,n){var s=n("d039"),u=/#|\.prototype\./,d=function(S,P){var I=g[o(S)];return I==E?!0:I==x?!1:typeof P=="function"?s(P):!!P},o=d.normalize=function(S){return String(S).replace(u,".").toLowerCase()},g=d.data={},x=d.NATIVE="N",E=d.POLYFILL="P";e.exports=d},"96b9":function(e,r,n){var s=n("ebc5");typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var u=n("499e").default;u("eaef6ce2",s,!0,{sourceMap:!1,shadowMode:!1})},"9bdd":function(e,r,n){var s=n("825a");e.exports=function(u,d,o,g){try{return g?d(s(o)[0],o[1]):d(o)}catch(E){var x=u.return;throw x!==void 0&&s(x.call(u)),E}}},"9bf2":function(e,r,n){var s=n("83ab"),u=n("0cfb"),d=n("825a"),o=n("c04e"),g=Object.defineProperty;r.f=s?g:function(E,S,P){if(d(E),S=o(S,!0),d(P),u)try{return g(E,S,P)}catch{}if("get"in P||"set"in P)throw TypeError("Accessors not supported");return"value"in P&&(E[S]=P.value),E}},"9ed3":function(e,r,n){var s=n("ae93").IteratorPrototype,u=n("7c73"),d=n("5c6c"),o=n("d44e"),g=n("3f8c"),x=function(){return this};e.exports=function(E,S,P){var I=S+" Iterator";return E.prototype=u(s,{next:d(1,P)}),o(E,I,!1,!0),g[I]=x,E}},a232:function(e,r,n){n("96b9")},a4d3:function(e,r,n){var s=n("23e7"),u=n("da84"),d=n("d066"),o=n("c430"),g=n("83ab"),x=n("4930"),E=n("fdbf"),S=n("d039"),P=n("5135"),I=n("e8b5"),R=n("861d"),z=n("825a"),B=n("7b0b"),$=n("fc6a"),j=n("c04e"),G=n("5c6c"),K=n("7c73"),X=n("df75"),re=n("241c"),ue=n("057f"),ne=n("7418"),we=n("06cf"),xe=n("9bf2"),ke=n("d1e7"),Ie=n("9112"),Fe=n("6eeb"),se=n("5692"),Be=n("f772"),Ve=n("d012"),Je=n("90e3"),ut=n("b622"),ht=n("e538"),Et=n("746f"),Qt=n("d44e"),Nt=n("69f3"),yt=n("b727").forEach,et=Be("hidden"),Ne="Symbol",tt="prototype",ft=ut("toPrimitive"),mt=Nt.set,Ht=Nt.getterFor(Ne),Zt=Object[tt],Lt=u.Symbol,ye=d("JSON","stringify"),Me=we.f,$e=xe.f,it=ue.f,ot=ke.f,st=se("symbols"),gt=se("op-symbols"),lt=se("string-to-symbol-registry"),Ye=se("symbol-to-string-registry"),pt=se("wks"),Tt=u.QObject,St=!Tt||!Tt[tt]||!Tt[tt].findChild,zt=g&&S(function(){return K($e({},"a",{get:function(){return $e(this,"a",{value:7}).a}})).a!=7})?function(or,Gt,rr){var Sr=Me(Zt,Gt);Sr&&delete Zt[Gt],$e(or,Gt,rr),Sr&&or!==Zt&&$e(Zt,Gt,Sr)}:$e,Yt=function(or,Gt){var rr=st[or]=K(Lt[tt]);return mt(rr,{type:Ne,tag:or,description:Gt}),g||(rr.description=Gt),rr},ur=E?function(or){return typeof or=="symbol"}:function(or){return Object(or)instanceof Lt},xr=function(Gt,rr,Sr){Gt===Zt&&xr(gt,rr,Sr),z(Gt);var zr=j(rr,!0);return z(Sr),P(st,zr)?(Sr.enumerable?(P(Gt,et)&&Gt[et][zr]&&(Gt[et][zr]=!1),Sr=K(Sr,{enumerable:G(0,!1)})):(P(Gt,et)||$e(Gt,et,G(1,{})),Gt[et][zr]=!0),zt(Gt,zr,Sr)):$e(Gt,zr,Sr)},fr=function(Gt,rr){z(Gt);var Sr=$(rr),zr=X(Sr).concat(ui(Sr));return yt(zr,function(Ii){(!g||Qr.call(Sr,Ii))&&xr(Gt,Ii,Sr[Ii])}),Gt},br=function(Gt,rr){return rr===void 0?K(Gt):fr(K(Gt),rr)},Qr=function(Gt){var rr=j(Gt,!0),Sr=ot.call(this,rr);return this===Zt&&P(st,rr)&&!P(gt,rr)?!1:Sr||!P(this,rr)||!P(st,rr)||P(this,et)&&this[et][rr]?Sr:!0},Wi=function(Gt,rr){var Sr=$(Gt),zr=j(rr,!0);if(!(Sr===Zt&&P(st,zr)&&!P(gt,zr))){var Ii=Me(Sr,zr);return Ii&&P(st,zr)&&!(P(Sr,et)&&Sr[et][zr])&&(Ii.enumerable=!0),Ii}},Ei=function(Gt){var rr=it($(Gt)),Sr=[];return yt(rr,function(zr){!P(st,zr)&&!P(Ve,zr)&&Sr.push(zr)}),Sr},ui=function(Gt){var rr=Gt===Zt,Sr=it(rr?gt:$(Gt)),zr=[];return yt(Sr,function(Ii){P(st,Ii)&&(!rr||P(Zt,Ii))&&zr.push(st[Ii])}),zr};if(x||(Lt=function(){if(this instanceof Lt)throw TypeError("Symbol is not a constructor");var Gt=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),rr=Je(Gt),Sr=function(zr){this===Zt&&Sr.call(gt,zr),P(this,et)&&P(this[et],rr)&&(this[et][rr]=!1),zt(this,rr,G(1,zr))};return g&&St&&zt(Zt,rr,{configurable:!0,set:Sr}),Yt(rr,Gt)},Fe(Lt[tt],"toString",function(){return Ht(this).tag}),Fe(Lt,"withoutSetter",function(or){return Yt(Je(or),or)}),ke.f=Qr,xe.f=xr,we.f=Wi,re.f=ue.f=Ei,ne.f=ui,ht.f=function(or){return Yt(ut(or),or)},g&&($e(Lt[tt],"description",{configurable:!0,get:function(){return Ht(this).description}}),o||Fe(Zt,"propertyIsEnumerable",Qr,{unsafe:!0}))),s({global:!0,wrap:!0,forced:!x,sham:!x},{Symbol:Lt}),yt(X(pt),function(or){Et(or)}),s({target:Ne,stat:!0,forced:!x},{for:function(or){var Gt=String(or);if(P(lt,Gt))return lt[Gt];var rr=Lt(Gt);return lt[Gt]=rr,Ye[rr]=Gt,rr},keyFor:function(Gt){if(!ur(Gt))throw TypeError(Gt+" is not a symbol");if(P(Ye,Gt))return Ye[Gt]},useSetter:function(){St=!0},useSimple:function(){St=!1}}),s({target:"Object",stat:!0,forced:!x,sham:!g},{create:br,defineProperty:xr,defineProperties:fr,getOwnPropertyDescriptor:Wi}),s({target:"Object",stat:!0,forced:!x},{getOwnPropertyNames:Ei,getOwnPropertySymbols:ui}),s({target:"Object",stat:!0,forced:S(function(){ne.f(1)})},{getOwnPropertySymbols:function(Gt){return ne.f(B(Gt))}}),ye){var Un=!x||S(function(){var or=Lt();return ye([or])!="[null]"||ye({a:or})!="{}"||ye(Object(or))!="{}"});s({target:"JSON",stat:!0,forced:Un},{stringify:function(Gt,rr,Sr){for(var zr=[Gt],Ii=1,Ks;arguments.length>Ii;)zr.push(arguments[Ii++]);if(Ks=rr,!(!R(rr)&&Gt===void 0||ur(Gt)))return I(rr)||(rr=function(Gn,rn){if(typeof Ks=="function"&&(rn=Ks.call(this,Gn,rn)),!ur(rn))return rn}),zr[1]=rr,ye.apply(null,zr)}})}Lt[tt][ft]||Ie(Lt[tt],ft,Lt[tt].valueOf),Qt(Lt,Ne),Ve[et]=!0},a630:function(e,r,n){var s=n("23e7"),u=n("4df4"),d=n("1c7e"),o=!d(function(g){Array.from(g)});s({target:"Array",stat:!0,forced:o},{from:u})},a640:function(e,r,n){var s=n("d039");e.exports=function(u,d){var o=[][u];return!!o&&s(function(){o.call(null,d||function(){throw 1},1)})}},a691:function(e,r){var n=Math.ceil,s=Math.floor;e.exports=function(u){return isNaN(u=+u)?0:(u>0?s:n)(u)}},a9e3:function(e,r,n){var s=n("83ab"),u=n("da84"),d=n("94ca"),o=n("6eeb"),g=n("5135"),x=n("c6b6"),E=n("7156"),S=n("c04e"),P=n("d039"),I=n("7c73"),R=n("241c").f,z=n("06cf").f,B=n("9bf2").f,$=n("58a8").trim,j="Number",G=u[j],K=G.prototype,X=x(I(K))==j,re=function(ke){var Ie=S(ke,!1),Fe,se,Be,Ve,Je,ut,ht,Et;if(typeof Ie=="string"&&Ie.length>2){if(Ie=$(Ie),Fe=Ie.charCodeAt(0),Fe===43||Fe===45){if(se=Ie.charCodeAt(2),se===88||se===120)return NaN}else if(Fe===48){switch(Ie.charCodeAt(1)){case 66:case 98:Be=2,Ve=49;break;case 79:case 111:Be=8,Ve=55;break;default:return+Ie}for(Je=Ie.slice(2),ut=Je.length,ht=0;ht<ut;ht++)if(Et=Je.charCodeAt(ht),Et<48||Et>Ve)return NaN;return parseInt(Je,Be)}}return+Ie};if(d(j,!G(" 0o1")||!G("0b1")||G("+0x1"))){for(var ue=function(Ie){var Fe=arguments.length<1?0:Ie,se=this;return se instanceof ue&&(X?P(function(){K.valueOf.call(se)}):x(se)!=j)?E(new G(re(Fe)),se,ue):re(Fe)},ne=s?R(G):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),we=0,xe;ne.length>we;we++)g(G,xe=ne[we])&&!g(ue,xe)&&B(ue,xe,z(G,xe));ue.prototype=K,K.constructor=ue,o(u,j,ue)}},ab13:function(e,r,n){var s=n("b622"),u=s("match");e.exports=function(d){var o=/./;try{"/./"[d](o)}catch{try{return o[u]=!1,"/./"[d](o)}catch{}}return!1}},abfb:function(e,r,n){var s=n("24fb");r=s(!1),r.push([e.i,".tab-panels[data-v-41b04636]{white-space:nowrap;overflow:hidden}.hide-scrollbar[data-v-41b04636]::-webkit-scrollbar{display:none}.hide-scrollbar[data-v-41b04636]{-ms-overflow-style:none;scrollbar-width:none}",""]),e.exports=r},ad6d:function(e,r,n){var s=n("825a");e.exports=function(){var u=s(this),d="";return u.global&&(d+="g"),u.ignoreCase&&(d+="i"),u.multiline&&(d+="m"),u.dotAll&&(d+="s"),u.unicode&&(d+="u"),u.sticky&&(d+="y"),d}},ae40:function(e,r,n){var s=n("83ab"),u=n("d039"),d=n("5135"),o=Object.defineProperty,g={},x=function(E){throw E};e.exports=function(E,S){if(d(g,E))return g[E];S||(S={});var P=[][E],I=d(S,"ACCESSORS")?S.ACCESSORS:!1,R=d(S,0)?S[0]:x,z=d(S,1)?S[1]:void 0;return g[E]=!!P&&!u(function(){if(I&&!s)return!0;var B={length:-1};I?o(B,1,{enumerable:!0,get:x}):B[1]=1,P.call(B,R,z)})}},ae93:function(e,r,n){var s=n("e163"),u=n("9112"),d=n("5135"),o=n("b622"),g=n("c430"),x=o("iterator"),E=!1,S=function(){return this},P,I,R;[].keys&&(R=[].keys(),"next"in R?(I=s(s(R)),I!==Object.prototype&&(P=I)):E=!0),P==null&&(P={}),!g&&!d(P,x)&&u(P,x,S),e.exports={IteratorPrototype:P,BUGGY_SAFARI_ITERATORS:E}},b041:function(e,r,n){var s=n("00ee"),u=n("f5df");e.exports=s?{}.toString:function(){return"[object "+u(this)+"]"}},b0c0:function(e,r,n){var s=n("83ab"),u=n("9bf2").f,d=Function.prototype,o=d.toString,g=/^\s*function ([^ (]*)/,x="name";s&&!(x in d)&&u(d,x,{configurable:!0,get:function(){try{return o.call(this).match(g)[1]}catch{return""}}})},b622:function(e,r,n){var s=n("da84"),u=n("5692"),d=n("5135"),o=n("90e3"),g=n("4930"),x=n("fdbf"),E=u("wks"),S=s.Symbol,P=x?S:S&&S.withoutSetter||o;e.exports=function(I){return d(E,I)||(g&&d(S,I)?E[I]=S[I]:E[I]=P("Symbol."+I)),E[I]}},b64b:function(e,r,n){var s=n("24fb");r=s(!1),r.push([e.i,".tabs[data-v-221ca9e4]{display:flex;flex-wrap:wrap}",""]),e.exports=r},b64b6:function(e,r,n){var s=n("23e7"),u=n("7b0b"),d=n("df75"),o=n("d039"),g=o(function(){d(1)});s({target:"Object",stat:!0,forced:g},{keys:function(E){return d(u(E))}})},b727:function(e,r,n){var s=n("0366"),u=n("44ad"),d=n("7b0b"),o=n("50c4"),g=n("65f0"),x=[].push,E=function(S){var P=S==1,I=S==2,R=S==3,z=S==4,B=S==6,$=S==5||B;return function(j,G,K,X){for(var re=d(j),ue=u(re),ne=s(G,K,3),we=o(ue.length),xe=0,ke=X||g,Ie=P?ke(j,we):I?ke(j,0):void 0,Fe,se;we>xe;xe++)if(($||xe in ue)&&(Fe=ue[xe],se=ne(Fe,xe,re),S)){if(P)Ie[xe]=se;else if(se)switch(S){case 3:return!0;case 5:return Fe;case 6:return xe;case 2:x.call(Ie,Fe)}else if(z)return!1}return B?-1:R||z?z:Ie}};e.exports={forEach:E(0),map:E(1),filter:E(2),some:E(3),every:E(4),find:E(5),findIndex:E(6)}},c04e:function(e,r,n){var s=n("861d");e.exports=function(u,d){if(!s(u))return u;var o,g;if(d&&typeof(o=u.toString)=="function"&&!s(g=o.call(u))||typeof(o=u.valueOf)=="function"&&!s(g=o.call(u))||!d&&typeof(o=u.toString)=="function"&&!s(g=o.call(u)))return g;throw TypeError("Can't convert object to primitive value")}},c430:function(e,r){e.exports=!1},c6b6:function(e,r){var n={}.toString;e.exports=function(s){return n.call(s).slice(8,-1)}},c6cd:function(e,r,n){var s=n("da84"),u=n("ce4e"),d="__core-js_shared__",o=s[d]||u(d,{});e.exports=o},c740:function(e,r,n){var s=n("23e7"),u=n("b727").findIndex,d=n("44d2"),o=n("ae40"),g="findIndex",x=!0,E=o(g);g in[]&&Array(1)[g](function(){x=!1}),s({target:"Array",proto:!0,forced:x||!E},{findIndex:function(P){return u(this,P,arguments.length>1?arguments[1]:void 0)}}),d(g)},c8ba:function(e,r){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch{typeof window=="object"&&(n=window)}e.exports=n},ca84:function(e,r,n){var s=n("5135"),u=n("fc6a"),d=n("4d64").indexOf,o=n("d012");e.exports=function(g,x){var E=u(g),S=0,P=[],I;for(I in E)!s(o,I)&&s(E,I)&&P.push(I);for(;x.length>S;)s(E,I=x[S++])&&(~d(P,I)||P.push(I));return P}},caad:function(e,r,n){var s=n("23e7"),u=n("4d64").includes,d=n("44d2"),o=n("ae40"),g=o("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:!g},{includes:function(E){return u(this,E,arguments.length>1?arguments[1]:void 0)}}),d("includes")},cc12:function(e,r,n){var s=n("da84"),u=n("861d"),d=s.document,o=u(d)&&u(d.createElement);e.exports=function(g){return o?d.createElement(g):{}}},ce4e:function(e,r,n){var s=n("da84"),u=n("9112");e.exports=function(d,o){try{u(s,d,o)}catch{s[d]=o}return o}},cfa2:function(e,r,n){var s=n("abfb");typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var u=n("499e").default;u("b7131092",s,!0,{sourceMap:!1,shadowMode:!1})},d012:function(e,r){e.exports={}},d039:function(e,r){e.exports=function(n){try{return!!n()}catch{return!0}}},d066:function(e,r,n){var s=n("428f"),u=n("da84"),d=function(o){return typeof o=="function"?o:void 0};e.exports=function(o,g){return arguments.length<2?d(s[o])||d(u[o]):s[o]&&s[o][g]||u[o]&&u[o][g]}},d1e7:function(e,r,n){var s={}.propertyIsEnumerable,u=Object.getOwnPropertyDescriptor,d=u&&!s.call({1:2},1);r.f=d?function(g){var x=u(this,g);return!!x&&x.enumerable}:s},d28b:function(e,r,n){var s=n("746f");s("iterator")},d2bb:function(e,r,n){var s=n("825a"),u=n("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var d=!1,o={},g;try{g=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,g.call(o,[]),d=o instanceof Array}catch{}return function(E,S){return s(E),u(S),d?g.call(E,S):E.__proto__=S,E}}():void 0)},d3b7:function(e,r,n){var s=n("00ee"),u=n("6eeb"),d=n("b041");s||u(Object.prototype,"toString",d,{unsafe:!0})},d44e:function(e,r,n){var s=n("9bf2").f,u=n("5135"),d=n("b622"),o=d("toStringTag");e.exports=function(g,x,E){g&&!u(g=E?g:g.prototype,o)&&s(g,o,{configurable:!0,value:x})}},d81d:function(e,r,n){var s=n("23e7"),u=n("b727").map,d=n("1dde"),o=n("ae40"),g=d("map"),x=o("map");s({target:"Array",proto:!0,forced:!g||!x},{map:function(S){return u(this,S,arguments.length>1?arguments[1]:void 0)}})},da84:function(e,r,n){(function(s){var u=function(d){return d&&d.Math==Math&&d};e.exports=u(typeof globalThis=="object"&&globalThis)||u(typeof window=="object"&&window)||u(typeof self=="object"&&self)||u(typeof s=="object"&&s)||Function("return this")()}).call(this,n("c8ba"))},dbb4:function(e,r,n){var s=n("23e7"),u=n("83ab"),d=n("56ef"),o=n("fc6a"),g=n("06cf"),x=n("8418");s({target:"Object",stat:!0,sham:!u},{getOwnPropertyDescriptors:function(S){for(var P=o(S),I=g.f,R=d(P),z={},B=0,$,j;R.length>B;)j=I(P,$=R[B++]),j!==void 0&&x(z,$,j);return z}})},ddb0:function(e,r,n){var s=n("da84"),u=n("fdbc"),d=n("e260"),o=n("9112"),g=n("b622"),x=g("iterator"),E=g("toStringTag"),S=d.values;for(var P in u){var I=s[P],R=I&&I.prototype;if(R){if(R[x]!==S)try{o(R,x,S)}catch{R[x]=S}if(R[E]||o(R,E,P),u[P]){for(var z in d)if(R[z]!==d[z])try{o(R,z,d[z])}catch{R[z]=d[z]}}}}},df75:function(e,r,n){var s=n("ca84"),u=n("7839");e.exports=Object.keys||function(o){return s(o,u)}},e01a:function(e,r,n){var s=n("23e7"),u=n("83ab"),d=n("da84"),o=n("5135"),g=n("861d"),x=n("9bf2").f,E=n("e893"),S=d.Symbol;if(u&&typeof S=="function"&&(!("description"in S.prototype)||S().description!==void 0)){var P={},I=function(){var G=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),K=this instanceof I?new S(G):G===void 0?S():S(G);return G===""&&(P[K]=!0),K};E(I,S);var R=I.prototype=S.prototype;R.constructor=I;var z=R.toString,B=String(S("test"))=="Symbol(test)",$=/^Symbol\((.*)\)[^)]+$/;x(R,"description",{configurable:!0,get:function(){var G=g(this)?this.valueOf():this,K=z.call(G);if(o(P,G))return"";var X=B?K.slice(7,-1):K.replace($,"$1");return X===""?void 0:X}}),s({global:!0,forced:!0},{Symbol:I})}},e163:function(e,r,n){var s=n("5135"),u=n("7b0b"),d=n("f772"),o=n("e177"),g=d("IE_PROTO"),x=Object.prototype;e.exports=o?Object.getPrototypeOf:function(E){return E=u(E),s(E,g)?E[g]:typeof E.constructor=="function"&&E instanceof E.constructor?E.constructor.prototype:E instanceof Object?x:null}},e177:function(e,r,n){var s=n("d039");e.exports=!s(function(){function u(){}return u.prototype.constructor=null,Object.getPrototypeOf(new u)!==u.prototype})},e260:function(e,r,n){var s=n("fc6a"),u=n("44d2"),d=n("3f8c"),o=n("69f3"),g=n("7dd0"),x="Array Iterator",E=o.set,S=o.getterFor(x);e.exports=g(Array,"Array",function(P,I){E(this,{type:x,target:s(P),index:0,kind:I})},function(){var P=S(this),I=P.target,R=P.kind,z=P.index++;return!I||z>=I.length?(P.target=void 0,{value:void 0,done:!0}):R=="keys"?{value:z,done:!1}:R=="values"?{value:I[z],done:!1}:{value:[z,I[z]],done:!1}},"values"),d.Arguments=d.Array,u("keys"),u("values"),u("entries")},e439:function(e,r,n){var s=n("23e7"),u=n("d039"),d=n("fc6a"),o=n("06cf").f,g=n("83ab"),x=u(function(){o(1)}),E=!g||x;s({target:"Object",stat:!0,forced:E,sham:!g},{getOwnPropertyDescriptor:function(P,I){return o(d(P),I)}})},e538:function(e,r,n){var s=n("b622");r.f=s},e893:function(e,r,n){var s=n("5135"),u=n("56ef"),d=n("06cf"),o=n("9bf2");e.exports=function(g,x){for(var E=u(x),S=o.f,P=d.f,I=0;I<E.length;I++){var R=E[I];s(g,R)||S(g,R,P(x,R))}}},e8b5:function(e,r,n){var s=n("c6b6");e.exports=Array.isArray||function(d){return s(d)=="Array"}},e95a:function(e,r,n){var s=n("b622"),u=n("3f8c"),d=s("iterator"),o=Array.prototype;e.exports=function(g){return g!==void 0&&(u.Array===g||o[d]===g)}},ebc5:function(e,r,n){var s=n("24fb");r=s(!1),r.push([e.i,".tab-panel[data-v-ac96bb56]{width:100%;display:inline-block;white-space:normal;vertical-align:top}",""]),e.exports=r},f5df:function(e,r,n){var s=n("00ee"),u=n("c6b6"),d=n("b622"),o=d("toStringTag"),g=u(function(){return arguments}())=="Arguments",x=function(E,S){try{return E[S]}catch{}};e.exports=s?u:function(E){var S,P,I;return E===void 0?"Undefined":E===null?"Null":typeof(P=x(S=Object(E),o))=="string"?P:g?u(S):(I=u(S))=="Object"&&typeof S.callee=="function"?"Arguments":I}},f772:function(e,r,n){var s=n("5692"),u=n("90e3"),d=s("keys");e.exports=function(o){return d[o]||(d[o]=u(o))}},fb15:function(e,r,n){if(n.r(r),n.d(r,"Tabs",function(){return P}),n.d(r,"Tab",function(){return K}),n.d(r,"TabPanels",function(){return Et}),n.d(r,"TabPanel",function(){return we}),typeof window!="undefined"){var s=window.document.currentScript;{var u=n("8875");s=u(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:u})}var d=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);d&&(n.p=d[1])}var o=n("8bbf"),g=Object(o.withScopeId)("data-v-221ca9e4");Object(o.pushScopeId)("data-v-221ca9e4");var x={class:"tabs"};Object(o.popScopeId)();var E=g(function(et,Ne,tt,ft,mt,Ht){return Object(o.openBlock)(),Object(o.createBlock)("div",x,[Object(o.renderSlot)(et.$slots,"default")])});n("a9e3");var S=Object(o.defineComponent)({name:"Tabs",props:{modelValue:{default:null,type:[String,Number]}},emits:["update:modelValue"],setup:function(et,Ne){var tt=Ne.emit,ft=Object(o.reactive)({active:Object(o.computed)(function(){return et.modelValue})});Object(o.provide)("tabs",{state:ft,activateTab:mt});function mt(Ht){tt("update:modelValue",Ht)}}});n("04de"),S.render=E,S.__scopeId="data-v-221ca9e4";var P=S,I=Object(o.withScopeId)("data-v-90ee39a8");Object(o.pushScopeId)("data-v-90ee39a8");var R={class:"tab"};Object(o.popScopeId)();var z=I(function(et,Ne,tt,ft,mt,Ht){return Object(o.openBlock)(),Object(o.createBlock)("div",{class:{active:et.isActive&&et.indicator},onClick:Ne[1]||(Ne[1]=function(){return et.onClickTab.apply(et,arguments)})},[Object(o.renderSlot)(et.$slots,"default",{},function(){return[Object(o.createVNode)("div",R,Object(o.toDisplayString)(et.label),1)]})],2)});n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b6"),n("159b");function B(yt,et,Ne){return et in yt?Object.defineProperty(yt,et,{value:Ne,enumerable:!0,configurable:!0,writable:!0}):yt[et]=Ne,yt}function $(yt,et){var Ne=Object.keys(yt);if(Object.getOwnPropertySymbols){var tt=Object.getOwnPropertySymbols(yt);et&&(tt=tt.filter(function(ft){return Object.getOwnPropertyDescriptor(yt,ft).enumerable})),Ne.push.apply(Ne,tt)}return Ne}function j(yt){for(var et=1;et<arguments.length;et++){var Ne=arguments[et]!=null?arguments[et]:{};et%2?$(Object(Ne),!0).forEach(function(tt){B(yt,tt,Ne[tt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(yt,Object.getOwnPropertyDescriptors(Ne)):$(Object(Ne)).forEach(function(tt){Object.defineProperty(yt,tt,Object.getOwnPropertyDescriptor(Ne,tt))})}return yt}var G=Object(o.defineComponent)({name:"Tab",props:{val:{default:null,type:[String,Number]},label:{default:null,type:String},indicator:{default:!1,type:Boolean}},setup:function(et){var Ne=Object(o.inject)("tabs",{state:Object(o.reactive)({active:null}),activateTab:function(){}}),tt=Object(o.reactive)({isActive:Object(o.computed)(function(){return Ne.state.active===et.val})});function ft(){Ne.activateTab(et.val)}return j(j({},Object(o.toRefs)(tt)),{},{tabs:Ne,onClickTab:ft})}});n("ffa6"),G.render=z,G.__scopeId="data-v-90ee39a8";var K=G,X=Object(o.withScopeId)("data-v-ac96bb56");Object(o.pushScopeId)("data-v-ac96bb56");var re={class:"tab-panel"};Object(o.popScopeId)();var ue=X(function(et,Ne,tt,ft,mt,Ht){return Object(o.openBlock)(),Object(o.createBlock)("div",re,[Object(o.renderSlot)(et.$slots,"default")])}),ne=Object(o.defineComponent)({name:"TabPanel"});n("a232"),ne.render=ue,ne.__scopeId="data-v-ac96bb56";var we=ne,xe=Object(o.withScopeId)("data-v-41b04636"),ke=xe(function(et,Ne,tt,ft,mt,Ht){return Object(o.openBlock)(),Object(o.createBlock)("div",{class:"tab-panels hide-scrollbar",onMousedown:Ne[1]||(Ne[1]=function(){return et.onMoveStart.apply(et,arguments)}),onMouseup:Ne[2]||(Ne[2]=function(){return et.onMoveEnd.apply(et,arguments)}),onMouseleave:Ne[3]||(Ne[3]=function(){return et.onMoveEnd.apply(et,arguments)}),onTouchstart:Ne[4]||(Ne[4]=function(){return et.onMoveStart.apply(et,arguments)}),onTouchend:Ne[5]||(Ne[5]=function(){return et.onMoveEnd.apply(et,arguments)}),ref:"tabPanelsRef",key:et.modelValue},[Object(o.renderSlot)(et.$slots,"default")],544)});n("7db0"),n("c740"),n("caad"),n("d81d"),n("b0c0"),n("2532");function Ie(yt,et){(et==null||et>yt.length)&&(et=yt.length);for(var Ne=0,tt=new Array(et);Ne<et;Ne++)tt[Ne]=yt[Ne];return tt}function Fe(yt){if(Array.isArray(yt))return Ie(yt)}n("e01a"),n("d28b"),n("a630"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");function se(yt){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(yt))return Array.from(yt)}n("fb6a"),n("25f0");function Be(yt,et){if(!!yt){if(typeof yt=="string")return Ie(yt,et);var Ne=Object.prototype.toString.call(yt).slice(8,-1);if(Ne==="Object"&&yt.constructor&&(Ne=yt.constructor.name),Ne==="Map"||Ne==="Set")return Array.from(yt);if(Ne==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ne))return Ie(yt,et)}}function Ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Je(yt){return Fe(yt)||se(yt)||Be(yt)||Ve()}function ut(yt){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:50,Ne=null;return function(){clearTimeout(Ne),Ne=setTimeout(function(){yt()},et)}}var ht=Object(o.defineComponent)({name:"TabPanels",props:{modelValue:{default:null,type:[String,Number]},animate:{default:!1,type:Boolean},swipeable:{default:!1,type:Boolean},threshold:{default:50,type:Number},responsive:{default:!0,type:Boolean}},emits:["update:modelValue","on-animation-end"],setup:function(et,Ne){var tt=Ne.emit,ft=Ne.slots,mt=Object(o.reactive)({tabPanelsRef:null,start:!1,startPosition:{x:0,y:0},tabPanelOptions:[],previousModelValue:void 0});Object(o.onMounted)(function(){ye(),Lt(et.modelValue),et.responsive&&window.addEventListener("resize",Ht)}),Object(o.onUnmounted)(function(){et.responsive&&window.removeEventListener("resize",Ht)}),Object(o.onUpdated)(function(){ye(),Lt(et.modelValue)}),Object(o.watch)(function(){return et.modelValue},function(st,gt){mt.previousModelValue=gt,Lt(st)},{immediate:!0});var Ht=ut(function(){ye(),Lt(et.modelValue,!1)},10);function Zt(st,gt,lt){!!st&&Math.abs(st.scrollLeft-gt)>5?window.requestAnimationFrame(function(){return Zt(st,gt,lt)}):lt()}function Lt(st){var gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,lt=mt.tabPanelOptions.findIndex(function(Tt){return Tt.value===st}),Ye=mt.tabPanelOptions[lt];if(Ye&&mt.tabPanelsRef){if(mt.previousModelValue!==void 0){var pt=mt.tabPanelOptions.find(function(Tt){return Tt.value===mt.previousModelValue});pt&&mt.tabPanelsRef.scrollTo({left:pt.left})}mt.tabPanelsRef.scrollTo({left:Ye.left,behavior:et.animate&&gt?"smooth":void 0}),window.requestAnimationFrame(function(){return Zt(mt.tabPanelsRef,Ye.left,function(){var Tt,St=((Tt=mt.tabPanelsRef)===null||Tt===void 0?void 0:Tt.children)||[],zt=Je(St).filter(function(Yt,ur){return ur!==lt});zt.forEach(function(Yt){Yt.remove()}),tt("on-animation-end",st)})})}}function ye(){if(ft.default&&mt.tabPanelsRef){var st,gt,lt,Ye=[],pt=ft.default()||[];((st=pt[0])===null||st===void 0||(gt=st.type)===null||gt===void 0?void 0:gt.name)==="TabPanel"?Ye=pt:Ye=pt[0].children;var Tt=(lt=mt.tabPanelsRef)===null||lt===void 0?void 0:lt.getBoundingClientRect(),St=(Tt==null?void 0:Tt.width)||0;mt.tabPanelOptions=Ye.map(function(zt,Yt){return{left:St*Yt,value:zt.props!=null?zt.props.val:void 0}})}}function Me(st){tt("update:modelValue",st)}function $e(st){if(st.type.includes("touch")){var gt=st.changedTouches[0];return gt?{x:gt.clientX,y:gt.clientY}:void 0}else return st.type.includes("mouse")?{x:st.clientX,y:st.clientY}:void 0}function it(st){if(et.swipeable){mt.start=!0;var gt=$e(st);if(!gt)return;mt.startPosition.x=gt.x,mt.startPosition.y=gt.y}}function ot(st){if(mt.start){mt.start=!1;var gt=$e(st);if(!gt)return;var lt=mt.tabPanelOptions.findIndex(function(St){return St.value===et.modelValue}),Ye=mt.startPosition.x-gt.x;if(Ye<-et.threshold){if(lt>0){var pt=mt.tabPanelOptions[lt-1];Me(pt.value)}}else if(Ye>et.threshold&&lt<mt.tabPanelOptions.length-1){var Tt=mt.tabPanelOptions[lt+1];Me(Tt.value)}}}return j({onMoveStart:it,onMoveEnd:ot},Object(o.toRefs)(mt))}});n("70a4"),ht.render=ke,ht.__scopeId="data-v-41b04636";var Et=ht,Qt=function(et){et.component("Tabs",P),et.component("Tab",K),et.component("TabPanels",Et),et.component("TabPanel",we)};P.install=Qt;var Nt=P;r.default=Nt},fb6a:function(e,r,n){var s=n("23e7"),u=n("861d"),d=n("e8b5"),o=n("23cb"),g=n("50c4"),x=n("fc6a"),E=n("8418"),S=n("b622"),P=n("1dde"),I=n("ae40"),R=P("slice"),z=I("slice",{ACCESSORS:!0,0:0,1:2}),B=S("species"),$=[].slice,j=Math.max;s({target:"Array",proto:!0,forced:!R||!z},{slice:function(K,X){var re=x(this),ue=g(re.length),ne=o(K,ue),we=o(X===void 0?ue:X,ue),xe,ke,Ie;if(d(re)&&(xe=re.constructor,typeof xe=="function"&&(xe===Array||d(xe.prototype))?xe=void 0:u(xe)&&(xe=xe[B],xe===null&&(xe=void 0)),xe===Array||xe===void 0))return $.call(re,ne,we);for(ke=new(xe===void 0?Array:xe)(j(we-ne,0)),Ie=0;ne<we;ne++,Ie++)ne in re&&E(ke,Ie,re[ne]);return ke.length=Ie,ke}})},fc01:function(e,r,n){var s=n("5e61");typeof s=="string"&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var u=n("499e").default;u("de719e96",s,!0,{sourceMap:!1,shadowMode:!1})},fc6a:function(e,r,n){var s=n("44ad"),u=n("1d80");e.exports=function(d){return s(u(d))}},fdbc:function(e,r){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(e,r,n){var s=n("4930");e.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},ffa6:function(e,r,n){n("fc01")}})})(rp);var Tb={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(t,e){(function(r,n){n(e)})(Jy,function(r){function n(){for(var ee=arguments.length,q=Array(ee),Y=0;Y<ee;Y++)q[Y]=arguments[Y];if(q.length>1){q[0]=q[0].slice(0,-1);for(var fe=q.length-1,Te=1;Te<fe;++Te)q[Te]=q[Te].slice(1,-1);return q[fe]=q[fe].slice(1),q.join("")}else return q[0]}function s(ee){return"(?:"+ee+")"}function u(ee){return ee===void 0?"undefined":ee===null?"null":Object.prototype.toString.call(ee).split(" ").pop().split("]").shift().toLowerCase()}function d(ee){return ee.toUpperCase()}function o(ee){return ee!=null?ee instanceof Array?ee:typeof ee.length!="number"||ee.split||ee.setInterval||ee.call?[ee]:Array.prototype.slice.call(ee):[]}function g(ee,q){var Y=ee;if(q)for(var fe in q)Y[fe]=q[fe];return Y}function x(ee){var q="[A-Za-z]",Y="[0-9]",fe=n(Y,"[A-Fa-f]"),Te=s(s("%[EFef]"+fe+"%"+fe+fe+"%"+fe+fe)+"|"+s("%[89A-Fa-f]"+fe+"%"+fe+fe)+"|"+s("%"+fe+fe)),rt="[\\:\\/\\?\\#\\[\\]\\@]",He="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",At=n(rt,He),Ft=ee?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",jt=ee?"[\\uE000-\\uF8FF]":"[]",Ot=n(q,Y,"[\\-\\.\\_\\~]",Ft);s(q+n(q,Y,"[\\+\\-\\.]")+"*"),s(s(Te+"|"+n(Ot,He,"[\\:]"))+"*");var qt=s(s("25[0-5]")+"|"+s("2[0-4]"+Y)+"|"+s("1"+Y+Y)+"|"+s("0?[1-9]"+Y)+"|0?0?"+Y),lr=s(qt+"\\."+qt+"\\."+qt+"\\."+qt),Wt=s(fe+"{1,4}"),ar=s(s(Wt+"\\:"+Wt)+"|"+lr),ze=s(s(Wt+"\\:")+"{6}"+ar),Ir=s("\\:\\:"+s(Wt+"\\:")+"{5}"+ar),jr=s(s(Wt)+"?\\:\\:"+s(Wt+"\\:")+"{4}"+ar),gi=s(s(s(Wt+"\\:")+"{0,1}"+Wt)+"?\\:\\:"+s(Wt+"\\:")+"{3}"+ar),Hn=s(s(s(Wt+"\\:")+"{0,2}"+Wt)+"?\\:\\:"+s(Wt+"\\:")+"{2}"+ar),ki=s(s(s(Wt+"\\:")+"{0,3}"+Wt)+"?\\:\\:"+Wt+"\\:"+ar),Wn=s(s(s(Wt+"\\:")+"{0,4}"+Wt)+"?\\:\\:"+ar),hn=s(s(s(Wt+"\\:")+"{0,5}"+Wt)+"?\\:\\:"+Wt),nn=s(s(s(Wt+"\\:")+"{0,6}"+Wt)+"?\\:\\:"),Dt=s([ze,Ir,jr,gi,Hn,ki,Wn,hn,nn].join("|")),pr=s(s(Ot+"|"+Te)+"+");s("[vV]"+fe+"+\\."+n(Ot,He,"[\\:]")+"+"),s(s(Te+"|"+n(Ot,He))+"*");var dr=s(Te+"|"+n(Ot,He,"[\\:\\@]"));return s(s(Te+"|"+n(Ot,He,"[\\@]"))+"+"),s(s(dr+"|"+n("[\\/\\?]",jt))+"*"),{NOT_SCHEME:new RegExp(n("[^]",q,Y,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(n("[^\\%\\:]",Ot,He),"g"),NOT_HOST:new RegExp(n("[^\\%\\[\\]\\:]",Ot,He),"g"),NOT_PATH:new RegExp(n("[^\\%\\/\\:\\@]",Ot,He),"g"),NOT_PATH_NOSCHEME:new RegExp(n("[^\\%\\/\\@]",Ot,He),"g"),NOT_QUERY:new RegExp(n("[^\\%]",Ot,He,"[\\:\\@\\/\\?]",jt),"g"),NOT_FRAGMENT:new RegExp(n("[^\\%]",Ot,He,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(n("[^]",Ot,He),"g"),UNRESERVED:new RegExp(Ot,"g"),OTHER_CHARS:new RegExp(n("[^\\%]",Ot,At),"g"),PCT_ENCODED:new RegExp(Te,"g"),IPV4ADDRESS:new RegExp("^("+lr+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Dt+")"+s(s("\\%25|\\%(?!"+fe+"{2})")+"("+pr+")")+"?\\]?$")}}var E=x(!1),S=x(!0),P=function(){function ee(q,Y){var fe=[],Te=!0,rt=!1,He=void 0;try{for(var At=q[Symbol.iterator](),Ft;!(Te=(Ft=At.next()).done)&&(fe.push(Ft.value),!(Y&&fe.length===Y));Te=!0);}catch(jt){rt=!0,He=jt}finally{try{!Te&&At.return&&At.return()}finally{if(rt)throw He}}return fe}return function(q,Y){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return ee(q,Y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),I=function(ee){if(Array.isArray(ee)){for(var q=0,Y=Array(ee.length);q<ee.length;q++)Y[q]=ee[q];return Y}else return Array.from(ee)},R=2147483647,z=36,B=1,$=26,j=38,G=700,K=72,X=128,re="-",ue=/^xn--/,ne=/[^\0-\x7E]/,we=/[\x2E\u3002\uFF0E\uFF61]/g,xe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ke=z-B,Ie=Math.floor,Fe=String.fromCharCode;function se(ee){throw new RangeError(xe[ee])}function Be(ee,q){for(var Y=[],fe=ee.length;fe--;)Y[fe]=q(ee[fe]);return Y}function Ve(ee,q){var Y=ee.split("@"),fe="";Y.length>1&&(fe=Y[0]+"@",ee=Y[1]),ee=ee.replace(we,".");var Te=ee.split("."),rt=Be(Te,q).join(".");return fe+rt}function Je(ee){for(var q=[],Y=0,fe=ee.length;Y<fe;){var Te=ee.charCodeAt(Y++);if(Te>=55296&&Te<=56319&&Y<fe){var rt=ee.charCodeAt(Y++);(rt&64512)==56320?q.push(((Te&1023)<<10)+(rt&1023)+65536):(q.push(Te),Y--)}else q.push(Te)}return q}var ut=function(q){return String.fromCodePoint.apply(String,I(q))},ht=function(q){return q-48<10?q-22:q-65<26?q-65:q-97<26?q-97:z},Et=function(q,Y){return q+22+75*(q<26)-((Y!=0)<<5)},Qt=function(q,Y,fe){var Te=0;for(q=fe?Ie(q/G):q>>1,q+=Ie(q/Y);q>ke*$>>1;Te+=z)q=Ie(q/ke);return Ie(Te+(ke+1)*q/(q+j))},Nt=function(q){var Y=[],fe=q.length,Te=0,rt=X,He=K,At=q.lastIndexOf(re);At<0&&(At=0);for(var Ft=0;Ft<At;++Ft)q.charCodeAt(Ft)>=128&&se("not-basic"),Y.push(q.charCodeAt(Ft));for(var jt=At>0?At+1:0;jt<fe;){for(var Ot=Te,qt=1,lr=z;;lr+=z){jt>=fe&&se("invalid-input");var Wt=ht(q.charCodeAt(jt++));(Wt>=z||Wt>Ie((R-Te)/qt))&&se("overflow"),Te+=Wt*qt;var ar=lr<=He?B:lr>=He+$?$:lr-He;if(Wt<ar)break;var ze=z-ar;qt>Ie(R/ze)&&se("overflow"),qt*=ze}var Ir=Y.length+1;He=Qt(Te-Ot,Ir,Ot==0),Ie(Te/Ir)>R-rt&&se("overflow"),rt+=Ie(Te/Ir),Te%=Ir,Y.splice(Te++,0,rt)}return String.fromCodePoint.apply(String,Y)},yt=function(q){var Y=[];q=Je(q);var fe=q.length,Te=X,rt=0,He=K,At=!0,Ft=!1,jt=void 0;try{for(var Ot=q[Symbol.iterator](),qt;!(At=(qt=Ot.next()).done);At=!0){var lr=qt.value;lr<128&&Y.push(Fe(lr))}}catch(Hr){Ft=!0,jt=Hr}finally{try{!At&&Ot.return&&Ot.return()}finally{if(Ft)throw jt}}var Wt=Y.length,ar=Wt;for(Wt&&Y.push(re);ar<fe;){var ze=R,Ir=!0,jr=!1,gi=void 0;try{for(var Hn=q[Symbol.iterator](),ki;!(Ir=(ki=Hn.next()).done);Ir=!0){var Wn=ki.value;Wn>=Te&&Wn<ze&&(ze=Wn)}}catch(Hr){jr=!0,gi=Hr}finally{try{!Ir&&Hn.return&&Hn.return()}finally{if(jr)throw gi}}var hn=ar+1;ze-Te>Ie((R-rt)/hn)&&se("overflow"),rt+=(ze-Te)*hn,Te=ze;var nn=!0,Dt=!1,pr=void 0;try{for(var dr=q[Symbol.iterator](),vn;!(nn=(vn=dr.next()).done);nn=!0){var Is=vn.value;if(Is<Te&&++rt>R&&se("overflow"),Is==Te){for(var hr=rt,xn=z;;xn+=z){var us=xn<=He?B:xn>=He+$?$:xn-He;if(hr<us)break;var _o=hr-us,dn=z-us;Y.push(Fe(Et(us+_o%dn,0))),hr=Ie(_o/dn)}Y.push(Fe(Et(hr,0))),He=Qt(rt,hn,ar==Wt),rt=0,++ar}}}catch(Hr){Dt=!0,pr=Hr}finally{try{!nn&&dr.return&&dr.return()}finally{if(Dt)throw pr}}++rt,++Te}return Y.join("")},et=function(q){return Ve(q,function(Y){return ue.test(Y)?Nt(Y.slice(4).toLowerCase()):Y})},Ne=function(q){return Ve(q,function(Y){return ne.test(Y)?"xn--"+yt(Y):Y})},tt={version:"2.1.0",ucs2:{decode:Je,encode:ut},decode:Nt,encode:yt,toASCII:Ne,toUnicode:et},ft={};function mt(ee){var q=ee.charCodeAt(0),Y=void 0;return q<16?Y="%0"+q.toString(16).toUpperCase():q<128?Y="%"+q.toString(16).toUpperCase():q<2048?Y="%"+(q>>6|192).toString(16).toUpperCase()+"%"+(q&63|128).toString(16).toUpperCase():Y="%"+(q>>12|224).toString(16).toUpperCase()+"%"+(q>>6&63|128).toString(16).toUpperCase()+"%"+(q&63|128).toString(16).toUpperCase(),Y}function Ht(ee){for(var q="",Y=0,fe=ee.length;Y<fe;){var Te=parseInt(ee.substr(Y+1,2),16);if(Te<128)q+=String.fromCharCode(Te),Y+=3;else if(Te>=194&&Te<224){if(fe-Y>=6){var rt=parseInt(ee.substr(Y+4,2),16);q+=String.fromCharCode((Te&31)<<6|rt&63)}else q+=ee.substr(Y,6);Y+=6}else if(Te>=224){if(fe-Y>=9){var He=parseInt(ee.substr(Y+4,2),16),At=parseInt(ee.substr(Y+7,2),16);q+=String.fromCharCode((Te&15)<<12|(He&63)<<6|At&63)}else q+=ee.substr(Y,9);Y+=9}else q+=ee.substr(Y,3),Y+=3}return q}function Zt(ee,q){function Y(fe){var Te=Ht(fe);return Te.match(q.UNRESERVED)?Te:fe}return ee.scheme&&(ee.scheme=String(ee.scheme).replace(q.PCT_ENCODED,Y).toLowerCase().replace(q.NOT_SCHEME,"")),ee.userinfo!==void 0&&(ee.userinfo=String(ee.userinfo).replace(q.PCT_ENCODED,Y).replace(q.NOT_USERINFO,mt).replace(q.PCT_ENCODED,d)),ee.host!==void 0&&(ee.host=String(ee.host).replace(q.PCT_ENCODED,Y).toLowerCase().replace(q.NOT_HOST,mt).replace(q.PCT_ENCODED,d)),ee.path!==void 0&&(ee.path=String(ee.path).replace(q.PCT_ENCODED,Y).replace(ee.scheme?q.NOT_PATH:q.NOT_PATH_NOSCHEME,mt).replace(q.PCT_ENCODED,d)),ee.query!==void 0&&(ee.query=String(ee.query).replace(q.PCT_ENCODED,Y).replace(q.NOT_QUERY,mt).replace(q.PCT_ENCODED,d)),ee.fragment!==void 0&&(ee.fragment=String(ee.fragment).replace(q.PCT_ENCODED,Y).replace(q.NOT_FRAGMENT,mt).replace(q.PCT_ENCODED,d)),ee}function Lt(ee){return ee.replace(/^0*(.*)/,"$1")||"0"}function ye(ee,q){var Y=ee.match(q.IPV4ADDRESS)||[],fe=P(Y,2),Te=fe[1];return Te?Te.split(".").map(Lt).join("."):ee}function Me(ee,q){var Y=ee.match(q.IPV6ADDRESS)||[],fe=P(Y,3),Te=fe[1],rt=fe[2];if(Te){for(var He=Te.toLowerCase().split("::").reverse(),At=P(He,2),Ft=At[0],jt=At[1],Ot=jt?jt.split(":").map(Lt):[],qt=Ft.split(":").map(Lt),lr=q.IPV4ADDRESS.test(qt[qt.length-1]),Wt=lr?7:8,ar=qt.length-Wt,ze=Array(Wt),Ir=0;Ir<Wt;++Ir)ze[Ir]=Ot[Ir]||qt[ar+Ir]||"";lr&&(ze[Wt-1]=ye(ze[Wt-1],q));var jr=ze.reduce(function(hn,nn,Dt){if(!nn||nn==="0"){var pr=hn[hn.length-1];pr&&pr.index+pr.length===Dt?pr.length++:hn.push({index:Dt,length:1})}return hn},[]),gi=jr.sort(function(hn,nn){return nn.length-hn.length})[0],Hn=void 0;if(gi&&gi.length>1){var ki=ze.slice(0,gi.index),Wn=ze.slice(gi.index+gi.length);Hn=ki.join(":")+"::"+Wn.join(":")}else Hn=ze.join(":");return rt&&(Hn+="%"+rt),Hn}else return ee}var $e=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,it="".match(/(){0}/)[1]===void 0;function ot(ee){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y={},fe=q.iri!==!1?S:E;q.reference==="suffix"&&(ee=(q.scheme?q.scheme+":":"")+"//"+ee);var Te=ee.match($e);if(Te){it?(Y.scheme=Te[1],Y.userinfo=Te[3],Y.host=Te[4],Y.port=parseInt(Te[5],10),Y.path=Te[6]||"",Y.query=Te[7],Y.fragment=Te[8],isNaN(Y.port)&&(Y.port=Te[5])):(Y.scheme=Te[1]||void 0,Y.userinfo=ee.indexOf("@")!==-1?Te[3]:void 0,Y.host=ee.indexOf("//")!==-1?Te[4]:void 0,Y.port=parseInt(Te[5],10),Y.path=Te[6]||"",Y.query=ee.indexOf("?")!==-1?Te[7]:void 0,Y.fragment=ee.indexOf("#")!==-1?Te[8]:void 0,isNaN(Y.port)&&(Y.port=ee.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?Te[4]:void 0)),Y.host&&(Y.host=Me(ye(Y.host,fe),fe)),Y.scheme===void 0&&Y.userinfo===void 0&&Y.host===void 0&&Y.port===void 0&&!Y.path&&Y.query===void 0?Y.reference="same-document":Y.scheme===void 0?Y.reference="relative":Y.fragment===void 0?Y.reference="absolute":Y.reference="uri",q.reference&&q.reference!=="suffix"&&q.reference!==Y.reference&&(Y.error=Y.error||"URI is not a "+q.reference+" reference.");var rt=ft[(q.scheme||Y.scheme||"").toLowerCase()];if(!q.unicodeSupport&&(!rt||!rt.unicodeSupport)){if(Y.host&&(q.domainHost||rt&&rt.domainHost))try{Y.host=tt.toASCII(Y.host.replace(fe.PCT_ENCODED,Ht).toLowerCase())}catch(He){Y.error=Y.error||"Host's domain name can not be converted to ASCII via punycode: "+He}Zt(Y,E)}else Zt(Y,fe);rt&&rt.parse&&rt.parse(Y,q)}else Y.error=Y.error||"URI can not be parsed.";return Y}function st(ee,q){var Y=q.iri!==!1?S:E,fe=[];return ee.userinfo!==void 0&&(fe.push(ee.userinfo),fe.push("@")),ee.host!==void 0&&fe.push(Me(ye(String(ee.host),Y),Y).replace(Y.IPV6ADDRESS,function(Te,rt,He){return"["+rt+(He?"%25"+He:"")+"]"})),(typeof ee.port=="number"||typeof ee.port=="string")&&(fe.push(":"),fe.push(String(ee.port))),fe.length?fe.join(""):void 0}var gt=/^\.\.?\//,lt=/^\/\.(\/|$)/,Ye=/^\/\.\.(\/|$)/,pt=/^\/?(?:.|\n)*?(?=\/|$)/;function Tt(ee){for(var q=[];ee.length;)if(ee.match(gt))ee=ee.replace(gt,"");else if(ee.match(lt))ee=ee.replace(lt,"/");else if(ee.match(Ye))ee=ee.replace(Ye,"/"),q.pop();else if(ee==="."||ee==="..")ee="";else{var Y=ee.match(pt);if(Y){var fe=Y[0];ee=ee.slice(fe.length),q.push(fe)}else throw new Error("Unexpected dot segment condition")}return q.join("")}function St(ee){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y=q.iri?S:E,fe=[],Te=ft[(q.scheme||ee.scheme||"").toLowerCase()];if(Te&&Te.serialize&&Te.serialize(ee,q),ee.host&&!Y.IPV6ADDRESS.test(ee.host)){if(q.domainHost||Te&&Te.domainHost)try{ee.host=q.iri?tt.toUnicode(ee.host):tt.toASCII(ee.host.replace(Y.PCT_ENCODED,Ht).toLowerCase())}catch(At){ee.error=ee.error||"Host's domain name can not be converted to "+(q.iri?"Unicode":"ASCII")+" via punycode: "+At}}Zt(ee,Y),q.reference!=="suffix"&&ee.scheme&&(fe.push(ee.scheme),fe.push(":"));var rt=st(ee,q);if(rt!==void 0&&(q.reference!=="suffix"&&fe.push("//"),fe.push(rt),ee.path&&ee.path.charAt(0)!=="/"&&fe.push("/")),ee.path!==void 0){var He=ee.path;!q.absolutePath&&(!Te||!Te.absolutePath)&&(He=Tt(He)),rt===void 0&&(He=He.replace(/^\/\//,"/%2F")),fe.push(He)}return ee.query!==void 0&&(fe.push("?"),fe.push(ee.query)),ee.fragment!==void 0&&(fe.push("#"),fe.push(ee.fragment)),fe.join("")}function zt(ee,q){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},fe=arguments[3],Te={};return fe||(ee=ot(St(ee,Y),Y),q=ot(St(q,Y),Y)),Y=Y||{},!Y.tolerant&&q.scheme?(Te.scheme=q.scheme,Te.userinfo=q.userinfo,Te.host=q.host,Te.port=q.port,Te.path=Tt(q.path||""),Te.query=q.query):(q.userinfo!==void 0||q.host!==void 0||q.port!==void 0?(Te.userinfo=q.userinfo,Te.host=q.host,Te.port=q.port,Te.path=Tt(q.path||""),Te.query=q.query):(q.path?(q.path.charAt(0)==="/"?Te.path=Tt(q.path):((ee.userinfo!==void 0||ee.host!==void 0||ee.port!==void 0)&&!ee.path?Te.path="/"+q.path:ee.path?Te.path=ee.path.slice(0,ee.path.lastIndexOf("/")+1)+q.path:Te.path=q.path,Te.path=Tt(Te.path)),Te.query=q.query):(Te.path=ee.path,q.query!==void 0?Te.query=q.query:Te.query=ee.query),Te.userinfo=ee.userinfo,Te.host=ee.host,Te.port=ee.port),Te.scheme=ee.scheme),Te.fragment=q.fragment,Te}function Yt(ee,q,Y){var fe=g({scheme:"null"},Y);return St(zt(ot(ee,fe),ot(q,fe),fe,!0),fe)}function ur(ee,q){return typeof ee=="string"?ee=St(ot(ee,q),q):u(ee)==="object"&&(ee=ot(St(ee,q),q)),ee}function xr(ee,q,Y){return typeof ee=="string"?ee=St(ot(ee,Y),Y):u(ee)==="object"&&(ee=St(ee,Y)),typeof q=="string"?q=St(ot(q,Y),Y):u(q)==="object"&&(q=St(q,Y)),ee===q}function fr(ee,q){return ee&&ee.toString().replace(!q||!q.iri?E.ESCAPE:S.ESCAPE,mt)}function br(ee,q){return ee&&ee.toString().replace(!q||!q.iri?E.PCT_ENCODED:S.PCT_ENCODED,Ht)}var Qr={scheme:"http",domainHost:!0,parse:function(q,Y){return q.host||(q.error=q.error||"HTTP URIs must have a host."),q},serialize:function(q,Y){var fe=String(q.scheme).toLowerCase()==="https";return(q.port===(fe?443:80)||q.port==="")&&(q.port=void 0),q.path||(q.path="/"),q}},Wi={scheme:"https",domainHost:Qr.domainHost,parse:Qr.parse,serialize:Qr.serialize};function Ei(ee){return typeof ee.secure=="boolean"?ee.secure:String(ee.scheme).toLowerCase()==="wss"}var ui={scheme:"ws",domainHost:!0,parse:function(q,Y){var fe=q;return fe.secure=Ei(fe),fe.resourceName=(fe.path||"/")+(fe.query?"?"+fe.query:""),fe.path=void 0,fe.query=void 0,fe},serialize:function(q,Y){if((q.port===(Ei(q)?443:80)||q.port==="")&&(q.port=void 0),typeof q.secure=="boolean"&&(q.scheme=q.secure?"wss":"ws",q.secure=void 0),q.resourceName){var fe=q.resourceName.split("?"),Te=P(fe,2),rt=Te[0],He=Te[1];q.path=rt&&rt!=="/"?rt:void 0,q.query=He,q.resourceName=void 0}return q.fragment=void 0,q}},Un={scheme:"wss",domainHost:ui.domainHost,parse:ui.parse,serialize:ui.serialize},or={},Gt="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",rr="[0-9A-Fa-f]",Sr=s(s("%[EFef]"+rr+"%"+rr+rr+"%"+rr+rr)+"|"+s("%[89A-Fa-f]"+rr+"%"+rr+rr)+"|"+s("%"+rr+rr)),zr="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Ii="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Ks=n(Ii,'[\\"\\\\]'),Gn="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",rn=new RegExp(Gt,"g"),Ln=new RegExp(Sr,"g"),Ra=new RegExp(n("[^]",zr,"[\\.]",'[\\"]',Ks),"g"),Zi=new RegExp(n("[^]",Gt,Gn),"g"),Wo=Zi;function me(ee){var q=Ht(ee);return q.match(rn)?q:ee}var W={scheme:"mailto",parse:function(q,Y){var fe=q,Te=fe.to=fe.path?fe.path.split(","):[];if(fe.path=void 0,fe.query){for(var rt=!1,He={},At=fe.query.split("&"),Ft=0,jt=At.length;Ft<jt;++Ft){var Ot=At[Ft].split("=");switch(Ot[0]){case"to":for(var qt=Ot[1].split(","),lr=0,Wt=qt.length;lr<Wt;++lr)Te.push(qt[lr]);break;case"subject":fe.subject=br(Ot[1],Y);break;case"body":fe.body=br(Ot[1],Y);break;default:rt=!0,He[br(Ot[0],Y)]=br(Ot[1],Y);break}}rt&&(fe.headers=He)}fe.query=void 0;for(var ar=0,ze=Te.length;ar<ze;++ar){var Ir=Te[ar].split("@");if(Ir[0]=br(Ir[0]),Y.unicodeSupport)Ir[1]=br(Ir[1],Y).toLowerCase();else try{Ir[1]=tt.toASCII(br(Ir[1],Y).toLowerCase())}catch(jr){fe.error=fe.error||"Email address's domain name can not be converted to ASCII via punycode: "+jr}Te[ar]=Ir.join("@")}return fe},serialize:function(q,Y){var fe=q,Te=o(q.to);if(Te){for(var rt=0,He=Te.length;rt<He;++rt){var At=String(Te[rt]),Ft=At.lastIndexOf("@"),jt=At.slice(0,Ft).replace(Ln,me).replace(Ln,d).replace(Ra,mt),Ot=At.slice(Ft+1);try{Ot=Y.iri?tt.toUnicode(Ot):tt.toASCII(br(Ot,Y).toLowerCase())}catch(ar){fe.error=fe.error||"Email address's domain name can not be converted to "+(Y.iri?"Unicode":"ASCII")+" via punycode: "+ar}Te[rt]=jt+"@"+Ot}fe.path=Te.join(",")}var qt=q.headers=q.headers||{};q.subject&&(qt.subject=q.subject),q.body&&(qt.body=q.body);var lr=[];for(var Wt in qt)qt[Wt]!==or[Wt]&&lr.push(Wt.replace(Ln,me).replace(Ln,d).replace(Zi,mt)+"="+qt[Wt].replace(Ln,me).replace(Ln,d).replace(Wo,mt));return lr.length&&(fe.query=lr.join("&")),fe}},J=/^([^\:]+)\:(.*)/,pe={scheme:"urn",parse:function(q,Y){var fe=q.path&&q.path.match(J),Te=q;if(fe){var rt=Y.scheme||Te.scheme||"urn",He=fe[1].toLowerCase(),At=fe[2],Ft=rt+":"+(Y.nid||He),jt=ft[Ft];Te.nid=He,Te.nss=At,Te.path=void 0,jt&&(Te=jt.parse(Te,Y))}else Te.error=Te.error||"URN can not be parsed.";return Te},serialize:function(q,Y){var fe=Y.scheme||q.scheme||"urn",Te=q.nid,rt=fe+":"+(Y.nid||Te),He=ft[rt];He&&(q=He.serialize(q,Y));var At=q,Ft=q.nss;return At.path=(Te||Y.nid)+":"+Ft,At}},Ee=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Oe={scheme:"urn:uuid",parse:function(q,Y){var fe=q;return fe.uuid=fe.nss,fe.nss=void 0,!Y.tolerant&&(!fe.uuid||!fe.uuid.match(Ee))&&(fe.error=fe.error||"UUID is not valid."),fe},serialize:function(q,Y){var fe=q;return fe.nss=(q.uuid||"").toLowerCase(),fe}};ft[Qr.scheme]=Qr,ft[Wi.scheme]=Wi,ft[ui.scheme]=ui,ft[Un.scheme]=Un,ft[W.scheme]=W,ft[pe.scheme]=pe,ft[Oe.scheme]=Oe,r.SCHEMES=ft,r.pctEncChar=mt,r.pctDecChars=Ht,r.parse=ot,r.removeDotSegments=Tt,r.serialize=St,r.resolveComponents=zt,r.resolve=Yt,r.normalize=ur,r.equal=xr,r.escapeComponent=fr,r.unescapeComponent=br,Object.defineProperty(r,"__esModule",{value:!0})})})(Tb,Tb.exports);var D1=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,u;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(u=Object.keys(e),n=u.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,u[s]))return!1;for(s=n;s--!==0;){var d=u[s];if(!t(e[d],r[d]))return!1}return!0}return e!==e&&r!==r},PV=function(e){for(var r=0,n=e.length,s=0,u;s<n;)r++,u=e.charCodeAt(s++),u>=55296&&u<=56319&&s<n&&(u=e.charCodeAt(s),(u&64512)==56320&&s++);return r},dd={copy:CV,checkDataType:Sb,checkDataTypes:IV,coerceToTypes:MV,toHash:R1,getProperty:L1,escapeQuotes:k1,equal:D1,ucs2length:PV,varOccurences:RV,varReplace:LV,schemaHasRules:kV,schemaHasRulesExcept:zV,schemaUnknownRules:FV,toQuotedString:Ab,getPathExpr:BV,getPath:NV,getData:VV,unescapeFragment:UV,unescapeJsonPointer:F1,escapeFragment:GV,escapeJsonPointer:z1};function CV(t,e){e=e||{};for(var r in t)e[r]=t[r];return e}function Sb(t,e,r,n){var s=n?" !== ":" === ",u=n?" || ":" && ",d=n?"!":"",o=n?"":"!";switch(t){case"null":return e+s+"null";case"array":return d+"Array.isArray("+e+")";case"object":return"("+d+e+u+"typeof "+e+s+'"object"'+u+o+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+s+'"number"'+u+o+"("+e+" % 1)"+u+e+s+e+(r?u+d+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+s+'"'+t+'"'+(r?u+d+"isFinite("+e+")":"")+")";default:return"typeof "+e+s+'"'+t+'"'}}function IV(t,e,r){switch(t.length){case 1:return Sb(t[0],e,r,!0);default:var n="",s=R1(t);s.array&&s.object&&(n=s.null?"(":"(!"+e+" || ",n+="typeof "+e+' !== "object")',delete s.null,delete s.array,delete s.object),s.number&&delete s.integer;for(var u in s)n+=(n?" && ":"")+Sb(u,e,r,!0);return n}}var mA=R1(["string","number","integer","boolean","null"]);function MV(t,e){if(Array.isArray(e)){for(var r=[],n=0;n<e.length;n++){var s=e[n];(mA[s]||t==="array"&&s==="array")&&(r[r.length]=s)}if(r.length)return r}else{if(mA[e])return[e];if(t==="array"&&e==="array")return["array"]}}function R1(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return e}var OV=/^[a-z$_][a-z$_0-9]*$/i,DV=/'|\\/g;function L1(t){return typeof t=="number"?"["+t+"]":OV.test(t)?"."+t:"['"+k1(t)+"']"}function k1(t){return t.replace(DV,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function RV(t,e){e+="[^0-9]";var r=t.match(new RegExp(e,"g"));return r?r.length:0}function LV(t,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),t.replace(new RegExp(e,"g"),r+"$1")}function kV(t,e){if(typeof t=="boolean")return!t;for(var r in t)if(e[r])return!0}function zV(t,e,r){if(typeof t=="boolean")return!t&&r!="not";for(var n in t)if(n!=r&&e[n])return!0}function FV(t,e){if(typeof t!="boolean"){for(var r in t)if(!e[r])return r}}function Ab(t){return"'"+k1(t)+"'"}function BV(t,e,r,n){var s=r?"'/' + "+e+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return kM(t,s)}function NV(t,e,r){var n=Ab(r?"/"+z1(e):L1(e));return kM(t,n)}var jV=/^\/(?:[^~]|~0|~1)*$/,$V=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function VV(t,e,r){var n,s,u,d;if(t==="")return"rootData";if(t[0]=="/"){if(!jV.test(t))throw new Error("Invalid JSON-pointer: "+t);s=t,u="rootData"}else{if(d=t.match($V),!d)throw new Error("Invalid JSON-pointer: "+t);if(n=+d[1],s=d[2],s=="#"){if(n>=e)throw new Error("Cannot access property/index "+n+" levels up, current level is "+e);return r[e-n]}if(n>e)throw new Error("Cannot access data "+n+" levels up, current level is "+e);if(u="data"+(e-n||""),!s)return u}for(var o=u,g=s.split("/"),x=0;x<g.length;x++){var E=g[x];E&&(u+=L1(F1(E)),o+=" && "+u)}return o}function kM(t,e){return t=='""'?e:(t+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function UV(t){return F1(decodeURIComponent(t))}function GV(t){return encodeURIComponent(z1(t))}function z1(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function F1(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}var HV=dd,zM=WV;function WV(t){HV.copy(t,this)}var FM={exports:{}},Al=FM.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};z_(e,n,s,t,"",t)};Al.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};Al.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Al.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Al.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function z_(t,e,r,n,s,u,d,o,g,x){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,u,d,o,g,x);for(var E in n){var S=n[E];if(Array.isArray(S)){if(E in Al.arrayKeywords)for(var P=0;P<S.length;P++)z_(t,e,r,S[P],s+"/"+E+"/"+P,u,s,E,n,P)}else if(E in Al.propsKeywords){if(S&&typeof S=="object")for(var I in S)z_(t,e,r,S[I],s+"/"+E+"/"+ZV(I),u,s,E,n,I)}else(E in Al.keywords||t.allKeys&&!(E in Al.skipKeywords))&&z_(t,e,r,S,s+"/"+E,u,s,E,n)}r(n,s,u,d,o,g,x)}}function ZV(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}var Kp=Tb.exports,gA=D1,nv=dd,sy=zM,qV=FM.exports,B1=Gl;Gl.normalizeId=Ml;Gl.fullPath=oy;Gl.url=ay;Gl.ids=QV;Gl.inlineRef=Pb;Gl.schema=sv;function Gl(t,e,r){var n=this._refs[r];if(typeof n=="string")if(this._refs[n])n=this._refs[n];else return Gl.call(this,t,e,n);if(n=n||this._schemas[r],n instanceof sy)return Pb(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var s=sv.call(this,e,r),u,d,o;return s&&(u=s.schema,e=s.root,o=s.baseId),u instanceof sy?d=u.validate||t.call(this,u.schema,e,void 0,o):u!==void 0&&(d=Pb(u,this._opts.inlineRefs)?u:t.call(this,u,e,void 0,o)),d}function sv(t,e){var r=Kp.parse(e),n=NM(r),s=oy(this._getId(t.schema));if(Object.keys(t.schema).length===0||n!==s){var u=Ml(n),d=this._refs[u];if(typeof d=="string")return KV.call(this,t,d,r);if(d instanceof sy)d.validate||this._compile(d),t=d;else if(d=this._schemas[u],d instanceof sy){if(d.validate||this._compile(d),u==Ml(e))return{schema:d,root:t,baseId:s};t=d}else return;if(!t.schema)return;s=oy(this._getId(t.schema))}return BM.call(this,r,s,t.schema,t)}function KV(t,e,r){var n=sv.call(this,t,e);if(n){var s=n.schema,u=n.baseId;t=n.root;var d=this._getId(s);return d&&(u=ay(u,d)),BM.call(this,r,u,s,t)}}var XV=nv.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function BM(t,e,r,n){if(t.fragment=t.fragment||"",t.fragment.slice(0,1)=="/"){for(var s=t.fragment.split("/"),u=1;u<s.length;u++){var d=s[u];if(d){if(d=nv.unescapeFragment(d),r=r[d],r===void 0)break;var o;if(!XV[d]&&(o=this._getId(r),o&&(e=ay(e,o)),r.$ref)){var g=ay(e,r.$ref),x=sv.call(this,n,g);x&&(r=x.schema,n=x.root,e=x.baseId)}}}if(r!==void 0&&r!==n.schema)return{schema:r,root:n,baseId:e}}}var YV=nv.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function Pb(t,e){if(e===!1)return!1;if(e===void 0||e===!0)return Cb(t);if(e)return Ib(t)<=e}function Cb(t){var e;if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(e=t[r],typeof e=="object"&&!Cb(e))return!1}else for(var n in t)if(n=="$ref"||(e=t[n],typeof e=="object"&&!Cb(e)))return!1;return!0}function Ib(t){var e=0,r;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if(r=t[n],typeof r=="object"&&(e+=Ib(r)),e==1/0)return 1/0}else for(var s in t){if(s=="$ref")return 1/0;if(YV[s])e++;else if(r=t[s],typeof r=="object"&&(e+=Ib(r)+1),e==1/0)return 1/0}return e}function oy(t,e){e!==!1&&(t=Ml(t));var r=Kp.parse(t);return NM(r)}function NM(t){return Kp.serialize(t).split("#")[0]+"#"}var JV=/#\/?$/;function Ml(t){return t?t.replace(JV,""):""}function ay(t,e){return e=Ml(e),Kp.resolve(t,e)}function QV(t){var e=Ml(this._getId(t)),r={"":e},n={"":oy(e,!1)},s={},u=this;return qV(t,{allKeys:!0},function(d,o,g,x,E,S,P){if(o!==""){var I=u._getId(d),R=r[x],z=n[x]+"/"+E;if(P!==void 0&&(z+="/"+(typeof P=="number"?P:nv.escapeFragment(P))),typeof I=="string"){I=R=Ml(R?Kp.resolve(R,I):I);var B=u._refs[I];if(typeof B=="string"&&(B=u._refs[B]),B&&B.schema){if(!gA(d,B.schema))throw new Error('id "'+I+'" resolves to more than one schema')}else if(I!=Ml(z))if(I[0]=="#"){if(s[I]&&!gA(d,s[I]))throw new Error('id "'+I+'" resolves to more than one schema');s[I]=d}else u._refs[I]=z}r[o]=R,n[o]=z}}),s}var fx=B1,N1={Validation:_A(e6),MissingRef:_A(j1)};function e6(t){this.message="validation failed",this.errors=t,this.ajv=this.validation=!0}j1.message=function(t,e){return"can't resolve reference "+e+" from id "+t};function j1(t,e,r){this.message=r||j1.message(t,e),this.missingRef=fx.url(t,e),this.missingSchema=fx.normalizeId(fx.fullPath(this.missingRef))}function _A(t){return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var jM=function(t,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,n=e.cmp&&function(u){return function(d){return function(o,g){var x={key:o,value:d[o]},E={key:g,value:d[g]};return u(x,E)}}}(e.cmp),s=[];return function u(d){if(d&&d.toJSON&&typeof d.toJSON=="function"&&(d=d.toJSON()),d!==void 0){if(typeof d=="number")return isFinite(d)?""+d:"null";if(typeof d!="object")return JSON.stringify(d);var o,g;if(Array.isArray(d)){for(g="[",o=0;o<d.length;o++)o&&(g+=","),g+=u(d[o])||"null";return g+"]"}if(d===null)return"null";if(s.indexOf(d)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var x=s.push(d)-1,E=Object.keys(d).sort(n&&n(d));for(g="",o=0;o<E.length;o++){var S=E[o],P=u(d[S]);!P||(g&&(g+=","),g+=JSON.stringify(S)+":"+P)}return s.splice(x,1),"{"+g+"}"}}(t)},$M=function(e,r,n){var s="",u=e.schema.$async===!0,d=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var g=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(g){var x="unknown keyword: "+g;if(e.opts.strictKeywords==="log")e.logger.warn(x);else throw new Error(x)}}if(e.isTop&&(s+=" var validate = ",u&&(e.async=!0,s+="async "),s+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(s+=" "+("/*# sourceURL="+o+" */")+" ")),typeof e.schema=="boolean"||!(d||e.schema.$ref)){var r="false schema",E=e.level,S=e.dataLevel,P=e.schema[r],I=e.schemaPath+e.util.getProperty(r),R=e.errSchemaPath+"/"+r,X=!e.opts.allErrors,ne,z="data"+(S||""),K="valid"+E;if(e.schema===!1){e.isTop?X=!0:s+=" var "+K+" = false; ";var B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(ne||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(R)+" , params: {} ",e.opts.messages!==!1&&(s+=" , message: 'boolean schema is false' "),e.opts.verbose&&(s+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+z+" "),s+=" } "):s+=" {} ";var $=s;s=B.pop(),!e.compositeRule&&X?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?u?s+=" return data; ":s+=" validate.errors = null; return true; ":s+=" var "+K+" = true; ";return e.isTop&&(s+=" }; return validate; "),s}if(e.isTop){var j=e.isTop,E=e.level=0,S=e.dataLevel=0,z="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var G="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(G);else throw new Error(G)}s+=" var vErrors = null; ",s+=" var errors = 0;     ",s+=" if (rootData === undefined) rootData = data; "}else{var E=e.level,S=e.dataLevel,z="data"+(S||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),u&&!e.async)throw new Error("async schema in sync schema");s+=" var errs_"+E+" = errors;"}var K="valid"+E,X=!e.opts.allErrors,re="",ue="",ne,we=e.schema.type,xe=Array.isArray(we);if(we&&e.opts.nullable&&e.schema.nullable===!0&&(xe?we.indexOf("null")==-1&&(we=we.concat("null")):we!="null"&&(we=[we,"null"],xe=!0)),xe&&we.length==1&&(we=we[0],xe=!1),e.schema.$ref&&d){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(d=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(s+=" "+e.RULES.all.$comment.code(e,"$comment")),we){if(e.opts.coerceTypes)var ke=e.util.coerceToTypes(e.opts.coerceTypes,we);var Ie=e.RULES.types[we];if(ke||xe||Ie===!0||Ie&&!lt(Ie)){var I=e.schemaPath+".type",R=e.errSchemaPath+"/type",I=e.schemaPath+".type",R=e.errSchemaPath+"/type",Fe=xe?"checkDataTypes":"checkDataType";if(s+=" if ("+e.util[Fe](we,z,e.opts.strictNumbers,!0)+") { ",ke){var se="dataType"+E,Be="coerced"+E;s+=" var "+se+" = typeof "+z+"; var "+Be+" = undefined; ",e.opts.coerceTypes=="array"&&(s+=" if ("+se+" == 'object' && Array.isArray("+z+") && "+z+".length == 1) { "+z+" = "+z+"[0]; "+se+" = typeof "+z+"; if ("+e.util.checkDataType(e.schema.type,z,e.opts.strictNumbers)+") "+Be+" = "+z+"; } "),s+=" if ("+Be+" !== undefined) ; ";var Ve=ke;if(Ve)for(var Je,ut=-1,ht=Ve.length-1;ut<ht;)Je=Ve[ut+=1],Je=="string"?s+=" else if ("+se+" == 'number' || "+se+" == 'boolean') "+Be+" = '' + "+z+"; else if ("+z+" === null) "+Be+" = ''; ":Je=="number"||Je=="integer"?(s+=" else if ("+se+" == 'boolean' || "+z+" === null || ("+se+" == 'string' && "+z+" && "+z+" == +"+z+" ",Je=="integer"&&(s+=" && !("+z+" % 1)"),s+=")) "+Be+" = +"+z+"; "):Je=="boolean"?s+=" else if ("+z+" === 'false' || "+z+" === 0 || "+z+" === null) "+Be+" = false; else if ("+z+" === 'true' || "+z+" === 1) "+Be+" = true; ":Je=="null"?s+=" else if ("+z+" === '' || "+z+" === 0 || "+z+" === false) "+Be+" = null; ":e.opts.coerceTypes=="array"&&Je=="array"&&(s+=" else if ("+se+" == 'string' || "+se+" == 'number' || "+se+" == 'boolean' || "+z+" == null) "+Be+" = ["+z+"]; ");s+=" else {   ";var B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(ne||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(R)+" , params: { type: '",xe?s+=""+we.join(","):s+=""+we,s+="' } ",e.opts.messages!==!1&&(s+=" , message: 'should be ",xe?s+=""+we.join(","):s+=""+we,s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+I+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+z+" "),s+=" } "):s+=" {} ";var $=s;s=B.pop(),!e.compositeRule&&X?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } if ("+Be+" !== undefined) {  ";var Et=S?"data"+(S-1||""):"parentData",Qt=S?e.dataPathArr[S]:"parentDataProperty";s+=" "+z+" = "+Be+"; ",S||(s+="if ("+Et+" !== undefined)"),s+=" "+Et+"["+Qt+"] = "+Be+"; } "}else{var B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(ne||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(R)+" , params: { type: '",xe?s+=""+we.join(","):s+=""+we,s+="' } ",e.opts.messages!==!1&&(s+=" , message: 'should be ",xe?s+=""+we.join(","):s+=""+we,s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+I+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+z+" "),s+=" } "):s+=" {} ";var $=s;s=B.pop(),!e.compositeRule&&X?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}s+=" } "}}if(e.schema.$ref&&!d)s+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",X&&(s+=" } if (errors === ",j?s+="0":s+="errs_"+E,s+=") { ",ue+="}");else{var Nt=e.RULES;if(Nt){for(var Ie,yt=-1,et=Nt.length-1;yt<et;)if(Ie=Nt[yt+=1],lt(Ie)){if(Ie.type&&(s+=" if ("+e.util.checkDataType(Ie.type,z,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(Ie.type=="object"&&e.schema.properties){var P=e.schema.properties,Ne=Object.keys(P),tt=Ne;if(tt)for(var ft,mt=-1,Ht=tt.length-1;mt<Ht;){ft=tt[mt+=1];var Zt=P[ft];if(Zt.default!==void 0){var Lt=z+e.util.getProperty(ft);if(e.compositeRule){if(e.opts.strictDefaults){var G="default is ignored for: "+Lt;if(e.opts.strictDefaults==="log")e.logger.warn(G);else throw new Error(G)}}else s+=" if ("+Lt+" === undefined ",e.opts.useDefaults=="empty"&&(s+=" || "+Lt+" === null || "+Lt+" === '' "),s+=" ) "+Lt+" = ",e.opts.useDefaults=="shared"?s+=" "+e.useDefault(Zt.default)+" ":s+=" "+JSON.stringify(Zt.default)+" ",s+="; "}}}else if(Ie.type=="array"&&Array.isArray(e.schema.items)){var ye=e.schema.items;if(ye){for(var Zt,ut=-1,Me=ye.length-1;ut<Me;)if(Zt=ye[ut+=1],Zt.default!==void 0){var Lt=z+"["+ut+"]";if(e.compositeRule){if(e.opts.strictDefaults){var G="default is ignored for: "+Lt;if(e.opts.strictDefaults==="log")e.logger.warn(G);else throw new Error(G)}}else s+=" if ("+Lt+" === undefined ",e.opts.useDefaults=="empty"&&(s+=" || "+Lt+" === null || "+Lt+" === '' "),s+=" ) "+Lt+" = ",e.opts.useDefaults=="shared"?s+=" "+e.useDefault(Zt.default)+" ":s+=" "+JSON.stringify(Zt.default)+" ",s+="; "}}}}var $e=Ie.rules;if($e){for(var it,ot=-1,st=$e.length-1;ot<st;)if(it=$e[ot+=1],Ye(it)){var gt=it.code(e,it.keyword,Ie.type);gt&&(s+=" "+gt+" ",X&&(re+="}"))}}if(X&&(s+=" "+re+" ",re=""),Ie.type&&(s+=" } ",we&&we===Ie.type&&!ke)){s+=" else { ";var I=e.schemaPath+".type",R=e.errSchemaPath+"/type",B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(ne||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(R)+" , params: { type: '",xe?s+=""+we.join(","):s+=""+we,s+="' } ",e.opts.messages!==!1&&(s+=" , message: 'should be ",xe?s+=""+we.join(","):s+=""+we,s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+I+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+z+" "),s+=" } "):s+=" {} ";var $=s;s=B.pop(),!e.compositeRule&&X?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } "}X&&(s+=" if (errors === ",j?s+="0":s+="errs_"+E,s+=") { ",ue+="}")}}}X&&(s+=" "+ue+" "),j?(u?(s+=" if (errors === 0) return data;           ",s+=" else throw new ValidationError(vErrors); "):(s+=" validate.errors = vErrors; ",s+=" return errors === 0;       "),s+=" }; return validate;"):s+=" var "+K+" = errors === errs_"+E+";";function lt(Tt){for(var St=Tt.rules,zt=0;zt<St.length;zt++)if(Ye(St[zt]))return!0}function Ye(Tt){return e.schema[Tt.keyword]!==void 0||Tt.implements&&pt(Tt)}function pt(Tt){for(var St=Tt.implements,zt=0;zt<St.length;zt++)if(e.schema[St[zt]]!==void 0)return!0}return s},o_=B1,ly=dd,VM=N1,t6=jM,yA=$M,r6=ly.ucs2length,i6=D1,n6=VM.Validation,s6=Mb;function Mb(t,e,r,n){var s=this,u=this._opts,d=[void 0],o={},g=[],x={},E=[],S={},P=[];e=e||{schema:t,refVal:d,refs:o};var I=o6.call(this,t,e,n),R=this._compilations[I.index];if(I.compiling)return R.callValidate=G;var z=this._formats,B=this.RULES;try{var $=K(t,e,r,n);R.validate=$;var j=R.callValidate;return j&&(j.schema=$.schema,j.errors=null,j.refs=$.refs,j.refVal=$.refVal,j.root=$.root,j.$async=$.$async,u.sourceCode&&(j.source=$.source)),$}finally{a6.call(this,t,e,n)}function G(){var Fe=R.validate,se=Fe.apply(this,arguments);return G.errors=Fe.errors,se}function K(Fe,se,Be,Ve){var Je=!se||se&&se.schema==Fe;if(se.schema!=e.schema)return Mb.call(s,Fe,se,Be,Ve);var ut=Fe.$async===!0,ht=yA({isTop:!0,schema:Fe,isRoot:Je,baseId:Ve,root:se,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:VM.MissingRef,RULES:B,validate:yA,util:ly,resolve:o_,resolveRef:X,usePattern:xe,useDefault:ke,useCustomRule:Ie,opts:u,formats:z,logger:s.logger,self:s});ht=a_(d,u6)+a_(g,l6)+a_(E,c6)+a_(P,h6)+ht,u.processCode&&(ht=u.processCode(ht,Fe));var Et;try{var Qt=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",ht);Et=Qt(s,B,z,e,d,E,P,i6,r6,n6),d[0]=Et}catch(Nt){throw s.logger.error("Error compiling schema, function code:",ht),Nt}return Et.schema=Fe,Et.errors=null,Et.refs=o,Et.refVal=d,Et.root=Je?Et:se,ut&&(Et.$async=!0),u.sourceCode===!0&&(Et.source={code:ht,patterns:g,defaults:E}),Et}function X(Fe,se,Be){se=o_.url(Fe,se);var Ve=o[se],Je,ut;if(Ve!==void 0)return Je=d[Ve],ut="refVal["+Ve+"]",we(Je,ut);if(!Be&&e.refs){var ht=e.refs[se];if(ht!==void 0)return Je=e.refVal[ht],ut=re(se,Je),we(Je,ut)}ut=re(se);var Et=o_.call(s,K,e,se);if(Et===void 0){var Qt=r&&r[se];Qt&&(Et=o_.inlineRef(Qt,u.inlineRefs)?Qt:Mb.call(s,Qt,e,r,Fe))}if(Et===void 0)ue(se);else return ne(se,Et),we(Et,ut)}function re(Fe,se){var Be=d.length;return d[Be]=se,o[Fe]=Be,"refVal"+Be}function ue(Fe){delete o[Fe]}function ne(Fe,se){var Be=o[Fe];d[Be]=se}function we(Fe,se){return typeof Fe=="object"||typeof Fe=="boolean"?{code:se,schema:Fe,inline:!0}:{code:se,$async:Fe&&!!Fe.$async}}function xe(Fe){var se=x[Fe];return se===void 0&&(se=x[Fe]=g.length,g[se]=Fe),"pattern"+se}function ke(Fe){switch(typeof Fe){case"boolean":case"number":return""+Fe;case"string":return ly.toQuotedString(Fe);case"object":if(Fe===null)return"null";var se=t6(Fe),Be=S[se];return Be===void 0&&(Be=S[se]=E.length,E[Be]=Fe),"default"+Be}}function Ie(Fe,se,Be,Ve){if(s._opts.validateSchema!==!1){var Je=Fe.definition.dependencies;if(Je&&!Je.every(function(tt){return Object.prototype.hasOwnProperty.call(Be,tt)}))throw new Error("parent schema must have all required keywords: "+Je.join(","));var ut=Fe.definition.validateSchema;if(ut){var ht=ut(se);if(!ht){var Et="keyword schema is invalid: "+s.errorsText(ut.errors);if(s._opts.validateSchema=="log")s.logger.error(Et);else throw new Error(Et)}}}var Qt=Fe.definition.compile,Nt=Fe.definition.inline,yt=Fe.definition.macro,et;if(Qt)et=Qt.call(s,se,Be,Ve);else if(yt)et=yt.call(s,se,Be,Ve),u.validateSchema!==!1&&s.validateSchema(et,!0);else if(Nt)et=Nt.call(s,Ve,Fe.keyword,se,Be);else if(et=Fe.definition.validate,!et)return;if(et===void 0)throw new Error('custom keyword "'+Fe.keyword+'"failed to compile');var Ne=P.length;return P[Ne]=et,{code:"customRule"+Ne,validate:et}}}function o6(t,e,r){var n=UM.call(this,t,e,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:t,root:e,baseId:r},{index:n,compiling:!1})}function a6(t,e,r){var n=UM.call(this,t,e,r);n>=0&&this._compilations.splice(n,1)}function UM(t,e,r){for(var n=0;n<this._compilations.length;n++){var s=this._compilations[n];if(s.schema==t&&s.root==e&&s.baseId==r)return n}return-1}function l6(t,e){return"var pattern"+t+" = new RegExp("+ly.toQuotedString(e[t])+");"}function c6(t){return"var default"+t+" = defaults["+t+"];"}function u6(t,e){return e[t]===void 0?"":"var refVal"+t+" = refVal["+t+"];"}function h6(t){return"var customRule"+t+" = customRules["+t+"];"}function a_(t,e){if(!t.length)return"";for(var r="",n=0;n<t.length;n++)r+=e(n,t);return r}var GM={exports:{}},ov=GM.exports=function(){this._cache={}};ov.prototype.put=function(e,r){this._cache[e]=r};ov.prototype.get=function(e){return this._cache[e]};ov.prototype.del=function(e){delete this._cache[e]};ov.prototype.clear=function(){this._cache={}};var d6=dd,f6=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,p6=[0,31,28,31,30,31,30,31,31,30,31,30,31],m6=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,HM=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,g6=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,_6=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,WM=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,ZM=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,qM=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,KM=/^(?:\/(?:[^~/]|~0|~1)*)*$/,XM=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,YM=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,y6=av;function av(t){return t=t=="full"?"full":"fast",d6.copy(av[t])}av.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":WM,url:ZM,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:HM,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:eO,uuid:qM,"json-pointer":KM,"json-pointer-uri-fragment":XM,"relative-json-pointer":YM};av.full={date:JM,time:QM,"date-time":b6,uri:E6,"uri-reference":_6,"uri-template":WM,url:ZM,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:HM,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:eO,uuid:qM,"json-pointer":KM,"json-pointer-uri-fragment":XM,"relative-json-pointer":YM};function v6(t){return t%4===0&&(t%100!==0||t%400===0)}function JM(t){var e=t.match(f6);if(!e)return!1;var r=+e[1],n=+e[2],s=+e[3];return n>=1&&n<=12&&s>=1&&s<=(n==2&&v6(r)?29:p6[n])}function QM(t,e){var r=t.match(m6);if(!r)return!1;var n=r[1],s=r[2],u=r[3],d=r[5];return(n<=23&&s<=59&&u<=59||n==23&&s==59&&u==60)&&(!e||d)}var x6=/t|\s/i;function b6(t){var e=t.split(x6);return e.length==2&&JM(e[0])&&QM(e[1],!0)}var w6=/\/|:/;function E6(t){return w6.test(t)&&g6.test(t)}var T6=/[^\\]\\Z/;function eO(t){if(T6.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}var S6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.errSchemaPath+"/"+r,x=!e.opts.allErrors,E="data"+(d||""),S="valid"+u,P,I;if(o=="#"||o=="#/")e.isRoot?(P=e.async,I="validate"):(P=e.root.schema.$async===!0,I="root.refVal[0]");else{var R=e.resolveRef(e.baseId,o,e.isRoot);if(R===void 0){var z=e.MissingRefError.message(e.baseId,o);if(e.opts.missingRefs=="fail"){e.logger.error(z);var B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { ref: '"+e.util.escapeQuotes(o)+"' } ",e.opts.messages!==!1&&(s+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(o)+"' "),e.opts.verbose&&(s+=" , schema: "+e.util.toQuotedString(o)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+E+" "),s+=" } "):s+=" {} ";var $=s;s=B.pop(),!e.compositeRule&&x?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x&&(s+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(z),x&&(s+=" if (true) { ");else throw new e.MissingRefError(e.baseId,o,z)}else if(R.inline){var j=e.util.copy(e);j.level++;var G="valid"+j.level;j.schema=R.schema,j.schemaPath="",j.errSchemaPath=o;var K=e.validate(j).replace(/validate\.schema/g,R.code);s+=" "+K+" ",x&&(s+=" if ("+G+") { ")}else P=R.$async===!0||e.async&&R.$async!==!1,I=R.code}if(I){var B=B||[];B.push(s),s="",e.opts.passContext?s+=" "+I+".call(this, ":s+=" "+I+"( ",s+=" "+E+", (dataPath || '')",e.errorPath!='""'&&(s+=" + "+e.errorPath);var X=d?"data"+(d-1||""):"parentData",re=d?e.dataPathArr[d]:"parentDataProperty";s+=" , "+X+" , "+re+", rootData)  ";var ue=s;if(s=B.pop(),P){if(!e.async)throw new Error("async schema referenced by sync schema");x&&(s+=" var "+S+"; "),s+=" try { await "+ue+"; ",x&&(s+=" "+S+" = true; "),s+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",x&&(s+=" "+S+" = false; "),s+=" } ",x&&(s+=" if ("+S+") { ")}else s+=" if (!"+ue+") { if (vErrors === null) vErrors = "+I+".errors; else vErrors = vErrors.concat("+I+".errors); errors = vErrors.length; } ",x&&(s+=" else { ")}return s},A6=function(e,r,n){var s=" ",u=e.schema[r],d=e.schemaPath+e.util.getProperty(r),o=e.errSchemaPath+"/"+r,g=!e.opts.allErrors,x=e.util.copy(e),E="";x.level++;var S="valid"+x.level,P=x.baseId,I=!0,R=u;if(R)for(var z,B=-1,$=R.length-1;B<$;)z=R[B+=1],(e.opts.strictKeywords?typeof z=="object"&&Object.keys(z).length>0||z===!1:e.util.schemaHasRules(z,e.RULES.all))&&(I=!1,x.schema=z,x.schemaPath=d+"["+B+"]",x.errSchemaPath=o+"/"+B,s+="  "+e.validate(x)+" ",x.baseId=P,g&&(s+=" if ("+S+") { ",E+="}"));return g&&(I?s+=" if (true) { ":s+=" "+E.slice(0,-1)+" "),s},P6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I="errs__"+u,R=e.util.copy(e),z="";R.level++;var B="valid"+R.level,$=o.every(function(ne){return e.opts.strictKeywords?typeof ne=="object"&&Object.keys(ne).length>0||ne===!1:e.util.schemaHasRules(ne,e.RULES.all)});if($){var j=R.baseId;s+=" var "+I+" = errors; var "+P+" = false;  ";var G=e.compositeRule;e.compositeRule=R.compositeRule=!0;var K=o;if(K)for(var X,re=-1,ue=K.length-1;re<ue;)X=K[re+=1],R.schema=X,R.schemaPath=g+"["+re+"]",R.errSchemaPath=x+"/"+re,s+="  "+e.validate(R)+" ",R.baseId=j,s+=" "+P+" = "+P+" || "+B+"; if (!"+P+") { ",z+="}";e.compositeRule=R.compositeRule=G,s+=" "+z+" if (!"+P+") {   var err =   ",e.createErrors!==!1?(s+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: {} ",e.opts.messages!==!1&&(s+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&E&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; "),s+=" } else {  errors = "+I+"; if (vErrors !== null) { if ("+I+") vErrors.length = "+I+"; else vErrors = null; } ",e.opts.allErrors&&(s+=" } ")}else E&&(s+=" if (true) { ");return s},C6=function(e,r,n){var s=" ",u=e.schema[r],d=e.errSchemaPath+"/"+r;e.opts.allErrors;var o=e.util.toQuotedString(u);return e.opts.$comment===!0?s+=" console.log("+o+");":typeof e.opts.$comment=="function"&&(s+=" self._opts.$comment("+o+", "+e.util.toQuotedString(d)+", validate.root.schema);"),s},I6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I=e.opts.$data&&o&&o.$data;I&&(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; "),I||(s+=" var schema"+u+" = validate.schema"+g+";"),s+="var "+P+" = equal("+S+", schema"+u+"); if (!"+P+") {   ";var R=R||[];R.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { allowedValue: schema"+u+" } ",e.opts.messages!==!1&&(s+=" , message: 'should be equal to constant' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var z=s;return s=R.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+z+"]); ":s+=" validate.errors = ["+z+"]; return false; ":s+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" }",E&&(s+=" else { "),s},M6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I="errs__"+u,R=e.util.copy(e),z="";R.level++;var B="valid"+R.level,$="i"+u,j=R.dataLevel=e.dataLevel+1,G="data"+j,K=e.baseId,X=e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all);if(s+="var "+I+" = errors;var "+P+";",X){var re=e.compositeRule;e.compositeRule=R.compositeRule=!0,R.schema=o,R.schemaPath=g,R.errSchemaPath=x,s+=" var "+B+" = false; for (var "+$+" = 0; "+$+" < "+S+".length; "+$+"++) { ",R.errorPath=e.util.getPathExpr(e.errorPath,$,e.opts.jsonPointers,!0);var ue=S+"["+$+"]";R.dataPathArr[j]=$;var ne=e.validate(R);R.baseId=K,e.util.varOccurences(ne,G)<2?s+=" "+e.util.varReplace(ne,G,ue)+" ":s+=" var "+G+" = "+ue+"; "+ne+" ",s+=" if ("+B+") break; }  ",e.compositeRule=R.compositeRule=re,s+=" "+z+" if (!"+B+") {"}else s+=" if ("+S+".length == 0) {";var we=we||[];we.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: {} ",e.opts.messages!==!1&&(s+=" , message: 'should contain a valid item' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var xe=s;return s=we.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+xe+"]); ":s+=" validate.errors = ["+xe+"]; return false; ":s+=" var err = "+xe+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } else { ",X&&(s+="  errors = "+I+"; if (vErrors !== null) { if ("+I+") vErrors.length = "+I+"; else vErrors = null; } "),e.opts.allErrors&&(s+=" } "),s},O6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="errs__"+u,I=e.util.copy(e),R="";I.level++;var z="valid"+I.level,B={},$={},j=e.opts.ownProperties;for(re in o)if(re!="__proto__"){var G=o[re],K=Array.isArray(G)?$:B;K[re]=G}s+="var "+P+" = errors;";var X=e.errorPath;s+="var missing"+u+";";for(var re in $)if(K=$[re],K.length){if(s+=" if ( "+S+e.util.getProperty(re)+" !== undefined ",j&&(s+=" && Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(re)+"') "),E){s+=" && ( ";var ue=K;if(ue)for(var ne,we=-1,xe=ue.length-1;we<xe;){ne=ue[we+=1],we&&(s+=" || ");var ke=e.util.getProperty(ne),Ie=S+ke;s+=" ( ( "+Ie+" === undefined ",j&&(s+=" || ! Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(ne)+"') "),s+=") && (missing"+u+" = "+e.util.toQuotedString(e.opts.jsonPointers?ne:ke)+") ) "}s+=")) {  ";var Fe="missing"+u,se="' + "+Fe+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(X,Fe,!0):X+" + "+Fe);var Be=Be||[];Be.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { property: '"+e.util.escapeQuotes(re)+"', missingProperty: '"+se+"', depsCount: "+K.length+", deps: '"+e.util.escapeQuotes(K.length==1?K[0]:K.join(", "))+"' } ",e.opts.messages!==!1&&(s+=" , message: 'should have ",K.length==1?s+="property "+e.util.escapeQuotes(K[0]):s+="properties "+e.util.escapeQuotes(K.join(", ")),s+=" when property "+e.util.escapeQuotes(re)+" is present' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var Ve=s;s=Be.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+Ve+"]); ":s+=" validate.errors = ["+Ve+"]; return false; ":s+=" var err = "+Ve+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{s+=" ) { ";var Je=K;if(Je)for(var ne,ut=-1,ht=Je.length-1;ut<ht;){ne=Je[ut+=1];var ke=e.util.getProperty(ne),se=e.util.escapeQuotes(ne),Ie=S+ke;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(X,ne,e.opts.jsonPointers)),s+=" if ( "+Ie+" === undefined ",j&&(s+=" || ! Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(ne)+"') "),s+=") {  var err =   ",e.createErrors!==!1?(s+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { property: '"+e.util.escapeQuotes(re)+"', missingProperty: '"+se+"', depsCount: "+K.length+", deps: '"+e.util.escapeQuotes(K.length==1?K[0]:K.join(", "))+"' } ",e.opts.messages!==!1&&(s+=" , message: 'should have ",K.length==1?s+="property "+e.util.escapeQuotes(K[0]):s+="properties "+e.util.escapeQuotes(K.join(", ")),s+=" when property "+e.util.escapeQuotes(re)+" is present' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}s+=" }   ",E&&(R+="}",s+=" else { ")}e.errorPath=X;var Et=I.baseId;for(var re in B){var G=B[re];(e.opts.strictKeywords?typeof G=="object"&&Object.keys(G).length>0||G===!1:e.util.schemaHasRules(G,e.RULES.all))&&(s+=" "+z+" = true; if ( "+S+e.util.getProperty(re)+" !== undefined ",j&&(s+=" && Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(re)+"') "),s+=") { ",I.schema=G,I.schemaPath=g+e.util.getProperty(re),I.errSchemaPath=x+"/"+e.util.escapeFragment(re),s+="  "+e.validate(I)+" ",I.baseId=Et,s+=" }  ",E&&(s+=" if ("+z+") { ",R+="}"))}return E&&(s+="   "+R+" if ("+P+" == errors) {"),s},D6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I=e.opts.$data&&o&&o.$data;I&&(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ");var R="i"+u,z="schema"+u;I||(s+=" var "+z+" = validate.schema"+g+";"),s+="var "+P+";",I&&(s+=" if (schema"+u+" === undefined) "+P+" = true; else if (!Array.isArray(schema"+u+")) "+P+" = false; else {"),s+=""+P+" = false;for (var "+R+"=0; "+R+"<"+z+".length; "+R+"++) if (equal("+S+", "+z+"["+R+"])) { "+P+" = true; break; }",I&&(s+="  }  "),s+=" if (!"+P+") {   ";var B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { allowedValues: schema"+u+" } ",e.opts.messages!==!1&&(s+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var $=s;return s=B.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" }",E&&(s+=" else { "),s},R6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||"");if(e.opts.format===!1)return E&&(s+=" if (true) { "),s;var P=e.opts.$data&&o&&o.$data,I;P?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",I="schema"+u):I=o;var R=e.opts.unknownFormats,z=Array.isArray(R);if(P){var B="format"+u,$="isObject"+u,j="formatType"+u;s+=" var "+B+" = formats["+I+"]; var "+$+" = typeof "+B+" == 'object' && !("+B+" instanceof RegExp) && "+B+".validate; var "+j+" = "+$+" && "+B+".type || 'string'; if ("+$+") { ",e.async&&(s+=" var async"+u+" = "+B+".async; "),s+=" "+B+" = "+B+".validate; } if (  ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'string') || "),s+=" (",R!="ignore"&&(s+=" ("+I+" && !"+B+" ",z&&(s+=" && self._opts.unknownFormats.indexOf("+I+") == -1 "),s+=") || "),s+=" ("+B+" && "+j+" == '"+n+"' && !(typeof "+B+" == 'function' ? ",e.async?s+=" (async"+u+" ? await "+B+"("+S+") : "+B+"("+S+")) ":s+=" "+B+"("+S+") ",s+=" : "+B+".test("+S+"))))) {"}else{var B=e.formats[o];if(!B){if(R=="ignore")return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),E&&(s+=" if (true) { "),s;if(z&&R.indexOf(o)>=0)return E&&(s+=" if (true) { "),s;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var $=typeof B=="object"&&!(B instanceof RegExp)&&B.validate,j=$&&B.type||"string";if($){var G=B.async===!0;B=B.validate}if(j!=n)return E&&(s+=" if (true) { "),s;if(G){if(!e.async)throw new Error("async format in sync schema");var K="formats"+e.util.getProperty(o)+".validate";s+=" if (!(await "+K+"("+S+"))) { "}else{s+=" if (! ";var K="formats"+e.util.getProperty(o);$&&(K+=".validate"),typeof B=="function"?s+=" "+K+"("+S+") ":s+=" "+K+".test("+S+") ",s+=") { "}}var X=X||[];X.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { format:  ",P?s+=""+I:s+=""+e.util.toQuotedString(o),s+="  } ",e.opts.messages!==!1&&(s+=` , message: 'should match format "`,P?s+="' + "+I+" + '":s+=""+e.util.escapeQuotes(o),s+=`"' `),e.opts.verbose&&(s+=" , schema:  ",P?s+="validate.schema"+g:s+=""+e.util.toQuotedString(o),s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var re=s;return s=X.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+re+"]); ":s+=" validate.errors = ["+re+"]; return false; ":s+=" var err = "+re+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",E&&(s+=" else { "),s},L6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I="errs__"+u,R=e.util.copy(e);R.level++;var z="valid"+R.level,B=e.schema.then,$=e.schema.else,j=B!==void 0&&(e.opts.strictKeywords?typeof B=="object"&&Object.keys(B).length>0||B===!1:e.util.schemaHasRules(B,e.RULES.all)),G=$!==void 0&&(e.opts.strictKeywords?typeof $=="object"&&Object.keys($).length>0||$===!1:e.util.schemaHasRules($,e.RULES.all)),K=R.baseId;if(j||G){var X;R.createErrors=!1,R.schema=o,R.schemaPath=g,R.errSchemaPath=x,s+=" var "+I+" = errors; var "+P+" = true;  ";var re=e.compositeRule;e.compositeRule=R.compositeRule=!0,s+="  "+e.validate(R)+" ",R.baseId=K,R.createErrors=!0,s+="  errors = "+I+"; if (vErrors !== null) { if ("+I+") vErrors.length = "+I+"; else vErrors = null; }  ",e.compositeRule=R.compositeRule=re,j?(s+=" if ("+z+") {  ",R.schema=e.schema.then,R.schemaPath=e.schemaPath+".then",R.errSchemaPath=e.errSchemaPath+"/then",s+="  "+e.validate(R)+" ",R.baseId=K,s+=" "+P+" = "+z+"; ",j&&G?(X="ifClause"+u,s+=" var "+X+" = 'then'; "):X="'then'",s+=" } ",G&&(s+=" else { ")):s+=" if (!"+z+") { ",G&&(R.schema=e.schema.else,R.schemaPath=e.schemaPath+".else",R.errSchemaPath=e.errSchemaPath+"/else",s+="  "+e.validate(R)+" ",R.baseId=K,s+=" "+P+" = "+z+"; ",j&&G?(X="ifClause"+u,s+=" var "+X+" = 'else'; "):X="'else'",s+=" } "),s+=" if (!"+P+") {   var err =   ",e.createErrors!==!1?(s+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { failingKeyword: "+X+" } ",e.opts.messages!==!1&&(s+=` , message: 'should match "' + `+X+` + '" schema' `),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&E&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; "),s+=" }   ",E&&(s+=" else { ")}else E&&(s+=" if (true) { ");return s},k6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I="errs__"+u,R=e.util.copy(e),z="";R.level++;var B="valid"+R.level,$="i"+u,j=R.dataLevel=e.dataLevel+1,G="data"+j,K=e.baseId;if(s+="var "+I+" = errors;var "+P+";",Array.isArray(o)){var X=e.schema.additionalItems;if(X===!1){s+=" "+P+" = "+S+".length <= "+o.length+"; ";var re=x;x=e.errSchemaPath+"/additionalItems",s+="  if (!"+P+") {   ";var ue=ue||[];ue.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { limit: "+o.length+" } ",e.opts.messages!==!1&&(s+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(s+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var ne=s;s=ue.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+ne+"]); ":s+=" validate.errors = ["+ne+"]; return false; ":s+=" var err = "+ne+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",x=re,E&&(z+="}",s+=" else { ")}var we=o;if(we){for(var xe,ke=-1,Ie=we.length-1;ke<Ie;)if(xe=we[ke+=1],e.opts.strictKeywords?typeof xe=="object"&&Object.keys(xe).length>0||xe===!1:e.util.schemaHasRules(xe,e.RULES.all)){s+=" "+B+" = true; if ("+S+".length > "+ke+") { ";var Fe=S+"["+ke+"]";R.schema=xe,R.schemaPath=g+"["+ke+"]",R.errSchemaPath=x+"/"+ke,R.errorPath=e.util.getPathExpr(e.errorPath,ke,e.opts.jsonPointers,!0),R.dataPathArr[j]=ke;var se=e.validate(R);R.baseId=K,e.util.varOccurences(se,G)<2?s+=" "+e.util.varReplace(se,G,Fe)+" ":s+=" var "+G+" = "+Fe+"; "+se+" ",s+=" }  ",E&&(s+=" if ("+B+") { ",z+="}")}}if(typeof X=="object"&&(e.opts.strictKeywords?typeof X=="object"&&Object.keys(X).length>0||X===!1:e.util.schemaHasRules(X,e.RULES.all))){R.schema=X,R.schemaPath=e.schemaPath+".additionalItems",R.errSchemaPath=e.errSchemaPath+"/additionalItems",s+=" "+B+" = true; if ("+S+".length > "+o.length+") {  for (var "+$+" = "+o.length+"; "+$+" < "+S+".length; "+$+"++) { ",R.errorPath=e.util.getPathExpr(e.errorPath,$,e.opts.jsonPointers,!0);var Fe=S+"["+$+"]";R.dataPathArr[j]=$;var se=e.validate(R);R.baseId=K,e.util.varOccurences(se,G)<2?s+=" "+e.util.varReplace(se,G,Fe)+" ":s+=" var "+G+" = "+Fe+"; "+se+" ",E&&(s+=" if (!"+B+") break; "),s+=" } }  ",E&&(s+=" if ("+B+") { ",z+="}")}}else if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){R.schema=o,R.schemaPath=g,R.errSchemaPath=x,s+="  for (var "+$+" = "+0+"; "+$+" < "+S+".length; "+$+"++) { ",R.errorPath=e.util.getPathExpr(e.errorPath,$,e.opts.jsonPointers,!0);var Fe=S+"["+$+"]";R.dataPathArr[j]=$;var se=e.validate(R);R.baseId=K,e.util.varOccurences(se,G)<2?s+=" "+e.util.varReplace(se,G,Fe)+" ":s+=" var "+G+" = "+Fe+"; "+se+" ",E&&(s+=" if (!"+B+") break; "),s+=" }"}return E&&(s+=" "+z+" if ("+I+" == errors) {"),s},vA=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,K,S="data"+(d||""),P=e.opts.$data&&o&&o.$data,I;P?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",I="schema"+u):I=o;var R=r=="maximum",z=R?"exclusiveMaximum":"exclusiveMinimum",B=e.schema[z],$=e.opts.$data&&B&&B.$data,j=R?"<":">",G=R?">":"<",K=void 0;if(!(P||typeof o=="number"||o===void 0))throw new Error(r+" must be number");if(!($||B===void 0||typeof B=="number"||typeof B=="boolean"))throw new Error(z+" must be number or boolean");if($){var X=e.util.getData(B.$data,d,e.dataPathArr),re="exclusive"+u,ue="exclType"+u,ne="exclIsNumber"+u,we="op"+u,xe="' + "+we+" + '";s+=" var schemaExcl"+u+" = "+X+"; ",X="schemaExcl"+u,s+=" var "+re+"; var "+ue+" = typeof "+X+"; if ("+ue+" != 'boolean' && "+ue+" != 'undefined' && "+ue+" != 'number') { ";var K=z,ke=ke||[];ke.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(K||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: {} ",e.opts.messages!==!1&&(s+=" , message: '"+z+" should be boolean' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var Ie=s;s=ke.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+Ie+"]); ":s+=" validate.errors = ["+Ie+"]; return false; ":s+=" var err = "+Ie+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } else if ( ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'number') || "),s+=" "+ue+" == 'number' ? ( ("+re+" = "+I+" === undefined || "+X+" "+j+"= "+I+") ? "+S+" "+G+"= "+X+" : "+S+" "+G+" "+I+" ) : ( ("+re+" = "+X+" === true) ? "+S+" "+G+"= "+I+" : "+S+" "+G+" "+I+" ) || "+S+" !== "+S+") { var op"+u+" = "+re+" ? '"+j+"' : '"+j+"='; ",o===void 0&&(K=z,x=e.errSchemaPath+"/"+z,I=X,P=$)}else{var ne=typeof B=="number",xe=j;if(ne&&P){var we="'"+xe+"'";s+=" if ( ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'number') || "),s+=" ( "+I+" === undefined || "+B+" "+j+"= "+I+" ? "+S+" "+G+"= "+B+" : "+S+" "+G+" "+I+" ) || "+S+" !== "+S+") { "}else{ne&&o===void 0?(re=!0,K=z,x=e.errSchemaPath+"/"+z,I=B,G+="="):(ne&&(I=Math[R?"min":"max"](B,o)),B===(ne?I:!0)?(re=!0,K=z,x=e.errSchemaPath+"/"+z,G+="="):(re=!1,xe+="="));var we="'"+xe+"'";s+=" if ( ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'number') || "),s+=" "+S+" "+G+" "+I+" || "+S+" !== "+S+") { "}}K=K||r;var ke=ke||[];ke.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(K||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { comparison: "+we+", limit: "+I+", exclusive: "+re+" } ",e.opts.messages!==!1&&(s+=" , message: 'should be "+xe+" ",P?s+="' + "+I:s+=""+I+"'"),e.opts.verbose&&(s+=" , schema:  ",P?s+="validate.schema"+g:s+=""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var Ie=s;return s=ke.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+Ie+"]); ":s+=" validate.errors = ["+Ie+"]; return false; ":s+=" var err = "+Ie+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",E&&(s+=" else { "),s},xA=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,z,S="data"+(d||""),P=e.opts.$data&&o&&o.$data,I;if(P?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",I="schema"+u):I=o,!(P||typeof o=="number"))throw new Error(r+" must be number");var R=r=="maxItems"?">":"<";s+="if ( ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'number') || "),s+=" "+S+".length "+R+" "+I+") { ";var z=r,B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(z||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { limit: "+I+" } ",e.opts.messages!==!1&&(s+=" , message: 'should NOT have ",r=="maxItems"?s+="more":s+="fewer",s+=" than ",P?s+="' + "+I+" + '":s+=""+o,s+=" items' "),e.opts.verbose&&(s+=" , schema:  ",P?s+="validate.schema"+g:s+=""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var $=s;return s=B.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",E&&(s+=" else { "),s},bA=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,z,S="data"+(d||""),P=e.opts.$data&&o&&o.$data,I;if(P?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",I="schema"+u):I=o,!(P||typeof o=="number"))throw new Error(r+" must be number");var R=r=="maxLength"?">":"<";s+="if ( ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'number') || "),e.opts.unicode===!1?s+=" "+S+".length ":s+=" ucs2length("+S+") ",s+=" "+R+" "+I+") { ";var z=r,B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(z||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { limit: "+I+" } ",e.opts.messages!==!1&&(s+=" , message: 'should NOT be ",r=="maxLength"?s+="longer":s+="shorter",s+=" than ",P?s+="' + "+I+" + '":s+=""+o,s+=" characters' "),e.opts.verbose&&(s+=" , schema:  ",P?s+="validate.schema"+g:s+=""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var $=s;return s=B.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",E&&(s+=" else { "),s},wA=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,z,S="data"+(d||""),P=e.opts.$data&&o&&o.$data,I;if(P?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",I="schema"+u):I=o,!(P||typeof o=="number"))throw new Error(r+" must be number");var R=r=="maxProperties"?">":"<";s+="if ( ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'number') || "),s+=" Object.keys("+S+").length "+R+" "+I+") { ";var z=r,B=B||[];B.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(z||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { limit: "+I+" } ",e.opts.messages!==!1&&(s+=" , message: 'should NOT have ",r=="maxProperties"?s+="more":s+="fewer",s+=" than ",P?s+="' + "+I+" + '":s+=""+o,s+=" properties' "),e.opts.verbose&&(s+=" , schema:  ",P?s+="validate.schema"+g:s+=""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var $=s;return s=B.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+$+"]); ":s+=" validate.errors = ["+$+"]; return false; ":s+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",E&&(s+=" else { "),s},z6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P=e.opts.$data&&o&&o.$data,I;if(P?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",I="schema"+u):I=o,!(P||typeof o=="number"))throw new Error(r+" must be number");s+="var division"+u+";if (",P&&(s+=" "+I+" !== undefined && ( typeof "+I+" != 'number' || "),s+=" (division"+u+" = "+S+" / "+I+", ",e.opts.multipleOfPrecision?s+=" Math.abs(Math.round(division"+u+") - division"+u+") > 1e-"+e.opts.multipleOfPrecision+" ":s+=" division"+u+" !== parseInt(division"+u+") ",s+=" ) ",P&&(s+="  )  "),s+=" ) {   ";var R=R||[];R.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { multipleOf: "+I+" } ",e.opts.messages!==!1&&(s+=" , message: 'should be multiple of ",P?s+="' + "+I:s+=""+I+"'"),e.opts.verbose&&(s+=" , schema:  ",P?s+="validate.schema"+g:s+=""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var z=s;return s=R.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+z+"]); ":s+=" validate.errors = ["+z+"]; return false; ":s+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",E&&(s+=" else { "),s},F6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="errs__"+u,I=e.util.copy(e);I.level++;var R="valid"+I.level;if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){I.schema=o,I.schemaPath=g,I.errSchemaPath=x,s+=" var "+P+" = errors;  ";var z=e.compositeRule;e.compositeRule=I.compositeRule=!0,I.createErrors=!1;var B;I.opts.allErrors&&(B=I.opts.allErrors,I.opts.allErrors=!1),s+=" "+e.validate(I)+" ",I.createErrors=!0,B&&(I.opts.allErrors=B),e.compositeRule=I.compositeRule=z,s+=" if ("+R+") {   ";var $=$||[];$.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: {} ",e.opts.messages!==!1&&(s+=" , message: 'should NOT be valid' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var j=s;s=$.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+j+"]); ":s+=" validate.errors = ["+j+"]; return false; ":s+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } else {  errors = "+P+"; if (vErrors !== null) { if ("+P+") vErrors.length = "+P+"; else vErrors = null; } ",e.opts.allErrors&&(s+=" } ")}else s+="  var err =   ",e.createErrors!==!1?(s+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: {} ",e.opts.messages!==!1&&(s+=" , message: 'should NOT be valid' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",E&&(s+=" if (false) { ");return s},B6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I="errs__"+u,R=e.util.copy(e),z="";R.level++;var B="valid"+R.level,$=R.baseId,j="prevValid"+u,G="passingSchemas"+u;s+="var "+I+" = errors , "+j+" = false , "+P+" = false , "+G+" = null; ";var K=e.compositeRule;e.compositeRule=R.compositeRule=!0;var X=o;if(X)for(var re,ue=-1,ne=X.length-1;ue<ne;)re=X[ue+=1],(e.opts.strictKeywords?typeof re=="object"&&Object.keys(re).length>0||re===!1:e.util.schemaHasRules(re,e.RULES.all))?(R.schema=re,R.schemaPath=g+"["+ue+"]",R.errSchemaPath=x+"/"+ue,s+="  "+e.validate(R)+" ",R.baseId=$):s+=" var "+B+" = true; ",ue&&(s+=" if ("+B+" && "+j+") { "+P+" = false; "+G+" = ["+G+", "+ue+"]; } else { ",z+="}"),s+=" if ("+B+") { "+P+" = "+j+" = true; "+G+" = "+ue+"; }";return e.compositeRule=R.compositeRule=K,s+=""+z+"if (!"+P+") {   var err =   ",e.createErrors!==!1?(s+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { passingSchemas: "+G+" } ",e.opts.messages!==!1&&(s+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&E&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; "),s+="} else {  errors = "+I+"; if (vErrors !== null) { if ("+I+") vErrors.length = "+I+"; else vErrors = null; }",e.opts.allErrors&&(s+=" } "),s},N6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P=e.opts.$data&&o&&o.$data,I;P?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",I="schema"+u):I=o;var R=P?"(new RegExp("+I+"))":e.usePattern(o);s+="if ( ",P&&(s+=" ("+I+" !== undefined && typeof "+I+" != 'string') || "),s+=" !"+R+".test("+S+") ) {   ";var z=z||[];z.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { pattern:  ",P?s+=""+I:s+=""+e.util.toQuotedString(o),s+="  } ",e.opts.messages!==!1&&(s+=` , message: 'should match pattern "`,P?s+="' + "+I+" + '":s+=""+e.util.escapeQuotes(o),s+=`"' `),e.opts.verbose&&(s+=" , schema:  ",P?s+="validate.schema"+g:s+=""+e.util.toQuotedString(o),s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var B=s;return s=z.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+B+"]); ":s+=" validate.errors = ["+B+"]; return false; ":s+=" var err = "+B+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",E&&(s+=" else { "),s},j6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="errs__"+u,I=e.util.copy(e),R="";I.level++;var z="valid"+I.level,B="key"+u,$="idx"+u,j=I.dataLevel=e.dataLevel+1,G="data"+j,K="dataProperties"+u,X=Object.keys(o||{}).filter(ut),re=e.schema.patternProperties||{},ue=Object.keys(re).filter(ut),ne=e.schema.additionalProperties,we=X.length||ue.length,xe=ne===!1,ke=typeof ne=="object"&&Object.keys(ne).length,Ie=e.opts.removeAdditional,Fe=xe||ke||Ie,se=e.opts.ownProperties,Be=e.baseId,Ve=e.schema.required;if(Ve&&!(e.opts.$data&&Ve.$data)&&Ve.length<e.opts.loopRequired)var Je=e.util.toHash(Ve);function ut(xr){return xr!=="__proto__"}if(s+="var "+P+" = errors;var "+z+" = true;",se&&(s+=" var "+K+" = undefined;"),Fe){if(se?s+=" "+K+" = "+K+" || Object.keys("+S+"); for (var "+$+"=0; "+$+"<"+K+".length; "+$+"++) { var "+B+" = "+K+"["+$+"]; ":s+=" for (var "+B+" in "+S+") { ",we){if(s+=" var isAdditional"+u+" = !(false ",X.length)if(X.length>8)s+=" || validate.schema"+g+".hasOwnProperty("+B+") ";else{var ht=X;if(ht)for(var Et,Qt=-1,Nt=ht.length-1;Qt<Nt;)Et=ht[Qt+=1],s+=" || "+B+" == "+e.util.toQuotedString(Et)+" "}if(ue.length){var yt=ue;if(yt)for(var et,Ne=-1,tt=yt.length-1;Ne<tt;)et=yt[Ne+=1],s+=" || "+e.usePattern(et)+".test("+B+") "}s+=" ); if (isAdditional"+u+") { "}if(Ie=="all")s+=" delete "+S+"["+B+"]; ";else{var ft=e.errorPath,mt="' + "+B+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,B,e.opts.jsonPointers)),xe)if(Ie)s+=" delete "+S+"["+B+"]; ";else{s+=" "+z+" = false; ";var Ht=x;x=e.errSchemaPath+"/additionalProperties";var Zt=Zt||[];Zt.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { additionalProperty: '"+mt+"' } ",e.opts.messages!==!1&&(s+=" , message: '",e.opts._errorDataPathProperty?s+="is an invalid additional property":s+="should NOT have additional properties",s+="' "),e.opts.verbose&&(s+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var Lt=s;s=Zt.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+Lt+"]); ":s+=" validate.errors = ["+Lt+"]; return false; ":s+=" var err = "+Lt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x=Ht,E&&(s+=" break; ")}else if(ke)if(Ie=="failing"){s+=" var "+P+" = errors;  ";var ye=e.compositeRule;e.compositeRule=I.compositeRule=!0,I.schema=ne,I.schemaPath=e.schemaPath+".additionalProperties",I.errSchemaPath=e.errSchemaPath+"/additionalProperties",I.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,B,e.opts.jsonPointers);var Me=S+"["+B+"]";I.dataPathArr[j]=B;var $e=e.validate(I);I.baseId=Be,e.util.varOccurences($e,G)<2?s+=" "+e.util.varReplace($e,G,Me)+" ":s+=" var "+G+" = "+Me+"; "+$e+" ",s+=" if (!"+z+") { errors = "+P+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+S+"["+B+"]; }  ",e.compositeRule=I.compositeRule=ye}else{I.schema=ne,I.schemaPath=e.schemaPath+".additionalProperties",I.errSchemaPath=e.errSchemaPath+"/additionalProperties",I.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,B,e.opts.jsonPointers);var Me=S+"["+B+"]";I.dataPathArr[j]=B;var $e=e.validate(I);I.baseId=Be,e.util.varOccurences($e,G)<2?s+=" "+e.util.varReplace($e,G,Me)+" ":s+=" var "+G+" = "+Me+"; "+$e+" ",E&&(s+=" if (!"+z+") break; ")}e.errorPath=ft}we&&(s+=" } "),s+=" }  ",E&&(s+=" if ("+z+") { ",R+="}")}var it=e.opts.useDefaults&&!e.compositeRule;if(X.length){var ot=X;if(ot)for(var Et,st=-1,gt=ot.length-1;st<gt;){Et=ot[st+=1];var lt=o[Et];if(e.opts.strictKeywords?typeof lt=="object"&&Object.keys(lt).length>0||lt===!1:e.util.schemaHasRules(lt,e.RULES.all)){var Ye=e.util.getProperty(Et),Me=S+Ye,pt=it&&lt.default!==void 0;I.schema=lt,I.schemaPath=g+Ye,I.errSchemaPath=x+"/"+e.util.escapeFragment(Et),I.errorPath=e.util.getPath(e.errorPath,Et,e.opts.jsonPointers),I.dataPathArr[j]=e.util.toQuotedString(Et);var $e=e.validate(I);if(I.baseId=Be,e.util.varOccurences($e,G)<2){$e=e.util.varReplace($e,G,Me);var Tt=Me}else{var Tt=G;s+=" var "+G+" = "+Me+"; "}if(pt)s+=" "+$e+" ";else{if(Je&&Je[Et]){s+=" if ( "+Tt+" === undefined ",se&&(s+=" || ! Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(Et)+"') "),s+=") { "+z+" = false; ";var ft=e.errorPath,Ht=x,St=e.util.escapeQuotes(Et);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(ft,Et,e.opts.jsonPointers)),x=e.errSchemaPath+"/required";var Zt=Zt||[];Zt.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { missingProperty: '"+St+"' } ",e.opts.messages!==!1&&(s+=" , message: '",e.opts._errorDataPathProperty?s+="is a required property":s+="should have required property \\'"+St+"\\'",s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var Lt=s;s=Zt.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+Lt+"]); ":s+=" validate.errors = ["+Lt+"]; return false; ":s+=" var err = "+Lt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x=Ht,e.errorPath=ft,s+=" } else { "}else E?(s+=" if ( "+Tt+" === undefined ",se&&(s+=" || ! Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(Et)+"') "),s+=") { "+z+" = true; } else { "):(s+=" if ("+Tt+" !== undefined ",se&&(s+=" &&   Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(Et)+"') "),s+=" ) { ");s+=" "+$e+" } "}}E&&(s+=" if ("+z+") { ",R+="}")}}if(ue.length){var zt=ue;if(zt)for(var et,Yt=-1,ur=zt.length-1;Yt<ur;){et=zt[Yt+=1];var lt=re[et];if(e.opts.strictKeywords?typeof lt=="object"&&Object.keys(lt).length>0||lt===!1:e.util.schemaHasRules(lt,e.RULES.all)){I.schema=lt,I.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(et),I.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(et),se?s+=" "+K+" = "+K+" || Object.keys("+S+"); for (var "+$+"=0; "+$+"<"+K+".length; "+$+"++) { var "+B+" = "+K+"["+$+"]; ":s+=" for (var "+B+" in "+S+") { ",s+=" if ("+e.usePattern(et)+".test("+B+")) { ",I.errorPath=e.util.getPathExpr(e.errorPath,B,e.opts.jsonPointers);var Me=S+"["+B+"]";I.dataPathArr[j]=B;var $e=e.validate(I);I.baseId=Be,e.util.varOccurences($e,G)<2?s+=" "+e.util.varReplace($e,G,Me)+" ":s+=" var "+G+" = "+Me+"; "+$e+" ",E&&(s+=" if (!"+z+") break; "),s+=" } ",E&&(s+=" else "+z+" = true; "),s+=" }  ",E&&(s+=" if ("+z+") { ",R+="}")}}}return E&&(s+=" "+R+" if ("+P+" == errors) {"),s},$6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="errs__"+u,I=e.util.copy(e),R="";I.level++;var z="valid"+I.level;if(s+="var "+P+" = errors;",e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){I.schema=o,I.schemaPath=g,I.errSchemaPath=x;var B="key"+u,$="idx"+u,j="i"+u,G="' + "+B+" + '",K=I.dataLevel=e.dataLevel+1,X="data"+K,re="dataProperties"+u,ue=e.opts.ownProperties,ne=e.baseId;ue&&(s+=" var "+re+" = undefined; "),ue?s+=" "+re+" = "+re+" || Object.keys("+S+"); for (var "+$+"=0; "+$+"<"+re+".length; "+$+"++) { var "+B+" = "+re+"["+$+"]; ":s+=" for (var "+B+" in "+S+") { ",s+=" var startErrs"+u+" = errors; ";var we=B,xe=e.compositeRule;e.compositeRule=I.compositeRule=!0;var ke=e.validate(I);I.baseId=ne,e.util.varOccurences(ke,X)<2?s+=" "+e.util.varReplace(ke,X,we)+" ":s+=" var "+X+" = "+we+"; "+ke+" ",e.compositeRule=I.compositeRule=xe,s+=" if (!"+z+") { for (var "+j+"=startErrs"+u+"; "+j+"<errors; "+j+"++) { vErrors["+j+"].propertyName = "+B+"; }   var err =   ",e.createErrors!==!1?(s+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { propertyName: '"+G+"' } ",e.opts.messages!==!1&&(s+=" , message: 'property name \\'"+G+"\\' is invalid' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&E&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; "),E&&(s+=" break; "),s+=" } }"}return E&&(s+=" "+R+" if ("+P+" == errors) {"),s},V6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I=e.opts.$data&&o&&o.$data;I&&(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ");var R="schema"+u;if(!I)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var z=[],B=o;if(B)for(var $,j=-1,G=B.length-1;j<G;){$=B[j+=1];var K=e.schema.properties[$];K&&(e.opts.strictKeywords?typeof K=="object"&&Object.keys(K).length>0||K===!1:e.util.schemaHasRules(K,e.RULES.all))||(z[z.length]=$)}}else var z=o;if(I||z.length){var X=e.errorPath,re=I||z.length>=e.opts.loopRequired,ue=e.opts.ownProperties;if(E)if(s+=" var missing"+u+"; ",re){I||(s+=" var "+R+" = validate.schema"+g+"; ");var ne="i"+u,we="schema"+u+"["+ne+"]",xe="' + "+we+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(X,we,e.opts.jsonPointers)),s+=" var "+P+" = true; ",I&&(s+=" if (schema"+u+" === undefined) "+P+" = true; else if (!Array.isArray(schema"+u+")) "+P+" = false; else {"),s+=" for (var "+ne+" = 0; "+ne+" < "+R+".length; "+ne+"++) { "+P+" = "+S+"["+R+"["+ne+"]] !== undefined ",ue&&(s+=" &&   Object.prototype.hasOwnProperty.call("+S+", "+R+"["+ne+"]) "),s+="; if (!"+P+") break; } ",I&&(s+="  }  "),s+="  if (!"+P+") {   ";var ke=ke||[];ke.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { missingProperty: '"+xe+"' } ",e.opts.messages!==!1&&(s+=" , message: '",e.opts._errorDataPathProperty?s+="is a required property":s+="should have required property \\'"+xe+"\\'",s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var Ie=s;s=ke.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+Ie+"]); ":s+=" validate.errors = ["+Ie+"]; return false; ":s+=" var err = "+Ie+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } else { "}else{s+=" if ( ";var Fe=z;if(Fe)for(var se,ne=-1,Be=Fe.length-1;ne<Be;){se=Fe[ne+=1],ne&&(s+=" || ");var Ve=e.util.getProperty(se),Je=S+Ve;s+=" ( ( "+Je+" === undefined ",ue&&(s+=" || ! Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(se)+"') "),s+=") && (missing"+u+" = "+e.util.toQuotedString(e.opts.jsonPointers?se:Ve)+") ) "}s+=") {  ";var we="missing"+u,xe="' + "+we+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(X,we,!0):X+" + "+we);var ke=ke||[];ke.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { missingProperty: '"+xe+"' } ",e.opts.messages!==!1&&(s+=" , message: '",e.opts._errorDataPathProperty?s+="is a required property":s+="should have required property \\'"+xe+"\\'",s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var Ie=s;s=ke.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+Ie+"]); ":s+=" validate.errors = ["+Ie+"]; return false; ":s+=" var err = "+Ie+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } else { "}else if(re){I||(s+=" var "+R+" = validate.schema"+g+"; ");var ne="i"+u,we="schema"+u+"["+ne+"]",xe="' + "+we+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(X,we,e.opts.jsonPointers)),I&&(s+=" if ("+R+" && !Array.isArray("+R+")) {  var err =   ",e.createErrors!==!1?(s+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { missingProperty: '"+xe+"' } ",e.opts.messages!==!1&&(s+=" , message: '",e.opts._errorDataPathProperty?s+="is a required property":s+="should have required property \\'"+xe+"\\'",s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+R+" !== undefined) { "),s+=" for (var "+ne+" = 0; "+ne+" < "+R+".length; "+ne+"++) { if ("+S+"["+R+"["+ne+"]] === undefined ",ue&&(s+=" || ! Object.prototype.hasOwnProperty.call("+S+", "+R+"["+ne+"]) "),s+=") {  var err =   ",e.createErrors!==!1?(s+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { missingProperty: '"+xe+"' } ",e.opts.messages!==!1&&(s+=" , message: '",e.opts._errorDataPathProperty?s+="is a required property":s+="should have required property \\'"+xe+"\\'",s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",I&&(s+="  }  ")}else{var ut=z;if(ut)for(var se,ht=-1,Et=ut.length-1;ht<Et;){se=ut[ht+=1];var Ve=e.util.getProperty(se),xe=e.util.escapeQuotes(se),Je=S+Ve;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(X,se,e.opts.jsonPointers)),s+=" if ( "+Je+" === undefined ",ue&&(s+=" || ! Object.prototype.hasOwnProperty.call("+S+", '"+e.util.escapeQuotes(se)+"') "),s+=") {  var err =   ",e.createErrors!==!1?(s+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { missingProperty: '"+xe+"' } ",e.opts.messages!==!1&&(s+=" , message: '",e.opts._errorDataPathProperty?s+="is a required property":s+="should have required property \\'"+xe+"\\'",s+="' "),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=X}else E&&(s+=" if (true) {");return s},U6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S="data"+(d||""),P="valid"+u,I=e.opts.$data&&o&&o.$data,R;if(I?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",R="schema"+u):R=o,(o||I)&&e.opts.uniqueItems!==!1){I&&(s+=" var "+P+"; if ("+R+" === false || "+R+" === undefined) "+P+" = true; else if (typeof "+R+" != 'boolean') "+P+" = false; else { "),s+=" var i = "+S+".length , "+P+" = true , j; if (i > 1) { ";var z=e.schema.items&&e.schema.items.type,B=Array.isArray(z);if(!z||z=="object"||z=="array"||B&&(z.indexOf("object")>=0||z.indexOf("array")>=0))s+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+S+"[i], "+S+"[j])) { "+P+" = false; break outer; } } } ";else{s+=" var itemIndices = {}, item; for (;i--;) { var item = "+S+"[i]; ";var $="checkDataType"+(B?"s":"");s+=" if ("+e.util[$](z,"item",e.opts.strictNumbers,!0)+") continue; ",B&&(s+=` if (typeof item == 'string') item = '"' + item; `),s+=" if (typeof itemIndices[item] == 'number') { "+P+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}s+=" } ",I&&(s+="  }  "),s+=" if (!"+P+") {   ";var j=j||[];j.push(s),s="",e.createErrors!==!1?(s+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(s+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(s+=" , schema:  ",I?s+="validate.schema"+g:s+=""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+S+" "),s+=" } "):s+=" {} ";var G=s;s=j.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+G+"]); ":s+=" validate.errors = ["+G+"]; return false; ":s+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",E&&(s+=" else { ")}else E&&(s+=" if (true) { ");return s},G6={$ref:S6,allOf:A6,anyOf:P6,$comment:C6,const:I6,contains:M6,dependencies:O6,enum:D6,format:R6,if:L6,items:k6,maximum:vA,minimum:vA,maxItems:xA,minItems:xA,maxLength:bA,minLength:bA,maxProperties:wA,minProperties:wA,multipleOf:z6,not:F6,oneOf:B6,pattern:N6,properties:j6,propertyNames:$6,required:V6,uniqueItems:U6,validate:$M},EA=G6,px=dd.toHash,H6=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],r=["type","$comment"],n=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],s=["number","integer","string","array","object","boolean","null"];return e.all=px(r),e.types=px(s),e.forEach(function(u){u.rules=u.rules.map(function(d){var o;if(typeof d=="object"){var g=Object.keys(d)[0];o=d[g],d=g,o.forEach(function(E){r.push(E),e.all[E]=!0})}r.push(d);var x=e.all[d]={keyword:d,code:EA[d],implements:o};return x}),e.all.$comment={keyword:"$comment",code:EA.$comment},u.type&&(e.types[u.type]=u)}),e.keywords=px(r.concat(n)),e.custom={},e},TA=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"],W6=function(t,e){for(var r=0;r<e.length;r++){t=JSON.parse(JSON.stringify(t));var n=e[r].split("/"),s=t,u;for(u=1;u<n.length;u++)s=s[n[u]];for(u=0;u<TA.length;u++){var d=TA[u],o=s[d];o&&(s[d]={anyOf:[o,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return t},Z6=N1.MissingRef,q6=tO;function tO(t,e,r){var n=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(r=e,e=void 0);var s=u(t).then(function(){var o=n._addSchema(t,void 0,e);return o.validate||d(o)});return r&&s.then(function(o){r(null,o)},r),s;function u(o){var g=o.$schema;return g&&!n.getSchema(g)?tO.call(n,{$ref:g},!0):Promise.resolve()}function d(o){try{return n._compile(o)}catch(x){if(x instanceof Z6)return g(x);throw x}function g(x){var E=x.missingSchema;if(I(E))throw new Error("Schema "+E+" is loaded but "+x.missingRef+" cannot be resolved");var S=n._loadingSchemas[E];return S||(S=n._loadingSchemas[E]=n._opts.loadSchema(E),S.then(P,P)),S.then(function(R){if(!I(E))return u(R).then(function(){I(E)||n.addSchema(R,E,void 0,e)})}).then(function(){return d(o)});function P(){delete n._loadingSchemas[E]}function I(R){return n._refs[R]||n._schemas[R]}}}}var K6=function(e,r,n){var s=" ",u=e.level,d=e.dataLevel,o=e.schema[r],g=e.schemaPath+e.util.getProperty(r),x=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,S,P="data"+(d||""),I="valid"+u,R="errs__"+u,z=e.opts.$data&&o&&o.$data,B;z?(s+=" var schema"+u+" = "+e.util.getData(o.$data,d,e.dataPathArr)+"; ",B="schema"+u):B=o;var $=this,j="definition"+u,G=$.definition,K="",X,re,ue,ne,we;if(z&&G.$data){we="keywordValidate"+u;var xe=G.validateSchema;s+=" var "+j+" = RULES.custom['"+r+"'].definition; var "+we+" = "+j+".validate;"}else{if(ne=e.useCustomRule($,o,e.schema,e),!ne)return;B="validate.schema"+g,we=ne.code,X=G.compile,re=G.inline,ue=G.macro}var ke=we+".errors",Ie="i"+u,Fe="ruleErr"+u,se=G.async;if(se&&!e.async)throw new Error("async keyword in sync schema");if(re||ue||(s+=""+ke+" = null;"),s+="var "+R+" = errors;var "+I+";",z&&G.$data&&(K+="}",s+=" if ("+B+" === undefined) { "+I+" = true; } else { ",xe&&(K+="}",s+=" "+I+" = "+j+".validateSchema("+B+"); if ("+I+") { ")),re)G.statements?s+=" "+ne.validate+" ":s+=" "+I+" = "+ne.validate+"; ";else if(ue){var Be=e.util.copy(e),K="";Be.level++;var Ve="valid"+Be.level;Be.schema=ne.validate,Be.schemaPath="";var Je=e.compositeRule;e.compositeRule=Be.compositeRule=!0;var ut=e.validate(Be).replace(/validate\.schema/g,we);e.compositeRule=Be.compositeRule=Je,s+=" "+ut}else{var ht=ht||[];ht.push(s),s="",s+="  "+we+".call( ",e.opts.passContext?s+="this":s+="self",X||G.schema===!1?s+=" , "+P+" ":s+=" , "+B+" , "+P+" , validate.schema"+e.schemaPath+" ",s+=" , (dataPath || '')",e.errorPath!='""'&&(s+=" + "+e.errorPath);var Et=d?"data"+(d-1||""):"parentData",Qt=d?e.dataPathArr[d]:"parentDataProperty";s+=" , "+Et+" , "+Qt+" , rootData )  ";var Nt=s;s=ht.pop(),G.errors===!1?(s+=" "+I+" = ",se&&(s+="await "),s+=""+Nt+"; "):se?(ke="customErrors"+u,s+=" var "+ke+" = null; try { "+I+" = await "+Nt+"; } catch (e) { "+I+" = false; if (e instanceof ValidationError) "+ke+" = e.errors; else throw e; } "):s+=" "+ke+" = null; "+I+" = "+Nt+"; "}if(G.modifying&&(s+=" if ("+Et+") "+P+" = "+Et+"["+Qt+"];"),s+=""+K,G.valid)E&&(s+=" if (true) { ");else{s+=" if ( ",G.valid===void 0?(s+=" !",ue?s+=""+Ve:s+=""+I):s+=" "+!G.valid+" ",s+=") { ",S=$.keyword;var ht=ht||[];ht.push(s),s="";var ht=ht||[];ht.push(s),s="",e.createErrors!==!1?(s+=" { keyword: '"+(S||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { keyword: '"+$.keyword+"' } ",e.opts.messages!==!1&&(s+=` , message: 'should pass "`+$.keyword+`" keyword validation' `),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+P+" "),s+=" } "):s+=" {} ";var yt=s;s=ht.pop(),!e.compositeRule&&E?e.async?s+=" throw new ValidationError(["+yt+"]); ":s+=" validate.errors = ["+yt+"]; return false; ":s+=" var err = "+yt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var et=s;s=ht.pop(),re?G.errors?G.errors!="full"&&(s+="  for (var "+Ie+"="+R+"; "+Ie+"<errors; "+Ie+"++) { var "+Fe+" = vErrors["+Ie+"]; if ("+Fe+".dataPath === undefined) "+Fe+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+Fe+".schemaPath === undefined) { "+Fe+'.schemaPath = "'+x+'"; } ',e.opts.verbose&&(s+=" "+Fe+".schema = "+B+"; "+Fe+".data = "+P+"; "),s+=" } "):G.errors===!1?s+=" "+et+" ":(s+=" if ("+R+" == errors) { "+et+" } else {  for (var "+Ie+"="+R+"; "+Ie+"<errors; "+Ie+"++) { var "+Fe+" = vErrors["+Ie+"]; if ("+Fe+".dataPath === undefined) "+Fe+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+Fe+".schemaPath === undefined) { "+Fe+'.schemaPath = "'+x+'"; } ',e.opts.verbose&&(s+=" "+Fe+".schema = "+B+"; "+Fe+".data = "+P+"; "),s+=" } } "):ue?(s+="   var err =   ",e.createErrors!==!1?(s+=" { keyword: '"+(S||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(x)+" , params: { keyword: '"+$.keyword+"' } ",e.opts.messages!==!1&&(s+=` , message: 'should pass "`+$.keyword+`" keyword validation' `),e.opts.verbose&&(s+=" , schema: validate.schema"+g+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+P+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&E&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; ")):G.errors===!1?s+=" "+et+" ":(s+=" if (Array.isArray("+ke+")) { if (vErrors === null) vErrors = "+ke+"; else vErrors = vErrors.concat("+ke+"); errors = vErrors.length;  for (var "+Ie+"="+R+"; "+Ie+"<errors; "+Ie+"++) { var "+Fe+" = vErrors["+Ie+"]; if ("+Fe+".dataPath === undefined) "+Fe+".dataPath = (dataPath || '') + "+e.errorPath+";  "+Fe+'.schemaPath = "'+x+'";  ',e.opts.verbose&&(s+=" "+Fe+".schema = "+B+"; "+Fe+".data = "+P+"; "),s+=" } } else { "+et+" } "),s+=" } ",E&&(s+=" else { ")}return s};const X6="http://json-schema.org/draft-07/schema#",Y6="http://json-schema.org/draft-07/schema#",J6="Core schema meta-schema",Q6={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},eU=["object","boolean"],tU={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}};var rO={$schema:X6,$id:Y6,title:J6,definitions:Q6,type:eU,properties:tU,default:!0},SA=rO,rU={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:SA.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:SA.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}},iU=/^[a-z_$][a-z0-9_$-]*$/i,nU=K6,sU=rU,oU={add:aU,get:lU,remove:cU,validate:Ob};function aU(t,e){var r=this.RULES;if(r.keywords[t])throw new Error("Keyword "+t+" is already defined");if(!iU.test(t))throw new Error("Keyword "+t+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var n=e.type;if(Array.isArray(n))for(var s=0;s<n.length;s++)d(t,n[s],e);else d(t,n,e);var u=e.metaSchema;u&&(e.$data&&this._opts.$data&&(u={anyOf:[u,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(u,!0))}r.keywords[t]=r.all[t]=!0;function d(o,g,x){for(var E,S=0;S<r.length;S++){var P=r[S];if(P.type==g){E=P;break}}E||(E={type:g,rules:[]},r.push(E));var I={keyword:o,definition:x,custom:!0,code:nU,implements:x.implements};E.rules.push(I),r.custom[o]=I}return this}function lU(t){var e=this.RULES.custom[t];return e?e.definition:this.RULES.keywords[t]||!1}function cU(t){var e=this.RULES;delete e.keywords[t],delete e.all[t],delete e.custom[t];for(var r=0;r<e.length;r++)for(var n=e[r].rules,s=0;s<n.length;s++)if(n[s].keyword==t){n.splice(s,1);break}return this}function Ob(t,e){Ob.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(sU,!0);if(r(t))return!0;if(Ob.errors=r.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}const uU="http://json-schema.org/draft-07/schema#",hU="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",dU="Meta-schema for $data reference (JSON Schema extension proposal)",fU="object",pU=["$data"],mU={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},gU=!1;var _U={$schema:uU,$id:hU,description:dU,type:fU,required:pU,properties:mU,additionalProperties:gU},iO=s6,tu=B1,yU=GM.exports,nO=zM,vU=jM,xU=y6,bU=H6,sO=W6,oO=dd,wU=Vi;Vi.prototype.validate=TU;Vi.prototype.compile=SU;Vi.prototype.addSchema=AU;Vi.prototype.addMetaSchema=PU;Vi.prototype.validateSchema=CU;Vi.prototype.getSchema=MU;Vi.prototype.removeSchema=DU;Vi.prototype.addFormat=jU;Vi.prototype.errorsText=NU;Vi.prototype._addSchema=RU;Vi.prototype._compile=LU;Vi.prototype.compileAsync=q6;var lv=oU;Vi.prototype.addKeyword=lv.add;Vi.prototype.getKeyword=lv.get;Vi.prototype.removeKeyword=lv.remove;Vi.prototype.validateKeyword=lv.validate;var aO=N1;Vi.ValidationError=aO.Validation;Vi.MissingRefError=aO.MissingRef;Vi.$dataMetaSchema=sO;var cy="http://json-schema.org/draft-07/schema",AA=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],EU=["/properties"];function Vi(t){if(!(this instanceof Vi))return new Vi(t);t=this._opts=oO.copy(t)||{},WU(this),this._schemas={},this._refs={},this._fragments={},this._formats=xU(t.format),this._cache=t.cache||new yU,this._loadingSchemas={},this._compilations=[],this.RULES=bU(),this._getId=kU(t),t.loopRequired=t.loopRequired||1/0,t.errorDataPath=="property"&&(t._errorDataPathProperty=!0),t.serialize===void 0&&(t.serialize=vU),this._metaOpts=HU(this),t.formats&&UU(this),t.keywords&&GU(this),$U(this),typeof t.meta=="object"&&this.addMetaSchema(t.meta),t.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),VU(this)}function TU(t,e){var r;if(typeof t=="string"){if(r=this.getSchema(t),!r)throw new Error('no schema with key or ref "'+t+'"')}else{var n=this._addSchema(t);r=n.validate||this._compile(n)}var s=r(e);return r.$async!==!0&&(this.errors=r.errors),s}function SU(t,e){var r=this._addSchema(t,void 0,e);return r.validate||this._compile(r)}function AU(t,e,r,n){if(Array.isArray(t)){for(var s=0;s<t.length;s++)this.addSchema(t[s],void 0,r,n);return this}var u=this._getId(t);if(u!==void 0&&typeof u!="string")throw new Error("schema id must be string");return e=tu.normalizeId(e||u),cO(this,e),this._schemas[e]=this._addSchema(t,r,n,!0),this}function PU(t,e,r){return this.addSchema(t,e,r,!0),this}function CU(t,e){var r=t.$schema;if(r!==void 0&&typeof r!="string")throw new Error("$schema must be a string");if(r=r||this._opts.defaultMeta||IU(this),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(r,t);if(!n&&e){var s="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(s);else throw new Error(s)}return n}function IU(t){var e=t._opts.meta;return t._opts.defaultMeta=typeof e=="object"?t._getId(e)||e:t.getSchema(cy)?cy:void 0,t._opts.defaultMeta}function MU(t){var e=lO(this,t);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return OU(this,t)}}function OU(t,e){var r=tu.schema.call(t,{schema:{}},e);if(r){var n=r.schema,s=r.root,u=r.baseId,d=iO.call(t,n,s,void 0,u);return t._fragments[e]=new nO({ref:e,fragment:!0,schema:n,root:s,baseId:u,validate:d}),d}}function lO(t,e){return e=tu.normalizeId(e),t._schemas[e]||t._refs[e]||t._fragments[e]}function DU(t){if(t instanceof RegExp)return l_(this,this._schemas,t),l_(this,this._refs,t),this;switch(typeof t){case"undefined":return l_(this,this._schemas),l_(this,this._refs),this._cache.clear(),this;case"string":var e=lO(this,t);return e&&this._cache.del(e.cacheKey),delete this._schemas[t],delete this._refs[t],this;case"object":var r=this._opts.serialize,n=r?r(t):t;this._cache.del(n);var s=this._getId(t);s&&(s=tu.normalizeId(s),delete this._schemas[s],delete this._refs[s])}return this}function l_(t,e,r){for(var n in e){var s=e[n];!s.meta&&(!r||r.test(n))&&(t._cache.del(s.cacheKey),delete e[n])}}function RU(t,e,r,n){if(typeof t!="object"&&typeof t!="boolean")throw new Error("schema should be object or boolean");var s=this._opts.serialize,u=s?s(t):t,d=this._cache.get(u);if(d)return d;n=n||this._opts.addUsedSchema!==!1;var o=tu.normalizeId(this._getId(t));o&&n&&cO(this,o);var g=this._opts.validateSchema!==!1&&!e,x;g&&!(x=o&&o==tu.normalizeId(t.$schema))&&this.validateSchema(t,!0);var E=tu.ids.call(this,t),S=new nO({id:o,schema:t,localRefs:E,cacheKey:u,meta:r});return o[0]!="#"&&n&&(this._refs[o]=S),this._cache.put(u,S),g&&x&&this.validateSchema(t,!0),S}function LU(t,e){if(t.compiling)return t.validate=s,s.schema=t.schema,s.errors=null,s.root=e||s,t.schema.$async===!0&&(s.$async=!0),s;t.compiling=!0;var r;t.meta&&(r=this._opts,this._opts=this._metaOpts);var n;try{n=iO.call(this,t.schema,e,t.localRefs)}catch(u){throw delete t.validate,u}finally{t.compiling=!1,t.meta&&(this._opts=r)}return t.validate=n,t.refs=n.refs,t.refVal=n.refVal,t.root=n.root,n;function s(){var u=t.validate,d=u.apply(this,arguments);return s.errors=u.errors,d}}function kU(t){switch(t.schemaId){case"auto":return BU;case"id":return zU;default:return FU}}function zU(t){return t.$id&&this.logger.warn("schema $id ignored",t.$id),t.id}function FU(t){return t.id&&this.logger.warn("schema id ignored",t.id),t.$id}function BU(t){if(t.$id&&t.id&&t.$id!=t.id)throw new Error("schema $id is different from id");return t.$id||t.id}function NU(t,e){if(t=t||this.errors,!t)return"No errors";e=e||{};for(var r=e.separator===void 0?", ":e.separator,n=e.dataVar===void 0?"data":e.dataVar,s="",u=0;u<t.length;u++){var d=t[u];d&&(s+=n+d.dataPath+" "+d.message+r)}return s.slice(0,-r.length)}function jU(t,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[t]=e,this}function $U(t){var e;if(t._opts.$data&&(e=_U,t.addMetaSchema(e,e.$id,!0)),t._opts.meta!==!1){var r=rO;t._opts.$data&&(r=sO(r,EU)),t.addMetaSchema(r,cy,!0),t._refs["http://json-schema.org/schema"]=cy}}function VU(t){var e=t._opts.schemas;if(!!e)if(Array.isArray(e))t.addSchema(e);else for(var r in e)t.addSchema(e[r],r)}function UU(t){for(var e in t._opts.formats){var r=t._opts.formats[e];t.addFormat(e,r)}}function GU(t){for(var e in t._opts.keywords){var r=t._opts.keywords[e];t.addKeyword(e,r)}}function cO(t,e){if(t._schemas[e]||t._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function HU(t){for(var e=oO.copy(t._opts),r=0;r<AA.length;r++)delete e[AA[r]];return e}function WU(t){var e=t._opts.logger;if(e===!1)t.logger={log:mx,warn:mx,error:mx};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");t.logger=e}}function mx(){}var ZU=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,u;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(s of e.entries())if(!r.has(s[0]))return!1;for(s of e.entries())if(!t(s[1],r.get(s[0])))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(s of e.entries())if(!r.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(e[s]!==r[s])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(u=Object.keys(e),n=u.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,u[s]))return!1;for(s=n;s--!==0;){var d=u[s];if(!t(e[d],r[d]))return!1}return!0}return e!==e&&r!==r},qU=ZU;class Rh{static isObject(e){return typeof e=="object"&&e===Object(e)&&!Array.isArray(e)}static hasText(e){return typeof e=="string"&&e.length>0}static equals(e,r){return qU(e,r)}static pickFromObject(e,r){e=Object(e),typeof r=="string"&&(r=[r]);const n={};return r.forEach(s=>n[s]=e[s]),n}static omitFromObject(e,r){e=Object(e),typeof r=="string"&&(r=[r]);var n=Object.assign({},e);for(let s of r)delete n[s];return n}static mapObject(e,r){const n=Object.keys(e),s=new Array(n.length);return n.forEach((u,d)=>{s[d]=r(e[u],u,e)}),s}static mapObjectValues(e,r){e=Object(e);const n={};return Object.keys(e).forEach(s=>{n[s]=r(e[s],s,e)}),n}static unique(e,r=!1){return r?e.filter((n,s,u)=>u.findIndex(d=>Rh.equals(n,d))===s):[...new Set(e)]}static size(e){return typeof e=="object"&&e!==null?Array.isArray(e)?e.length:Object.keys(e).length:0}static isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}static deepClone(e){return JSON.parse(JSON.stringify(e))}static normalizeUrl(e,r=null){let n=e.replace(/\/$/,"");return typeof r=="string"&&(r.substr(0,1)!=="/"&&(r="/"+r),n=n+r.replace(/\/$/,"")),n}static replacePlaceholders(e,r={}){if(typeof e=="string"&&Rh.isObject(r))for(var n in r){let s=r[n];e=e.replace("{"+n+"}",Array.isArray(s)?s.join("; "):s)}return e}static compareStringCaseInsensitive(e,r){return typeof e!="string"&&(e=String(e)),typeof r!="string"&&(r=String(r)),e.localeCompare(r,void 0,{numeric:!0,sensitivity:"base"})}static prettifyString(e,r="; "){return Array.isArray(e)||(e=[String(e)]),e=e.map(n=>{if(n.length>=3){const s=(u,d,o)=>d+" "+o.toUpperCase();return n.includes("_")?n=n.replace(/([a-zA-Z\d])_([a-zA-Z\d])/g,s):n.includes("-")?n=n.replace(/([a-zA-Z\d])-([a-zA-Z\d])/g,s):n=n.replace(/([a-z])([A-Z])/g,s),n.charAt(0).toUpperCase()+n.substr(1)}return n}),e.join(r)}static friendlyLinks(e,r=!0,n=["self"]){let s=[];if(!Array.isArray(e))return s;for(let u of e)u=Object.assign({},u),!(typeof u.rel=="string"&&n.includes(u.rel.toLowerCase()))&&((typeof u.title!="string"||u.title.length===0)&&(typeof u.rel=="string"&&u.rel.length>1?u.title=Rh.prettifyString(u.rel):u.title=u.href.replace(/^https?:\/\/(www.)?/i,"").replace(/\/$/i,"")),s.push(u));return r&&s.sort((u,d)=>Rh.compareStringCaseInsensitive(u.title,d.title)),s}}var Ho=Rh;class KU{constructor(){this.errors=[]}first(){return this.errors[0]||null}last(){return this.errors[this.errors.length-1]||null}merge(e){this.errors=this.errors.concat(e.getAll())}add(e){this.errors.push(e)}count(){return this.errors.length}toJSON(){return this.errors.map(e=>typeof e.toJSON=="function"?e.toJSON():{code:"InternalError",message:e.message})}getMessage(){var e="";for(var r in this.errors)e+=parseInt(r,10)+1+". "+this.errors[r].message+`\r
`;return e.trim()}getAll(){return this.errors}}var uO=KU;const XU=fd,PA={MultipleResultNodes:"Multiple result nodes specified for the process.",StartNodeMissing:"No start nodes found for the process.",ResultNodeMissing:"No result node found for the process.",ReferencedNodeMissing:"Referenced process node '{node_id}' doesn't exist.",NodeIdInvalid:"Invalid node id specified in the process.",NodeInvalid:"Process node '{node_id}' is not a valid object.",ProcessIdMissing:"Process node '{node_id}' doesn't contain a process id.",ProcessGraphParameterMissing:"Invalid parameter '{argument}' referenced in process node '{node_id}' (process: {process_id}, namespace: {namespace}).",ProcessUnsupported:"Process '{process}' (namespace: {namespace}) is not supported.",ProcessArgumentUnsupported:"Process '{process}' (namespace: {namespace}) does not support the following arguments: {arguments}",ProcessArgumentRequired:"Process '{process}' (namespace: {namespace}) requires argument '{argument}'.",ProcessArgumentInvalid:"The argument '{argument}' in process '{process}' (namespace: {namespace}) is invalid: {reason}",ProcessGraphMissing:"No process graph specified",ProcessMissing:"No process specified"};class YU extends Error{constructor(e,r={}){super(),this.variables=r,typeof PA[e]=="string"?(this.code=e,this.message=XU.replacePlaceholders(PA[e],r)):(this.code=e.replace(/[^\w\d]+/g,""),this.message=e)}toJSON(){return{code:this.code,message:this.message}}}var cv=YU;const c_=cv,Mo=fd;class JU{constructor(e,r,n=null){if(typeof r!="string"||r.length===0)throw new c_("NodeIdInvalid");if(!Mo.isObject(e))throw new c_("NodeInvalid",{node_id:r});if(typeof e.process_id!="string")throw new c_("ProcessIdMissing",{node_id:r});this.id=r,this.processGraph=n,this.source=e,this.process_id=e.process_id,this.namespace=e.namespace||null,this.arguments=Mo.isObject(e.arguments)?Mo.deepClone(e.arguments):{},this.description=e.description||null,this.isResultNode=e.result||!1,this.expectsFrom=[],this.receivedFrom=[],this.passesTo=[],this.computedResult=void 0}toJSON(){let e=Mo.mapObjectValues(this.arguments,r=>Mo.isObject(r)&&typeof r.toJSON=="function"?r.toJSON():r);return Object.assign({},this.source,{process_id:this.process_id,namespace:this.namespace,description:this.description,arguments:e,result:this.isResultNode})}getProcessGraph(){return this.processGraph}getParent(){return this.processGraph!==null?this.processGraph.getParentNode():null}getArgumentNames(){return Object.keys(this.arguments)}hasArgument(e){return typeof this.arguments[e]!="undefined"}getArgumentType(e){return Mo.getType(this.getRawArgument(e))}getRawArgument(e){return Mo.isObject(this.source.arguments)?this.source.arguments[e]:void 0}getParsedArgument(e){return this.arguments[e]}getArgument(e,r=void 0){return typeof this.arguments[e]=="undefined"?r:this.evaluateArgument(this.arguments[e])}getArgumentRefs(e){return Mo.getRefs(this.getRawArgument(e),!1)}getRefs(){return Mo.getRefs(this.source.arguments,!1)}getProcessGraphParameterValue(e){let r,n=this.processGraph;do{if(n.hasArgument(e))return n.getArgument(e);n.hasParameterDefault(e)&&(r=n.getParameterDefault(e)),n=n.getParent()}while(n!==null);if(typeof r!="undefined")return r;if(!this.processGraph.allowUndefinedParameterRefs)throw new c_("ProcessGraphParameterMissing",{argument:e,node_id:this.id,process_id:this.process_id,namespace:this.namespace||"n/a"})}evaluateArgument(e){var r=Mo.getType(e);switch(r){case"result":return this.processGraph.getNode(e.from_node).getResult();case"callback":return e;case"parameter":return this.getProcessGraphParameterValue(e.from_parameter);case"array":case"object":let s=r==="array"?[]:{};for(var n in e)s[n]=this.evaluateArgument(e[n]);return s;default:return e}}isStartNode(){return this.expectsFrom.length===0}addPreviousNode(e){this.expectsFrom.find(r=>r.id===e.id)||this.expectsFrom.push(e)}getPreviousNodes(){return this.expectsFrom.sort((e,r)=>e.id.localeCompare(r.id))}addNextNode(e){this.passesTo.find(r=>r.id===e.id)||this.passesTo.push(e)}getNextNodes(){return this.passesTo.sort((e,r)=>e.id.localeCompare(r.id))}reset(){this.computedResult=void 0,this.receivedFrom=[]}getDescription(){return this.description}setDescription(e){typeof e=="string"?this.description=e:this.description=null}setResult(e){this.computedResult=e}getResult(){return this.computedResult}solveDependency(e){return e!==null&&this.expectsFrom.includes(e)&&this.receivedFrom.push(e),this.expectsFrom.length===this.receivedFrom.length}}var hO=JU;const mn=Ho;class xs{static normalizeJsonSchema(e,r=!1){mn.isObject(e)?e=[e]:Array.isArray(e)?e=e:e=[];let n=[];for(let s of e)if(Array.isArray(s.allOf))n.push(Object.assign({},...s.allOf));else if(Array.isArray(s.oneOf)||Array.isArray(s.anyOf)){let u=mn.omitFromObject(s,["oneOf","anyOf"]),d=s.oneOf||s.anyOf;for(let o of d)n.push(Object.assign({},u,o))}else n.push(s);if(!r)return n;e=[];for(let s of n)Array.isArray(s.type)?e=e.concat(s.type.map(u=>Object.assign({},s,{type:u}))):e.push(s);return e}static getCallbackParameters(e,r=[]){if(!mn.isObject(e)||!e.schema)return[];let n=xs.normalizeJsonSchema(e.schema),s;for(;s=r.shift();)n=n.map(d=>xs.normalizeJsonSchema(xs.getElementJsonSchema(d,s))),n=n.concat(...n);let u=[];for(let d of n){let o=null;if(Array.isArray(d.parameters)?o=d.parameters:mn.isObject(d.additionalProperties)&&Array.isArray(d.additionalProperties.parameters)&&(o=d.additionalProperties.parameters),Array.isArray(o)){if(u.length>0&&!mn.equals(u,o))throw new Error("Multiple schemas with different callback parameters found.");u=o}}return u}static getCallbackParametersForProcess(e,r,n=[]){if(!mn.isObject(e)||!Array.isArray(e.parameters))return[];let s=e.parameters.find(u=>u.name===r);return xs.getCallbackParameters(s,n)}static getNativeTypesForJsonSchema(e,r=!1){if(mn.isObject(e)&&Array.isArray(e.type)){let n=mn.unique(e.type).filter(s=>xs.JSON_SCHEMA_TYPES.includes(s));return n.length>0&&n.length<xs.JSON_SCHEMA_TYPES.length?n:r?[]:xs.JSON_SCHEMA_TYPES}else return mn.isObject(e)&&typeof e.type=="string"&&xs.JSON_SCHEMA_TYPES.includes(e.type)?[e.type]:r?[]:xs.JSON_SCHEMA_TYPES}static getElementJsonSchema(e,r=null){let n=xs.getNativeTypesForJsonSchema(e);if(mn.isObject(e)&&n.includes("array")&&typeof r!="string"){if(mn.isObject(e.items))return e.items;if(Array.isArray(e.items)){if(r!==null&&mn.isObject(e.items[r]))return e.items[r];if(mn.isObject(e.additionalItems))return e.additionalItems}}if(mn.isObject(e)&&n.includes("object")){if(r!==null&&mn.isObject(e.properties)&&mn.isObject(e.properties[r]))return e.properties[r];if(mn.isObject(e.additionalProperties))return e.additionalProperties}return{}}}xs.JSON_SCHEMA_TYPES=["string","number","integer","boolean","array","object","null"];var Xp=xs;const QU=fO,CA=uO,e8=V1,u_=cv,gx=hO,zc=fd,t8=Xp,r8=["id","summary","description","categories","parameters","returns","deprecated","experimental","exceptions","examples","links","process_graph"];class $1{constructor(e,r=null,n=null){this.process=e,this.nodes={},this.startNodes=[],this.resultNode=null,this.children=[],this.parentNode=null,this.parsed=!1,this.validated=!1,this.errors=new CA,this.callbackParameters=[],this.processRegistry=r,this.jsonSchemaValidator=n,this.arguments={},this.allowEmptyGraph=!1,this.fillProcessParameters=!1,this.allowUndefinedParameterRefs=!0}toJSON(){return this.process}getJsonSchemaValidator(){return this.jsonSchemaValidator===null&&(this.jsonSchemaValidator=this.createJsonSchemaValidatorInstance()),this.jsonSchemaValidator.setProcessGraphParser(this),this.jsonSchemaValidator}createJsonSchemaValidatorInstance(){return new e8}createNodeInstance(e,r,n){return new gx(e,r,n)}createProcessGraphInstance(e){let r=new $1(e,this.processRegistry,this.getJsonSchemaValidator());return this.copyProcessGraphInstanceProperties(r)}createProcessInstance(e){return new QU(e)}copyProcessGraphInstanceProperties(e){return e.allowEmptyGraph=this.allowEmptyGraph,e.fillProcessParameters=this.fillProcessParameters,e.allowUndefinedParameterRefs=this.allowUndefinedParameterRefs,e}createChildProcessGraph(e,r,n=[]){var s=this.createProcessGraphInstance(e);if(s.setArguments(this.arguments),s.setParentNode(r),n.length>0){let u=n.shift();s.setCallbackParameters(t8.getCallbackParametersForProcess(s.getParentProcess(),u,n))}return s.parse(),this.children.push(s),s}getParentNode(){return this.parentNode}getParent(){return this.parentNode?this.parentNode.getProcessGraph():null}setParentNode(e){e instanceof gx?this.parentNode=e:this.parentNode=null}isValid(){return this.validated&&this.errors.count()===0}addError(e){this.errors.add(e)}allowUndefinedParameters(e=!0){e||(this.fillProcessParameters=!1),this.allowUndefinedParameterRefs=e}fillUndefinedParameters(e=!0){e&&(this.allowUndefinedParameterRefs=!0),this.fillProcessParameters=e}allowEmpty(e=!0){this.allowEmptyGraph=e}parse(){if(this.parsed)return;const e=n=>this.getParentProcessId()?new u_(n+"Callback",{process_id:this.getParentProcessId(),node_id:this.parentNode?this.parentNode.id:"N/A"}):new u_(n);if(!zc.isObject(this.process))throw e("ProcessMissing");if(zc.size(this.process.process_graph)===0){if(this.allowEmptyGraph){let n=Object.keys(this.process).find(s=>r8.includes(s));if(zc.size(this.process)===0||n){this.parsed=!0;return}}throw e("ProcessGraphMissing")}this.nodes=zc.mapObjectValues(this.process.process_graph,(n,s)=>this.createNodeInstance(n,s,this));for(let n in this.nodes){var r=this.nodes[n];if(r.isResultNode){if(this.resultNode!==null)throw e("MultipleResultNodes");this.resultNode=r}this.parseNodeArguments(n,r)}if(this.resultNode===null)throw e("ResultNodeMissing");if(this.startNodes=Object.values(this.nodes).filter(n=>n.isStartNode()).sort((n,s)=>n.id.localeCompare(s.id)),this.startNodes.length===0)throw e("StartNodeMissing");this.parsed=!0}async validate(e=!0){if(this.validated){if(e&&this.errors.count()>0)throw this.errors.first();return this.errors}this.validated=!0;try{this.parse()}catch(r){if(this.addError(r),e)throw r}return await this.validateNodes(this.getStartNodes(),e),this.errors}async execute(e=null){return this.allowUndefinedParameters(!1),this.setArguments(e),await this.validate(),this.reset(),await this.executeNodes(this.getStartNodes()),this.getResultNode()}async validateNodes(e,r,n=null){if(e.length!==0){var s=e.map(async u=>{if(!!u.solveDependency(n)){try{await this.validateNode(u)}catch(d){if(d instanceof CA){if(this.errors.merge(d),r)throw d.first()}else if(this.addError(d),r)throw d}await this.validateNodes(u.getNextNodes(),r,u)}});await Promise.all(s)}}async validateNode(e){var r=this.getProcess(e);if(r)return await r.validate(e)}async executeNodes(e,r=null){if(e.length!==0){var n=e.map(async s=>{if(!!s.solveDependency(r)){var u=await this.executeNode(s);s.setResult(u),await this.executeNodes(s.getNextNodes(),s)}});return await Promise.all(n)}}async executeNode(e){var r=this.getProcess(e);return await r.execute(e)}parseNodeArguments(e,r,n=[],s=void 0){typeof s=="undefined"&&(s=r.arguments);for(let d in s){let o=s[d],g=n.concat([d]);switch(zc.getType(o)){case"result":var u=this.nodes[o.from_node];if(typeof u=="undefined")throw new u_("ReferencedNodeMissing",{node_id:o.from_node});r.addPreviousNode(u),u.addNextNode(r);break;case"callback":s[d]=this.createChildProcessGraph(o,r,g);break;case"parameter":this.fillProcessParameters&&!this.hasParameter(o.from_parameter)&&this.addProcessParameter(o.from_parameter);break;case"array":case"object":this.parseNodeArguments(e,r,g,o);break}}}setCallbackParameters(e){this.callbackParameters=e}getCallbackParameter(e){return this.getCallbackParameters().find(r=>r.name===e)||null}getCallbackParameters(){return this.callbackParameters}addProcessParameter(e,r="",n={}){Array.isArray(this.process.parameters)||(this.process.parameters=[]),this.process.parameters.push({name:e,description:r,schema:n})}hasParameterDefault(e){return this.getParameterDefault(e)!==void 0}getParameterDefault(e){let r=this.getParameter(e);if(r!==null)return r.default}hasParameter(e){return this.getParameter(e)!==null}getProcessParameters(e=!1){let r=Array.isArray(this.process.parameters)?this.process.parameters.slice(0):[];if(e&&!this.fillProcessParameters)for(let n in this.nodes){let s=this.nodes[n].getRefs();for(let u of s)u.from_parameter&&!r.find(d=>d.name===u.from_parameter)&&r.push({name:u.from_parameter,description:"",schema:{}})}return r}getProcessParameter(e,r=!1){return this.getProcessParameters(r).find(n=>n.name===e)||null}getParameter(e){let r=this.getCallbackParameter(e),n=this.getProcessParameter(e);return r&&n?Object.assign({},r,n):r||n||null}setArguments(e){zc.isObject(e)&&Object.assign(this.arguments,e)}hasArgument(e){return typeof this.arguments[e]!="undefined"}getArgument(e){return this.arguments[e]}reset(){for(var e in this.nodes)this.nodes[e].reset();this.children.forEach(r=>r.reset())}getResultNode(){return this.resultNode}getStartNodes(){return this.startNodes}getStartNodeIds(){return this.startNodes.map(e=>e.id)}getNode(e){return e in this.nodes?this.nodes[e]:null}getNodeCount(){return zc.size(this.nodes)}getNodes(){return this.nodes}getErrors(){return this.errors}getProcess(e,r=null){if(this.processRegistry===null)return null;let n;e instanceof gx?(n=e.process_id,r=e.namespace):n=e;let s=this.processRegistry.get(n,r);if(s===null)throw new u_("ProcessUnsupported",{process:n,namespace:r||"n/a"});return this.createProcessInstance(s)}getParentProcessId(){return this.getParentNode()?this.getParentNode().process_id:null}getParentProcess(){return this.processRegistry===null?null:this.processRegistry.get(this.getParentProcessId())}}var dO=$1;const i8=Ho;class _a extends i8{static containsRef(e,r=!0,n=!1){switch(_a.getType(e)){case"result":case"parameter":return!0;case"callback":if(r&&_a.containsRef(e.process_graph,n,n))return!0;break;case"array":case"object":for(let u in e)if(_a.containsRef(e[u],r,n))return!0}return!1}static getRefs(e,r=!0,n=!1){var s=[],u=_a.getType(e);switch(u){case"result":case"parameter":s.push(e);break;case"callback":r&&(s=s.concat(_a.getRefs(e.process_graph,n,n)));break;case"array":case"object":for(var d in e)s=s.concat(_a.getRefs(e[d],r,n));break}return _a.unique(s,!0)}static getType(e){const r=dO;return typeof e=="object"?e===null?"null":Array.isArray(e)?"array":e.hasOwnProperty("process_graph")||e instanceof r?"callback":e.hasOwnProperty("from_node")?"result":e.hasOwnProperty("from_parameter")?"parameter":"object":typeof e}}var fd=_a,n8={subtype:{metaSchema:{type:"string"}},parameters:{dependencies:["subtype"],metaSchema:{type:"array",items:{type:"object",required:["name","description","schema"],properties:{name:{type:"string",pattern:"^\\w+$"},description:{type:"string"},optional:{type:"boolean",default:!1},deprecated:{type:"boolean",default:!1},experimental:{type:"boolean",default:!1},default:{},schema:{oneOf:[{$ref:"http://json-schema.org/draft-07/schema"},{type:"array",items:{$ref:"http://json-schema.org/draft-07/schema"}}]}}}}},returns:{dependencies:["subtype"],metaSchema:{type:"object",required:["schema"],properties:{description:{type:"string"},schema:{oneOf:[{$ref:"http://json-schema.org/draft-07/schema"},{type:"array",items:{$ref:"http://json-schema.org/draft-07/schema"}}]}}}}};const s8="http://json-schema.org/draft-07/schema#",o8="https://geojson.org/schema/GeoJSON.json",a8="GeoJSON",l8=[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Feature",type:"object",required:["type","properties","geometry"],properties:{type:{type:"string",enum:["Feature"]},properties:{oneOf:[{type:"null"},{type:"object"}]},geometry:{oneOf:[{type:"null"},{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON FeatureCollection",type:"object",required:["type","features"],properties:{type:{type:"string",enum:["FeatureCollection"]},features:{type:"array",items:{title:"GeoJSON Feature",type:"object",required:["type","properties","geometry"],properties:{type:{type:"string",enum:["Feature"]},properties:{oneOf:[{type:"null"},{type:"object"}]},geometry:{oneOf:[{type:"null"},{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]},bbox:{type:"array",minItems:4,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}];var c8={$schema:s8,$id:o8,title:a8,oneOf:l8};const u8="http://json-schema.org/draft-07/schema#",h8="http://processes.openeo.org/1.1.0/meta/subtype-schemas.json",d8="Subtype Schemas",f8="This file defines the schemas for subtypes we define for openEO processes.",p8={"band-name":{type:"string",subtype:"band-name",title:"Band Name",description:"Either a unique band name (metadata field `name`) or a [common band name](https://github.com/radiantearth/stac-spec/tree/v0.9.0/extensions/eo#common-band-names) (metadata field `common_name`) available in the data cube. If the unique band name and the common name conflict, the unique band name has a higher priority."},"bounding-box":{type:"object",subtype:"bounding-box",title:"Bounding Box",description:"A bounding box with the required fields `west`, `south`, `east`, `north` and optionally `base`, `height`, `crs`. The `crs` is a EPSG code, a WKT2:2018 string or a PROJ definition (deprecated).",required:["west","south","east","north"],properties:{west:{description:"West (lower left corner, coordinate axis 1).",type:"number"},south:{description:"South (lower left corner, coordinate axis 2).",type:"number"},east:{description:"East (upper right corner, coordinate axis 1).",type:"number"},north:{description:"North (upper right corner, coordinate axis 2).",type:"number"},base:{description:"Base (optional, lower left corner, coordinate axis 3).",type:["number","null"],default:null},height:{description:"Height (optional, upper right corner, coordinate axis 3).",type:["number","null"],default:null},crs:{description:"Coordinate reference system of the extent, specified as as [EPSG code](http://www.epsg-registry.org/), [WKT2 (ISO 19162) string](http://docs.opengeospatial.org/is/18-010r7/18-010r7.html) or [PROJ definition (deprecated)](https://proj.org/usage/quickstart.html). Defaults to `4326` (EPSG code 4326) unless the client explicitly requests a different coordinate reference system.",anyOf:[{$ref:"#/definitions/epsg-code"},{$ref:"#/definitions/wkt2-definition"},{$ref:"#/definitions/proj-definition"}],default:4326}}},"chunk-size":{type:"object",subtype:"chunk-size",required:["dimension","value"],properties:{dimension:{type:"string"},value:{default:null,anyOf:[{type:"null"},{type:"number",minimum:0},{$ref:"#/definitions/duration"}]},unit:{type:"string",description:"The unit the values are given in. If no unit is given, uses the unit specified for the dimension or otherwise the default unit of the reference system."}}},"collection-id":{type:"string",subtype:"collection-id",title:"Collection ID",description:"A collection id from the list of supported collections.",pattern:"^[\\w\\-\\.~/]+$"},date:{type:"string",subtype:"date",format:"date",title:"Date only",description:"Date only representation, as defined for `full-date` by [RFC 3339 in section 5.6](https://www.rfc-editor.org/rfc/rfc3339.html#section-5.6). The time zone is UTC."},"date-time":{type:"string",subtype:"date-time",format:"date-time",title:"Date with Time",description:"Date and time representation, as defined for `date-time` by [RFC 3339 in section 5.6](https://www.rfc-editor.org/rfc/rfc3339.html#section-5.6)."},duration:{type:"string",subtype:"duration",description:"[ISO 8601 duration](https://en.wikipedia.org/wiki/ISO_8601#Durations), e.g. `P1D` for one day.",pattern:"^(-?)P(?=\\d|T\\d)(?:(\\d+)Y)?(?:(\\d+)M)?(?:(\\d+)([DW]))?(?:T(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+(?:\\.\\d+)?)S)?)?$"},"epsg-code":{type:"integer",subtype:"epsg-code",title:"EPSG Code",description:"Specifies details about cartographic projections as [EPSG](http://www.epsg.org) code.",minimum:1e3,examples:[3857]},"file-path":{type:"string",subtype:"file-path",pattern:`^[^\r
\\:'"]+$`,title:"Single File path",description:"A relative path to a user-uploaded file. Folders can't be specified."},"file-paths":{type:"array",subtype:"file-paths",title:"Multiple File paths",description:"An array with relative paths to user-uploaded files. Clients should assist to generate a list of files for folders.",items:{$ref:"#/definitions/file-path"}},geojson:{type:"object",subtype:"geojson",title:"GeoJSON",description:"GeoJSON as defined by [RFC 7946](https://www.rfc-editor.org/rfc/rfc7946.html).",allOf:[{$ref:"https://geojson.org/schema/GeoJSON.json"}]},"input-format":{type:"string",subtype:"input-format",title:"Input File Format",description:"An input format supported by the back-end."},"input-format-options":{type:"object",subtype:"input-format-options",title:"Options for Input File Formats",description:"Key-value-pairs with arguments for the input format options supported by the back-end."},"job-id":{type:"string",subtype:"job-id",title:"Batch Job ID",description:"A batch job id, either one of the jobs a user has stored or a publicly available job.",pattern:"^[\\w\\-\\.~]+$"},kernel:{type:"array",subtype:"kernel",title:"Image Kernel",description:"Image kernel, a two-dimensional array of numbers.",items:{type:"array",items:{type:"number"}}},"labeled-array":{type:"array",subtype:"labeled-array",title:"Array with labels",description:`An associative, ordered list of key-value pairs. Basically an array, which additionally has labels for each value. Labels can be numbers or (temporal) strings.

**Important:** Due to the lack of such a data type in JSON, the schema for the items is not formally specified yet and a placeholder.`,items:{description:"Any data type."}},"metadata-filter":{type:"object",subtype:"metadata-filter",title:"Filters",description:"A list of filters to check against. Specify key-value-pairs with the key being the name of the metadata property name and the value being a user-defined process evaluated against the metadata values.",additionalProperties:{type:"object",subtype:"process-graph",parameters:[{name:"value",description:"The property value to be checked against.",schema:{description:"Any data type."}}],returns:{description:"`true` if the data should be used, otherwise `false`.",schema:{type:"boolean"}}}},"output-format":{type:"string",subtype:"output-format",title:"Output File Format",description:"An output format supported by the back-end."},"output-format-options":{type:"object",subtype:"output-format-options",title:"Options for Output File Formats",description:"Key-value-pairs with arguments for the output format options supported by the back-end."},"process-graph":{type:"object",subtype:"process-graph",title:"User-defined process",description:"An process graph that is passed as an argument and is expected to be executed by the process. Parameters passed to the process graph are specified in the `parameters` property of the corresponding schema.",required:["process_graph"],properties:{process_graph:{type:"object",additionalProperties:{type:"object",required:["process_id","arguments"],properties:{process_id:{type:"string"},arguments:{}}}}}},"proj-definition":{type:"string",subtype:"proj-definition",title:"PROJ definition",description:"**DEPRECATED.** Specifies details about cartographic projections as [PROJ](https://proj.org/usage/quickstart.html) definition."},"raster-cube":{type:"object",subtype:"raster-cube",title:"Raster data cube",description:"A raster data cube, an image collection stored at the back-end. Different back-ends have different internal representations for this data structure."},"temporal-interval":{type:"array",subtype:"temporal-interval",title:"Single temporal interval",description:`Left-closed temporal interval, represented as two-element array with the following elements:

1. The first element is the start of the temporal interval. The specified instance in time is **included** in the interval.
2. The second element is the end of the temporal interval. The specified instance in time is **excluded** from the interval.

The specified temporal strings follow [RFC 3339](https://www.rfc-editor.org/rfc/rfc3339.html). Although [RFC 3339 prohibits the hour to be '24'](https://www.rfc-editor.org/rfc/rfc3339.html#section-5.7), **this process allows the value '24' for the hour** of an end time in order to make it possible that left-closed time intervals can fully cover the day. \`null\` can be used to specify open intervals.`,minItems:2,maxItems:2,items:{description:"Processes and implementations may choose to only implement a subset of the subtypes specified here. Clients must check what back-ends / processes actually support.",anyOf:[{$ref:"#/definitions/date-time"},{$ref:"#/definitions/date"},{$ref:"#/definitions/time"},{$ref:"#/definitions/year"},{type:"null"}]},examples:[["2015-01-01T00:00:00Z","2016-01-01T00:00:00Z"],["2015-01-01","2016-01-01"],["00:00:00Z","12:00:00Z"],["2015-01-01",null]]},"temporal-intervals":{type:"array",subtype:"temporal-intervals",title:"Multiple temporal intervals",description:"Left-closed temporal intervals, which are allowed to overlap. Formatted as an array of two-element arrays, each being an array with subtype `temporal-interval`.",items:{$ref:"#/definitions/temporal-interval"},minItems:1,examples:[[["2015-01-01","2016-01-01"],["2016-01-01","2017-01-01"],["2017-01-01","2018-01-01"]],[["00:00:00Z","12:00:00Z"],["12:00:00Z","24:00:00Z"]],[["2020-01-01T00:00:00Z",null]]]},time:{type:"string",subtype:"time",format:"time",title:"Time only",description:"Time only representation, as defined for `full-time` by [RFC 3339 in section 5.6](https://www.rfc-editor.org/rfc/rfc3339.html#section-5.6). Although [RFC 3339 prohibits the hour to be '24'](https://www.rfc-editor.org/rfc/rfc3339.html#section-5.7), this definition allows the value '24' for the hour as end time in an interval in order to make it possible that left-closed time intervals can fully cover the day."},"udf-code":{type:"string",subtype:"udf-code",title:"UDF source code",description:"The multi-line source code of a user-defined function (UDF), must contain a newline/line-break.",pattern:`(\r
|\r|
)`},"udf-runtime":{type:"string",subtype:"udf-runtime",title:"UDF runtime",description:"The name of a UDF runtime."},"udf-runtime-version":{type:"string",subtype:"udf-runtime-version",title:"UDF Runtime version",description:"The version of a UDF runtime."},uri:{type:"string",subtype:"uri",format:"uri",title:"URI",description:"A valid URI according to [RFC3986](https://www.rfc-editor.org/rfc/rfc3986.html). Can be restricted using a regular expression, e.g. to (dis)allow certain protocols."},"vector-cube":{type:"object",subtype:"vector-cube",title:"Vector data cube",description:"A vector data cube, a vector collection stored at the back-end. Different back-ends have different internal representations for this data structure"},"wkt2-definition":{type:"string",subtype:"wkt2-definition",title:"WKT2 definition",description:"Specifies details about cartographic projections as WKT2 string. Refers to the latest WKT2 version (currently [WKT2:2018](http://docs.opengeospatial.org/is/18-010r7/18-010r7.html) / ISO 19162:2018) unless otherwise stated by the process."},year:{type:"string",subtype:"year",minLength:4,maxLength:4,pattern:"^\\d{4}$",title:"Year only",description:"Year representation, as defined for `date-fullyear` by [RFC 3339 in section 5.6](https://www.rfc-editor.org/rfc/rfc3339.html#section-5.6)."}};var m8={$schema:u8,$id:h8,title:d8,description:f8,definitions:p8};const no=wU,gs=fd,IA=Xp,_x=n8;var g8=c8,yx=m8;class uy{constructor(){this.ajv=new no({schemaId:"auto",format:"full",addUsedSchema:!1}),this.ajv.addSchema(g8),this.ajv.addKeyword("parameters",Object.assign(_x.parameters,{valid:!0,errors:!0})),this.ajv.addKeyword("returns",Object.assign(_x.returns,{valid:!0,errors:!0})),this.ajv.addKeyword("subtype",Object.assign(_x.subtype,{validate:async(e,r,n)=>await this.validateSubtype(e,r,n),async:!0,errors:!0})),this.collections=null,this.epsgCodes=null,this.fileFormats={input:null,output:null},this.processRegistry=null,this.udfRuntimes=null}getFunctionName(e){return"validate"+e.replace(/(^|\-)(\w)/g,(r,n,s)=>s.toUpperCase())}makeSchema(e,r=!1){if(e=gs.deepClone(e),Array.isArray(e)&&(e={anyOf:e}),typeof e.$schema=="undefined"&&(e.$schema="http://json-schema.org/draft-07/schema#"),r&&(e.$async=!0,gs.isObject(e.definitions)))for(let n in e.definitions)e.definitions[n].$async=!0;return e}async validateValue(e,r){r=this.makeSchema(r,!0);try{return await this.ajv.validate(r,e),[]}catch(n){if(Array.isArray(n.errors))return n.errors.map(s=>s.message);throw n}}async validateSubtype(e,r,n){typeof yx.definitions[e]!="undefined"?(n=this.makeSchema(yx,!0),n=Object.assign({},yx.definitions[e],n),e==="process-graph"&&(delete n.required,delete n.properties)):n=this.makeSchema(n,!0),delete n.subtype;let s=await this.ajv.validate(n,r),u=this.getFunctionName(e);return s&&typeof this[u]=="function"?await this[u](r):s}setUdfRuntimes(e){!gs.isObject(e)||(this.udfRuntimes=e)}setCollections(e){if(!!Array.isArray(e)){this.collections=[];for(let r of e)gs.isObject(r)&&typeof r.id=="string"?this.collections.push(r.id):typeof r=="string"&&this.collections.push(r)}}setFileFormats(e){if(!!gs.isObject(e)){for(let r of["input","output"])if(this.fileFormats[r]={},!!gs.isObject(e[r]))for(let n in e[r])this.fileFormats[r][n.toUpperCase()]=e[r][n]}}setEpsgCodes(e){Array.isArray(e)&&(this.epsgCodes=e.map(r=>parseInt(r,10)))}async validateCollectionId(e){if(Array.isArray(this.collections)&&!this.collections.find(r=>r===e))throw new no.ValidationError([{message:"Collection with id '"+e+"' doesn't exist."}]);return!0}async validateUdfRuntime(e){if(gs.isObject(this.udfRuntimes)&&!(e in this.udfRuntimes))throw new no.ValidationError([{message:"UDF runtime '"+e+"' is not supported."}]);return!0}async validateEpsgCode(e){if(Array.isArray(this.epsgCodes)){if(this.epsgCodes.includes(e))return!0}else if(e>=2e3)return!0;throw new no.ValidationError([{message:"Invalid EPSG code '"+e+"' specified."}])}async validateInputFormat(e){if(gs.isObject(this.fileFormats.input)&&!(e.toUpperCase()in this.fileFormats.input))throw new no.ValidationError([{message:"Input format  '"+e+"' not supported."}]);return!0}async validateOutputFormat(e){if(gs.isObject(this.fileFormats.output)&&!(e.toUpperCase()in this.fileFormats.output))throw new no.ValidationError([{message:"Output format  '"+e+"' not supported."}]);return!0}async validateProjDefinition(e){if(!e.toLowerCase().includes("+proj"))throw new no.ValidationError([{message:"Invalid PROJ string specified (doesn't contain '+proj')."}]);return!0}async validateWkt2Definition(e){var r=["BOUNDCRS","COMPOUNDCRS","ENGCRS","ENGINEERINGCRS","GEODCRS","GEODETICCRS","GEOGCRS","GEOGRAPHICCRS","PARAMETRICCRS","PROJCRS","PROJECTEDCRS","TIMECRS","VERTCRS","VERTICALCRS"];if(e=e.toUpperCase(),!r.some(n=>e.indexOf(n)!==-1))throw new no.ValidationError([{message:"Invalid WKT2 string specified."}]);return!0}async validateTemporalInterval(e){if(e[0]===null&&e[1]===null)throw new no.ValidationError([{message:"Temporal interval must not be open on both ends."}]);if(e[0]!==null&&e[1]!==null){let r=new Date(e[0]);if(new Date(e[1]).getTime()<r.getTime())throw new no.ValidationError([{message:"The second timestamp can't be before the first timestamp."}])}return!0}async validateTemporalIntervals(e){for(let r of e)await this.validateTemporalInterval(r);return!0}setProcessGraphParser(e){this.processGraph=e}async validateProcessGraph(e){try{const n=require("./processgraph");var r;return e instanceof n?r=e:this.processGraph?r=this.processGraph.createProcessGraphInstance(e):r=new n(e,null,this),await r.validate(),!0}catch(n){throw new no.ValidationError([{message:n.message}])}}static isSchemaCompatible(e,r,n=!1,s=!1){var u=IA.normalizeJsonSchema(e,!0),d=IA.normalizeJsonSchema(r,!0),o=u.findIndex(g=>{for(var x in d){var E=d[x];if(typeof g.type!="string"||!n&&typeof E.type!="string")return!0;if(g.type===E.type||s&&(g.type==="array"||g.type==="object")||g.type==="number"&&E.type==="integer"||!n&&g.type==="integer"&&E.type==="number")if(g.type==="array"&&gs.isObject(g.items)&&gs.isObject(E.items)){if(s&&uy.isSchemaCompatible(g.items,E,n))return!0;if(uy.isSchemaCompatible(g.items,E.items,n))return!0}else{if(g.type==="object"&&gs.isObject(g.properties)&&gs.isObject(E.properties))return!0;if(!n&&(typeof g.subtype!="string"||typeof E.subtype!="string"))return!0;if(typeof g.subtype!="string")return!0;if(g.subtype===E.subtype)return!0}}return!1});return o!==-1}}var V1=uy;const vx=V1,Fc=cv,MA=Xp,h_=fd;class _8{constructor(e){if(Object.assign(this,e),typeof this.id!="string")throw new Error("Invalid process specified, no id given.");Array.isArray(this.parameters)||(this.parameters=[])}toJSON(){return h_.omitFromObject(this,["validate","validateArgument","execute","test"])}async validate(e){let r=e.getArgumentNames().filter(n=>this.parameters.findIndex(s=>s.name===n)===-1);if(r.length>0)throw new Fc("ProcessArgumentUnsupported",{process:this.id,namespace:this.namespace||"n/a",arguments:r});for(let n in this.parameters){let s=this.parameters[n];if(!e.hasArgument(s.name)){if(s.optional)continue;throw new Fc("ProcessArgumentRequired",{process:this.id,namespace:this.namespace||"n/a",argument:s.name})}let u=e.getParsedArgument(s.name),d=e.getRawArgument(s.name);await this.validateArgument(u,d,e,s)}}async validateArgument(e,r,n,s,u=null){u||(u=s.name);let d=h_.getType(e),o=n.getProcessGraph();switch(d){case"parameter":let x=o.getCallbackParameter(e.from_parameter);if(x){if(!vx.isSchemaCompatible(s.schema,x.schema))throw new Fc("ProcessArgumentInvalid",{process:this.id,namespace:this.namespace||"n/a",argument:u,reason:"Schema for parameter '"+e.from_parameter+"' not compatible with reference"});return}let E=n.getProcessGraphParameterValue(e.from_parameter);if(typeof E=="undefined"&&!o.allowUndefinedParameterRefs)throw new Fc("ProcessGraphParameterMissing",{argument:e.from_parameter,node_id:n.id,process_id:n.process_id,namespace:n.namespace||"n/a"});let S=o.getProcessParameter(e.from_parameter);if(h_.isObject(S)&&S.schema&&(typeof E!="undefined"&&await this.validateArgument(E,r,n,S,u),!vx.isSchemaCompatible(s.schema,S.schema)))throw new Fc("ProcessArgumentInvalid",{process:this.id,namespace:this.namespace||"n/a",argument:u,reason:"Schema for parameter '"+e.from_parameter+"' not compatible"});break;case"result":let P=o.getNode(e.from_node),I=o.getProcess(P);if(!vx.isSchemaCompatible(s.schema,I.returns.schema))throw new Fc("ProcessArgumentInvalid",{process:this.id,namespace:this.namespace||"n/a",argument:u,reason:"Schema for result '"+e.from_node+"' not compatible"});break;case"array":case"object":let R=MA.normalizeJsonSchema(s.schema).filter(j=>["array","object"].includes(j.type)),z=R.length===1&&R[0].subtype==="process-graph";if(h_.containsRef(r)&&!z){for(var g in e){let j=R.map(G=>MA.getElementJsonSchema(G,g)).filter(G=>Object.keys(G).length);if(j.length>0){let G=0,K=null;for(let X of j)try{await this.validateArgument(e[g],r[g],n,{schema:X},u+"/"+g),G++}catch(re){K=re}if(G===0&&K)throw K}}return}default:let $=await n.getProcessGraph().getJsonSchemaValidator().validateValue(e,s.schema);if($.length>0)throw new Fc("ProcessArgumentInvalid",{process:this.id,namespace:this.namespace||"n/a",argument:u,reason:$})}}async execute(){throw new Error(`execute not implemented yet for process '${this.id}' (namespace: ${this.namespace||"n/a"})`)}test(){throw new Error(`test not implemented yet for process '${this.id}' (namespace: ${this.namespace||"n/a"})`)}}var fO=_8;const xx=Ho;class U1{constructor(e=[],r=!1){if(this.listeners=[],this.processes={},this.addNamespace=r,e instanceof U1)for(let n in e.processes)this.addAll(e.processes[n]);else this.addAll(e)}onChange(e,r,n){for(let s of this.listeners)s(e,r,n)}addAll(e,r="backend"){for(var n in e)this.add(e[n],r,!1);this.onChange("addAll",e,r)}add(e,r="backend",n=!0){if(!xx.isObject(e))throw new Error("Invalid process; not an object.");if(typeof e.id!="string")throw new Error("Invalid process; no id specified.");if(typeof r!="string")throw new Error("Invalid namespace; not a string.");this.processes[r]||(this.processes[r]={}),e=Object.assign(this.addNamespace?{namespace:r}:{},e),this.processes[r][e.id]=e,n&&this.onChange("add",e,r)}count(){return xx.size(this.all())}all(){let e=[];for(let r in this.processes)e=e.concat(Object.values(this.processes[r]));return e}hasNamespace(e){return typeof e!="string"?!1:Boolean(this.processes[e])}namespaces(){return Object.keys(this.processes).sort()}namespace(e){if(typeof e!="string")return[];let r=this.processes[e];return r?Object.values(r):[]}has(e,r=null){return Boolean(this.get(e,r))}get(e,r=null){return typeof e!="string"?null:r===null?this.get(e,"user")||this.get(e,"backend"):this.processes[r]&&this.processes[r][e]||null}remove(e=null,r="user"){if(typeof r!="string")return!1;if(this.processes[r])if(typeof e=="string"){if(this.processes[r][e]){let n=this.processes[r][e];return delete this.processes[r][e],xx.size(this.processes[r])===0&&delete this.processes[r],this.onChange("remove",n,r),!0}}else return delete this.processes[r],this.onChange("remove",null,r),!0;return!1}}var pO=U1;const y8=pO;class v8 extends y8{}var x8=v8;const b8=fO,w8=uO,E8=V1,T8=dO,S8=cv,A8=hO,P8=x8,C8=fd;var uv={BaseProcess:b8,ErrorList:w8,JsonSchemaValidator:E8,ProcessGraph:T8,ProcessGraphError:S8,ProcessGraphNode:A8,ProcessRegistry:P8,Utils:C8},mO={exports:{}};mO.exports=class extends uv.BaseProcess{};var po=mO.exports,gO={exports:{}};gO.exports=class{constructor(e=[],r=null){this.BufferArray=e,this.label=r}get bufferArray(){return this.BufferArray}set setLabel(e){this.label=e}};var hv=gO.exports,_O={exports:{}};const OA=hv;_O.exports=class{constructor(e=[OA],r=null,n={}){this.bands=e,this.source=r,this.metadata=n}addBand(e){if(e instanceof OA)this.bands.push(e);else throw Error("Error: it is not a valid OERasterband")}get getSource(){return this.source}set setSource(e){if(this.source)throw Error("source already declare");this.source=e}getWidth(){return this.metadata.fileDirectory.ImageWidth}getHeight(){return this.metadata.fileDirectory.ImageLength}};var G1=_O.exports;const Hf=Ho;class rd{constructor(e,r=null,n=void 0){this.schema=e,typeof this.schema.default=="undefined"&&(this.schema.default=n),this.parent=r}toJSON(){return Object.assign({},this.schema,{default:this.default()})}isAny(){return this.dataType()==="any"}isNull(){return this.schema.type==="null"}nullable(){return this.isNull()||this.isAny()}isEditable(){return!rd.NON_EDITABLE.includes(this.dataType())}dataType(e=!1){let r=this.schema.type||"any";return e?r:this.schema.subtype||r}nativeDataType(){return this.dataType(!0)}isEnum(){return Array.isArray(this.schema.enum)&&this.schema.enum.length>0}getEnumChoices(){return this.isEnum()?this.schema.enum:[]}getCallbackParameters(){return Array.isArray(this.schema.parameters)?this.schema.parameters:Hf.isObject(this.schema.additionalProperties)&&Array.isArray(this.schema.additionalProperties.parameters)?this.schema.additionalProperties.parameters:[]}group(){return Hf.hasText(this.schema.group)?this.schema.group:rd.DEFAULT_GROUP}title(){return Hf.hasText(this.schema.title)?this.schema.title:Hf.prettifyString(this.dataType())}description(){return Hf.hasText(this.schema.description)?this.schema.description:""}default(){return typeof this.schema.default=="function"?this.schema.default():this.schema.default}}rd.DEFAULT_GROUP="Other";rd.NON_EDITABLE=["raster-cube","vector-cube","labeled-array"];var yO=rd,vO={exports:{}};const DA=G1;vO.exports=class{constructor(e=[DA],r=[Date]){this.rasters=e,this.tdimension=r}addRaster(e,r){let n=null;for(let s=0;s>this.tdimension.length;s++)n=this.tdimension[s]===r?s:null;if(n==null)throw Error("No time or time does not match");if(e instanceof DA)this.rasters[n].push(e);else throw Error("Error: it is not a valid OERaster")}get getTdim(){return this.tdimension}setTdim(e,r){if(e instanceof Date)this.tdimension[r]=e;else throw Error("Tdimension should be a Date object")}getImage(e){if(!Number.isInteger(e))throw Error("band does not exist");return this.rasters[e]}};var xO=vO.exports,bO={exports:{}};const RA=hv,I8=G1,M8=xO,O8=po;var my,wO,RP;bO.exports=(RP=class extends O8{constructor(){super(...arguments);Fn(this,my)}async execute(r){const n=r.getArgument("data");return await Bn(this,my,wO).call(this,r,n)}},my=new WeakSet,wO=async function(r,n,s=["temporal","bands"],u="reducer",d="dimension"){const o=r.getArgument(d);if(!s.includes(o))throw Error({process:process_id,argument:d,reason:"Reducing dimension types other than "+s.join(" or ")+" is currently not supported."});var g=r.getArgument(u);if(g instanceof uv.ProcessGraph){if(g.getNodeCount()!==1)throw Error({process:this.id,argument:"reducer",reason:"No complex reducer supported at the moment"});if(o==="temporal"){const E=n.rasters[0].bands[0].BufferArray.length;let S=new Float32Array(E),P=[];const I=n.rasters[0].metadata,R=new I8([],"",I);for(let B of n.rasters)for(let $ of B.bands)P.includes($.label)||P.push($.label);for(let B of P){let $=n.rasters.map(G=>G.bands.filter(K=>K.label==B));for(let G=0;G<E;G++){let K=[];$.forEach(re=>{K.push(re[0].BufferArray[G])}),await g.setArguments({data:K});var x=await g.execute();const X=await x.getResult();S[G]=X}const j=new RA(S,B);R.bands.push(j)}const z=new M8([],[]);return z.rasters.push(R),z}if(o==="bands"){const E=n.rasters[0][0].bands[0].BufferArray.length;let S=new Float32Array(E);for(let P in n.tdimension){for(let z of n.rasters[P])for(let B=0;B<E;B++){let $=[];z.bands.forEach(K=>{$.push(K.BufferArray[B])}),await g.setArguments({data:$});var x=await g.execute();const G=await x.getResult();S[B]=G}const I=n.rasters[0],R=RA(S,"reducer");I[0].bands=R,n.rasters=I}return n}}else throw Error({argument:u,reason:"No "+u+" specified."})},RP);var D8=bO.exports,EO={exports:{}};const R8=po,L8=hv;var Ub,k8,gy,TO,kp,Db,_y,SO,yy,AO,LP;EO.exports=(LP=class extends R8{constructor(){super(...arguments);Fn(this,Ub);Fn(this,gy);Fn(this,kp);Fn(this,_y);Fn(this,yy)}async validate(r){await super.validate(r)}async execute(r){const n=r.getArgument("red"),s=r.getArgument("nir"),u=r.getArgument("rastercube");return await Bn(this,yy,AO).call(this,u,n,s)}},Ub=new WeakSet,k8=function(r,n,s){return r.map(u=>(u-s)/(n-s)*255)},gy=new WeakSet,TO=function(r){if(r.tdimension.length===0){const n=r.rasters.length;r.tdimension=Array.apply(null,Array(n)).map(()=>new Date)}return r},kp=new WeakSet,Db=function(r,n){if(r===void 0)throw Error(`${n} band undefined`)},_y=new WeakSet,SO=async function(r,n,s){const u=r.bands,d=u[n].BufferArray;Bn(this,kp,Db).call(this,d,"red");const o=u[s].BufferArray;if(Bn(this,kp,Db).call(this,d,"ndvi"),d.length!==o.length)throw new Error("Image Dimensions do not fit");const g=new Float32Array(d.length);for(let x=0;x<d.length;x+=1)g[x]=(d[x]-o[x])/(d[x]+o[x]);return g},yy=new WeakSet,AO=async function(r,n,s){r=Bn(this,gy,TO).call(this,r);for(const u in r.tdimension){const d=r.rasters[u],o=await Bn(this,_y,SO).call(this,d,n,s),g=new L8(o,"ndvi_process");return r.rasters[u].bands.push(g),r}return r},LP);var z8=EO.exports,PO={exports:{}};const F8=po;PO.exports=class extends F8{getModeOfArray(e,{debug:r=!1,no_data:n=void 0}={debug:!1,no_data:void 0}){const s=[],u=[];let d,o=0;e.map(g=>{u[g]=(u[g]||0)+1,u[g]>o&&(o=u[g])});for(d in u)u.hasOwnProperty(d)&&u[d]===o&&s.push(Number(d));return s.length==1?s[0]:s}calcMode(e){return(()=>this.getModeOfArray(e))()}async validate(e){await super.validate(e)}async execute(e){const r=e.getArgument("data");return await this.calcMode(r)}};var B8=PO.exports,CO={exports:{}};const N8=po;var vy,IO,kP;CO.exports=(kP=class extends N8{constructor(){super(...arguments);Fn(this,vy)}calcMin(r){return(()=>Bn(this,vy,IO).call(this,r))()}async validate(r){await super.validate(r)}async execute(r){const n=r.getArgument("data");return await this.calcMin(n)}},vy=new WeakSet,IO=function(r,{debug:n=!1,no_data:s=void 0}={debug:!1,no_data:void 0}){let u=1e3;return r.map(d=>{d<u?u=d:u=u}),u},kP);var j8=CO.exports,MO={exports:{}};const $8=po;MO.exports=class extends $8{getMedianOfArray(e){let r=0;const n=e.length;return e.sort(),n%2===0?r=(e[n/2-1]+e[n/2])/2:r=e[(n-1)/2],r}calcMedian(e){return(()=>this.getMedianOfArray(e))()}async validate(e){await super.validate(e)}async execute(e){const r=e.getArgument("data");return await this.calcMedian(r)}};var V8=MO.exports,OO={exports:{}};const U8=po;OO.exports=class extends U8{getMeanOfArray(e){const{length:r}=e;let n=0;for(let s=1;s<r;s++)n+=e[s];return n/r}calcMean(e){return(()=>this.getMeanOfArray(e))()}async validate(e){await super.validate(e)}async execute(e){const r=e.getArgument("data");return await this.calcMean(r)}};var G8=OO.exports,DO={exports:{}};const H8=po;var xy,RO,zP;DO.exports=(zP=class extends H8{constructor(){super(...arguments);Fn(this,xy)}calcMax(r){return(()=>Bn(this,xy,RO).call(this,r))()}async validate(r){await super.validate(r)}async execute(r){const n=r.getArgument("data");return await this.calcMax(n)}},xy=new WeakSet,RO=function(r){let n=0;return r.map(s=>{s>n?n=s:n=n}),n},zP);var W8=DO.exports,Rb={exports:{}};(function(t,e){var r=typeof self!="undefined"?self:Jy,n=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(d){var o={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function g(se){return se&&DataView.prototype.isPrototypeOf(se)}if(o.arrayBuffer)var x=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(se){return se&&x.indexOf(Object.prototype.toString.call(se))>-1};function S(se){if(typeof se!="string"&&(se=String(se)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(se))throw new TypeError("Invalid character in header field name");return se.toLowerCase()}function P(se){return typeof se!="string"&&(se=String(se)),se}function I(se){var Be={next:function(){var Ve=se.shift();return{done:Ve===void 0,value:Ve}}};return o.iterable&&(Be[Symbol.iterator]=function(){return Be}),Be}function R(se){this.map={},se instanceof R?se.forEach(function(Be,Ve){this.append(Ve,Be)},this):Array.isArray(se)?se.forEach(function(Be){this.append(Be[0],Be[1])},this):se&&Object.getOwnPropertyNames(se).forEach(function(Be){this.append(Be,se[Be])},this)}R.prototype.append=function(se,Be){se=S(se),Be=P(Be);var Ve=this.map[se];this.map[se]=Ve?Ve+", "+Be:Be},R.prototype.delete=function(se){delete this.map[S(se)]},R.prototype.get=function(se){return se=S(se),this.has(se)?this.map[se]:null},R.prototype.has=function(se){return this.map.hasOwnProperty(S(se))},R.prototype.set=function(se,Be){this.map[S(se)]=P(Be)},R.prototype.forEach=function(se,Be){for(var Ve in this.map)this.map.hasOwnProperty(Ve)&&se.call(Be,this.map[Ve],Ve,this)},R.prototype.keys=function(){var se=[];return this.forEach(function(Be,Ve){se.push(Ve)}),I(se)},R.prototype.values=function(){var se=[];return this.forEach(function(Be){se.push(Be)}),I(se)},R.prototype.entries=function(){var se=[];return this.forEach(function(Be,Ve){se.push([Ve,Be])}),I(se)},o.iterable&&(R.prototype[Symbol.iterator]=R.prototype.entries);function z(se){if(se.bodyUsed)return Promise.reject(new TypeError("Already read"));se.bodyUsed=!0}function B(se){return new Promise(function(Be,Ve){se.onload=function(){Be(se.result)},se.onerror=function(){Ve(se.error)}})}function $(se){var Be=new FileReader,Ve=B(Be);return Be.readAsArrayBuffer(se),Ve}function j(se){var Be=new FileReader,Ve=B(Be);return Be.readAsText(se),Ve}function G(se){for(var Be=new Uint8Array(se),Ve=new Array(Be.length),Je=0;Je<Be.length;Je++)Ve[Je]=String.fromCharCode(Be[Je]);return Ve.join("")}function K(se){if(se.slice)return se.slice(0);var Be=new Uint8Array(se.byteLength);return Be.set(new Uint8Array(se)),Be.buffer}function X(){return this.bodyUsed=!1,this._initBody=function(se){this._bodyInit=se,se?typeof se=="string"?this._bodyText=se:o.blob&&Blob.prototype.isPrototypeOf(se)?this._bodyBlob=se:o.formData&&FormData.prototype.isPrototypeOf(se)?this._bodyFormData=se:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(se)?this._bodyText=se.toString():o.arrayBuffer&&o.blob&&g(se)?(this._bodyArrayBuffer=K(se.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(se)||E(se))?this._bodyArrayBuffer=K(se):this._bodyText=se=Object.prototype.toString.call(se):this._bodyText="",this.headers.get("content-type")||(typeof se=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(se)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var se=z(this);if(se)return se;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then($)}),this.text=function(){var se=z(this);if(se)return se;if(this._bodyBlob)return j(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(G(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(we)}),this.json=function(){return this.text().then(JSON.parse)},this}var re=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function ue(se){var Be=se.toUpperCase();return re.indexOf(Be)>-1?Be:se}function ne(se,Be){Be=Be||{};var Ve=Be.body;if(se instanceof ne){if(se.bodyUsed)throw new TypeError("Already read");this.url=se.url,this.credentials=se.credentials,Be.headers||(this.headers=new R(se.headers)),this.method=se.method,this.mode=se.mode,this.signal=se.signal,!Ve&&se._bodyInit!=null&&(Ve=se._bodyInit,se.bodyUsed=!0)}else this.url=String(se);if(this.credentials=Be.credentials||this.credentials||"same-origin",(Be.headers||!this.headers)&&(this.headers=new R(Be.headers)),this.method=ue(Be.method||this.method||"GET"),this.mode=Be.mode||this.mode||null,this.signal=Be.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Ve)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Ve)}ne.prototype.clone=function(){return new ne(this,{body:this._bodyInit})};function we(se){var Be=new FormData;return se.trim().split("&").forEach(function(Ve){if(Ve){var Je=Ve.split("="),ut=Je.shift().replace(/\+/g," "),ht=Je.join("=").replace(/\+/g," ");Be.append(decodeURIComponent(ut),decodeURIComponent(ht))}}),Be}function xe(se){var Be=new R,Ve=se.replace(/\r?\n[\t ]+/g," ");return Ve.split(/\r?\n/).forEach(function(Je){var ut=Je.split(":"),ht=ut.shift().trim();if(ht){var Et=ut.join(":").trim();Be.append(ht,Et)}}),Be}X.call(ne.prototype);function ke(se,Be){Be||(Be={}),this.type="default",this.status=Be.status===void 0?200:Be.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Be?Be.statusText:"OK",this.headers=new R(Be.headers),this.url=Be.url||"",this._initBody(se)}X.call(ke.prototype),ke.prototype.clone=function(){return new ke(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new R(this.headers),url:this.url})},ke.error=function(){var se=new ke(null,{status:0,statusText:""});return se.type="error",se};var Ie=[301,302,303,307,308];ke.redirect=function(se,Be){if(Ie.indexOf(Be)===-1)throw new RangeError("Invalid status code");return new ke(null,{status:Be,headers:{location:se}})},d.DOMException=u.DOMException;try{new d.DOMException}catch{d.DOMException=function(Be,Ve){this.message=Be,this.name=Ve;var Je=Error(Be);this.stack=Je.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function Fe(se,Be){return new Promise(function(Ve,Je){var ut=new ne(se,Be);if(ut.signal&&ut.signal.aborted)return Je(new d.DOMException("Aborted","AbortError"));var ht=new XMLHttpRequest;function Et(){ht.abort()}ht.onload=function(){var Qt={status:ht.status,statusText:ht.statusText,headers:xe(ht.getAllResponseHeaders()||"")};Qt.url="responseURL"in ht?ht.responseURL:Qt.headers.get("X-Request-URL");var Nt="response"in ht?ht.response:ht.responseText;Ve(new ke(Nt,Qt))},ht.onerror=function(){Je(new TypeError("Network request failed"))},ht.ontimeout=function(){Je(new TypeError("Network request failed"))},ht.onabort=function(){Je(new d.DOMException("Aborted","AbortError"))},ht.open(ut.method,ut.url,!0),ut.credentials==="include"?ht.withCredentials=!0:ut.credentials==="omit"&&(ht.withCredentials=!1),"responseType"in ht&&o.blob&&(ht.responseType="blob"),ut.headers.forEach(function(Qt,Nt){ht.setRequestHeader(Nt,Qt)}),ut.signal&&(ut.signal.addEventListener("abort",Et),ht.onreadystatechange=function(){ht.readyState===4&&ut.signal.removeEventListener("abort",Et)}),ht.send(typeof ut._bodyInit=="undefined"?null:ut._bodyInit)})}return Fe.polyfill=!0,u.fetch||(u.fetch=Fe,u.Headers=R,u.Request=ne,u.Response=ke),d.Headers=R,d.Request=ne,d.Response=ke,d.fetch=Fe,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(Rb,Rb.exports);var Z8=p4(Rb.exports);function yn(t){return(e,...r)=>q8(t,e,r)}function pd(t,e){return yn(LO(t,e).get)}const{apply:q8,construct:BJ,defineProperty:NJ,get:jJ,getOwnPropertyDescriptor:LO,getPrototypeOf:H1,has:$J,ownKeys:K8,set:VJ,setPrototypeOf:UJ}=Reflect,{iterator:Yp,species:GJ,toStringTag:X8,for:HJ}=Symbol,Y8=Object,{create:W1,defineProperty:J8,freeze:WJ,is:ZJ}=Y8,Q8=Array,eG=Q8.prototype,kO=eG[Yp],tG=yn(kO),zO=ArrayBuffer,rG=zO.prototype;pd(rG,"byteLength");const LA=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:null;LA&&pd(LA.prototype,"byteLength");const FO=H1(Uint8Array);FO.from;const Vn=FO.prototype;Vn[Yp];yn(Vn.keys);yn(Vn.values);yn(Vn.entries);yn(Vn.set);yn(Vn.reverse);yn(Vn.fill);yn(Vn.copyWithin);yn(Vn.sort);yn(Vn.slice);yn(Vn.subarray);pd(Vn,"buffer");pd(Vn,"byteOffset");pd(Vn,"length");pd(Vn,X8);const md=Uint32Array,iG=Float32Array,Rp=H1([][Yp]()),BO=yn(Rp.next),nG=yn(function*(){}().next),sG=H1(Rp),oG=DataView.prototype,aG=yn(oG.getUint16),Z1=WeakMap,NO=Z1.prototype,jO=yn(NO.get),lG=yn(NO.set),$O=new Z1,cG=W1(null,{next:{value:function(){const e=jO($O,this);return BO(e)}},[Yp]:{value:function(){return this}}});function uG(t){if(t[Yp]===kO&&Rp.next===BO)return t;const e=W1(cG);return lG($O,e,tG(t)),e}const hG=new Z1,dG=W1(sG,{next:{value:function(){const e=jO(hG,this);return nG(e)},writable:!0,configurable:!0}});for(const t of K8(Rp))t!=="next"&&J8(dG,t,LO(Rp,t));const VO=new zO(4),fG=new iG(VO),pG=new md(VO),Oo=new md(512),Do=new md(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(Oo[t]=0,Oo[t|256]=32768,Do[t]=24,Do[t|256]=24):e<-14?(Oo[t]=1024>>-e-14,Oo[t|256]=1024>>-e-14|32768,Do[t]=-e-1,Do[t|256]=-e-1):e<=15?(Oo[t]=e+15<<10,Oo[t|256]=e+15<<10|32768,Do[t]=13,Do[t|256]=13):e<128?(Oo[t]=31744,Oo[t|256]=64512,Do[t]=24,Do[t|256]=24):(Oo[t]=31744,Oo[t|256]=64512,Do[t]=13,Do[t|256]=13)}const q1=new md(2048),gd=new md(64),UO=new md(64);for(let t=1;t<1024;++t){let e=t<<13,r=0;for(;(e&8388608)===0;)e<<=1,r-=8388608;e&=-8388609,r+=947912704,q1[t]=e|r}for(let t=1024;t<2048;++t)q1[t]=939524096+(t-1024<<13);for(let t=1;t<31;++t)gd[t]=t<<23;gd[31]=1199570944;gd[32]=2147483648;for(let t=33;t<63;++t)gd[t]=2147483648+(t-32<<23);gd[63]=3347054592;for(let t=1;t<64;++t)t!==32&&(UO[t]=1024);function mG(t){const e=t>>10;return pG[0]=q1[UO[e]+(t&1023)]+gd[e],fG[0]}function GO(t,e,...r){return mG(aG(t,e,...uG(r)))}var K1={exports:{}};function HO(t,e,r){const n=r&&r.debug||!1;n&&console.log("getting "+e+" in "+t);const s=typeof t=="object"?t.outer:t,u=`${e}\\="([^"]*)"`;n&&console.log("pattern:",u);const o=new RegExp(u).exec(s);if(n&&console.log("match:",o),o)return o[1]}K1.exports=HO;K1.exports.default=HO;var kA=K1.exports,X1={exports:{}},Y1={exports:{}},J1={exports:{}};function WO(t,e,r){const s=new RegExp(e).exec(t.slice(r));return s?r+s.index:-1}J1.exports=WO;J1.exports.default=WO;var Q1={exports:{}};function ZO(t,e,r){const s=new RegExp(e).exec(t.slice(r));return s?r+s.index+s[0].length-1:-1}Q1.exports=ZO;Q1.exports.default=ZO;var ew={exports:{}};function qO(t,e){const r=new RegExp(e,"g"),n=t.match(r);return n?n.length:0}ew.exports=qO;ew.exports.default=qO;const gG=J1.exports,bx=Q1.exports,zA=ew.exports;function KO(t,e,r){const n=r&&r.debug||!1,s=!(r&&typeof r.nested===!1),u=r&&r.startIndex||0;n&&console.log("[xml-utils] starting findTagByName with",e," and ",r);const d=gG(t,`<${e}[ >/]`,u);if(n&&console.log("[xml-utils] start:",d),d===-1)return;const o=t.slice(d+e.length);let g=bx(o,"^[^<]*[ /]>",0);const x=g!==-1&&o[g-1]==="/";if(n&&console.log("[xml-utils] selfClosing:",x),x===!1)if(s){let I=0,R=1,z=0;for(;(g=bx(o,"[ /]"+e+">",I))!==-1;){const B=o.substring(I,g+1);if(R+=zA(B,"<"+e),z+=zA(B,"/"+e+">"),z>=R)break;I=g}}else g=bx(o,"[ /]"+e+">",0);const E=d+e.length+g+1;if(n&&console.log("[xml-utils] end:",E),E===-1)return;const S=t.slice(d,E);let P;return x?P=null:P=S.slice(S.indexOf(">")+1,S.lastIndexOf("<")),{inner:P,outer:S,start:d,end:E}}Y1.exports=KO;Y1.exports.default=KO;const _G=Y1.exports;function XO(t,e,r){const n=[],s=r&&r.debug||!1,u=r&&typeof r.nested=="boolean"?r.nested:!0;let d=r&&r.startIndex||0,o;for(;o=_G(t,e,{debug:s,startIndex:d});)u?d=o.start+1+e.length:d=o.end,n.push(o);return s&&console.log("findTagsByName found",n.length,"tags"),n}X1.exports=XO;X1.exports.default=XO;var yG=X1.exports;const mp={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},Lo={};for(const t in mp)mp.hasOwnProperty(t)&&(Lo[mp[t]]=parseInt(t,10));const vG=[Lo.BitsPerSample,Lo.ExtraSamples,Lo.SampleFormat,Lo.StripByteCounts,Lo.StripOffsets,Lo.StripRowCounts,Lo.TileByteCounts,Lo.TileOffsets,Lo.SubIFDs],wx={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},Cr={};for(const t in wx)wx.hasOwnProperty(t)&&(Cr[wx[t]]=parseInt(t,10));const _s={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},xG={Unspecified:0,Assocalpha:1,Unassalpha:2},qJ={Version:0,AddCompression:1},KJ={None:0,Deflate:1},bG={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function wG(t,e){const{width:r,height:n}=t,s=new Uint8Array(r*n*3);let u;for(let d=0,o=0;d<t.length;++d,o+=3)u=256-t[d]/e*256,s[o]=u,s[o+1]=u,s[o+2]=u;return s}function EG(t,e){const{width:r,height:n}=t,s=new Uint8Array(r*n*3);let u;for(let d=0,o=0;d<t.length;++d,o+=3)u=t[d]/e*256,s[o]=u,s[o+1]=u,s[o+2]=u;return s}function TG(t,e){const{width:r,height:n}=t,s=new Uint8Array(r*n*3),u=e.length/3,d=e.length/3*2;for(let o=0,g=0;o<t.length;++o,g+=3){const x=t[o];s[g]=e[x]/65536*256,s[g+1]=e[x+u]/65536*256,s[g+2]=e[x+d]/65536*256}return s}function SG(t){const{width:e,height:r}=t,n=new Uint8Array(e*r*3);for(let s=0,u=0;s<t.length;s+=4,u+=3){const d=t[s],o=t[s+1],g=t[s+2],x=t[s+3];n[u]=255*((255-d)/256)*((255-x)/256),n[u+1]=255*((255-o)/256)*((255-x)/256),n[u+2]=255*((255-g)/256)*((255-x)/256)}return n}function AG(t){const{width:e,height:r}=t,n=new Uint8ClampedArray(e*r*3);for(let s=0,u=0;s<t.length;s+=3,u+=3){const d=t[s],o=t[s+1],g=t[s+2];n[u]=d+1.402*(g-128),n[u+1]=d-.34414*(o-128)-.71414*(g-128),n[u+2]=d+1.772*(o-128)}return n}const PG=.95047,CG=1,IG=1.08883;function MG(t){const{width:e,height:r}=t,n=new Uint8Array(e*r*3);for(let s=0,u=0;s<t.length;s+=3,u+=3){const d=t[s+0],o=t[s+1]<<24>>24,g=t[s+2]<<24>>24;let x=(d+16)/116,E=o/500+x,S=x-g/200,P,I,R;E=PG*(E*E*E>.008856?E*E*E:(E-16/116)/7.787),x=CG*(x*x*x>.008856?x*x*x:(x-16/116)/7.787),S=IG*(S*S*S>.008856?S*S*S:(S-16/116)/7.787),P=E*3.2406+x*-1.5372+S*-.4986,I=E*-.9689+x*1.8758+S*.0415,R=E*.0557+x*-.204+S*1.057,P=P>.0031308?1.055*P**(1/2.4)-.055:12.92*P,I=I>.0031308?1.055*I**(1/2.4)-.055:12.92*I,R=R>.0031308?1.055*R**(1/2.4)-.055:12.92*R,n[u]=Math.max(0,Math.min(1,P))*255,n[u+1]=Math.max(0,Math.min(1,I))*255,n[u+2]=Math.max(0,Math.min(1,R))*255}return n}const OG="modulepreload",FA={},DG="/OpenEO-processes-js/",_d=function(e,r){return!r||r.length===0?e():Promise.all(r.map(n=>{if(n=`${DG}${n}`,n in FA)return;FA[n]=!0;const s=n.endsWith(".css"),u=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${u}`))return;const d=document.createElement("link");if(d.rel=s?"stylesheet":OG,s||(d.as="script",d.crossOrigin=""),d.href=n,document.head.appendChild(d),s)return new Promise((o,g)=>{d.addEventListener("load",o),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>e())},YO=new Map;function mu(t,e){Array.isArray(t)||(t=[t]),t.forEach(r=>YO.set(r,e))}async function RG(t){const e=YO.get(t.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${t.Compression}`);const r=await e();return new r(t)}mu([void 0,1],()=>_d(()=>import("./raw.f9f795b5.js"),["assets/raw.f9f795b5.js","assets/basedecoder.7751ec97.js"]).then(t=>t.default));mu(5,()=>_d(()=>import("./lzw.af7f834f.js"),["assets/lzw.af7f834f.js","assets/basedecoder.7751ec97.js"]).then(t=>t.default));mu(6,()=>{throw new Error("old style JPEG compression is not supported.")});mu(7,()=>_d(()=>import("./jpeg.d77a600d.js"),["assets/jpeg.d77a600d.js","assets/basedecoder.7751ec97.js"]).then(t=>t.default));mu([8,32946],()=>_d(()=>import("./deflate.64c996cb.js"),["assets/deflate.64c996cb.js","assets/pako.esm.5b8a81bf.js","assets/basedecoder.7751ec97.js"]).then(t=>t.default));mu(32773,()=>_d(()=>import("./packbits.13c43dee.js"),["assets/packbits.13c43dee.js","assets/basedecoder.7751ec97.js"]).then(t=>t.default));mu(34887,()=>_d(()=>import("./lerc.6e2afa0f.js"),["assets/lerc.6e2afa0f.js","assets/pako.esm.5b8a81bf.js","assets/basedecoder.7751ec97.js"]).then(t=>t.default));function dv(t,e,r,n=1){return new(Object.getPrototypeOf(t)).constructor(e*r*n)}function LG(t,e,r,n,s){const u=e/n,d=r/s;return t.map(o=>{const g=dv(o,n,s);for(let x=0;x<s;++x){const E=Math.min(Math.round(d*x),r-1);for(let S=0;S<n;++S){const P=Math.min(Math.round(u*S),e-1),I=o[E*e+P];g[x*n+S]=I}}return g})}function Gh(t,e,r){return(1-r)*t+r*e}function kG(t,e,r,n,s){const u=e/n,d=r/s;return t.map(o=>{const g=dv(o,n,s);for(let x=0;x<s;++x){const E=d*x,S=Math.floor(E),P=Math.min(Math.ceil(E),r-1);for(let I=0;I<n;++I){const R=u*I,z=R%1,B=Math.floor(R),$=Math.min(Math.ceil(R),e-1),j=o[S*e+B],G=o[S*e+$],K=o[P*e+B],X=o[P*e+$],re=Gh(Gh(j,G,z),Gh(K,X,z),E%1);g[x*n+I]=re}}return g})}function zG(t,e,r,n,s,u="nearest"){switch(u.toLowerCase()){case"nearest":return LG(t,e,r,n,s);case"bilinear":case"linear":return kG(t,e,r,n,s);default:throw new Error(`Unsupported resampling method: '${u}'`)}}function FG(t,e,r,n,s,u){const d=e/n,o=r/s,g=dv(t,n,s,u);for(let x=0;x<s;++x){const E=Math.min(Math.round(o*x),r-1);for(let S=0;S<n;++S){const P=Math.min(Math.round(d*S),e-1);for(let I=0;I<u;++I){const R=t[E*e*u+P*u+I];g[x*n*u+S*u+I]=R}}}return g}function BG(t,e,r,n,s,u){const d=e/n,o=r/s,g=dv(t,n,s,u);for(let x=0;x<s;++x){const E=o*x,S=Math.floor(E),P=Math.min(Math.ceil(E),r-1);for(let I=0;I<n;++I){const R=d*I,z=R%1,B=Math.floor(R),$=Math.min(Math.ceil(R),e-1);for(let j=0;j<u;++j){const G=t[S*e*u+B*u+j],K=t[S*e*u+$*u+j],X=t[P*e*u+B*u+j],re=t[P*e*u+$*u+j],ue=Gh(Gh(G,K,z),Gh(X,re,z),E%1);g[x*n*u+I*u+j]=ue}}}return g}function NG(t,e,r,n,s,u,d="nearest"){switch(d.toLowerCase()){case"nearest":return FG(t,e,r,n,s,u);case"bilinear":case"linear":return BG(t,e,r,n,s,u);default:throw new Error(`Unsupported resampling method: '${d}'`)}}function jG(t,e,r){let n=0;for(let s=e;s<r;++s)n+=t[s];return n}function Lb(t,e,r){switch(t){case 1:if(e<=8)return new Uint8Array(r);if(e<=16)return new Uint16Array(r);if(e<=32)return new Uint32Array(r);break;case 2:if(e===8)return new Int8Array(r);if(e===16)return new Int16Array(r);if(e===32)return new Int32Array(r);break;case 3:switch(e){case 16:case 32:return new Float32Array(r);case 64:return new Float64Array(r)}break}throw Error("Unsupported data format/bitsPerSample")}function $G(t,e){return(t===1||t===2)&&e<=32&&e%8===0?!1:!(t===3&&(e===16||e===32||e===64))}function VG(t,e,r,n,s,u,d){const o=new DataView(t),g=r===2?d*u:d*u*n,x=r===2?1:n,E=Lb(e,s,g),S=parseInt("1".repeat(s),2);if(e===1){let P;r===1?P=n*s:P=s;let I=u*P;(I&7)!==0&&(I=I+7&-8);for(let R=0;R<d;++R){const z=R*I;for(let B=0;B<u;++B){const $=z+B*x*s;for(let j=0;j<x;++j){const G=$+j*s,K=(R*u+B)*x+j,X=Math.floor(G/8),re=G%8;if(re+s<=8)E[K]=o.getUint8(X)>>8-s-re&S;else if(re+s<=16)E[K]=o.getUint16(X)>>16-s-re&S;else if(re+s<=24){const ue=o.getUint16(X)<<8|o.getUint8(X+2);E[K]=ue>>24-s-re&S}else E[K]=o.getUint32(X)>>32-s-re&S}}}}return E.buffer}class UG{constructor(e,r,n,s,u,d){this.fileDirectory=e,this.geoKeys=r,this.dataView=n,this.littleEndian=s,this.tiles=u?{}:null,this.isTiled=!e.StripOffsets;const o=e.PlanarConfiguration;if(this.planarConfiguration=typeof o=="undefined"?1:o,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=d}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel!="undefined"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip!="undefined"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let r=0;r<this.fileDirectory.BitsPerSample.length;++r)e+=this.getSampleByteSize(r);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const r=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,n=this.fileDirectory.BitsPerSample[e];switch(r){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(s,u){return GO(this,s,u)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,r){const n=this.getSampleFormat(e),s=this.getBitsPerSample(e);return Lb(n,s,r)}async getTileOrStrip(e,r,n,s,u){const d=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let g;const{tiles:x}=this;this.planarConfiguration===1?g=r*d+e:this.planarConfiguration===2&&(g=n*d*o+r*d+e);let E,S;this.isTiled?(E=this.fileDirectory.TileOffsets[g],S=this.fileDirectory.TileByteCounts[g]):(E=this.fileDirectory.StripOffsets[g],S=this.fileDirectory.StripByteCounts[g]);const P=(await this.source.fetch([{offset:E,length:S}],u))[0];let I;return x===null||!x[g]?(I=(async()=>{let R=await s.decode(this.fileDirectory,P);const z=this.getSampleFormat(),B=this.getBitsPerSample();return $G(z,B)&&(R=VG(R,z,this.planarConfiguration,this.getSamplesPerPixel(),B,this.getTileWidth(),this.getBlockHeight(r))),R})(),x!==null&&(x[g]=I)):I=x[g],{x:e,y:r,sample:n,data:await I}}async _readRaster(e,r,n,s,u,d,o,g,x){const E=this.getTileWidth(),S=this.getTileHeight(),P=this.getWidth(),I=this.getHeight(),R=Math.max(Math.floor(e[0]/E),0),z=Math.min(Math.ceil(e[2]/E),Math.ceil(P/E)),B=Math.max(Math.floor(e[1]/S),0),$=Math.min(Math.ceil(e[3]/S),Math.ceil(I/S)),j=e[2]-e[0];let G=this.getBytesPerPixel();const K=[],X=[];for(let ne=0;ne<r.length;++ne)this.planarConfiguration===1?K.push(jG(this.fileDirectory.BitsPerSample,0,r[ne])/8):K.push(0),X.push(this.getReaderForSample(r[ne]));const re=[],{littleEndian:ue}=this;for(let ne=B;ne<$;++ne)for(let we=R;we<z;++we)for(let xe=0;xe<r.length;++xe){const ke=xe,Ie=r[xe];this.planarConfiguration===2&&(G=this.getSampleByteSize(xe));const Fe=this.getTileOrStrip(we,ne,Ie,u,x);re.push(Fe),Fe.then(se=>{const Be=se.data,Ve=new DataView(Be),Je=this.getBlockHeight(se.y),ut=se.y*S,ht=se.x*E,Et=ut+Je,Qt=(se.x+1)*E,Nt=X[ke],yt=Math.min(Je,Je-(Et-e[3]),I-ut),et=Math.min(E,E-(Qt-e[2]),P-ht);for(let Ne=Math.max(0,e[1]-ut);Ne<yt;++Ne)for(let tt=Math.max(0,e[0]-ht);tt<et;++tt){const ft=(Ne*E+tt)*G,mt=Nt.call(Ve,ft+K[ke],ue);let Ht;s?(Ht=(Ne+ut-e[1])*j*r.length+(tt+ht-e[0])*r.length+ke,n[Ht]=mt):(Ht=(Ne+ut-e[1])*j+tt+ht-e[0],n[ke][Ht]=mt)}})}if(await Promise.all(re),d&&e[2]-e[0]!==d||o&&e[3]-e[1]!==o){let ne;return s?ne=NG(n,e[2]-e[0],e[3]-e[1],d,o,r.length,g):ne=zG(n,e[2]-e[0],e[3]-e[1],d,o,g),ne.width=d,ne.height=o,ne}return n.width=d||e[2]-e[0],n.height=o||e[3]-e[1],n}async readRasters({window:e,samples:r=[],interleave:n,pool:s=null,width:u,height:d,resampleMethod:o,fillValue:g,signal:x}={}){const E=e||[0,0,this.getWidth(),this.getHeight()];if(E[0]>E[2]||E[1]>E[3])throw new Error("Invalid subsets");const S=E[2]-E[0],P=E[3]-E[1],I=S*P,R=this.getSamplesPerPixel();if(!r||!r.length)for(let j=0;j<R;++j)r.push(j);else for(let j=0;j<r.length;++j)if(r[j]>=R)return Promise.reject(new RangeError(`Invalid sample index '${r[j]}'.`));let z;if(n){const j=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,G=Math.max.apply(null,this.fileDirectory.BitsPerSample);z=Lb(j,G,I*r.length),g&&z.fill(g)}else{z=[];for(let j=0;j<r.length;++j){const G=this.getArrayForSample(r[j],I);Array.isArray(g)&&j<g.length?G.fill(g[j]):g&&!Array.isArray(g)&&G.fill(g),z.push(G)}}const B=s||await RG(this.fileDirectory);return await this._readRaster(E,r,z,n,B,u,d,o,x)}async readRGB({window:e,interleave:r=!0,pool:n=null,width:s,height:u,resampleMethod:d,enableAlpha:o=!1,signal:g}={}){const x=e||[0,0,this.getWidth(),this.getHeight()];if(x[0]>x[2]||x[1]>x[3])throw new Error("Invalid subsets");const E=this.fileDirectory.PhotometricInterpretation;if(E===_s.RGB){let $=[0,1,2];if(this.fileDirectory.ExtraSamples!==xG.Unspecified&&o){$=[];for(let j=0;j<this.fileDirectory.BitsPerSample.length;j+=1)$.push(j)}return this.readRasters({window:e,interleave:r,samples:$,pool:n,width:s,height:u,resampleMethod:d,signal:g})}let S;switch(E){case _s.WhiteIsZero:case _s.BlackIsZero:case _s.Palette:S=[0];break;case _s.CMYK:S=[0,1,2,3];break;case _s.YCbCr:case _s.CIELab:S=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const P={window:x,interleave:!0,samples:S,pool:n,width:s,height:u,resampleMethod:d,signal:g},{fileDirectory:I}=this,R=await this.readRasters(P),z=2**this.fileDirectory.BitsPerSample[0];let B;switch(E){case _s.WhiteIsZero:B=wG(R,z);break;case _s.BlackIsZero:B=EG(R,z);break;case _s.Palette:B=TG(R,I.ColorMap);break;case _s.CMYK:B=SG(R);break;case _s.YCbCr:B=AG(R);break;case _s.CIELab:B=MG(R);break;default:throw new Error("Unsupported photometric interpretation.")}if(!r){const $=new Uint8Array(B.length/3),j=new Uint8Array(B.length/3),G=new Uint8Array(B.length/3);for(let K=0,X=0;K<B.length;K+=3,++X)$[X]=B[K],j[X]=B[K+1],G[X]=B[K+2];B=[$,j,G]}return B.width=R.width,B.height=R.height,B}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let r=0;r<this.fileDirectory.ModelTiepoint.length;r+=6)e.push({i:this.fileDirectory.ModelTiepoint[r],j:this.fileDirectory.ModelTiepoint[r+1],k:this.fileDirectory.ModelTiepoint[r+2],x:this.fileDirectory.ModelTiepoint[r+3],y:this.fileDirectory.ModelTiepoint[r+4],z:this.fileDirectory.ModelTiepoint[r+5]});return e}getGDALMetadata(e=null){const r={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let s=yG(n,"Item");e!==null&&(s=s.filter(u=>Number(kA(u,"sample"))===e));for(let u=0;u<s.length;++u){const d=s[u];r[kA(d,"name")]=d.inner}return r}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,r=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(r)return[r[3],r[7],r[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const r=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(r)return[r[0],-r[1],r[2]];if(n)return[n[0],n[5],n[10]];if(e){const[s,u,d]=e.getResolution();return[s*e.getWidth()/this.getWidth(),u*e.getHeight()/this.getHeight(),d*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const e=this.getOrigin(),r=this.getResolution(),n=e[0],s=e[1],u=n+r[0]*this.getWidth(),d=s+r[1]*this.getHeight();return[Math.min(n,u),Math.min(s,d),Math.max(n,u),Math.max(s,d)]}}var GG=UG;class HG{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,r){const n=this.getUint32(e,r),s=this.getUint32(e+4,r);let u;if(r){if(u=n+2**32*s,!Number.isSafeInteger(u))throw new Error(`${u} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return u}if(u=2**32*n+s,!Number.isSafeInteger(u))throw new Error(`${u} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return u}getInt64(e,r){let n=0;const s=(this._dataView.getUint8(e+(r?7:0))&128)>0;let u=!0;for(let d=0;d<8;d++){let o=this._dataView.getUint8(e+(r?d:7-d));s&&(u?o!==0&&(o=~(o-1)&255,u=!1):o=~o&255),n+=o*256**d}return s&&(n=-n),n}getUint8(e,r){return this._dataView.getUint8(e,r)}getInt8(e,r){return this._dataView.getInt8(e,r)}getUint16(e,r){return this._dataView.getUint16(e,r)}getInt16(e,r){return this._dataView.getInt16(e,r)}getUint32(e,r){return this._dataView.getUint32(e,r)}getInt32(e,r){return this._dataView.getInt32(e,r)}getFloat16(e,r){return GO(this._dataView,e,r)}getFloat32(e,r){return this._dataView.getFloat32(e,r)}getFloat64(e,r){return this._dataView.getFloat64(e,r)}}class WG{constructor(e,r,n,s){this._dataView=new DataView(e),this._sliceOffset=r,this._littleEndian=n,this._bigTiff=s}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,r){return this.sliceOffset<=e&&this.sliceTop>=e+r}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const r=this.readUint32(e),n=this.readUint32(e+4);let s;if(this._littleEndian){if(s=r+2**32*n,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}if(s=2**32*r+n,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}readInt64(e){let r=0;const n=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let s=!0;for(let u=0;u<8;u++){let d=this._dataView.getUint8(e+(this._littleEndian?u:7-u));n&&(s?d!==0&&(d=~(d-1)&255,s=!1):d=~d&255),r+=d*256**u}return n&&(r=-r),r}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}class JO{async fetch(e,r=void 0){return Promise.all(e.map(n=>this.fetchSlice(n,r)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class tw extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,tw),this.name="AbortError"}}var rw={};class ZG extends JO{constructor(e){super(),this.arrayBuffer=e}fetchSlice(e,r){if(r&&r.aborted)throw new tw("Request aborted");return this.arrayBuffer.slice(e.offset,e.offset+e.length)}}function qG(t){return new ZG(t)}function KG(t){return new Promise((e,r)=>{rw.close(t,n=>{n?r(n):e()})})}function XG(t,e,r=void 0){return new Promise((n,s)=>{rw.open(t,e,r,(u,d)=>{u?s(u):n(d)})})}function YG(...t){return new Promise((e,r)=>{rw.read(...t,(n,s,u)=>{n?r(n):e({bytesRead:s,buffer:u})})})}class JG extends JO{constructor(e){super(),this.path=e,this.openRequest=XG(e,"r")}async fetchSlice(e){const r=await this.openRequest,{buffer:n}=await YG(r,Buffer.alloc(e.length),0,e.length,e.offset);return n.buffer}async close(){const e=await this.openRequest;await KG(e)}}function QG(t){return new JG(t)}function kb(t){switch(t){case Cr.BYTE:case Cr.ASCII:case Cr.SBYTE:case Cr.UNDEFINED:return 1;case Cr.SHORT:case Cr.SSHORT:return 2;case Cr.LONG:case Cr.SLONG:case Cr.FLOAT:case Cr.IFD:return 4;case Cr.RATIONAL:case Cr.SRATIONAL:case Cr.DOUBLE:case Cr.LONG8:case Cr.SLONG8:case Cr.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${t}`)}}function e9(t){const e=t.GeoKeyDirectory;if(!e)return null;const r={};for(let n=4;n<=e[3]*4;n+=4){const s=bG[e[n]],u=e[n+1]?mp[e[n+1]]:null,d=e[n+2],o=e[n+3];let g=null;if(!u)g=o;else{if(g=t[u],typeof g=="undefined"||g===null)throw new Error(`Could not get value of geoKey '${s}'.`);typeof g=="string"?g=g.substring(o,o+d-1):g.subarray&&(g=g.subarray(o,o+d),d===1&&(g=g[0]))}r[s]=g}return r}function Eh(t,e,r,n){let s=null,u=null;const d=kb(e);switch(e){case Cr.BYTE:case Cr.ASCII:case Cr.UNDEFINED:s=new Uint8Array(r),u=t.readUint8;break;case Cr.SBYTE:s=new Int8Array(r),u=t.readInt8;break;case Cr.SHORT:s=new Uint16Array(r),u=t.readUint16;break;case Cr.SSHORT:s=new Int16Array(r),u=t.readInt16;break;case Cr.LONG:case Cr.IFD:s=new Uint32Array(r),u=t.readUint32;break;case Cr.SLONG:s=new Int32Array(r),u=t.readInt32;break;case Cr.LONG8:case Cr.IFD8:s=new Array(r),u=t.readUint64;break;case Cr.SLONG8:s=new Array(r),u=t.readInt64;break;case Cr.RATIONAL:s=new Uint32Array(r*2),u=t.readUint32;break;case Cr.SRATIONAL:s=new Int32Array(r*2),u=t.readInt32;break;case Cr.FLOAT:s=new Float32Array(r),u=t.readFloat32;break;case Cr.DOUBLE:s=new Float64Array(r),u=t.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===Cr.RATIONAL||e===Cr.SRATIONAL)for(let o=0;o<r;o+=2)s[o]=u.call(t,n+o*d),s[o+1]=u.call(t,n+(o*d+4));else for(let o=0;o<r;++o)s[o]=u.call(t,n+o*d);return e===Cr.ASCII?new TextDecoder("utf-8").decode(s):s}class t9{constructor(e,r,n){this.fileDirectory=e,this.geoKeyDirectory=r,this.nextIFDByteOffset=n}}class d_ extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class r9{async readRasters(e={}){const{window:r,width:n,height:s}=e;let{resX:u,resY:d,bbox:o}=e;const g=await this.getImage();let x=g;const E=await this.getImageCount(),S=g.getBoundingBox();if(r&&o)throw new Error('Both "bbox" and "window" passed.');if(n||s){if(r){const[R,z]=g.getOrigin(),[B,$]=g.getResolution();o=[R+r[0]*B,z+r[1]*$,R+r[2]*B,z+r[3]*$]}const I=o||S;if(n){if(u)throw new Error("Both width and resX passed");u=(I[2]-I[0])/n}if(s){if(d)throw new Error("Both width and resY passed");d=(I[3]-I[1])/s}}if(u||d){const I=[];for(let R=0;R<E;++R){const z=await this.getImage(R),{SubfileType:B,NewSubfileType:$}=z.fileDirectory;(R===0||B===2||$&1)&&I.push(z)}I.sort((R,z)=>R.getWidth()-z.getWidth());for(let R=0;R<I.length;++R){const z=I[R],B=(S[2]-S[0])/z.getWidth(),$=(S[3]-S[1])/z.getHeight();if(x=z,u&&u>B||d&&d>$)break}}let P=r;if(o){const[I,R]=g.getOrigin(),[z,B]=x.getResolution(g);P=[Math.round((o[0]-I)/z),Math.round((o[1]-R)/B),Math.round((o[2]-I)/z),Math.round((o[3]-R)/B)],P=[Math.min(P[0],P[2]),Math.min(P[1],P[3]),Math.max(P[0],P[2]),Math.max(P[1],P[3])]}return x.readRasters({...e,window:P})}}class fv extends r9{constructor(e,r,n,s,u={}){super(),this.source=e,this.littleEndian=r,this.bigTiff=n,this.firstIFDOffset=s,this.cache=u.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,r){const n=this.bigTiff?4048:1024;return new WG((await this.source.fetch([{offset:e,length:typeof r!="undefined"?r:n}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const r=this.bigTiff?20:12,n=this.bigTiff?8:2;let s=await this.getSlice(e);const u=this.bigTiff?s.readUint64(e):s.readUint16(e),d=u*r+(this.bigTiff?16:6);s.covers(e,d)||(s=await this.getSlice(e,d));const o={};let g=e+(this.bigTiff?8:2);for(let S=0;S<u;g+=r,++S){const P=s.readUint16(g),I=s.readUint16(g+2),R=this.bigTiff?s.readUint64(g+4):s.readUint32(g+4);let z,B;const $=kb(I),j=g+(this.bigTiff?12:8);if($*R<=(this.bigTiff?8:4))z=Eh(s,I,R,j);else{const G=s.readOffset(j),K=kb(I)*R;if(s.covers(G,K))z=Eh(s,I,R,G);else{const X=await this.getSlice(G,K);z=Eh(X,I,R,G)}}R===1&&vG.indexOf(P)===-1&&!(I===Cr.RATIONAL||I===Cr.SRATIONAL)?B=z[0]:B=z,o[mp[P]]=B}const x=e9(o),E=s.readOffset(e+n+r*u);return new t9(o,x,E)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(r){throw r instanceof d_?new d_(e):r}return this.ifdRequests[e]=(async()=>{const r=await this.ifdRequests[e-1];if(r.nextIFDByteOffset===0)throw new d_(e);return this.parseFileDirectoryAt(r.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const r=await this.requestIFD(e);return new GG(r.fileDirectory,r.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,r=!0;for(;r;)try{await this.requestIFD(e),++e}catch(n){if(n instanceof d_)r=!1;else throw n}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const r="GDAL_STRUCTURAL_METADATA_SIZE=",n=r.length+100;let s=await this.getSlice(e,n);if(r===Eh(s,Cr.ASCII,r.length,e)){const d=Eh(s,Cr.ASCII,n,e).split(`
`)[0],o=Number(d.split("=")[1].split(" ")[0])+d.length;o>n&&(s=await this.getSlice(e,o));const g=Eh(s,Cr.ASCII,o,e);this.ghostValues={},g.split(`
`).filter(x=>x.length>0).map(x=>x.split("=")).forEach(([x,E])=>{this.ghostValues[x]=E})}return this.ghostValues}static async fromSource(e,r,n){const s=(await e.fetch([{offset:0,length:1024}],n))[0],u=new HG(s),d=u.getUint16(0,0);let o;if(d===18761)o=!0;else if(d===19789)o=!1;else throw new TypeError("Invalid byte order value.");const g=u.getUint16(2,o);let x;if(g===42)x=!1;else if(g===43){if(x=!0,u.getUint16(4,o)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const E=x?u.getUint64(8,o):u.getUint32(4,o);return new fv(e,o,x,E,r)}close(){return typeof this.source.close=="function"?this.source.close():!1}}async function i9(t,e){return fv.fromSource(qG(t),e)}async function n9(t,e){return fv.fromSource(QG(t),e)}var QO={exports:{}};const s9=Z8,o9=G1,a9=xO,l9=hv,c9=po;var by,eD,wy,tD,Ey,rD,FP;QO.exports=(FP=class extends c9{constructor(){super(...arguments);Fn(this,by);Fn(this,wy);Fn(this,Ey)}async validate(r){await super.validate(r)}async execute(r){const n=r.getArgument("source");return await Bn(this,Ey,rD).call(this,n)}},by=new WeakSet,eD=function(r){try{new URL(r)}catch{return!1}return!0},wy=new WeakSet,tD=async function(r,n){const s=await r.getImage(0),u=await s.readRasters(),d={fileDirectory:s.getFileDirectory(),gdalMetadata:s.getGDALMetadata(),gdalNoData:s.getGDALNoData(),GeoKeys:s.getGeoKeys()},o=new o9([],n,d);let g=0;return u.map(x=>{const E=new l9(x,g);o.addBand(E),g++}),o},Ey=new WeakSet,rD=async function(r){typeof r=="string"&&(r=[r]);for(const s of r)try{const u=new a9([],[]);if(Bn(this,by,eD).call(this,s)){const g=await(await s9(s)).arrayBuffer();var n=await i9(g,{ovr:!0})}else var n=await n9(s,{ovr:!0});const d=await Bn(this,wy,tD).call(this,n,s);return u.rasters.push(d),u.tdimension.push(new Date),u}catch(u){console.error(u)}},FP);var u9=QO.exports,iD={exports:{}};const h9=po;var Ty,nD,BP;iD.exports=(BP=class extends h9{constructor(){super(...arguments);Fn(this,Ty)}async validate(r){await super.validate(r)}async execute(r){const n=r.getArgument("x"),s=r.getArgument("inputMin"),u=r.getArgument("inputMax");let d=r.getArgument("outputMin"),o=r.getArgument("outputMax");return o||(o=1),d||(d=0),await Bn(this,Ty,nD).call(this,n,u,s,o,d)}},Ty=new WeakSet,nD=function(r,n,s,u,d){if(r===n)return u;if(r===s)return d;const o=(r-s)/(n-s),g=u-d,x=o*g+d;return console.log(x),x},BP);var d9=iD.exports,sD={exports:{}};const f9=po;var Sy,oD,NP;sD.exports=(NP=class extends f9{constructor(){super(...arguments);Fn(this,Sy)}async validate(r){await super.validate(r)}async execute(r){const n=r.getArgument("data");return await Bn(this,Sy,oD).call(this,r,n)}},Sy=new WeakSet,oD=async function(r,n,s="process"){var u=r.getArgument(s);if(u instanceof uv.ProcessGraph){let d=[];for(let o=0;o<n.rasters.length;o++){let g=[];const x=n.rasters[o];for(let E=0;E<x.bands.length;E++){const S=n.rasters[o].bands[E],P=S.BufferArray.length,I=new Float32Array(P),R=[],z=[];for(let B=0;B<S.BufferArray.length;B+=1)if(R.indexOf(S.BufferArray[B])!==-1){const $=R.indexOf(S.BufferArray[B]);I[B]=z[$]}else{u.setArguments({typedArray:S.BufferArray,x:S.BufferArray[B]});const j=await(await u.execute()).getResult();I[B]=j,R.push(S.BufferArray[B]),z.push(j)}S.BufferArray=I,g.push(S)}x.bands=g,d.push(x)}return n.rasters=d,n}else throw Error({argument:reducerArgName,reason:"No "+reducerArgName+" specified."})},NP);var p9=sD.exports,aD={exports:{}};const m9=po;var Ay,lD,jP;aD.exports=(jP=class extends m9{constructor(){super(...arguments);Fn(this,Ay)}async validate(r){await super.validate(r)}async execute(r){const n=r.getArgument("x");return await Bn(this,Ay,lD).call(this,n)}},Ay=new WeakSet,lD=function(r){return r>0?r:r*-1},jP);var g9=aD.exports,cD={exports:{}};const _9=g9,y9=p9,v9=d9,x9=u9,b9=W8,w9=G8,E9=V8,T9=j8,S9=B8,A9=z8,P9=D8,C9={absolute:_9,apply:y9,linear_scale_range:v9,load_collection:x9,max:b9,mean:w9,median:E9,min:T9,mode:S9,ndvi:A9,reduce_dimension:P9};function I9(t){return C9[t]}cD.exports=I9;var M9=cD.exports,uD={exports:{}};const O9=M9;uD.exports=class hD extends uv.ProcessGraph{createProcessInstance(e){const r=O9(e.id);return new r(e)}async executeNode(e){return await this.getProcess(e).execute(e)}async validateNode(e){this.getProcess(e)}createProcessGraphInstance(e){let r=new hD(e,this.processRegistry,this.getJsonSchemaValidator());return this.copyProcessGraphInstanceProperties(r)}};var D9=uD.exports;const R9="reduce_dimension",L9="Reduce dimensions",k9="Applies a reducer to a data cube dimension by collapsing all the pixel values along the specified dimension into an output value computed by the reducer.\n\nThe dimension is dropped. To avoid this, use ``apply_dimension()`` instead.",z9=["cubes","reducer"],F9=[{name:"data",description:"A data cube.",schema:{type:"object",subtype:"raster-cube"}},{name:"reducer",description:"A reducer to apply on the specified dimension. A reducer is a single process such as ``mean()`` or a set of processes, which computes a single value for a list of values, see the category 'reducer' for such processes.",schema:{type:"object",subtype:"process-graph",parameters:[{name:"data",description:"A labeled array with elements of any type.",schema:{type:"array",subtype:"labeled-array",items:{description:"Any data type."}}},{name:"context",description:"Additional data passed by the user.",schema:{description:"Any data type."},optional:!0,default:null}],returns:{description:"The value to be set in the new data cube.",schema:{description:"Any data type."}}}},{name:"dimension",description:"The name of the dimension over which to reduce. Fails with a `DimensionNotAvailable` exception if the specified dimension does not exist.",schema:{type:"string"}},{name:"context",description:"Additional data to be passed to the reducer.",schema:{description:"Any data type."},optional:!0,default:null}],B9={description:"A data cube with the newly computed values. It is missing the given dimension, the number of dimensions decreases by one. The dimension properties (name, type, labels, reference system and resolution) for all other dimensions remain unchanged.",schema:{type:"object",subtype:"raster-cube"}},N9={DimensionNotAvailable:{message:"A dimension with the specified name does not exist."}},j9=[{href:"https://openeo.org/documentation/1.0/datacubes.html#reduce",rel:"about",title:"Reducers explained in the openEO documentation"}];var $9={id:R9,summary:L9,description:k9,categories:z9,parameters:F9,returns:B9,exceptions:N9,links:j9};const V9="ndvi",U9="Normalized Difference Vegetation Index",G9="Computes the Normalized Difference Vegetation Index (NDVI). The NDVI is computed as *`(nir - red) / (nir + red)`*.\n\nThe `data` parameter expects a raster data cube with a dimension of type `bands` or a `DimensionAmbiguous` exception is thrown otherwise. By default, the dimension must have at least two bands with the common names `red` and `nir` assigned. Otherwise, the user has to specify the parameters `nir` and `red`. If neither is the case, either the exception `NirBandAmbiguous` or `RedBandAmbiguous` is thrown. The common names for each band are specified in the collection's band metadata and are *not* equal to the band names.\n\nBy default, the dimension of type `bands` is dropped by this process. To keep the dimension specify a new band name in the parameter `target_band`. This adds a new dimension label with the specified name to the dimension, which can be used to access the computed values. If a band with the specified name exists, a `BandExists` is thrown.\n\nThis process is very similar to the process ``normalized_difference()``, but determines the bands automatically based on the common names (`red`/`nir`) specified in the metadata.",H9=["math > indices","vegetation indices"],W9=[{name:"data",description:"A raster data cube with two bands that have the common names `red` and `nir` assigned.",schema:{type:"object",subtype:"raster-cube"}},{name:"nir",description:"The name of the NIR band. Defaults to the band that has the common name `nir` assigned.\n\nEither the unique band name (metadata field `name` in bands) or one of the common band names (metadata field `common_name` in bands) can be specified. If the unique band name and the common name conflict, the unique band name has a higher priority.",schema:{type:"string",subtype:"band-name"},default:"nir",optional:!0},{name:"red",description:"The name of the red band. Defaults to the band that has the common name `red` assigned.\n\nEither the unique band name (metadata field `name` in bands) or one of the common band names (metadata field `common_name` in bands) can be specified. If the unique band name and the common name conflict, the unique band name has a higher priority.",schema:{type:"string",subtype:"band-name"},default:"red",optional:!0},{name:"target_band",description:"By default, the dimension of type `bands` is dropped. To keep the dimension specify a new band name in this parameter so that a new dimension label with the specified name will be added for the computed values.",schema:[{type:"string",pattern:"^\\w+$"},{type:"null"}],default:null,optional:!0}],Z9={description:"A raster data cube containing the computed NDVI values. The structure of the data cube differs depending on the value passed to `target_band`:\n\n* `target_band` is `null`: The data cube does not contain the dimension of type `bands`, the number of dimensions decreases by one. The dimension properties (name, type, labels, reference system and resolution) for all other dimensions remain unchanged.\n* `target_band` is a string: The data cube keeps the same dimensions. The dimension properties remain unchanged, but the number of dimension labels for the dimension of type `bands` increases by one. The additional label is named as specified in `target_band`.",schema:{type:"object",subtype:"raster-cube"}},q9={NirBandAmbiguous:{message:"The NIR band can't be resolved, please specify the specific NIR band name."},RedBandAmbiguous:{message:"The red band can't be resolved, please specify the specific red band name."},DimensionAmbiguous:{message:"dimension of type `bands` is not available or is ambiguous.."},BandExists:{message:"A band with the specified target name exists."}},K9=[{rel:"about",href:"https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index",title:"NDVI explained by Wikipedia"},{rel:"about",href:"https://earthobservatory.nasa.gov/features/MeasuringVegetation/measuring_vegetation_2.php",title:"NDVI explained by NASA"},{rel:"about",href:"https://github.com/radiantearth/stac-spec/tree/master/extensions/eo#common-band-names",title:"List of common band names as specified by the STAC specification"}];var X9={id:V9,summary:U9,description:G9,categories:H9,parameters:W9,returns:Z9,exceptions:q9,links:K9};const Y9="mode",J9="Estimates the mode value from a TypedArray",Q9="the function reccieves a TypedArray object and return the modeimum",eH=["mode"],tH=[{name:"data",description:"array Object",schema:[{type:"array"}]}],rH={description:"return a number",schema:{type:"number"}};var iH={id:Y9,summary:J9,description:Q9,categories:eH,parameters:tH,returns:rH};const nH="min",sH="Minimum value",oH="Computes the smallest value of an array of numbers, which is equal to the last element of a sorted (i.e., ordered) version of the array.\n\nAn array without non-`null` elements resolves always with `null`.",aH=["math","math > statistics","reducer"],lH=[{name:"data",description:"An array of numbers.",schema:{type:"array",items:{type:["number","null"]}}},{name:"ignore_nodata",description:"Indicates whether no-data values are ignored or not. Ignores them by default. Setting this flag to `false` considers no-data values so that `null` is returned if any value is such a value.",schema:{type:"boolean"},default:!0,optional:!0}],cH={description:"The minimum value.",schema:{type:["number","null"]}},uH=[{arguments:{data:[1,0,3,2]},returns:0},{arguments:{data:[5,2.5,null,-.7]},returns:-.7},{arguments:{data:[1,0,3,null,2],ignore_nodata:!1},returns:null},{arguments:{data:[]},returns:null}],hH=[{rel:"about",href:"http://mathworld.wolfram.com/Minimum.html",title:"Minimum explained by Wolfram MathWorld"}];var dH={id:nH,summary:sH,description:oH,categories:aH,parameters:lH,returns:cH,examples:uH,links:hH};const fH="median",pH="Statistical median",mH="The statistical median of an array of numbers is the value separating the higher half from the lower half of the data.\n\nAn array without non-`null` elements resolves always with `null`.\n\n**Remarks:**\n\n* For symmetric arrays, the result is equal to the ``mean()``.\n* The median can also be calculated by computing the ``quantiles()`` with a probability of *0.5*.",gH=["math > statistics","reducer"],_H=[{name:"data",description:"An array of numbers.",schema:{type:"array",items:{type:["number","null"]}}},{name:"ignore_nodata",description:"Indicates whether no-data values are ignored or not. Ignores them by default. Setting this flag to `false` considers no-data values so that `null` is returned if any value is such a value.",schema:{type:"boolean"},default:!0,optional:!0}],yH={description:"The computed statistical median.",schema:{type:["number","null"]}},vH=[{arguments:{data:[1,3,3,6,7,8,9]},returns:6},{arguments:{data:[1,2,3,4,5,6,8,9]},returns:4.5},{arguments:{data:[-1,-.5,null,1]},returns:-.5},{arguments:{data:[-1,0,null,1],ignore_nodata:!1},returns:null},{description:"The input array is empty: return `null`.",arguments:{data:[]},returns:null},{description:"The input array has only `null` elements: return `null`.",arguments:{data:[null,null]},returns:null}],xH=[{rel:"about",href:"http://mathworld.wolfram.com/StatisticalMedian.html",title:"Statistical Median explained by Wolfram MathWorld"}],bH={quantiles:{process_id:"quantiles",arguments:{data:{from_parameter:"data"},probabilities:[.5],ignore_nodata:{from_parameter:"ignore_nodata"}}},array_element:{process_id:"array_element",arguments:{data:{from_node:"quantiles"},return_nodata:!0,index:0},result:!0}};var wH={id:fH,summary:pH,description:mH,categories:gH,parameters:_H,returns:yH,examples:vH,links:xH,process_graph:bH};const EH="mean",TH="Arithmetic mean (average)",SH="The arithmetic mean of an array of numbers is the quantity commonly called the average. It is defined as the sum of all elements divided by the number of elements.\n\nAn array without non-`null` elements resolves always with `null`.",AH=["math > statistics","reducer"],PH=[{name:"data",description:"An array of numbers.",schema:{type:"array",items:{type:["number","null"]}}}],CH={description:"The computed arithmetic mean.",schema:{type:["number","null"]}},IH=[{arguments:{data:[1,0,3,2]},returns:1.5},{arguments:{data:[9,2.5,null,-2.5]},returns:3},{arguments:{data:[1,null],ignore_nodata:!1},returns:null},{description:"The input array is empty: return `null`.",arguments:{data:[]},returns:null},{description:"The input array has only `null` elements: return `null`.",arguments:{data:[null,null]},returns:null}],MH=[{rel:"about",href:"http://mathworld.wolfram.com/ArithmeticMean.html",title:"Arithmetic mean explained by Wolfram MathWorld"}],OH={count_condition:{process_id:"if",arguments:{value:{from_parameter:"ignore_nodata"},accept:null,reject:!0}},count:{process_id:"count",arguments:{data:{from_parameter:"data"},condition:{from_node:"count_condition"}}},sum:{process_id:"sum",arguments:{data:{from_parameter:"data"},ignore_nodata:{from_parameter:"ignore_nodata"}}},divide:{process_id:"divide",arguments:{x:{from_node:"sum"},y:{from_node:"count"}}},neq:{process_id:"neq",arguments:{x:{from_node:"count"},y:0}},if:{process_id:"if",arguments:{value:{from_node:"neq"},accept:{from_node:"divide"}},result:!0}};var DH={id:EH,summary:TH,description:SH,categories:AH,parameters:PH,returns:CH,examples:IH,links:MH,process_graph:OH};const RH="max",LH="Maximum value",kH="Computes the largest value of an array of numbers, which is equal to the first element of a sorted (i.e., ordered) version of the array.\n\nAn array without non-`null` elements resolves always with `null`.",zH=["math","math > statistics","reducer"],FH=[{name:"data",description:"An array of numbers.",schema:{type:"array",items:{type:["number","null"]}}}],BH={description:"The maximum value.",schema:{type:["number","null"]}},NH=[{arguments:{data:[1,0,3,2]},returns:3},{arguments:{data:[5,2.5,null,-.7]},returns:5},{arguments:{data:[1,0,3,null,2],ignore_nodata:!1},returns:null},{description:"The input array is empty: return `null`.",arguments:{data:[]},returns:null}],jH=[{rel:"about",href:"http://mathworld.wolfram.com/Maximum.html",title:"Maximum explained by Wolfram MathWorld"}];var $H={id:RH,summary:LH,description:kH,categories:zH,parameters:FH,returns:BH,examples:NH,links:jH};const VH="load_collection",UH="Load an image from Local or Remote sources",GH="Transform imagenary sources into RasterCubes ready to be processed",HH=["load_collection","datacube"],WH=[{name:"source",description:"Path or URL to the source",schema:[{type:"array"},{type:"string",pattern:"^[\\w\\-\\.~/]+$"}]}],ZH={description:"return a raster datacube object",schema:{type:"object",subtype:"OERastercube"}};var qH={id:VH,summary:UH,description:GH,categories:HH,parameters:WH,returns:ZH};const KH="linear_scale_range",XH="Linear transformation between two ranges",YH="Performs a linear transformation between the input and output range.\n\nThe given number in `x` is clipped to the bounds specified in `inputMin` and `inputMax` so that the underlying formula *`((x - inputMin) / (inputMax - inputMin)) * (outputMax - outputMin) + outputMin`* never returns any value lower than `outputMin` or greater than `outputMax`.\n\nPotential use case include\n\n* scaling values to the 8-bit range (0 - 255) often used for numeric representation of values in one of the channels of the [RGB colour model](https://en.wikipedia.org/wiki/RGB_color_model#Numeric_representations) or\n* calculating percentages (0 - 100).\n\nThe no-data value `null` is passed through and therefore gets propagated.",JH=["math"],QH=[{name:"x",description:"A number to transform. The number gets clipped to the bounds specified in `inputMin` and `inputMax`.",schema:{type:["number","null"]}},{name:"inputMin",description:"Minimum value the input can obtain.",schema:{type:"number"}},{name:"inputMax",description:"Maximum value the input can obtain.",schema:{type:"number"}},{name:"outputMin",description:"Minimum value of the desired output range.",schema:{type:"number"},default:0,optional:!0},{name:"outputMax",description:"Maximum value of the desired output range.",schema:{type:"number"},default:1,optional:!0}],eW={description:"The transformed number.",schema:{type:["number","null"]}},tW=[{arguments:{x:.3,inputMin:-1,inputMax:1,outputMin:0,outputMax:255},returns:165.75},{arguments:{x:25.5,inputMin:0,inputMax:255},returns:.1},{arguments:{x:null,inputMin:0,inputMax:100},returns:null},{description:"Shows that the input data is clipped.",arguments:{x:1.12,inputMin:0,inputMax:1,outputMin:0,outputMax:255},returns:255}],rW={subtract1:{process_id:"subtract",arguments:{x:{from_parameter:"x"},y:{from_parameter:"inputMin"}}},subtract2:{process_id:"subtract",arguments:{x:{from_parameter:"inputMax"},y:{from_parameter:"inputMin"}}},subtract3:{process_id:"subtract",arguments:{x:{from_parameter:"outputMax"},y:{from_parameter:"outputMin"}}},divide:{process_id:"divide",arguments:{x:{from_node:"subtract1"},y:{from_node:"subtract2"}}},multiply:{process_id:"multiply",arguments:{x:{from_node:"divide"},y:{from_node:"subtract3"}}},add:{process_id:"add",arguments:{x:{from_node:"multiply"},y:{from_parameter:"outputMin"}},result:!0}};var iW={id:KH,summary:XH,description:YH,categories:JH,parameters:QH,returns:eW,examples:tW,process_graph:rW};const nW="apply",sW="Apply a process to each pixel",oW="Applies a process to each pixel value in the data cube (i.e. a local operation). In contrast, the process ``apply_dimension()`` applies a process to all pixel values along a particular dimension.",aW=["cubes"],lW=[{name:"data",description:"A data cube.",schema:{type:"object",subtype:"raster-cube"}},{name:"process",description:"A process that accepts and returns a single value and is applied on each individual value in the data cube. The process may consist of multiple sub-processes and could, for example, consist of processes such as ``abs()`` or ``linear_scale_range()``.",schema:{type:"object",subtype:"process-graph",parameters:[{name:"x",description:"The value to process.",schema:{description:"Any data type."}},{name:"context",description:"Additional data passed by the user.",schema:{description:"Any data type."},optional:!0,default:null}],returns:{description:"The value to be set in the new data cube.",schema:{description:"Any data type."}}}},{name:"context",description:"Additional data to be passed to the process.",schema:{description:"Any data type."},optional:!0,default:null}],cW={description:"A data cube with the newly computed values and the same dimensions. The dimension properties (name, type, labels, reference system and resolution) remain unchanged.",schema:{type:"object",subtype:"raster-cube"}},uW=[{href:"https://openeo.org/documentation/1.0/datacubes.html#apply",rel:"about",title:"Apply explained in the openEO documentation"}];var hW={id:nW,summary:sW,description:oW,categories:aW,parameters:lW,returns:cW,links:uW};const dW="absolute",fW="Absolute value",pW='Computes the absolute value of a real number `x`, which is the "unsigned" portion of x and often denoted as *|x|*.\n\nThe no-data value `null` is passed through and therefore gets propagated.',mW=["math"],gW=[{name:"x",description:"A number.",schema:{type:["number","null"]}}],_W={description:"The computed absolute value.",schema:{type:["number","null"],minimum:0}},yW=[{arguments:{x:0},returns:0},{arguments:{x:3.5},returns:3.5},{arguments:{x:-.4},returns:.4},{arguments:{x:-3.5},returns:3.5}],vW=[{rel:"about",href:"http://mathworld.wolfram.com/AbsoluteValue.html",title:"Absolute value explained by Wolfram MathWorld"}],xW={lt:{process_id:"lt",arguments:{x:{from_parameter:"x"},y:0}},multiply:{process_id:"multiply",arguments:{x:{from_parameter:"x"},y:-1}},if:{process_id:"if",arguments:{value:{from_node:"lt"},accept:{from_node:"multiply"},reject:{from_parameter:"x"}},result:!0}};var bW={id:dW,summary:fW,description:pW,categories:mW,parameters:gW,returns:_W,examples:yW,links:vW,process_graph:xW},dD={exports:{}};const wW=bW,EW=hW,TW=iW,SW=qH,AW=$H,PW=DH,CW=wH,IW=dH,MW=iH,OW=X9,DW=$9,RW={absolute:wW,apply:EW,linear_scale_range:TW,load_collection:SW,max:AW,mean:PW,median:CW,min:IW,mode:MW,ndvi:OW,reduce_dimension:DW};dD.exports=RW;var LW=dD.exports,fD={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(Jy,function(){var r=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function n(S,P){return S.indexOf(P)===-1?S.length:S.indexOf(P)}function s(S){var P=S.replace(/^v/,"").replace(/\+.*$/,""),I=n(P,"-"),R=P.substring(0,I).split(".");return R.push(P.substring(I+1)),R}function u(S){return isNaN(Number(S))?S:Number(S)}function d(S){if(typeof S!="string")throw new TypeError("Invalid argument expected string");if(!r.test(S))throw new Error("Invalid argument not valid semver ('"+S+"' received)")}function o(S,P){[S,P].forEach(d);for(var I=s(S),R=s(P),z=0;z<Math.max(I.length-1,R.length-1);z++){var B=parseInt(I[z]||0,10),$=parseInt(R[z]||0,10);if(B>$)return 1;if($>B)return-1}var j=I[I.length-1],G=R[R.length-1];if(j&&G){var K=j.split(".").map(u),X=G.split(".").map(u);for(z=0;z<Math.max(K.length,X.length);z++){if(K[z]===void 0||typeof X[z]=="string"&&typeof K[z]=="number")return-1;if(X[z]===void 0||typeof K[z]=="string"&&typeof X[z]=="number"||K[z]>X[z])return 1;if(X[z]>K[z])return-1}}else if(j||G)return j?-1:1;return 0}var g=[">",">=","=","<","<="],x={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function E(S){if(typeof S!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof S);if(g.indexOf(S)===-1)throw new TypeError("Invalid operator, expected one of "+g.join("|"))}return o.validate=function(S){return typeof S=="string"&&r.test(S)},o.compare=function(S,P,I){E(I);var R=o(S,P);return x[I].indexOf(R)>-1},o})})(fD);const Ex=fD.exports;class so{static compare(e,r,n=null){return n!==null?Ex.compare(e,r,n):Ex(e,r)}static validate(e){return Ex.validate(e)}static findCompatible(e,r=!0,n=null,s=null){if(!Array.isArray(e)||e.length===0)return[];let u=e.filter(d=>{if(typeof d.url=="string"&&so.validate(d.api_version)){let o=so.validate(n),g=so.validate(s);return o&&g?so.compare(d.api_version,n,">=")&&so.compare(d.api_version,s,"<="):o?so.compare(d.api_version,n,">="):g?so.compare(d.api_version,s,"<="):!0}return!1});return u.length===0?[]:u.sort((d,o)=>{let g=d.production===!0,x=o.production===!0;return!r||g===x?so.compare(d.api_version,o.api_version)*-1:g?-1:1})}static findLatest(e,r=!0,n=null,s=null){let u=so.findCompatible(e,r,n,s);return u.length>0?u[0]:null}}var Jp=so;const BA=Ho,kW=Jp;class zW{static migrateLinks(e,r,n="related"){return Array.isArray(e)?e.filter(s=>BA.isObject(s)&&typeof s.href=="string").map(s=>(typeof s.rel!="string"&&(s.rel=n),s)):[]}static migrateDiscoveryParameters(e,r){if(kW.compare(r,"1.0.0-rc.2","<="))for(var n in e){if(!BA.isObject(e[n])){delete e[n];continue}let s=e[n].type;typeof s=="string"&&(e[n].type=[s,"null"]);let u=e[n].example;typeof u!="undefined"&&(e[n].examples=[u],delete e[n].example)}return e}}var iw=zW;const Qi=Ho,Cn=Jp,Lh=iw,Tx="0.0.0";class FW{static guessApiVersion(e){if(!Qi.isObject(e))return Tx;if(Cn.validate(e.api_version))return e.api_version;if(Cn.validate(e.version))return e.version;if(Array.isArray(e.endpoints)){if(e.endpoints.find(r=>r.path==="/file_formats"||r.path==="/conformance"||r.path==="/files"))return"1.0.0";if(e.endpoints.find(r=>r.path==="/output_formats"||r.path==="/files/{user_id}"))return"0.4.2";if(!e.backend_version&&!e.title&&!e.description&&!e.links)return"0.3.1"}return Tx}static convertCapabilitiesToLatestSpec(e,r=null,n=!0,s=!0,u="unknown",d="Unknown",o="0.0.0"){if(r===null&&(r=this.guessApiVersion(e)),r===Tx)return{};if(Cn.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";let g=Qi.deepClone(e);return n?g.api_version="1.0.0":g.api_version=r,Qi.isObject(g.billing)?g.billing=this.convertBillingToLatestSpec(g.billing,r):delete g.billing,g.endpoints=this.convertEndpointsToLatestSpec(g.endpoints,r,s),!n&&Cn.compare(r,"0.4.x","=")?g.stac_version="0.6.2":(n||typeof g.stac_version!="string")&&(g.stac_version="0.9.0"),typeof g.production!="boolean"&&(g.production=!!(Cn.compare(r,"1.0.0-rc.1","=")||Cn.compare(r,"1.0.0-rc.2","="))),typeof g.backend_version!="string"&&(g.backend_version=o),typeof g.id!="string"&&(g.id=u),typeof g.title!="string"&&(g.title=d),typeof g.description!="string"&&(g.description=""),g.links=Lh.migrateLinks(g.links,r),g}static convertBillingToLatestSpec(e,r){if(Cn.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";return Qi.isObject(e)?e=Qi.deepClone(e):e={},typeof e.currency!="string"&&(e.currency=null),e}static convertEndpointsToLatestSpec(e,r,n=!1){if(Cn.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";if(!Array.isArray(e))return[];if(e=Qi.deepClone(e),n){let u=Cn.compare(r,"0.4.x","="),d=Cn.compare(r,"1.0.0-rc.2","<"),o=function(g){let x="/process_graphs/{process_graph_id}",E=g.findIndex(S=>S.path===x);return E>=0?g[E].methods.indexOf("PUT")===-1&&g[E].methods.push("PUT"):g.push({path:x,methods:["PUT"]}),g};for(var s in e){let g=e[s];if(u)switch(g.path){case"/output_formats":g.path="/file_formats";break;case"/files/{user_id}":g.path="/files";break;case"/files/{user_id}/{path}":g.path="/files/{path}";break}if(d)switch(g.path){case"/process_graphs":let x=g.methods.indexOf("POST");x>=0&&(g.methods.splice(x,1),o(e));break;case"/process_graphs/{process_graph_id}":let E=g.methods.indexOf("PATCH");E>=0&&(g.methods.splice(E,1),o(e));break}}}return e}static convertOutputFormatsToLatestSpec(e,r){return this.convertFileFormatsToLatestSpec(e,r)}static convertFileFormatsToLatestSpec(e,r){if(Cn.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";return Qi.isObject(e)?e=Qi.deepClone(e):e={},Cn.compare(r,"0.4.x","=")&&Qi.isObject(e)&&(e={output:e}),e.input=NA(e.input,r),e.output=NA(e.output,r),e}static convertServiceTypesToLatestSpec(e,r){if(Cn.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";if(!Qi.isObject(e))return{};e=Qi.deepClone(e);for(let n in e)Qi.isObject(e[n])||(e[n]={}),Cn.compare(r,"0.4.x","=")&&(delete e[n].attributes,Qi.isObject(e[n].parameters)&&(e[n].configuration=e[n].parameters),delete e[n].parameters,Array.isArray(e[n].variables)&&(e[n].process_parameters=e[n].variables.map(s=>{let u={name:s.variable_id,description:typeof s.description=="string"?s.description:"",schema:{type:[typeof s.type=="string"?s.type:"string","null"]}};return typeof s.default!="undefined"&&(u.default=s.default),u})),delete e[n].variables),Qi.isObject(e[n].configuration)?e[n].configuration=Lh.migrateDiscoveryParameters(e[n].configuration,r):e[n].configuration={},Array.isArray(e[n].process_parameters)||(e[n].process_parameters=[]),typeof e[n].links!="undefined"&&(e[n].links=Lh.migrateLinks(e[n].links,r));return e}static convertUdfRuntimesToLatestSpec(e,r){if(Cn.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";if(!Qi.isObject(e))return{};e=Qi.deepClone(e);for(let n in e){if(Cn.compare(r,"0.4.x","=")){if(!Qi.isObject(e[n])){delete e[n];continue}e[n].description===null&&(e[n].description="")}typeof e[n].type!="string"&&(typeof e[n].docker=="string"?e[n].type="docker":e[n].type="language"),typeof e[n].links!="undefined"&&(e[n].links=Lh.migrateLinks(e[n].links,r))}return e}}const BW=["raster","vector","table","other"];function NA(t,e){Qi.isObject(t)||(t={});for(let r in t)Qi.isObject(t[r].parameters)?t[r].parameters=Lh.migrateDiscoveryParameters(t[r].parameters,e):t[r].parameters={},Array.isArray(t[r].gis_data_types)?t[r].gis_data_types=t[r].gis_data_types.filter(n=>BW.includes(n)):t[r].gis_data_types=[],typeof t[r].links!="undefined"&&(t[r].links=Lh.migrateLinks(t[r].links,e));return t}var NW=FW;const ys=Ho,Wf=Jp,jA=iw,$A={cube:"datacube",eo:"eo",label:"label",pc:"pointcloud",proj:"projection",sar:"sar",sat:"sat",sci:"scientific",view:"view"},VA={"item:license":"license","item:providers":"providers","eo:instrument":"instruments","eo:platform":"platform","eo:constellation":"constellation","eo:epsg":"proj:epsg","eo:off_nadir":"view:off_nadir","eo:azimuth":"view:azimuth","eo:sun_azimuth":"view:sun_azimuth","eo:sun_elevation":"view:sun_elevation","dtr:start_datetime":"start_datetime","dtr:end_datetime":"end_datetime","pc:schema":"pc:schemas","sar:type":"sar:product_type","sar:polarization":"sar:polarizations","sar:instrument":"instruments","sar:platform":"platform","sar:constellation":"constellation","sar:off_nadir":"sat:off_nadir_angle","sar:relative_orbit":"sat:relative_orbit","sar:pass_direction":"sat:orbit_state"},jW=["cube:dimensions","sci:publications","sci:doi","sci:citation"],$W=["spatial","temporal","bands","other"];class nw{static convertCollectionsToLatestSpec(e,r){if(Wf.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";return e=ys.deepClone(e),Array.isArray(e.collections)?e.collections=e.collections.map(n=>nw.convertCollectionToLatestSpec(n,r)).filter(n=>typeof n.id=="string"):e.collections=[],e.links=jA.migrateLinks(e.links,r),e}static convertCollectionToLatestSpec(e,r){if(Wf.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";let n=ys.deepClone(e);if(typeof n.id!="string"||n.id.length===0)return{};if((!Wf.validate(n.stac_version)||Wf.compare(n.stac_version,"0.9.0","<"))&&(n.stac_version="0.9.0"),ys.isObject(n.extent)||(n.extent={}),Wf.compare(r,"0.4.x","=")){if(Array.isArray(n.extent.spatial)&&(n.extent.spatial={bbox:[n.extent.spatial]}),Array.isArray(n.extent.temporal)&&(n.extent.temporal={interval:[n.extent.temporal]}),ys.isObject(n.properties)){ys.isObject(n.other_properties)||(n.other_properties={});for(let g in n.properties)n.other_properties[g]={values:[n.properties[g]]}}delete n.properties;let o=ys.isObject(n.other_properties)?n.other_properties:{};for(let g in o){let x=o[g];ys.isObject(x)&&(Array.isArray(x.extent)||Array.isArray(x.values))?Array.isArray(x.extent)?o[g]={min:x.extent[0],max:x.extent[1]}:x.values.findIndex(E=>!Array.isArray(E))===-1?x.values.length<=1?o[g]=x.values[0]:o[g]=x.values.reduce((E,S)=>E.concat(S)):o[g]=x.values:(typeof n[g]=="undefined"&&(n[g]=x),delete o[g])}delete n.other_properties,ys.isObject(n.summaries)||(n.summaries={});for(let g in o){let x=o[g];g==="sar:pass_direction"&&(x=x.map(E=>E===null?"geostationary":E)),(g==="sar:resolution"||g==="sar:pixel_spacing"||g==="sar:looks")&&Array.isArray(x)&&x.length>=2?(n.summaries[g+"_range"]=x.slice(0,1),n.summaries[g+"_azimuth"]=x.slice(1,2),x.length>2&&(n.summaries[g+"_equivalent_number"]=x.slice(2,3))):typeof VA[g]=="string"?n.summaries[VA[g]]=x:jW.includes(g)&&Array.isArray(x)&&x.length===1?n[g]=x[0]:n.summaries[g]=x}}if(typeof n.description!="string"&&(n.description=""),ys.isObject(n.extent.spatial)||(n.extent.spatial={}),ys.isObject(n.extent.temporal)||(n.extent.temporal={}),typeof n.license!="string"&&(n.license="proprietary"),ys.isObject(n.summaries)||(n.summaries={}),!ys.isObject(n["cube:dimensions"]))n["cube:dimensions"]={};else for(var s in n["cube:dimensions"])ys.isObject(n["cube:dimensions"][s])&&!$W.includes(n["cube:dimensions"][s].type)&&(n["cube:dimensions"][s].type="other");n.links=jA.migrateLinks(n.links);var u=Array.isArray(n.stac_extensions)?n.stac_extensions:[];for(var d in n){let o=null,g=d.split(":",1);d==="deprecated"||d==="version"?o="version":typeof $A[g]=="string"&&(o=$A[g]),o!==null&&!u.includes(o)&&u.push(o)}return u.sort(),n.stac_extensions=u,n}}var VW=nw;const ya=Ho,Hh=Jp,UA=iw;class sw{static convertProcessesToLatestSpec(e,r){if(Hh.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";return e=ya.deepClone(e),Array.isArray(e.processes)?e.processes=e.processes.map(n=>sw.convertProcessToLatestSpec(n,r)).filter(n=>typeof n.id=="string"):e.processes=[],e.links=UA.migrateLinks(e.links,r),e}static convertProcessToLatestSpec(e,r){if(Hh.compare(r,"0.3.x","<="))throw"Migrating from API version 0.3.0 and older is not supported.";if(e=ya.deepClone(e),typeof e.id!="string"||e.id.length===0)return{};if(Hh.compare(r,"0.4.x","=")){if(!Array.isArray(e.parameter_order)||e.parameter_order.length===0){e.parameter_order=[];for(let u in e.parameters)e.parameter_order.push(u)}let s=[];for(let u of e.parameter_order){let d={name:u};ya.isObject(e.parameters[u])&&Object.assign(d,e.parameters[u]),d.required||(d.optional=!0),delete d.required,s.push(d)}delete e.parameter_order,e.parameters=s}if(typeof e.description!="string"&&(e.description=""),Array.isArray(e.parameters))for(var n=e.parameters.length-1;n>=0;n--){let s=e.parameters[n];if(!ya.isObject(s)){e.parameters.splice(n,1);continue}typeof s.description!="string"&&(s.description=""),e.parameters[n]=GA(s,r)}else e.parameters=[];return ya.isObject(e.returns)||(e.returns={}),e.returns=GA(e.returns,r,!1),Array.isArray(e.examples)&&(e.examples=e.examples.filter(s=>ya.isObject(s)&&ya.isObject(s.arguments))),typeof e.links!="undefined"&&(e.links=UA.migrateLinks(e.links,r)),e}}function GA(t,e,r=!0){var n={};if(t.schema&&typeof t.schema=="object"&&(n=t.schema),Hh.compare(e,"0.4.x","=")){for(let d of["anyOf","oneOf"])if(Array.isArray(n[d])){r&&typeof n.default!="undefined"&&(t.default=n.default),n=n[d];break}let s=Hh.compare(e,"0.4.x")<=0&&typeof t.media_type!="undefined",u=Array.isArray(n)?n:[n];for(let d of u)d=pD(d),r&&typeof d.default!="undefined"&&(t.default=d.default,delete d.default),s&&(d.contentMediaType=t.media_type);s&&delete t.media_type}return Hh.compare(e,"0.4.x",">")&&typeof t.default!="undefined"&&(t.optional=!0),t.schema=n,t}function pD(t){if(ya.isObject(t)&&typeof t.type!="undefined"&&typeof t.format=="string"){switch(t.format){case"url":t.format="uri";break;case"proj-definition":t.deprecated=!0;break;case"callback":if(t.format="process-graph",ya.isObject(t.parameters)){let e=[];for(let r in t.parameters){let n=t.parameters[r],s={name:r,description:typeof n.description=="string"?n.description:"",schema:n};e.push(s)}t.parameters=e}break}t.subtype=t.format,["date-time","time","date","uri"].includes(t.format)||delete t.format}for(let e in t)t[e]&&typeof t[e]=="object"&&(t[e]=pD(t[e]));return t}var UW=sw;const GW=Xp,HW=yO,WW=Ho;class ZW{constructor(e=null,r=void 0){if(!WW.isObject(e)&&!Array.isArray(e))this.unspecified=!0,this.schemas=[];else if(this.unspecified=!1,this.schemas=GW.normalizeJsonSchema(e,!0).map(n=>new HW(n,this,r)),typeof r=="undefined"){let n=this.schemas.map(s=>s.default()).filter(s=>typeof s!="undefined");this.default=n[0]}else this.default=r;this.refs=[]}toJSON(){return this.schemas.map(e=>e.toJSON())}isEditable(){return this.unspecified||this.schemas.filter(e=>e.isEditable()&&!e.isNull()).length>0}is(e){var r=this.dataTypes();return r.length===1&&r[0]===e}nativeDataType(){return this.dataType(!0)}dataType(e=!1){var r=this.dataTypes(!0,e),n=r.indexOf("null");return r.length===1?r[0]:r.length===2&&n!==-1?r[n===0?1:0]:"mixed"}dataTypes(e=!1,r=!1){var n=this.schemas.map(s=>s.dataType(r)).filter((s,u,d)=>d.indexOf(s)===u);return n.length===0||n.includes("any")?["any"]:e?n:n.filter(s=>s!=="null")}nullable(){return this.unspecified||this.schemas.filter(e=>e.nullable()).length>0}}var mD=ZW;const qW=mD;class KW extends qW{constructor(e){super(e.schema,e.default),Object.assign(this,e)}}var XW=KW;const YW=NW,JW=VW,QW=UW,e7=yO,t7=XW,r7=mD,i7=Xp,n7=pO,s7=Jp,o7=Ho;var gD={MigrateCapabilities:YW,MigrateCollections:JW,MigrateProcesses:QW,ProcessDataType:e7,ProcessParameter:t7,ProcessSchema:r7,ProcessUtils:i7,ProcessRegistry:n7,Versions:s7,Utils:o7},_D={exports:{}};const HA=LW;_D.exports=class extends gD.ProcessRegistry{constructor(){super()}addFromFolder(e){const r=vD;Object.keys(HA).forEach(s=>{this.addFromFile(s)});const n=r.size(this.namespace("backend"));return console.info(`Loaded ${n} processes.`),Promise.resolve(n)}async addFromFile(e){const r=JSON.parse(JSON.stringify(HA[e]));delete r.process_graph,this.add(r,"backend")}};var a7=_D.exports,yD={exports:{}};const l7=a7,c7={size(t){return gD.Utils.size(t)},getRegistry(t){const e=t||"./src/processes",r=new l7;return r.addFromFolder(e),r}};yD.exports=c7;var vD=yD.exports;const ml=async t=>{console.log(t);const e=performance.now(),r=JSON.parse(JSON.stringify(t));console.log(r);const n=vD.getRegistry();console.log("processGraph");const s=new D9(r,n);console.log(s),console.log("excecute");const u=await s.execute();console.log(u);const d=await u.getResult(),o=performance.now()-e;return console.log({result:d,time:o,memory:performance.memory.usedJSHeapSize/1e6}),{result:d,time:o,memory:performance.memory.usedJSHeapSize/1e6}};const WA=["User Case 1","User Case 2","User Case 3","User Case 4"],ZA=["Graph","Map"],u7={components:{NavBar:f4,MapView:v4,Tabs:rp.exports.Tabs,Tab:rp.exports.Tab,TabPanels:rp.exports.TabPanels,TabPanel:rp.exports.TabPanel,LineChart:SV},setup(){const t=Rl({selectedTab:WA[0]}),e=Rl({selectedTabRight:ZA[0]});return{tabs:WA,...Vx(t),tabsRight:ZA,...Vx(e),usercases:{"User Case 1":{id:"uc1",title:"Loading an Image",description:"This user case take an image in geotiff or Optimize Geotiff and creates an OERastercube.",code:"",json:""},"User Case 2":{id:"uc2",title:"Calculating an NDVI",description:"This user case take an image in geotiff or Optimize Geotiff and creates an OERastercube, based on the bands given, the code computes an NDVI",code:"",json:""},"User Case 3":{id:"uc3",title:"Processing a Reducer + simple Apply",description:"This user case take an image in geotiff or Optimize Geotiff and creates an OERastercube, then the raster cube is reduced temporarily and then applying a simple function trought the resulted raster cube (Linear scale range function)",code:"",json:""},"User Case 4":{id:"uc4",title:"Complex Apply function",description:"In this case the user adds an Image and then we apply a linear scale algoritm to the raster cube. This scaling process implies finding max and min the each band before create the calculations We expect that the computational power and requirement to be higher than the previous user cases.",code:"",json:""}}}},data(){return{labelsA:["Whole Picture","Muenster outskirts","Muenster city","Muenster City Hall"],dataA:[],dataAM:[],labelsR:["10","30","50","100"],dataR:[],dataRM:[],graphKey:0,url:"https://joaherrerama.github.io/OpenEO-processes-js/assets/sample_data"}},computed:{pretty(t){return JSON.stringify(JSON.parse(t),null,2)}},methods:{async runUserCase(t){let e=["sentinel_muenster.tif","sentinel_muenster_bg1.tif","sentinel_muenster_bg2.tif","sentinel_muenster_center.tif"],r=["sentinel_muenster.tif","sentinel_muenster_30.tif","sentinel_muenster_50.tif","sentinel_muenster_100.tif"],n=[],s=[],u=[],d=null;switch(t){case"uc1":n=[],u=[],d=null,this.usercases["User Case 1"].json={process_graph:{load_collection:{process_id:"load_collection",arguments:{source:[]},description:"Loading the data; The order of the specified bands is important for the following reduce operation.",result:!0}}};var o=this.usercases["User Case 1"].json;for(let g of e){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 1"].json);n.push(x.time),s.push(x.memory),u.push({img:g,time:x.time,memory:x.memory})}this.dataA=n,this.dataAM=s,n=[],s=[];for(let g of r){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 1"].json);n.push(x.time),s.push(x.memory),u.push({img:g,time:x.time,memory:x.memory}),d=x.result}this.usercases["User Case 1"].array=d,this.usercases["User Case 1"].performance=u,this.dataR=n,this.dataRM=s,this.graphKey+=1;break;case"uc2":n=[],s=[],u=[],d=null,this.usercases["User Case 2"].json={process_graph:{load_collection:{process_id:"load_collection",arguments:{source:[]},description:"Loading the data; The order of the specified bands is important for the following reduce operation."},ndvi:{process_id:"ndvi",arguments:{rastercube:{from_node:"load_collection"},red:0,nir:3},result:!0}}};var o=this.usercases["User Case 2"].json;for(let g of e){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 2"].json);n.push(x.time),s.push(x.memory),u.push({img:g,time:x.time,memory:x.memory})}this.dataA=n,this.dataAM=s,n=[],s=[];for(let g of r){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 2"].json);n.push(x.time),s.push(x.memory),u.push({img:g,time:x.time,memory:x.memory}),d=x.result}this.usercases["User Case 2"].array=d,this.usercases["User Case 2"].performance=u,this.dataR=n,this.dataRM=s,this.graphKey+=1;break;case"uc3":n=[],s=[],u=[],d=null,this.usercases["User Case 3"].json={process_graph:{load_collection:{process_id:"load_collection",arguments:{source:[]},description:"Loading the data; The order of the specified bands is important for the following reduce operation."},reduce_bands:{process_id:"reduce_dimension",arguments:{data:{from_node:"load_collection"},reducer:{process_graph:{median:{process_id:"median",arguments:{data:{from_parameter:"data"}},result:!0}}},dimension:"temporal"},description:"reducer median"},apply:{process_id:"apply",arguments:{data:{from_node:"load_collection"},process:{process_graph:{linear_scale_range:{process_id:"linear_scale_range",arguments:{x:{from_parameter:"x"},inputMin:0,inputMax:65536,outputMin:-1,outputMax:1},result:!0}}}},description:"normalizing bands",result:!0}}};var o=this.usercases["User Case 3"].json;for(let g of e){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 3"].json);n.push(x.time),s.push(x.memory),u.push({img:g,time:x.time,memory:x.memory})}this.dataA=n,this.dataAM=s,n=[],s=[];for(let g of r){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 3"].json);n.push(x.time),s.push(x.memory),d=x.result,u.push({img:g,time:x.time,memory:x.memory})}this.usercases["User Case 3"].array=d,this.usercases["User Case 3"].performance=u,this.dataR=n,this.dataRM=s,this.graphKey+=1;break;case"uc4":n=[],s=[],u=[],d=null,this.usercases["User Case 4"].json={process_graph:{load_collection:{process_id:"load_collection",arguments:{source:[]},description:"Loading the data; The order of the specified bands is important for the following reduce operation."},apply:{process_id:"apply",arguments:{data:{from_node:"load_collection"},process:{process_graph:{absolute:{process_id:"absolute",arguments:{x:{from_parameter:"x"}},result:!0}}}},description:"abs on bands",result:!0}}};var o=this.usercases["User Case 4"].json;for(let g of e){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 4"].json);n.push(x.time),s.push(x.memory),u.push({img:g,time:x.time,memory:x.memory})}this.dataA=n,this.dataAM=s,n=[],s=[];for(let g of r){o.process_graph.load_collection.arguments.source=[`${this.url}/${g}`];const x=await ml(this.usercases["User Case 4"].json);n.push(x.time),s.push(x.memory),u.push({img:g,time:x.time,memory:x.memory}),d=x.result}this.usercases["User Case 4"].array=d,this.usercases["User Case 4"].performance=u,this.dataR=n,this.dataRM=s,this.graphKey+=1;break}}}},h7={class:"main"},d7={class:"row"},f7={class:"row"},p7={class:"col-6 text-center"},m7={class:"container"},g7=Nr("div",{class:"title-head"},[Nr("h4",null,"Performance Analysis")],-1),_7={class:"title"},y7=["id","onClick"],v7={class:"description"},x7={class:"process"},b7=Nr("h5",null,"Performance",-1),w7={class:"chroma"},E7=Nr("h5",null,"Process ProcessGraph",-1),T7={class:"chroma"},S7=Nr("h5",null,"Last result Result Arrays (All result in Console Dev)",-1),A7={class:"chroma"},P7=Nr("div",null,null,-1),C7={class:"col-6"},I7=Nr("div",{class:"title-head"},null,-1),M7={key:0,style:{margin:"20px 0px 20px 0px"}},O7=Nr("h5",null,"Time & Space",-1),D7=Nr("p",null,"different areas",-1),R7={key:1},L7=Nr("h5",null,"Time & Space",-1),k7=Nr("p",null,"different resolutions",-1);function z7(t,e,r,n,s,u){const d=ga("nav-bar"),o=ga("tab"),g=ga("tabs"),x=ga("tab-panel"),E=ga("tab-panels"),S=ga("line-chart"),P=ga("MapView");return kr(),xi("div",h7,[Nr("div",d7,[ri(d)]),Nr("div",f7,[Nr("div",p7,[Nr("div",m7,[g7,ri(g,{modelValue:t.selectedTab,"onUpdate:modelValue":e[0]||(e[0]=I=>t.selectedTab=I)},{default:Fo(()=>[(kr(!0),xi(Ri,null,Gc(n.tabs,(I,R)=>(kr(),os(o,{class:"tab",key:`t${R}`,val:I,label:I,indicator:!0},null,8,["val","label"]))),128))]),_:1},8,["modelValue"]),ri(E,{modelValue:t.selectedTab,"onUpdate:modelValue":e[1]||(e[1]=I=>t.selectedTab=I),animate:!0},{default:Fo(()=>[(kr(!0),xi(Ri,null,Gc(n.tabs,(I,R)=>(kr(),os(x,{key:`tp${R}`,val:I},{default:Fo(()=>{var z,B,$,j,G,K;return[Nr("div",_7,[Nr("h4",null,bl((z=n.usercases[I])==null?void 0:z.title),1),Nr("button",{class:"btn btn-dark",type:"button",id:(B=n.usercases[I])==null?void 0:B.id,onClick:X=>{var re;return u.runUserCase((re=n.usercases[I])==null?void 0:re.id)}},"Run user case",8,y7)]),Nr("div",v7,[Nr("p",null,bl(($=n.usercases[I])==null?void 0:$.description),1)]),Nr("div",x7,[b7,(kr(),xi("div",{class:"highlight",key:s.graphKey},[Nr("pre",w7,"                    "+bl((j=n.usercases[I])==null?void 0:j.performance)+`
                `,1)])),E7,(kr(),xi("div",{class:"highlight",key:s.graphKey},[Nr("pre",T7,"                    "+bl((G=n.usercases[I])==null?void 0:G.json)+`
                `,1)])),S7,(kr(),xi("div",{class:"highlight",key:s.graphKey},[Nr("pre",A7,"                    "+bl((K=n.usercases[I])==null?void 0:K.array)+`
                `,1)])),P7])]}),_:2},1032,["val"]))),128))]),_:1},8,["modelValue"])])]),Nr("div",C7,[I7,ri(g,{modelValue:t.selectedTabRight,"onUpdate:modelValue":e[2]||(e[2]=I=>t.selectedTabRight=I)},{default:Fo(()=>[(kr(!0),xi(Ri,null,Gc(n.tabsRight,(I,R)=>(kr(),os(o,{class:"tab",key:`t${R}`,val:I,label:I,indicator:!0},null,8,["val","label"]))),128))]),_:1},8,["modelValue"]),ri(E,{modelValue:t.selectedTabRight,"onUpdate:modelValue":e[3]||(e[3]=I=>t.selectedTabRight=I),animate:!0},{default:Fo(()=>[(kr(!0),xi(Ri,null,Gc(n.tabsRight,(I,R)=>(kr(),os(x,{key:`tp${R}`,val:I},{default:Fo(()=>[I=="Graph"?(kr(),xi("div",M7,[O7,D7,(kr(),os(S,{id:"chart1",labels:s.labelsA,data:s.dataA,dataM:s.dataAM,key:s.graphKey},null,8,["labels","data","dataM"]))])):Jc("",!0),I=="Graph"?(kr(),xi("div",R7,[L7,k7,(kr(),os(S,{id:"chart2",labels:s.labelsR,data:s.dataR,dataM:s.dataRM,key:s.graphKey},null,8,["labels","data","dataM"]))])):Jc("",!0),I=="Map"?(kr(),os(P,{key:2})):Jc("",!0)]),_:2},1032,["val"]))),128))]),_:1},8,["modelValue"])])])])}var F7=Hp(u7,[["render",z7]]);const B7=t4({history:vB("/OpenEO-processes-js/"),routes:[{path:"/",name:"home",component:F7}]});var jn="top",Ps="bottom",Cs="right",$n="left",pv="auto",yd=[jn,Ps,Cs,$n],uu="start",id="end",xD="clippingParents",ow="viewport",Ih="popper",bD="reference",zb=yd.reduce(function(t,e){return t.concat([e+"-"+uu,e+"-"+id])},[]),aw=[].concat(yd,[pv]).reduce(function(t,e){return t.concat([e,e+"-"+uu,e+"-"+id])},[]),wD="beforeRead",ED="read",TD="afterRead",SD="beforeMain",AD="main",PD="afterMain",CD="beforeWrite",ID="write",MD="afterWrite",OD=[wD,ED,TD,SD,AD,PD,CD,ID,MD];function Go(t){return t?(t.nodeName||"").toLowerCase():null}function Zs(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function hu(t){var e=Zs(t).Element;return t instanceof e||t instanceof Element}function Gs(t){var e=Zs(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function lw(t){if(typeof ShadowRoot=="undefined")return!1;var e=Zs(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function N7(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},s=e.attributes[r]||{},u=e.elements[r];!Gs(u)||!Go(u)||(Object.assign(u.style,n),Object.keys(s).forEach(function(d){var o=s[d];o===!1?u.removeAttribute(d):u.setAttribute(d,o===!0?"":o)}))})}function j7(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var s=e.elements[n],u=e.attributes[n]||{},d=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=d.reduce(function(g,x){return g[x]="",g},{});!Gs(s)||!Go(s)||(Object.assign(s.style,o),Object.keys(u).forEach(function(g){s.removeAttribute(g)}))})}}var cw={name:"applyStyles",enabled:!0,phase:"write",fn:N7,effect:j7,requires:["computeStyles"]};function $o(t){return t.split("-")[0]}var ru=Math.max,hy=Math.min,nd=Math.round;function Fb(){var t=navigator.userAgentData;return t!=null&&t.brands?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function DD(){return!/^((?!chrome|android).)*safari/i.test(Fb())}function sd(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),s=1,u=1;e&&Gs(t)&&(s=t.offsetWidth>0&&nd(n.width)/t.offsetWidth||1,u=t.offsetHeight>0&&nd(n.height)/t.offsetHeight||1);var d=hu(t)?Zs(t):window,o=d.visualViewport,g=!DD()&&r,x=(n.left+(g&&o?o.offsetLeft:0))/s,E=(n.top+(g&&o?o.offsetTop:0))/u,S=n.width/s,P=n.height/u;return{width:S,height:P,top:E,right:x+S,bottom:E+P,left:x,x,y:E}}function uw(t){var e=sd(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function RD(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&lw(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Ma(t){return Zs(t).getComputedStyle(t)}function $7(t){return["table","td","th"].indexOf(Go(t))>=0}function Hl(t){return((hu(t)?t.ownerDocument:t.document)||window.document).documentElement}function mv(t){return Go(t)==="html"?t:t.assignedSlot||t.parentNode||(lw(t)?t.host:null)||Hl(t)}function qA(t){return!Gs(t)||Ma(t).position==="fixed"?null:t.offsetParent}function V7(t){var e=/firefox/i.test(Fb()),r=/Trident/i.test(Fb());if(r&&Gs(t)){var n=Ma(t);if(n.position==="fixed")return null}var s=mv(t);for(lw(s)&&(s=s.host);Gs(s)&&["html","body"].indexOf(Go(s))<0;){var u=Ma(s);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||e&&u.willChange==="filter"||e&&u.filter&&u.filter!=="none")return s;s=s.parentNode}return null}function Qp(t){for(var e=Zs(t),r=qA(t);r&&$7(r)&&Ma(r).position==="static";)r=qA(r);return r&&(Go(r)==="html"||Go(r)==="body"&&Ma(r).position==="static")?e:r||V7(t)||e}function hw(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function gp(t,e,r){return ru(t,hy(e,r))}function U7(t,e,r){var n=gp(t,e,r);return n>r?r:n}function LD(){return{top:0,right:0,bottom:0,left:0}}function kD(t){return Object.assign({},LD(),t)}function zD(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var G7=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,kD(typeof e!="number"?e:zD(e,yd))};function H7(t){var e,r=t.state,n=t.name,s=t.options,u=r.elements.arrow,d=r.modifiersData.popperOffsets,o=$o(r.placement),g=hw(o),x=[$n,Cs].indexOf(o)>=0,E=x?"height":"width";if(!(!u||!d)){var S=G7(s.padding,r),P=uw(u),I=g==="y"?jn:$n,R=g==="y"?Ps:Cs,z=r.rects.reference[E]+r.rects.reference[g]-d[g]-r.rects.popper[E],B=d[g]-r.rects.reference[g],$=Qp(u),j=$?g==="y"?$.clientHeight||0:$.clientWidth||0:0,G=z/2-B/2,K=S[I],X=j-P[E]-S[R],re=j/2-P[E]/2+G,ue=gp(K,re,X),ne=g;r.modifiersData[n]=(e={},e[ne]=ue,e.centerOffset=ue-re,e)}}function W7(t){var e=t.state,r=t.options,n=r.element,s=n===void 0?"[data-popper-arrow]":n;s!=null&&(typeof s=="string"&&(s=e.elements.popper.querySelector(s),!s)||!RD(e.elements.popper,s)||(e.elements.arrow=s))}var FD={name:"arrow",enabled:!0,phase:"main",fn:H7,effect:W7,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function od(t){return t.split("-")[1]}var Z7={top:"auto",right:"auto",bottom:"auto",left:"auto"};function q7(t){var e=t.x,r=t.y,n=window,s=n.devicePixelRatio||1;return{x:nd(e*s)/s||0,y:nd(r*s)/s||0}}function KA(t){var e,r=t.popper,n=t.popperRect,s=t.placement,u=t.variation,d=t.offsets,o=t.position,g=t.gpuAcceleration,x=t.adaptive,E=t.roundOffsets,S=t.isFixed,P=d.x,I=P===void 0?0:P,R=d.y,z=R===void 0?0:R,B=typeof E=="function"?E({x:I,y:z}):{x:I,y:z};I=B.x,z=B.y;var $=d.hasOwnProperty("x"),j=d.hasOwnProperty("y"),G=$n,K=jn,X=window;if(x){var re=Qp(r),ue="clientHeight",ne="clientWidth";if(re===Zs(r)&&(re=Hl(r),Ma(re).position!=="static"&&o==="absolute"&&(ue="scrollHeight",ne="scrollWidth")),re=re,s===jn||(s===$n||s===Cs)&&u===id){K=Ps;var we=S&&re===X&&X.visualViewport?X.visualViewport.height:re[ue];z-=we-n.height,z*=g?1:-1}if(s===$n||(s===jn||s===Ps)&&u===id){G=Cs;var xe=S&&re===X&&X.visualViewport?X.visualViewport.width:re[ne];I-=xe-n.width,I*=g?1:-1}}var ke=Object.assign({position:o},x&&Z7),Ie=E===!0?q7({x:I,y:z}):{x:I,y:z};if(I=Ie.x,z=Ie.y,g){var Fe;return Object.assign({},ke,(Fe={},Fe[K]=j?"0":"",Fe[G]=$?"0":"",Fe.transform=(X.devicePixelRatio||1)<=1?"translate("+I+"px, "+z+"px)":"translate3d("+I+"px, "+z+"px, 0)",Fe))}return Object.assign({},ke,(e={},e[K]=j?z+"px":"",e[G]=$?I+"px":"",e.transform="",e))}function K7(t){var e=t.state,r=t.options,n=r.gpuAcceleration,s=n===void 0?!0:n,u=r.adaptive,d=u===void 0?!0:u,o=r.roundOffsets,g=o===void 0?!0:o,x={placement:$o(e.placement),variation:od(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,KA(Object.assign({},x,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:d,roundOffsets:g})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,KA(Object.assign({},x,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var dw={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:K7,data:{}},f_={passive:!0};function X7(t){var e=t.state,r=t.instance,n=t.options,s=n.scroll,u=s===void 0?!0:s,d=n.resize,o=d===void 0?!0:d,g=Zs(e.elements.popper),x=[].concat(e.scrollParents.reference,e.scrollParents.popper);return u&&x.forEach(function(E){E.addEventListener("scroll",r.update,f_)}),o&&g.addEventListener("resize",r.update,f_),function(){u&&x.forEach(function(E){E.removeEventListener("scroll",r.update,f_)}),o&&g.removeEventListener("resize",r.update,f_)}}var fw={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:X7,data:{}},Y7={left:"right",right:"left",bottom:"top",top:"bottom"};function F_(t){return t.replace(/left|right|bottom|top/g,function(e){return Y7[e]})}var J7={start:"end",end:"start"};function XA(t){return t.replace(/start|end/g,function(e){return J7[e]})}function pw(t){var e=Zs(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function mw(t){return sd(Hl(t)).left+pw(t).scrollLeft}function Q7(t,e){var r=Zs(t),n=Hl(t),s=r.visualViewport,u=n.clientWidth,d=n.clientHeight,o=0,g=0;if(s){u=s.width,d=s.height;var x=DD();(x||!x&&e==="fixed")&&(o=s.offsetLeft,g=s.offsetTop)}return{width:u,height:d,x:o+mw(t),y:g}}function eZ(t){var e,r=Hl(t),n=pw(t),s=(e=t.ownerDocument)==null?void 0:e.body,u=ru(r.scrollWidth,r.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),d=ru(r.scrollHeight,r.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),o=-n.scrollLeft+mw(t),g=-n.scrollTop;return Ma(s||r).direction==="rtl"&&(o+=ru(r.clientWidth,s?s.clientWidth:0)-u),{width:u,height:d,x:o,y:g}}function gw(t){var e=Ma(t),r=e.overflow,n=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+s+n)}function BD(t){return["html","body","#document"].indexOf(Go(t))>=0?t.ownerDocument.body:Gs(t)&&gw(t)?t:BD(mv(t))}function _p(t,e){var r;e===void 0&&(e=[]);var n=BD(t),s=n===((r=t.ownerDocument)==null?void 0:r.body),u=Zs(n),d=s?[u].concat(u.visualViewport||[],gw(n)?n:[]):n,o=e.concat(d);return s?o:o.concat(_p(mv(d)))}function Bb(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function tZ(t,e){var r=sd(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function YA(t,e,r){return e===ow?Bb(Q7(t,r)):hu(e)?tZ(e,r):Bb(eZ(Hl(t)))}function rZ(t){var e=_p(mv(t)),r=["absolute","fixed"].indexOf(Ma(t).position)>=0,n=r&&Gs(t)?Qp(t):t;return hu(n)?e.filter(function(s){return hu(s)&&RD(s,n)&&Go(s)!=="body"}):[]}function iZ(t,e,r,n){var s=e==="clippingParents"?rZ(t):[].concat(e),u=[].concat(s,[r]),d=u[0],o=u.reduce(function(g,x){var E=YA(t,x,n);return g.top=ru(E.top,g.top),g.right=hy(E.right,g.right),g.bottom=hy(E.bottom,g.bottom),g.left=ru(E.left,g.left),g},YA(t,d,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function ND(t){var e=t.reference,r=t.element,n=t.placement,s=n?$o(n):null,u=n?od(n):null,d=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,g;switch(s){case jn:g={x:d,y:e.y-r.height};break;case Ps:g={x:d,y:e.y+e.height};break;case Cs:g={x:e.x+e.width,y:o};break;case $n:g={x:e.x-r.width,y:o};break;default:g={x:e.x,y:e.y}}var x=s?hw(s):null;if(x!=null){var E=x==="y"?"height":"width";switch(u){case uu:g[x]=g[x]-(e[E]/2-r[E]/2);break;case id:g[x]=g[x]+(e[E]/2-r[E]/2);break}}return g}function ad(t,e){e===void 0&&(e={});var r=e,n=r.placement,s=n===void 0?t.placement:n,u=r.strategy,d=u===void 0?t.strategy:u,o=r.boundary,g=o===void 0?xD:o,x=r.rootBoundary,E=x===void 0?ow:x,S=r.elementContext,P=S===void 0?Ih:S,I=r.altBoundary,R=I===void 0?!1:I,z=r.padding,B=z===void 0?0:z,$=kD(typeof B!="number"?B:zD(B,yd)),j=P===Ih?bD:Ih,G=t.rects.popper,K=t.elements[R?j:P],X=iZ(hu(K)?K:K.contextElement||Hl(t.elements.popper),g,E,d),re=sd(t.elements.reference),ue=ND({reference:re,element:G,strategy:"absolute",placement:s}),ne=Bb(Object.assign({},G,ue)),we=P===Ih?ne:re,xe={top:X.top-we.top+$.top,bottom:we.bottom-X.bottom+$.bottom,left:X.left-we.left+$.left,right:we.right-X.right+$.right},ke=t.modifiersData.offset;if(P===Ih&&ke){var Ie=ke[s];Object.keys(xe).forEach(function(Fe){var se=[Cs,Ps].indexOf(Fe)>=0?1:-1,Be=[jn,Ps].indexOf(Fe)>=0?"y":"x";xe[Fe]+=Ie[Be]*se})}return xe}function nZ(t,e){e===void 0&&(e={});var r=e,n=r.placement,s=r.boundary,u=r.rootBoundary,d=r.padding,o=r.flipVariations,g=r.allowedAutoPlacements,x=g===void 0?aw:g,E=od(n),S=E?o?zb:zb.filter(function(R){return od(R)===E}):yd,P=S.filter(function(R){return x.indexOf(R)>=0});P.length===0&&(P=S);var I=P.reduce(function(R,z){return R[z]=ad(t,{placement:z,boundary:s,rootBoundary:u,padding:d})[$o(z)],R},{});return Object.keys(I).sort(function(R,z){return I[R]-I[z]})}function sZ(t){if($o(t)===pv)return[];var e=F_(t);return[XA(t),e,XA(e)]}function oZ(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var s=r.mainAxis,u=s===void 0?!0:s,d=r.altAxis,o=d===void 0?!0:d,g=r.fallbackPlacements,x=r.padding,E=r.boundary,S=r.rootBoundary,P=r.altBoundary,I=r.flipVariations,R=I===void 0?!0:I,z=r.allowedAutoPlacements,B=e.options.placement,$=$o(B),j=$===B,G=g||(j||!R?[F_(B)]:sZ(B)),K=[B].concat(G).reduce(function(et,Ne){return et.concat($o(Ne)===pv?nZ(e,{placement:Ne,boundary:E,rootBoundary:S,padding:x,flipVariations:R,allowedAutoPlacements:z}):Ne)},[]),X=e.rects.reference,re=e.rects.popper,ue=new Map,ne=!0,we=K[0],xe=0;xe<K.length;xe++){var ke=K[xe],Ie=$o(ke),Fe=od(ke)===uu,se=[jn,Ps].indexOf(Ie)>=0,Be=se?"width":"height",Ve=ad(e,{placement:ke,boundary:E,rootBoundary:S,altBoundary:P,padding:x}),Je=se?Fe?Cs:$n:Fe?Ps:jn;X[Be]>re[Be]&&(Je=F_(Je));var ut=F_(Je),ht=[];if(u&&ht.push(Ve[Ie]<=0),o&&ht.push(Ve[Je]<=0,Ve[ut]<=0),ht.every(function(et){return et})){we=ke,ne=!1;break}ue.set(ke,ht)}if(ne)for(var Et=R?3:1,Qt=function(Ne){var tt=K.find(function(ft){var mt=ue.get(ft);if(mt)return mt.slice(0,Ne).every(function(Ht){return Ht})});if(tt)return we=tt,"break"},Nt=Et;Nt>0;Nt--){var yt=Qt(Nt);if(yt==="break")break}e.placement!==we&&(e.modifiersData[n]._skip=!0,e.placement=we,e.reset=!0)}}var jD={name:"flip",enabled:!0,phase:"main",fn:oZ,requiresIfExists:["offset"],data:{_skip:!1}};function JA(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function QA(t){return[jn,Cs,Ps,$n].some(function(e){return t[e]>=0})}function aZ(t){var e=t.state,r=t.name,n=e.rects.reference,s=e.rects.popper,u=e.modifiersData.preventOverflow,d=ad(e,{elementContext:"reference"}),o=ad(e,{altBoundary:!0}),g=JA(d,n),x=JA(o,s,u),E=QA(g),S=QA(x);e.modifiersData[r]={referenceClippingOffsets:g,popperEscapeOffsets:x,isReferenceHidden:E,hasPopperEscaped:S},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":E,"data-popper-escaped":S})}var $D={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:aZ};function lZ(t,e,r){var n=$o(t),s=[$n,jn].indexOf(n)>=0?-1:1,u=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,d=u[0],o=u[1];return d=d||0,o=(o||0)*s,[$n,Cs].indexOf(n)>=0?{x:o,y:d}:{x:d,y:o}}function cZ(t){var e=t.state,r=t.options,n=t.name,s=r.offset,u=s===void 0?[0,0]:s,d=aw.reduce(function(E,S){return E[S]=lZ(S,e.rects,u),E},{}),o=d[e.placement],g=o.x,x=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=g,e.modifiersData.popperOffsets.y+=x),e.modifiersData[n]=d}var VD={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:cZ};function uZ(t){var e=t.state,r=t.name;e.modifiersData[r]=ND({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var _w={name:"popperOffsets",enabled:!0,phase:"read",fn:uZ,data:{}};function hZ(t){return t==="x"?"y":"x"}function dZ(t){var e=t.state,r=t.options,n=t.name,s=r.mainAxis,u=s===void 0?!0:s,d=r.altAxis,o=d===void 0?!1:d,g=r.boundary,x=r.rootBoundary,E=r.altBoundary,S=r.padding,P=r.tether,I=P===void 0?!0:P,R=r.tetherOffset,z=R===void 0?0:R,B=ad(e,{boundary:g,rootBoundary:x,padding:S,altBoundary:E}),$=$o(e.placement),j=od(e.placement),G=!j,K=hw($),X=hZ(K),re=e.modifiersData.popperOffsets,ue=e.rects.reference,ne=e.rects.popper,we=typeof z=="function"?z(Object.assign({},e.rects,{placement:e.placement})):z,xe=typeof we=="number"?{mainAxis:we,altAxis:we}:Object.assign({mainAxis:0,altAxis:0},we),ke=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ie={x:0,y:0};if(!!re){if(u){var Fe,se=K==="y"?jn:$n,Be=K==="y"?Ps:Cs,Ve=K==="y"?"height":"width",Je=re[K],ut=Je+B[se],ht=Je-B[Be],Et=I?-ne[Ve]/2:0,Qt=j===uu?ue[Ve]:ne[Ve],Nt=j===uu?-ne[Ve]:-ue[Ve],yt=e.elements.arrow,et=I&&yt?uw(yt):{width:0,height:0},Ne=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:LD(),tt=Ne[se],ft=Ne[Be],mt=gp(0,ue[Ve],et[Ve]),Ht=G?ue[Ve]/2-Et-mt-tt-xe.mainAxis:Qt-mt-tt-xe.mainAxis,Zt=G?-ue[Ve]/2+Et+mt+ft+xe.mainAxis:Nt+mt+ft+xe.mainAxis,Lt=e.elements.arrow&&Qp(e.elements.arrow),ye=Lt?K==="y"?Lt.clientTop||0:Lt.clientLeft||0:0,Me=(Fe=ke==null?void 0:ke[K])!=null?Fe:0,$e=Je+Ht-Me-ye,it=Je+Zt-Me,ot=gp(I?hy(ut,$e):ut,Je,I?ru(ht,it):ht);re[K]=ot,Ie[K]=ot-Je}if(o){var st,gt=K==="x"?jn:$n,lt=K==="x"?Ps:Cs,Ye=re[X],pt=X==="y"?"height":"width",Tt=Ye+B[gt],St=Ye-B[lt],zt=[jn,$n].indexOf($)!==-1,Yt=(st=ke==null?void 0:ke[X])!=null?st:0,ur=zt?Tt:Ye-ue[pt]-ne[pt]-Yt+xe.altAxis,xr=zt?Ye+ue[pt]+ne[pt]-Yt-xe.altAxis:St,fr=I&&zt?U7(ur,Ye,xr):gp(I?ur:Tt,Ye,I?xr:St);re[X]=fr,Ie[X]=fr-Ye}e.modifiersData[n]=Ie}}var UD={name:"preventOverflow",enabled:!0,phase:"main",fn:dZ,requiresIfExists:["offset"]};function fZ(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function pZ(t){return t===Zs(t)||!Gs(t)?pw(t):fZ(t)}function mZ(t){var e=t.getBoundingClientRect(),r=nd(e.width)/t.offsetWidth||1,n=nd(e.height)/t.offsetHeight||1;return r!==1||n!==1}function gZ(t,e,r){r===void 0&&(r=!1);var n=Gs(e),s=Gs(e)&&mZ(e),u=Hl(e),d=sd(t,s,r),o={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(n||!n&&!r)&&((Go(e)!=="body"||gw(u))&&(o=pZ(e)),Gs(e)?(g=sd(e,!0),g.x+=e.clientLeft,g.y+=e.clientTop):u&&(g.x=mw(u))),{x:d.left+o.scrollLeft-g.x,y:d.top+o.scrollTop-g.y,width:d.width,height:d.height}}function _Z(t){var e=new Map,r=new Set,n=[];t.forEach(function(u){e.set(u.name,u)});function s(u){r.add(u.name);var d=[].concat(u.requires||[],u.requiresIfExists||[]);d.forEach(function(o){if(!r.has(o)){var g=e.get(o);g&&s(g)}}),n.push(u)}return t.forEach(function(u){r.has(u.name)||s(u)}),n}function yZ(t){var e=_Z(t);return OD.reduce(function(r,n){return r.concat(e.filter(function(s){return s.phase===n}))},[])}function vZ(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function xZ(t){var e=t.reduce(function(r,n){var s=r[n.name];return r[n.name]=s?Object.assign({},s,n,{options:Object.assign({},s.options,n.options),data:Object.assign({},s.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var eP={placement:"bottom",modifiers:[],strategy:"absolute"};function tP(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function gv(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,s=e.defaultOptions,u=s===void 0?eP:s;return function(o,g,x){x===void 0&&(x=u);var E={placement:"bottom",orderedModifiers:[],options:Object.assign({},eP,u),modifiersData:{},elements:{reference:o,popper:g},attributes:{},styles:{}},S=[],P=!1,I={state:E,setOptions:function($){var j=typeof $=="function"?$(E.options):$;z(),E.options=Object.assign({},u,E.options,j),E.scrollParents={reference:hu(o)?_p(o):o.contextElement?_p(o.contextElement):[],popper:_p(g)};var G=yZ(xZ([].concat(n,E.options.modifiers)));return E.orderedModifiers=G.filter(function(K){return K.enabled}),R(),I.update()},forceUpdate:function(){if(!P){var $=E.elements,j=$.reference,G=$.popper;if(!!tP(j,G)){E.rects={reference:gZ(j,Qp(G),E.options.strategy==="fixed"),popper:uw(G)},E.reset=!1,E.placement=E.options.placement,E.orderedModifiers.forEach(function(xe){return E.modifiersData[xe.name]=Object.assign({},xe.data)});for(var K=0;K<E.orderedModifiers.length;K++){if(E.reset===!0){E.reset=!1,K=-1;continue}var X=E.orderedModifiers[K],re=X.fn,ue=X.options,ne=ue===void 0?{}:ue,we=X.name;typeof re=="function"&&(E=re({state:E,options:ne,name:we,instance:I})||E)}}}},update:vZ(function(){return new Promise(function(B){I.forceUpdate(),B(E)})}),destroy:function(){z(),P=!0}};if(!tP(o,g))return I;I.setOptions(x).then(function(B){!P&&x.onFirstUpdate&&x.onFirstUpdate(B)});function R(){E.orderedModifiers.forEach(function(B){var $=B.name,j=B.options,G=j===void 0?{}:j,K=B.effect;if(typeof K=="function"){var X=K({state:E,name:$,instance:I,options:G}),re=function(){};S.push(X||re)}})}function z(){S.forEach(function(B){return B()}),S=[]}return I}}var bZ=gv(),wZ=[fw,_w,dw,cw],EZ=gv({defaultModifiers:wZ}),TZ=[fw,_w,dw,cw,VD,jD,UD,FD,$D],yw=gv({defaultModifiers:TZ}),GD=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:gv,detectOverflow:ad,createPopperBase:bZ,createPopper:yw,createPopperLite:EZ,top:jn,bottom:Ps,right:Cs,left:$n,auto:pv,basePlacements:yd,start:uu,end:id,clippingParents:xD,viewport:ow,popper:Ih,reference:bD,variationPlacements:zb,placements:aw,beforeRead:wD,read:ED,afterRead:TD,beforeMain:SD,main:AD,afterMain:PD,beforeWrite:CD,write:ID,afterWrite:MD,modifierPhases:OD,applyStyles:cw,arrow:FD,computeStyles:dw,eventListeners:fw,flip:jD,hide:$D,offset:VD,popperOffsets:_w,preventOverflow:UD},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const SZ=1e6,AZ=1e3,Nb="transitionend",PZ=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),CZ=t=>{do t+=Math.floor(Math.random()*SZ);while(document.getElementById(t));return t},HD=t=>{let e=t.getAttribute("data-bs-target");if(!e||e==="#"){let r=t.getAttribute("href");if(!r||!r.includes("#")&&!r.startsWith("."))return null;r.includes("#")&&!r.startsWith("#")&&(r=`#${r.split("#")[1]}`),e=r&&r!=="#"?r.trim():null}return e},WD=t=>{const e=HD(t);return e&&document.querySelector(e)?e:null},Sa=t=>{const e=HD(t);return e?document.querySelector(e):null},IZ=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:r}=window.getComputedStyle(t);const n=Number.parseFloat(e),s=Number.parseFloat(r);return!n&&!s?0:(e=e.split(",")[0],r=r.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(r))*AZ)},ZD=t=>{t.dispatchEvent(new Event(Nb))},Aa=t=>!t||typeof t!="object"?!1:(typeof t.jquery!="undefined"&&(t=t[0]),typeof t.nodeType!="undefined"),Nl=t=>Aa(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(t):null,vd=t=>{if(!Aa(t)||t.getClientRects().length===0)return!1;const e=getComputedStyle(t).getPropertyValue("visibility")==="visible",r=t.closest("details:not([open])");if(!r)return e;if(r!==t){const n=t.closest("summary");if(n&&n.parentNode!==r||n===null)return!1}return e},jl=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled!="undefined"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",qD=t=>{if(!document.documentElement.attachShadow)return null;if(typeof t.getRootNode=="function"){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?qD(t.parentNode):null},dy=()=>{},em=t=>{t.offsetHeight},KD=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Sx=[],MZ=t=>{document.readyState==="loading"?(Sx.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Sx)e()}),Sx.push(t)):t()},Ws=()=>document.documentElement.dir==="rtl",qs=t=>{MZ(()=>{const e=KD();if(e){const r=t.NAME,n=e.fn[r];e.fn[r]=t.jQueryInterface,e.fn[r].Constructor=t,e.fn[r].noConflict=()=>(e.fn[r]=n,t.jQueryInterface)}})},ba=t=>{typeof t=="function"&&t()},XD=(t,e,r=!0)=>{if(!r){ba(t);return}const n=5,s=IZ(e)+n;let u=!1;const d=({target:o})=>{o===e&&(u=!0,e.removeEventListener(Nb,d),ba(t))};e.addEventListener(Nb,d),setTimeout(()=>{u||ZD(e)},s)},vw=(t,e,r,n)=>{const s=t.length;let u=t.indexOf(e);return u===-1?!r&&n?t[s-1]:t[0]:(u+=r?1:-1,n&&(u=(u+s)%s),t[Math.max(0,Math.min(u,s-1))])},OZ=/[^.]*(?=\..*)\.|.*/,DZ=/\..*/,RZ=/::\d+$/,Ax={};let rP=1;const YD={mouseenter:"mouseover",mouseleave:"mouseout"},LZ=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function JD(t,e){return e&&`${e}::${rP++}`||t.uidEvent||rP++}function QD(t){const e=JD(t);return t.uidEvent=e,Ax[e]=Ax[e]||{},Ax[e]}function kZ(t,e){return function r(n){return xw(n,{delegateTarget:t}),r.oneOff&&Ct.off(t,n.type,e),e.apply(t,[n])}}function zZ(t,e,r){return function n(s){const u=t.querySelectorAll(e);for(let{target:d}=s;d&&d!==this;d=d.parentNode)for(const o of u)if(o===d)return xw(s,{delegateTarget:d}),n.oneOff&&Ct.off(t,s.type,e,r),r.apply(d,[s])}}function eR(t,e,r=null){return Object.values(t).find(n=>n.callable===e&&n.delegationSelector===r)}function tR(t,e,r){const n=typeof e=="string",s=n?r:e||r;let u=rR(t);return LZ.has(u)||(u=t),[n,s,u]}function iP(t,e,r,n,s){if(typeof e!="string"||!t)return;let[u,d,o]=tR(e,r,n);e in YD&&(d=(R=>function(z){if(!z.relatedTarget||z.relatedTarget!==z.delegateTarget&&!z.delegateTarget.contains(z.relatedTarget))return R.call(this,z)})(d));const g=QD(t),x=g[o]||(g[o]={}),E=eR(x,d,u?r:null);if(E){E.oneOff=E.oneOff&&s;return}const S=JD(d,e.replace(OZ,"")),P=u?zZ(t,r,d):kZ(t,d);P.delegationSelector=u?r:null,P.callable=d,P.oneOff=s,P.uidEvent=S,x[S]=P,t.addEventListener(o,P,u)}function jb(t,e,r,n,s){const u=eR(e[r],n,s);!u||(t.removeEventListener(r,u,Boolean(s)),delete e[r][u.uidEvent])}function FZ(t,e,r,n){const s=e[r]||{};for(const u of Object.keys(s))if(u.includes(n)){const d=s[u];jb(t,e,r,d.callable,d.delegationSelector)}}function rR(t){return t=t.replace(DZ,""),YD[t]||t}const Ct={on(t,e,r,n){iP(t,e,r,n,!1)},one(t,e,r,n){iP(t,e,r,n,!0)},off(t,e,r,n){if(typeof e!="string"||!t)return;const[s,u,d]=tR(e,r,n),o=d!==e,g=QD(t),x=g[d]||{},E=e.startsWith(".");if(typeof u!="undefined"){if(!Object.keys(x).length)return;jb(t,g,d,u,s?r:null);return}if(E)for(const S of Object.keys(g))FZ(t,g,S,e.slice(1));for(const S of Object.keys(x)){const P=S.replace(RZ,"");if(!o||e.includes(P)){const I=x[S];jb(t,g,d,I.callable,I.delegationSelector)}}},trigger(t,e,r){if(typeof e!="string"||!t)return null;const n=KD(),s=rR(e),u=e!==s;let d=null,o=!0,g=!0,x=!1;u&&n&&(d=n.Event(e,r),n(t).trigger(d),o=!d.isPropagationStopped(),g=!d.isImmediatePropagationStopped(),x=d.isDefaultPrevented());let E=new Event(e,{bubbles:o,cancelable:!0});return E=xw(E,r),x&&E.preventDefault(),g&&t.dispatchEvent(E),E.defaultPrevented&&d&&d.preventDefault(),E}};function xw(t,e){for(const[r,n]of Object.entries(e||{}))try{t[r]=n}catch{Object.defineProperty(t,r,{configurable:!0,get(){return n}})}return t}const gl=new Map,Px={set(t,e,r){gl.has(t)||gl.set(t,new Map);const n=gl.get(t);if(!n.has(e)&&n.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`);return}n.set(e,r)},get(t,e){return gl.has(t)&&gl.get(t).get(e)||null},remove(t,e){if(!gl.has(t))return;const r=gl.get(t);r.delete(e),r.size===0&&gl.delete(t)}};function nP(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function Cx(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Pa={setDataAttribute(t,e,r){t.setAttribute(`data-bs-${Cx(e)}`,r)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${Cx(e)}`)},getDataAttributes(t){if(!t)return{};const e={},r=Object.keys(t.dataset).filter(n=>n.startsWith("bs")&&!n.startsWith("bsConfig"));for(const n of r){let s=n.replace(/^bs/,"");s=s.charAt(0).toLowerCase()+s.slice(1,s.length),e[s]=nP(t.dataset[n])}return e},getDataAttribute(t,e){return nP(t.getAttribute(`data-bs-${Cx(e)}`))}};class tm{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,r){const n=Aa(r)?Pa.getDataAttribute(r,"config"):{};return{...this.constructor.Default,...typeof n=="object"?n:{},...Aa(r)?Pa.getDataAttributes(r):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,r=this.constructor.DefaultType){for(const n of Object.keys(r)){const s=r[n],u=e[n],d=Aa(u)?"element":PZ(u);if(!new RegExp(s).test(d))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${d}" but expected type "${s}".`)}}}const BZ="5.2.3";class mo extends tm{constructor(e,r){super(),e=Nl(e),e&&(this._element=e,this._config=this._getConfig(r),Px.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Px.remove(this._element,this.constructor.DATA_KEY),Ct.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,r,n=!0){XD(e,r,n)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Px.get(Nl(e),this.DATA_KEY)}static getOrCreateInstance(e,r={}){return this.getInstance(e)||new this(e,typeof r=="object"?r:null)}static get VERSION(){return BZ}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const _v=(t,e="hide")=>{const r=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;Ct.on(document,r,`[data-bs-dismiss="${n}"]`,function(s){if(["A","AREA"].includes(this.tagName)&&s.preventDefault(),jl(this))return;const u=Sa(this)||this.closest(`.${n}`);t.getOrCreateInstance(u)[e]()})},NZ="alert",jZ="bs.alert",iR=`.${jZ}`,$Z=`close${iR}`,VZ=`closed${iR}`,UZ="fade",GZ="show";class yv extends mo{static get NAME(){return NZ}close(){if(Ct.trigger(this._element,$Z).defaultPrevented)return;this._element.classList.remove(GZ);const r=this._element.classList.contains(UZ);this._queueCallback(()=>this._destroyElement(),this._element,r)}_destroyElement(){this._element.remove(),Ct.trigger(this._element,VZ),this.dispose()}static jQueryInterface(e){return this.each(function(){const r=yv.getOrCreateInstance(this);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}_v(yv,"close");qs(yv);const HZ="button",WZ="bs.button",ZZ=`.${WZ}`,qZ=".data-api",KZ="active",sP='[data-bs-toggle="button"]',XZ=`click${ZZ}${qZ}`;class vv extends mo{static get NAME(){return HZ}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(KZ))}static jQueryInterface(e){return this.each(function(){const r=vv.getOrCreateInstance(this);e==="toggle"&&r[e]()})}}Ct.on(document,XZ,sP,t=>{t.preventDefault();const e=t.target.closest(sP);vv.getOrCreateInstance(e).toggle()});qs(vv);const Or={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter(r=>r.matches(e))},parents(t,e){const r=[];let n=t.parentNode.closest(e);for(;n;)r.push(n),n=n.parentNode.closest(e);return r},prev(t,e){let r=t.previousElementSibling;for(;r;){if(r.matches(e))return[r];r=r.previousElementSibling}return[]},next(t,e){let r=t.nextElementSibling;for(;r;){if(r.matches(e))return[r];r=r.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(r=>`${r}:not([tabindex^="-"])`).join(",");return this.find(e,t).filter(r=>!jl(r)&&vd(r))}},YZ="swipe",xd=".bs.swipe",JZ=`touchstart${xd}`,QZ=`touchmove${xd}`,eq=`touchend${xd}`,tq=`pointerdown${xd}`,rq=`pointerup${xd}`,iq="touch",nq="pen",sq="pointer-event",oq=40,aq={endCallback:null,leftCallback:null,rightCallback:null},lq={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class fy extends tm{constructor(e,r){super(),this._element=e,!(!e||!fy.isSupported())&&(this._config=this._getConfig(r),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return aq}static get DefaultType(){return lq}static get NAME(){return YZ}dispose(){Ct.off(this._element,xd)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),ba(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=oq)return;const r=e/this._deltaX;this._deltaX=0,r&&ba(r>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Ct.on(this._element,tq,e=>this._start(e)),Ct.on(this._element,rq,e=>this._end(e)),this._element.classList.add(sq)):(Ct.on(this._element,JZ,e=>this._start(e)),Ct.on(this._element,QZ,e=>this._move(e)),Ct.on(this._element,eq,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===nq||e.pointerType===iq)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const cq="carousel",uq="bs.carousel",Wl=`.${uq}`,nR=".data-api",hq="ArrowLeft",dq="ArrowRight",fq=500,Zf="next",Th="prev",Mh="left",B_="right",pq=`slide${Wl}`,Ix=`slid${Wl}`,mq=`keydown${Wl}`,gq=`mouseenter${Wl}`,_q=`mouseleave${Wl}`,yq=`dragstart${Wl}`,vq=`load${Wl}${nR}`,xq=`click${Wl}${nR}`,sR="carousel",p_="active",bq="slide",wq="carousel-item-end",Eq="carousel-item-start",Tq="carousel-item-next",Sq="carousel-item-prev",oR=".active",aR=".carousel-item",Aq=oR+aR,Pq=".carousel-item img",Cq=".carousel-indicators",Iq="[data-bs-slide], [data-bs-slide-to]",Mq='[data-bs-ride="carousel"]',Oq={[hq]:B_,[dq]:Mh},Dq={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Rq={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class rm extends mo{constructor(e,r){super(e,r),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Or.findOne(Cq,this._element),this._addEventListeners(),this._config.ride===sR&&this.cycle()}static get Default(){return Dq}static get DefaultType(){return Rq}static get NAME(){return cq}next(){this._slide(Zf)}nextWhenVisible(){!document.hidden&&vd(this._element)&&this.next()}prev(){this._slide(Th)}pause(){this._isSliding&&ZD(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(!!this._config.ride){if(this._isSliding){Ct.one(this._element,Ix,()=>this.cycle());return}this.cycle()}}to(e){const r=this._getItems();if(e>r.length-1||e<0)return;if(this._isSliding){Ct.one(this._element,Ix,()=>this.to(e));return}const n=this._getItemIndex(this._getActive());if(n===e)return;const s=e>n?Zf:Th;this._slide(s,r[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Ct.on(this._element,mq,e=>this._keydown(e)),this._config.pause==="hover"&&(Ct.on(this._element,gq,()=>this.pause()),Ct.on(this._element,_q,()=>this._maybeEnableCycle())),this._config.touch&&fy.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const n of Or.find(Pq,this._element))Ct.on(n,yq,s=>s.preventDefault());const r={leftCallback:()=>this._slide(this._directionToOrder(Mh)),rightCallback:()=>this._slide(this._directionToOrder(B_)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),fq+this._config.interval))}};this._swipeHelper=new fy(this._element,r)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const r=Oq[e.key];r&&(e.preventDefault(),this._slide(this._directionToOrder(r)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const r=Or.findOne(oR,this._indicatorsElement);r.classList.remove(p_),r.removeAttribute("aria-current");const n=Or.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);n&&(n.classList.add(p_),n.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const r=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=r||this._config.defaultInterval}_slide(e,r=null){if(this._isSliding)return;const n=this._getActive(),s=e===Zf,u=r||vw(this._getItems(),n,s,this._config.wrap);if(u===n)return;const d=this._getItemIndex(u),o=I=>Ct.trigger(this._element,I,{relatedTarget:u,direction:this._orderToDirection(e),from:this._getItemIndex(n),to:d});if(o(pq).defaultPrevented||!n||!u)return;const x=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(d),this._activeElement=u;const E=s?Eq:wq,S=s?Tq:Sq;u.classList.add(S),em(u),n.classList.add(E),u.classList.add(E);const P=()=>{u.classList.remove(E,S),u.classList.add(p_),n.classList.remove(p_,S,E),this._isSliding=!1,o(Ix)};this._queueCallback(P,n,this._isAnimated()),x&&this.cycle()}_isAnimated(){return this._element.classList.contains(bq)}_getActive(){return Or.findOne(Aq,this._element)}_getItems(){return Or.find(aR,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ws()?e===Mh?Th:Zf:e===Mh?Zf:Th}_orderToDirection(e){return Ws()?e===Th?Mh:B_:e===Th?B_:Mh}static jQueryInterface(e){return this.each(function(){const r=rm.getOrCreateInstance(this,e);if(typeof e=="number"){r.to(e);return}if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}Ct.on(document,xq,Iq,function(t){const e=Sa(this);if(!e||!e.classList.contains(sR))return;t.preventDefault();const r=rm.getOrCreateInstance(e),n=this.getAttribute("data-bs-slide-to");if(n){r.to(n),r._maybeEnableCycle();return}if(Pa.getDataAttribute(this,"slide")==="next"){r.next(),r._maybeEnableCycle();return}r.prev(),r._maybeEnableCycle()});Ct.on(window,vq,()=>{const t=Or.find(Mq);for(const e of t)rm.getOrCreateInstance(e)});qs(rm);const Lq="collapse",kq="bs.collapse",im=`.${kq}`,zq=".data-api",Fq=`show${im}`,Bq=`shown${im}`,Nq=`hide${im}`,jq=`hidden${im}`,$q=`click${im}${zq}`,Mx="show",kh="collapse",m_="collapsing",Vq="collapsed",Uq=`:scope .${kh} .${kh}`,Gq="collapse-horizontal",Hq="width",Wq="height",Zq=".collapse.show, .collapse.collapsing",$b='[data-bs-toggle="collapse"]',qq={parent:null,toggle:!0},Kq={parent:"(null|element)",toggle:"boolean"};class Lp extends mo{constructor(e,r){super(e,r),this._isTransitioning=!1,this._triggerArray=[];const n=Or.find($b);for(const s of n){const u=WD(s),d=Or.find(u).filter(o=>o===this._element);u!==null&&d.length&&this._triggerArray.push(s)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return qq}static get DefaultType(){return Kq}static get NAME(){return Lq}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Zq).filter(o=>o!==this._element).map(o=>Lp.getOrCreateInstance(o,{toggle:!1}))),e.length&&e[0]._isTransitioning||Ct.trigger(this._element,Fq).defaultPrevented)return;for(const o of e)o.hide();const n=this._getDimension();this._element.classList.remove(kh),this._element.classList.add(m_),this._element.style[n]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const s=()=>{this._isTransitioning=!1,this._element.classList.remove(m_),this._element.classList.add(kh,Mx),this._element.style[n]="",Ct.trigger(this._element,Bq)},d=`scroll${n[0].toUpperCase()+n.slice(1)}`;this._queueCallback(s,this._element,!0),this._element.style[n]=`${this._element[d]}px`}hide(){if(this._isTransitioning||!this._isShown()||Ct.trigger(this._element,Nq).defaultPrevented)return;const r=this._getDimension();this._element.style[r]=`${this._element.getBoundingClientRect()[r]}px`,em(this._element),this._element.classList.add(m_),this._element.classList.remove(kh,Mx);for(const s of this._triggerArray){const u=Sa(s);u&&!this._isShown(u)&&this._addAriaAndCollapsedClass([s],!1)}this._isTransitioning=!0;const n=()=>{this._isTransitioning=!1,this._element.classList.remove(m_),this._element.classList.add(kh),Ct.trigger(this._element,jq)};this._element.style[r]="",this._queueCallback(n,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Mx)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=Nl(e.parent),e}_getDimension(){return this._element.classList.contains(Gq)?Hq:Wq}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren($b);for(const r of e){const n=Sa(r);n&&this._addAriaAndCollapsedClass([r],this._isShown(n))}}_getFirstLevelChildren(e){const r=Or.find(Uq,this._config.parent);return Or.find(e,this._config.parent).filter(n=>!r.includes(n))}_addAriaAndCollapsedClass(e,r){if(!!e.length)for(const n of e)n.classList.toggle(Vq,!r),n.setAttribute("aria-expanded",r)}static jQueryInterface(e){const r={};return typeof e=="string"&&/show|hide/.test(e)&&(r.toggle=!1),this.each(function(){const n=Lp.getOrCreateInstance(this,r);if(typeof e=="string"){if(typeof n[e]=="undefined")throw new TypeError(`No method named "${e}"`);n[e]()}})}}Ct.on(document,$q,$b,function(t){(t.target.tagName==="A"||t.delegateTarget&&t.delegateTarget.tagName==="A")&&t.preventDefault();const e=WD(this),r=Or.find(e);for(const n of r)Lp.getOrCreateInstance(n,{toggle:!1}).toggle()});qs(Lp);const oP="dropdown",Xq="bs.dropdown",gu=`.${Xq}`,bw=".data-api",Yq="Escape",aP="Tab",Jq="ArrowUp",lP="ArrowDown",Qq=2,eK=`hide${gu}`,tK=`hidden${gu}`,rK=`show${gu}`,iK=`shown${gu}`,lR=`click${gu}${bw}`,cR=`keydown${gu}${bw}`,nK=`keyup${gu}${bw}`,Oh="show",sK="dropup",oK="dropend",aK="dropstart",lK="dropup-center",cK="dropdown-center",Hc='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',uK=`${Hc}.${Oh}`,N_=".dropdown-menu",hK=".navbar",dK=".navbar-nav",fK=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",pK=Ws()?"top-end":"top-start",mK=Ws()?"top-start":"top-end",gK=Ws()?"bottom-end":"bottom-start",_K=Ws()?"bottom-start":"bottom-end",yK=Ws()?"left-start":"right-start",vK=Ws()?"right-start":"left-start",xK="top",bK="bottom",wK={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},EK={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Vo extends mo{constructor(e,r){super(e,r),this._popper=null,this._parent=this._element.parentNode,this._menu=Or.next(this._element,N_)[0]||Or.prev(this._element,N_)[0]||Or.findOne(N_,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return wK}static get DefaultType(){return EK}static get NAME(){return oP}toggle(){return this._isShown()?this.hide():this.show()}show(){if(jl(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Ct.trigger(this._element,rK,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(dK))for(const n of[].concat(...document.body.children))Ct.on(n,"mouseover",dy);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Oh),this._element.classList.add(Oh),Ct.trigger(this._element,iK,e)}}hide(){if(jl(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Ct.trigger(this._element,eK,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const n of[].concat(...document.body.children))Ct.off(n,"mouseover",dy);this._popper&&this._popper.destroy(),this._menu.classList.remove(Oh),this._element.classList.remove(Oh),this._element.setAttribute("aria-expanded","false"),Pa.removeDataAttribute(this._menu,"popper"),Ct.trigger(this._element,tK,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Aa(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${oP.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof GD=="undefined")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;this._config.reference==="parent"?e=this._parent:Aa(this._config.reference)?e=Nl(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const r=this._getPopperConfig();this._popper=yw(e,this._menu,r)}_isShown(){return this._menu.classList.contains(Oh)}_getPlacement(){const e=this._parent;if(e.classList.contains(oK))return yK;if(e.classList.contains(aK))return vK;if(e.classList.contains(lK))return xK;if(e.classList.contains(cK))return bK;const r=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(sK)?r?mK:pK:r?_K:gK}_detectNavbar(){return this._element.closest(hK)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(r=>Number.parseInt(r,10)):typeof e=="function"?r=>e(r,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Pa.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...typeof this._config.popperConfig=="function"?this._config.popperConfig(e):this._config.popperConfig}}_selectMenuItem({key:e,target:r}){const n=Or.find(fK,this._menu).filter(s=>vd(s));!n.length||vw(n,r,e===lP,!n.includes(r)).focus()}static jQueryInterface(e){return this.each(function(){const r=Vo.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]=="undefined")throw new TypeError(`No method named "${e}"`);r[e]()}})}static clearMenus(e){if(e.button===Qq||e.type==="keyup"&&e.key!==aP)return;const r=Or.find(uK);for(const n of r){const s=Vo.getInstance(n);if(!s||s._config.autoClose===!1)continue;const u=e.composedPath(),d=u.includes(s._menu);if(u.includes(s._element)||s._config.autoClose==="inside"&&!d||s._config.autoClose==="outside"&&d||s._menu.contains(e.target)&&(e.type==="keyup"&&e.key===aP||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const o={relatedTarget:s._element};e.type==="click"&&(o.clickEvent=e),s._completeHide(o)}}static dataApiKeydownHandler(e){const r=/input|textarea/i.test(e.target.tagName),n=e.key===Yq,s=[Jq,lP].includes(e.key);if(!s&&!n||r&&!n)return;e.preventDefault();const u=this.matches(Hc)?this:Or.prev(this,Hc)[0]||Or.next(this,Hc)[0]||Or.findOne(Hc,e.delegateTarget.parentNode),d=Vo.getOrCreateInstance(u);if(s){e.stopPropagation(),d.show(),d._selectMenuItem(e);return}d._isShown()&&(e.stopPropagation(),d.hide(),u.focus())}}Ct.on(document,cR,Hc,Vo.dataApiKeydownHandler);Ct.on(document,cR,N_,Vo.dataApiKeydownHandler);Ct.on(document,lR,Vo.clearMenus);Ct.on(document,nK,Vo.clearMenus);Ct.on(document,lR,Hc,function(t){t.preventDefault(),Vo.getOrCreateInstance(this).toggle()});qs(Vo);const cP=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",uP=".sticky-top",g_="padding-right",hP="margin-right";class Vb{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,g_,r=>r+e),this._setElementAttributes(cP,g_,r=>r+e),this._setElementAttributes(uP,hP,r=>r-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,g_),this._resetElementAttributes(cP,g_),this._resetElementAttributes(uP,hP)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,r,n){const s=this.getWidth(),u=d=>{if(d!==this._element&&window.innerWidth>d.clientWidth+s)return;this._saveInitialAttribute(d,r);const o=window.getComputedStyle(d).getPropertyValue(r);d.style.setProperty(r,`${n(Number.parseFloat(o))}px`)};this._applyManipulationCallback(e,u)}_saveInitialAttribute(e,r){const n=e.style.getPropertyValue(r);n&&Pa.setDataAttribute(e,r,n)}_resetElementAttributes(e,r){const n=s=>{const u=Pa.getDataAttribute(s,r);if(u===null){s.style.removeProperty(r);return}Pa.removeDataAttribute(s,r),s.style.setProperty(r,u)};this._applyManipulationCallback(e,n)}_applyManipulationCallback(e,r){if(Aa(e)){r(e);return}for(const n of Or.find(e,this._element))r(n)}}const uR="backdrop",TK="fade",dP="show",fP=`mousedown.bs.${uR}`,SK={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},AK={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class hR extends tm{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return SK}static get DefaultType(){return AK}static get NAME(){return uR}show(e){if(!this._config.isVisible){ba(e);return}this._append();const r=this._getElement();this._config.isAnimated&&em(r),r.classList.add(dP),this._emulateAnimation(()=>{ba(e)})}hide(e){if(!this._config.isVisible){ba(e);return}this._getElement().classList.remove(dP),this._emulateAnimation(()=>{this.dispose(),ba(e)})}dispose(){!this._isAppended||(Ct.off(this._element,fP),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(TK),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Nl(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Ct.on(e,fP,()=>{ba(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){XD(e,this._getElement(),this._config.isAnimated)}}const PK="focustrap",CK="bs.focustrap",py=`.${CK}`,IK=`focusin${py}`,MK=`keydown.tab${py}`,OK="Tab",DK="forward",pP="backward",RK={autofocus:!0,trapElement:null},LK={autofocus:"boolean",trapElement:"element"};class dR extends tm{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return RK}static get DefaultType(){return LK}static get NAME(){return PK}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Ct.off(document,py),Ct.on(document,IK,e=>this._handleFocusin(e)),Ct.on(document,MK,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){!this._isActive||(this._isActive=!1,Ct.off(document,py))}_handleFocusin(e){const{trapElement:r}=this._config;if(e.target===document||e.target===r||r.contains(e.target))return;const n=Or.focusableChildren(r);n.length===0?r.focus():this._lastTabNavDirection===pP?n[n.length-1].focus():n[0].focus()}_handleKeydown(e){e.key===OK&&(this._lastTabNavDirection=e.shiftKey?pP:DK)}}const kK="modal",zK="bs.modal",go=`.${zK}`,FK=".data-api",BK="Escape",NK=`hide${go}`,jK=`hidePrevented${go}`,fR=`hidden${go}`,pR=`show${go}`,$K=`shown${go}`,VK=`resize${go}`,UK=`click.dismiss${go}`,GK=`mousedown.dismiss${go}`,HK=`keydown.dismiss${go}`,WK=`click${go}${FK}`,mP="modal-open",ZK="fade",gP="show",Ox="modal-static",qK=".modal.show",KK=".modal-dialog",XK=".modal-body",YK='[data-bs-toggle="modal"]',JK={backdrop:!0,focus:!0,keyboard:!0},QK={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ld extends mo{constructor(e,r){super(e,r),this._dialog=Or.findOne(KK,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Vb,this._addEventListeners()}static get Default(){return JK}static get DefaultType(){return QK}static get NAME(){return kK}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Ct.trigger(this._element,pR,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(mP),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Ct.trigger(this._element,NK).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(gP),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){for(const e of[window,this._dialog])Ct.off(e,go);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new hR({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new dR({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const r=Or.findOne(XK,this._dialog);r&&(r.scrollTop=0),em(this._element),this._element.classList.add(gP);const n=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Ct.trigger(this._element,$K,{relatedTarget:e})};this._queueCallback(n,this._dialog,this._isAnimated())}_addEventListeners(){Ct.on(this._element,HK,e=>{if(e.key===BK){if(this._config.keyboard){e.preventDefault(),this.hide();return}this._triggerBackdropTransition()}}),Ct.on(window,VK,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Ct.on(this._element,GK,e=>{Ct.one(this._element,UK,r=>{if(!(this._element!==e.target||this._element!==r.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(mP),this._resetAdjustments(),this._scrollBar.reset(),Ct.trigger(this._element,fR)})}_isAnimated(){return this._element.classList.contains(ZK)}_triggerBackdropTransition(){if(Ct.trigger(this._element,jK).defaultPrevented)return;const r=this._element.scrollHeight>document.documentElement.clientHeight,n=this._element.style.overflowY;n==="hidden"||this._element.classList.contains(Ox)||(r||(this._element.style.overflowY="hidden"),this._element.classList.add(Ox),this._queueCallback(()=>{this._element.classList.remove(Ox),this._queueCallback(()=>{this._element.style.overflowY=n},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,r=this._scrollBar.getWidth(),n=r>0;if(n&&!e){const s=Ws()?"paddingLeft":"paddingRight";this._element.style[s]=`${r}px`}if(!n&&e){const s=Ws()?"paddingRight":"paddingLeft";this._element.style[s]=`${r}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,r){return this.each(function(){const n=ld.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]=="undefined")throw new TypeError(`No method named "${e}"`);n[e](r)}})}}Ct.on(document,WK,YK,function(t){const e=Sa(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),Ct.one(e,pR,s=>{s.defaultPrevented||Ct.one(e,fR,()=>{vd(this)&&this.focus()})});const r=Or.findOne(qK);r&&ld.getInstance(r).hide(),ld.getOrCreateInstance(e).toggle(this)});_v(ld);qs(ld);const eX="offcanvas",tX="bs.offcanvas",Da=`.${tX}`,mR=".data-api",rX=`load${Da}${mR}`,iX="Escape",_P="show",yP="showing",vP="hiding",nX="offcanvas-backdrop",gR=".offcanvas.show",sX=`show${Da}`,oX=`shown${Da}`,aX=`hide${Da}`,xP=`hidePrevented${Da}`,_R=`hidden${Da}`,lX=`resize${Da}`,cX=`click${Da}${mR}`,uX=`keydown.dismiss${Da}`,hX='[data-bs-toggle="offcanvas"]',dX={backdrop:!0,keyboard:!0,scroll:!1},fX={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class $l extends mo{constructor(e,r){super(e,r),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return dX}static get DefaultType(){return fX}static get NAME(){return eX}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Ct.trigger(this._element,sX,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Vb().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(yP);const n=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(_P),this._element.classList.remove(yP),Ct.trigger(this._element,oX,{relatedTarget:e})};this._queueCallback(n,this._element,!0)}hide(){if(!this._isShown||Ct.trigger(this._element,aX).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(vP),this._backdrop.hide();const r=()=>{this._element.classList.remove(_P,vP),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Vb().reset(),Ct.trigger(this._element,_R)};this._queueCallback(r,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Ct.trigger(this._element,xP);return}this.hide()},r=Boolean(this._config.backdrop);return new hR({className:nX,isVisible:r,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:r?e:null})}_initializeFocusTrap(){return new dR({trapElement:this._element})}_addEventListeners(){Ct.on(this._element,uX,e=>{if(e.key===iX){if(!this._config.keyboard){Ct.trigger(this._element,xP);return}this.hide()}})}static jQueryInterface(e){return this.each(function(){const r=$l.getOrCreateInstance(this,e);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}Ct.on(document,cX,hX,function(t){const e=Sa(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),jl(this))return;Ct.one(e,_R,()=>{vd(this)&&this.focus()});const r=Or.findOne(gR);r&&r!==e&&$l.getInstance(r).hide(),$l.getOrCreateInstance(e).toggle(this)});Ct.on(window,rX,()=>{for(const t of Or.find(gR))$l.getOrCreateInstance(t).show()});Ct.on(window,lX,()=>{for(const t of Or.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(t).position!=="fixed"&&$l.getOrCreateInstance(t).hide()});_v($l);qs($l);const pX=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),mX=/^aria-[\w-]*$/i,gX=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,_X=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,yX=(t,e)=>{const r=t.nodeName.toLowerCase();return e.includes(r)?pX.has(r)?Boolean(gX.test(t.nodeValue)||_X.test(t.nodeValue)):!0:e.filter(n=>n instanceof RegExp).some(n=>n.test(r))},yR={"*":["class","dir","id","lang","role",mX],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};function vX(t,e,r){if(!t.length)return t;if(r&&typeof r=="function")return r(t);const s=new window.DOMParser().parseFromString(t,"text/html"),u=[].concat(...s.body.querySelectorAll("*"));for(const d of u){const o=d.nodeName.toLowerCase();if(!Object.keys(e).includes(o)){d.remove();continue}const g=[].concat(...d.attributes),x=[].concat(e["*"]||[],e[o]||[]);for(const E of g)yX(E,x)||d.removeAttribute(E.nodeName)}return s.body.innerHTML}const xX="TemplateFactory",bX={allowList:yR,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},wX={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},EX={entry:"(string|element|function|null)",selector:"(string|element)"};class TX extends tm{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return bX}static get DefaultType(){return wX}static get NAME(){return xX}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[s,u]of Object.entries(this._config.content))this._setContent(e,u,s);const r=e.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&r.classList.add(...n.split(" ")),r}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[r,n]of Object.entries(e))super._typeCheckConfig({selector:r,entry:n},EX)}_setContent(e,r,n){const s=Or.findOne(n,e);if(!!s){if(r=this._resolvePossibleFunction(r),!r){s.remove();return}if(Aa(r)){this._putElementInTemplate(Nl(r),s);return}if(this._config.html){s.innerHTML=this._maybeSanitize(r);return}s.textContent=r}}_maybeSanitize(e){return this._config.sanitize?vX(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return typeof e=="function"?e(this):e}_putElementInTemplate(e,r){if(this._config.html){r.innerHTML="",r.append(e);return}r.textContent=e.textContent}}const SX="tooltip",AX=new Set(["sanitize","allowList","sanitizeFn"]),Dx="fade",PX="modal",__="show",CX=".tooltip-inner",bP=`.${PX}`,wP="hide.bs.modal",qf="hover",Rx="focus",IX="click",MX="manual",OX="hide",DX="hidden",RX="show",LX="shown",kX="inserted",zX="click",FX="focusin",BX="focusout",NX="mouseenter",jX="mouseleave",$X={AUTO:"auto",TOP:"top",RIGHT:Ws()?"left":"right",BOTTOM:"bottom",LEFT:Ws()?"right":"left"},VX={allowList:yR,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},UX={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class bd extends mo{constructor(e,r){if(typeof GD=="undefined")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,r),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return VX}static get DefaultType(){return UX}static get NAME(){return SX}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(!!this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Ct.off(this._element.closest(bP),wP,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Ct.trigger(this._element,this.constructor.eventName(RX)),n=(qD(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!n)return;this._disposePopper();const s=this._getTipElement();this._element.setAttribute("aria-describedby",s.getAttribute("id"));const{container:u}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(u.append(s),Ct.trigger(this._element,this.constructor.eventName(kX))),this._popper=this._createPopper(s),s.classList.add(__),"ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Ct.on(o,"mouseover",dy);const d=()=>{Ct.trigger(this._element,this.constructor.eventName(LX)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(d,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Ct.trigger(this._element,this.constructor.eventName(OX)).defaultPrevented)return;if(this._getTipElement().classList.remove(__),"ontouchstart"in document.documentElement)for(const s of[].concat(...document.body.children))Ct.off(s,"mouseover",dy);this._activeTrigger[IX]=!1,this._activeTrigger[Rx]=!1,this._activeTrigger[qf]=!1,this._isHovered=null;const n=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Ct.trigger(this._element,this.constructor.eventName(DX)))};this._queueCallback(n,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const r=this._getTemplateFactory(e).toHtml();if(!r)return null;r.classList.remove(Dx,__),r.classList.add(`bs-${this.constructor.NAME}-auto`);const n=CZ(this.constructor.NAME).toString();return r.setAttribute("id",n),this._isAnimated()&&r.classList.add(Dx),r}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new TX({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[CX]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Dx)}_isShown(){return this.tip&&this.tip.classList.contains(__)}_createPopper(e){const r=typeof this._config.placement=="function"?this._config.placement.call(this,e,this._element):this._config.placement,n=$X[r.toUpperCase()];return yw(this._element,e,this._getPopperConfig(n))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(r=>Number.parseInt(r,10)):typeof e=="function"?r=>e(r,this._element):e}_resolvePossibleFunction(e){return typeof e=="function"?e.call(this._element):e}_getPopperConfig(e){const r={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:n=>{this._getTipElement().setAttribute("data-popper-placement",n.state.placement)}}]};return{...r,...typeof this._config.popperConfig=="function"?this._config.popperConfig(r):this._config.popperConfig}}_setListeners(){const e=this._config.trigger.split(" ");for(const r of e)if(r==="click")Ct.on(this._element,this.constructor.eventName(zX),this._config.selector,n=>{this._initializeOnDelegatedTarget(n).toggle()});else if(r!==MX){const n=r===qf?this.constructor.eventName(NX):this.constructor.eventName(FX),s=r===qf?this.constructor.eventName(jX):this.constructor.eventName(BX);Ct.on(this._element,n,this._config.selector,u=>{const d=this._initializeOnDelegatedTarget(u);d._activeTrigger[u.type==="focusin"?Rx:qf]=!0,d._enter()}),Ct.on(this._element,s,this._config.selector,u=>{const d=this._initializeOnDelegatedTarget(u);d._activeTrigger[u.type==="focusout"?Rx:qf]=d._element.contains(u.relatedTarget),d._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Ct.on(this._element.closest(bP),wP,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");!e||(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,r){clearTimeout(this._timeout),this._timeout=setTimeout(e,r)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const r=Pa.getDataAttributes(this._element);for(const n of Object.keys(r))AX.has(n)&&delete r[n];return e={...r,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Nl(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const r in this._config)this.constructor.Default[r]!==this._config[r]&&(e[r]=this._config[r]);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const r=bd.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]=="undefined")throw new TypeError(`No method named "${e}"`);r[e]()}})}}qs(bd);const GX="popover",HX=".popover-header",WX=".popover-body",ZX={...bd.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},qX={...bd.DefaultType,content:"(null|string|element|function)"};class ww extends bd{static get Default(){return ZX}static get DefaultType(){return qX}static get NAME(){return GX}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[HX]:this._getTitle(),[WX]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const r=ww.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]=="undefined")throw new TypeError(`No method named "${e}"`);r[e]()}})}}qs(ww);const KX="scrollspy",XX="bs.scrollspy",Ew=`.${XX}`,YX=".data-api",JX=`activate${Ew}`,EP=`click${Ew}`,QX=`load${Ew}${YX}`,eY="dropdown-item",Sh="active",tY='[data-bs-spy="scroll"]',Lx="[href]",rY=".nav, .list-group",TP=".nav-link",iY=".nav-item",nY=".list-group-item",sY=`${TP}, ${iY} > ${TP}, ${nY}`,oY=".dropdown",aY=".dropdown-toggle",lY={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},cY={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class xv extends mo{constructor(e,r){super(e,r),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return lY}static get DefaultType(){return cY}static get NAME(){return KX}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Nl(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(r=>Number.parseFloat(r))),e}_maybeEnableSmoothScroll(){!this._config.smoothScroll||(Ct.off(this._config.target,EP),Ct.on(this._config.target,EP,Lx,e=>{const r=this._observableSections.get(e.target.hash);if(r){e.preventDefault();const n=this._rootElement||window,s=r.offsetTop-this._element.offsetTop;if(n.scrollTo){n.scrollTo({top:s,behavior:"smooth"});return}n.scrollTop=s}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(r=>this._observerCallback(r),e)}_observerCallback(e){const r=d=>this._targetLinks.get(`#${d.target.id}`),n=d=>{this._previousScrollData.visibleEntryTop=d.target.offsetTop,this._process(r(d))},s=(this._rootElement||document.documentElement).scrollTop,u=s>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=s;for(const d of e){if(!d.isIntersecting){this._activeTarget=null,this._clearActiveClass(r(d));continue}const o=d.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(u&&o){if(n(d),!s)return;continue}!u&&!o&&n(d)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Or.find(Lx,this._config.target);for(const r of e){if(!r.hash||jl(r))continue;const n=Or.findOne(r.hash,this._element);vd(n)&&(this._targetLinks.set(r.hash,r),this._observableSections.set(r.hash,n))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Sh),this._activateParents(e),Ct.trigger(this._element,JX,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(eY)){Or.findOne(aY,e.closest(oY)).classList.add(Sh);return}for(const r of Or.parents(e,rY))for(const n of Or.prev(r,sY))n.classList.add(Sh)}_clearActiveClass(e){e.classList.remove(Sh);const r=Or.find(`${Lx}.${Sh}`,e);for(const n of r)n.classList.remove(Sh)}static jQueryInterface(e){return this.each(function(){const r=xv.getOrCreateInstance(this,e);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}Ct.on(window,QX,()=>{for(const t of Or.find(tY))xv.getOrCreateInstance(t)});qs(xv);const uY="tab",hY="bs.tab",_u=`.${hY}`,dY=`hide${_u}`,fY=`hidden${_u}`,pY=`show${_u}`,mY=`shown${_u}`,gY=`click${_u}`,_Y=`keydown${_u}`,yY=`load${_u}`,vY="ArrowLeft",SP="ArrowRight",xY="ArrowUp",AP="ArrowDown",Wc="active",PP="fade",kx="show",bY="dropdown",wY=".dropdown-toggle",EY=".dropdown-menu",zx=":not(.dropdown-toggle)",TY='.list-group, .nav, [role="tablist"]',SY=".nav-item, .list-group-item",AY=`.nav-link${zx}, .list-group-item${zx}, [role="tab"]${zx}`,vR='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Fx=`${AY}, ${vR}`,PY=`.${Wc}[data-bs-toggle="tab"], .${Wc}[data-bs-toggle="pill"], .${Wc}[data-bs-toggle="list"]`;class cd extends mo{constructor(e){super(e),this._parent=this._element.closest(TY),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Ct.on(this._element,_Y,r=>this._keydown(r)))}static get NAME(){return uY}show(){const e=this._element;if(this._elemIsActive(e))return;const r=this._getActiveElem(),n=r?Ct.trigger(r,dY,{relatedTarget:e}):null;Ct.trigger(e,pY,{relatedTarget:r}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(r,e),this._activate(e,r))}_activate(e,r){if(!e)return;e.classList.add(Wc),this._activate(Sa(e));const n=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(kx);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Ct.trigger(e,mY,{relatedTarget:r})};this._queueCallback(n,e,e.classList.contains(PP))}_deactivate(e,r){if(!e)return;e.classList.remove(Wc),e.blur(),this._deactivate(Sa(e));const n=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(kx);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Ct.trigger(e,fY,{relatedTarget:r})};this._queueCallback(n,e,e.classList.contains(PP))}_keydown(e){if(![vY,SP,xY,AP].includes(e.key))return;e.stopPropagation(),e.preventDefault();const r=[SP,AP].includes(e.key),n=vw(this._getChildren().filter(s=>!jl(s)),e.target,r,!0);n&&(n.focus({preventScroll:!0}),cd.getOrCreateInstance(n).show())}_getChildren(){return Or.find(Fx,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,r){this._setAttributeIfNotExists(e,"role","tablist");for(const n of r)this._setInitialAttributesOnChild(n)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const r=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute("aria-selected",r),n!==e&&this._setAttributeIfNotExists(n,"role","presentation"),r||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const r=Sa(e);!r||(this._setAttributeIfNotExists(r,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(r,"aria-labelledby",`#${e.id}`))}_toggleDropDown(e,r){const n=this._getOuterElement(e);if(!n.classList.contains(bY))return;const s=(u,d)=>{const o=Or.findOne(u,n);o&&o.classList.toggle(d,r)};s(wY,Wc),s(EY,kx),n.setAttribute("aria-expanded",r)}_setAttributeIfNotExists(e,r,n){e.hasAttribute(r)||e.setAttribute(r,n)}_elemIsActive(e){return e.classList.contains(Wc)}_getInnerElement(e){return e.matches(Fx)?e:Or.findOne(Fx,e)}_getOuterElement(e){return e.closest(SY)||e}static jQueryInterface(e){return this.each(function(){const r=cd.getOrCreateInstance(this);if(typeof e=="string"){if(r[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);r[e]()}})}}Ct.on(document,gY,vR,function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),!jl(this)&&cd.getOrCreateInstance(this).show()});Ct.on(window,yY,()=>{for(const t of Or.find(PY))cd.getOrCreateInstance(t)});qs(cd);const CY="toast",IY="bs.toast",Zl=`.${IY}`,MY=`mouseover${Zl}`,OY=`mouseout${Zl}`,DY=`focusin${Zl}`,RY=`focusout${Zl}`,LY=`hide${Zl}`,kY=`hidden${Zl}`,zY=`show${Zl}`,FY=`shown${Zl}`,BY="fade",CP="hide",y_="show",v_="showing",NY={animation:"boolean",autohide:"boolean",delay:"number"},jY={animation:!0,autohide:!0,delay:5e3};class bv extends mo{constructor(e,r){super(e,r),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return jY}static get DefaultType(){return NY}static get NAME(){return CY}show(){if(Ct.trigger(this._element,zY).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(BY);const r=()=>{this._element.classList.remove(v_),Ct.trigger(this._element,FY),this._maybeScheduleHide()};this._element.classList.remove(CP),em(this._element),this._element.classList.add(y_,v_),this._queueCallback(r,this._element,this._config.animation)}hide(){if(!this.isShown()||Ct.trigger(this._element,LY).defaultPrevented)return;const r=()=>{this._element.classList.add(CP),this._element.classList.remove(v_,y_),Ct.trigger(this._element,kY)};this._element.classList.add(v_),this._queueCallback(r,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(y_),super.dispose()}isShown(){return this._element.classList.contains(y_)}_maybeScheduleHide(){!this._config.autohide||this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay))}_onInteraction(e,r){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=r;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=r;break}}if(r){this._clearTimeout();return}const n=e.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){Ct.on(this._element,MY,e=>this._onInteraction(e,!0)),Ct.on(this._element,OY,e=>this._onInteraction(e,!1)),Ct.on(this._element,DY,e=>this._onInteraction(e,!0)),Ct.on(this._element,RY,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const r=bv.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]=="undefined")throw new TypeError(`No method named "${e}"`);r[e](this)}})}}_v(bv);qs(bv);var $Y=Object.defineProperty,VY=Object.defineProperties,UY=Object.getOwnPropertyDescriptors,IP=Object.getOwnPropertySymbols,GY=Object.prototype.hasOwnProperty,HY=Object.prototype.propertyIsEnumerable,MP=(t,e,r)=>e in t?$Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ah=(t,e)=>{for(var r in e||(e={}))GY.call(e,r)&&MP(t,r,e[r]);if(IP)for(var r of IP(e))HY.call(e,r)&&MP(t,r,e[r]);return t},OP=(t,e)=>VY(t,UY(e));const WY={props:{autoscroll:{type:Boolean,default:!0}},watch:{typeAheadPointer(){this.autoscroll&&this.maybeAdjustScroll()},open(t){this.autoscroll&&t&&this.$nextTick(()=>this.maybeAdjustScroll())}},methods:{maybeAdjustScroll(){var t;const e=((t=this.$refs.dropdownMenu)==null?void 0:t.children[this.typeAheadPointer])||!1;if(e){const r=this.getDropdownViewport(),{top:n,bottom:s,height:u}=e.getBoundingClientRect();if(n<r.top)return this.$refs.dropdownMenu.scrollTop=e.offsetTop;if(s>r.bottom)return this.$refs.dropdownMenu.scrollTop=e.offsetTop-(r.height-u)}},getDropdownViewport(){return this.$refs.dropdownMenu?this.$refs.dropdownMenu.getBoundingClientRect():{height:0,top:0,bottom:0}}}},ZY={data(){return{typeAheadPointer:-1}},watch:{filteredOptions(){for(let t=0;t<this.filteredOptions.length;t++)if(this.selectable(this.filteredOptions[t])){this.typeAheadPointer=t;break}},open(t){t&&this.typeAheadToLastSelected()},selectedValue(){this.open&&this.typeAheadToLastSelected()}},methods:{typeAheadUp(){for(let t=this.typeAheadPointer-1;t>=0;t--)if(this.selectable(this.filteredOptions[t])){this.typeAheadPointer=t;break}},typeAheadDown(){for(let t=this.typeAheadPointer+1;t<this.filteredOptions.length;t++)if(this.selectable(this.filteredOptions[t])){this.typeAheadPointer=t;break}},typeAheadSelect(){const t=this.filteredOptions[this.typeAheadPointer];t&&this.selectable(t)&&this.select(t)},typeAheadToLastSelected(){this.typeAheadPointer=this.selectedValue.length!==0?this.filteredOptions.indexOf(this.selectedValue[this.selectedValue.length-1]):-1}}},qY={props:{loading:{type:Boolean,default:!1}},data(){return{mutableLoading:!1}},watch:{search(){this.$emit("search",this.search,this.toggleLoading)},loading(t){this.mutableLoading=t}},methods:{toggleLoading(t=null){return t==null?this.mutableLoading=!this.mutableLoading:this.mutableLoading=t}}},Tw=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r},KY={},XY={xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10"},YY=Nr("path",{d:"M6.895455 5l2.842897-2.842898c.348864-.348863.348864-.914488 0-1.263636L9.106534.261648c-.348864-.348864-.914489-.348864-1.263636 0L5 3.104545 2.157102.261648c-.348863-.348864-.914488-.348864-1.263636 0L.261648.893466c-.348864.348864-.348864.914489 0 1.263636L3.104545 5 .261648 7.842898c-.348864.348863-.348864.914488 0 1.263636l.631818.631818c.348864.348864.914773.348864 1.263636 0L5 6.895455l2.842898 2.842897c.348863.348864.914772.348864 1.263636 0l.631818-.631818c.348864-.348864.348864-.914489 0-1.263636L6.895455 5z"},null,-1),JY=[YY];function QY(t,e){return kr(),xi("svg",XY,JY)}const eJ=Tw(KY,[["render",QY]]),tJ={},rJ={xmlns:"http://www.w3.org/2000/svg",width:"14",height:"10"},iJ=Nr("path",{d:"M9.211364 7.59931l4.48338-4.867229c.407008-.441854.407008-1.158247 0-1.60046l-.73712-.80023c-.407008-.441854-1.066904-.441854-1.474243 0L7 5.198617 2.51662.33139c-.407008-.441853-1.066904-.441853-1.474243 0l-.737121.80023c-.407008.441854-.407008 1.158248 0 1.600461l4.48338 4.867228L7 10l2.211364-2.40069z"},null,-1),nJ=[iJ];function sJ(t,e){return kr(),xi("svg",rJ,nJ)}const oJ=Tw(tJ,[["render",sJ]]),DP={Deselect:eJ,OpenIndicator:oJ},aJ={mounted(t,{instance:e}){if(e.appendToBody){const{height:r,top:n,left:s,width:u}=e.$refs.toggle.getBoundingClientRect();let d=window.scrollX||window.pageXOffset,o=window.scrollY||window.pageYOffset;t.unbindPosition=e.calculatePosition(t,e,{width:u+"px",left:d+s+"px",top:o+n+r+"px"}),document.body.appendChild(t)}},unmounted(t,{instance:e}){e.appendToBody&&(t.unbindPosition&&typeof t.unbindPosition=="function"&&t.unbindPosition(),t.parentNode&&t.parentNode.removeChild(t))}};function lJ(t){const e={};return Object.keys(t).sort().forEach(r=>{e[r]=t[r]}),JSON.stringify(e)}let cJ=0;function uJ(){return++cJ}const hJ={components:Ah({},DP),directives:{appendToBody:aJ},mixins:[WY,ZY,qY],compatConfig:{MODE:3},emits:["open","close","update:modelValue","search","search:compositionstart","search:compositionend","search:keydown","search:blur","search:focus","search:input","option:created","option:selecting","option:selected","option:deselecting","option:deselected"],props:{modelValue:{},components:{type:Object,default:()=>({})},options:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},deselectFromDropdown:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},placeholder:{type:String,default:""},transition:{type:String,default:"vs__fade"},clearSearchOnSelect:{type:Boolean,default:!0},closeOnSelect:{type:Boolean,default:!0},label:{type:String,default:"label"},autocomplete:{type:String,default:"off"},reduce:{type:Function,default:t=>t},selectable:{type:Function,default:t=>!0},getOptionLabel:{type:Function,default(t){return typeof t=="object"?t.hasOwnProperty(this.label)?t[this.label]:console.warn(`[vue-select warn]: Label key "option.${this.label}" does not exist in options object ${JSON.stringify(t)}.
https://vue-select.org/api/props.html#getoptionlabel`):t}},getOptionKey:{type:Function,default(t){if(typeof t!="object")return t;try{return t.hasOwnProperty("id")?t.id:lJ(t)}catch(e){return console.warn(`[vue-select warn]: Could not stringify this option to generate unique key. Please provide'getOptionKey' prop to return a unique key for each option.
https://vue-select.org/api/props.html#getoptionkey`,t,e)}}},onTab:{type:Function,default:function(){this.selectOnTab&&!this.isComposing&&this.typeAheadSelect()}},taggable:{type:Boolean,default:!1},tabindex:{type:Number,default:null},pushTags:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},filterBy:{type:Function,default(t,e,r){return(e||"").toLocaleLowerCase().indexOf(r.toLocaleLowerCase())>-1}},filter:{type:Function,default(t,e){return t.filter(r=>{let n=this.getOptionLabel(r);return typeof n=="number"&&(n=n.toString()),this.filterBy(r,n,e)})}},createOption:{type:Function,default(t){return typeof this.optionList[0]=="object"?{[this.label]:t}:t}},resetOnOptionsChange:{default:!1,validator:t=>["function","boolean"].includes(typeof t)},clearSearchOnBlur:{type:Function,default:function({clearSearchOnSelect:t,multiple:e}){return t&&!e}},noDrop:{type:Boolean,default:!1},inputId:{type:String},dir:{type:String,default:"auto"},selectOnTab:{type:Boolean,default:!1},selectOnKeyCodes:{type:Array,default:()=>[13]},searchInputQuerySelector:{type:String,default:"[type=search]"},mapKeydown:{type:Function,default:(t,e)=>t},appendToBody:{type:Boolean,default:!1},calculatePosition:{type:Function,default(t,e,{width:r,top:n,left:s}){t.style.top=n,t.style.left=s,t.style.width=r}},dropdownShouldOpen:{type:Function,default({noDrop:t,open:e,mutableLoading:r}){return t?!1:e&&!r}},uid:{type:[String,Number],default:()=>uJ()}},data(){return{search:"",open:!1,isComposing:!1,pushedTags:[],_value:[],deselectButtons:[]}},computed:{isReducingValues(){return this.$props.reduce!==this.$options.props.reduce.default},isTrackingValues(){return typeof this.modelValue=="undefined"||this.isReducingValues},selectedValue(){let t=this.modelValue;return this.isTrackingValues&&(t=this.$data._value),t!=null&&t!==""?[].concat(t):[]},optionList(){return this.options.concat(this.pushTags?this.pushedTags:[])},searchEl(){return this.$slots.search?this.$refs.selectedOptions.querySelector(this.searchInputQuerySelector):this.$refs.search},scope(){const t={search:this.search,loading:this.loading,searching:this.searching,filteredOptions:this.filteredOptions};return{search:{attributes:Ah({disabled:this.disabled,placeholder:this.searchPlaceholder,tabindex:this.tabindex,readonly:!this.searchable,id:this.inputId,"aria-autocomplete":"list","aria-labelledby":`vs${this.uid}__combobox`,"aria-controls":`vs${this.uid}__listbox`,ref:"search",type:"search",autocomplete:this.autocomplete,value:this.search},this.dropdownOpen&&this.filteredOptions[this.typeAheadPointer]?{"aria-activedescendant":`vs${this.uid}__option-${this.typeAheadPointer}`}:{}),events:{compositionstart:()=>this.isComposing=!0,compositionend:()=>this.isComposing=!1,keydown:this.onSearchKeyDown,blur:this.onSearchBlur,focus:this.onSearchFocus,input:e=>this.search=e.target.value}},spinner:{loading:this.mutableLoading},noOptions:{search:this.search,loading:this.mutableLoading,searching:this.searching},openIndicator:{attributes:{ref:"openIndicator",role:"presentation",class:"vs__open-indicator"}},listHeader:t,listFooter:t,header:OP(Ah({},t),{deselect:this.deselect}),footer:OP(Ah({},t),{deselect:this.deselect})}},childComponents(){return Ah(Ah({},DP),this.components)},stateClasses(){return{"vs--open":this.dropdownOpen,"vs--single":!this.multiple,"vs--multiple":this.multiple,"vs--searching":this.searching&&!this.noDrop,"vs--searchable":this.searchable&&!this.noDrop,"vs--unsearchable":!this.searchable,"vs--loading":this.mutableLoading,"vs--disabled":this.disabled}},searching(){return!!this.search},dropdownOpen(){return this.dropdownShouldOpen(this)},searchPlaceholder(){return this.isValueEmpty&&this.placeholder?this.placeholder:void 0},filteredOptions(){const t=[].concat(this.optionList);if(!this.filterable&&!this.taggable)return t;const e=this.search.length?this.filter(t,this.search,this):t;if(this.taggable&&this.search.length){const r=this.createOption(this.search);this.optionExists(r)||e.unshift(r)}return e},isValueEmpty(){return this.selectedValue.length===0},showClearButton(){return!this.multiple&&this.clearable&&!this.open&&!this.isValueEmpty}},watch:{options(t,e){const r=()=>typeof this.resetOnOptionsChange=="function"?this.resetOnOptionsChange(t,e,this.selectedValue):this.resetOnOptionsChange;!this.taggable&&r()&&this.clearSelection(),this.modelValue&&this.isTrackingValues&&this.setInternalValueFromOptions(this.modelValue)},modelValue:{immediate:!0,handler(t){this.isTrackingValues&&this.setInternalValueFromOptions(t)}},multiple(){this.clearSelection()},open(t){this.$emit(t?"open":"close")}},created(){this.mutableLoading=this.loading},methods:{setInternalValueFromOptions(t){Array.isArray(t)?this.$data._value=t.map(e=>this.findOptionFromReducedValue(e)):this.$data._value=this.findOptionFromReducedValue(t)},select(t){this.$emit("option:selecting",t),this.isOptionSelected(t)?this.deselectFromDropdown&&(this.clearable||this.multiple&&this.selectedValue.length>1)&&this.deselect(t):(this.taggable&&!this.optionExists(t)&&(this.$emit("option:created",t),this.pushTag(t)),this.multiple&&(t=this.selectedValue.concat(t)),this.updateValue(t),this.$emit("option:selected",t)),this.onAfterSelect(t)},deselect(t){this.$emit("option:deselecting",t),this.updateValue(this.selectedValue.filter(e=>!this.optionComparator(e,t))),this.$emit("option:deselected",t)},clearSelection(){this.updateValue(this.multiple?[]:null)},onAfterSelect(t){this.closeOnSelect&&(this.open=!this.open,this.searchEl.blur()),this.clearSearchOnSelect&&(this.search="")},updateValue(t){typeof this.modelValue=="undefined"&&(this.$data._value=t),t!==null&&(Array.isArray(t)?t=t.map(e=>this.reduce(e)):t=this.reduce(t)),this.$emit("update:modelValue",t)},toggleDropdown(t){const e=t.target!==this.searchEl;e&&t.preventDefault();const r=[...this.deselectButtons||[],this.$refs.clearButton];if(this.searchEl===void 0||r.filter(Boolean).some(n=>n.contains(t.target)||n===t.target)){t.preventDefault();return}this.open&&e?this.searchEl.blur():this.disabled||(this.open=!0,this.searchEl.focus())},isOptionSelected(t){return this.selectedValue.some(e=>this.optionComparator(e,t))},isOptionDeselectable(t){return this.isOptionSelected(t)&&this.deselectFromDropdown},optionComparator(t,e){return this.getOptionKey(t)===this.getOptionKey(e)},findOptionFromReducedValue(t){const e=n=>JSON.stringify(this.reduce(n))===JSON.stringify(t),r=[...this.options,...this.pushedTags].filter(e);return r.length===1?r[0]:r.find(n=>this.optionComparator(n,this.$data._value))||t},closeSearchOptions(){this.open=!1,this.$emit("search:blur")},maybeDeleteValue(){if(!this.searchEl.value.length&&this.selectedValue&&this.selectedValue.length&&this.clearable){let t=null;this.multiple&&(t=[...this.selectedValue.slice(0,this.selectedValue.length-1)]),this.updateValue(t)}},optionExists(t){return this.optionList.some(e=>this.optionComparator(e,t))},normalizeOptionForSlot(t){return typeof t=="object"?t:{[this.label]:t}},pushTag(t){this.pushedTags.push(t)},onEscape(){this.search.length?this.search="":this.searchEl.blur()},onSearchBlur(){if(this.mousedown&&!this.searching)this.mousedown=!1;else{const{clearSearchOnSelect:t,multiple:e}=this;this.clearSearchOnBlur({clearSearchOnSelect:t,multiple:e})&&(this.search=""),this.closeSearchOptions();return}if(this.search.length===0&&this.options.length===0){this.closeSearchOptions();return}},onSearchFocus(){this.open=!0,this.$emit("search:focus")},onMousedown(){this.mousedown=!0},onMouseUp(){this.mousedown=!1},onSearchKeyDown(t){const e=s=>(s.preventDefault(),!this.isComposing&&this.typeAheadSelect()),r={8:s=>this.maybeDeleteValue(),9:s=>this.onTab(),27:s=>this.onEscape(),38:s=>(s.preventDefault(),this.typeAheadUp()),40:s=>(s.preventDefault(),this.typeAheadDown())};this.selectOnKeyCodes.forEach(s=>r[s]=e);const n=this.mapKeydown(r,this);if(typeof n[t.keyCode]=="function")return n[t.keyCode](t)}}},dJ=["dir"],fJ=["id","aria-expanded","aria-owns"],pJ={ref:"selectedOptions",class:"vs__selected-options"},mJ=["disabled","title","aria-label","onClick"],gJ={ref:"actions",class:"vs__actions"},_J=["disabled"],yJ={class:"vs__spinner"},vJ=["id"],xJ=["id","aria-selected","onMouseover","onClick"],bJ={key:0,class:"vs__no-options"},wJ=qh(" Sorry, no matching options. "),EJ=["id"];function TJ(t,e,r,n,s,u){const d=MC("append-to-body");return kr(),xi("div",{dir:r.dir,class:iu(["v-select",u.stateClasses])},[$s(t.$slots,"header",js(Vs(u.scope.header))),Nr("div",{id:`vs${r.uid}__combobox`,ref:"toggle",class:"vs__dropdown-toggle",role:"combobox","aria-expanded":u.dropdownOpen.toString(),"aria-owns":`vs${r.uid}__listbox`,"aria-label":"Search for option",onMousedown:e[1]||(e[1]=o=>u.toggleDropdown(o))},[Nr("div",pJ,[(kr(!0),xi(Ri,null,Gc(u.selectedValue,(o,g)=>$s(t.$slots,"selected-option-container",{option:u.normalizeOptionForSlot(o),deselect:u.deselect,multiple:r.multiple,disabled:r.disabled},()=>[(kr(),xi("span",{key:r.getOptionKey(o),class:"vs__selected"},[$s(t.$slots,"selected-option",js(Vs(u.normalizeOptionForSlot(o))),()=>[qh(bl(r.getOptionLabel(o)),1)]),r.multiple?(kr(),xi("button",{key:0,ref_for:!0,ref:x=>s.deselectButtons[g]=x,disabled:r.disabled,type:"button",class:"vs__deselect",title:`Deselect ${r.getOptionLabel(o)}`,"aria-label":`Deselect ${r.getOptionLabel(o)}`,onClick:x=>u.deselect(o)},[(kr(),os(w_(u.childComponents.Deselect)))],8,mJ)):Jc("",!0)]))])),256)),$s(t.$slots,"search",js(Vs(u.scope.search)),()=>[Nr("input",G_({class:"vs__search"},u.scope.search.attributes,DC(u.scope.search.events)),null,16)])],512),Nr("div",gJ,[b_(Nr("button",{ref:"clearButton",disabled:r.disabled,type:"button",class:"vs__clear",title:"Clear Selected","aria-label":"Clear Selected",onClick:e[0]||(e[0]=(...o)=>u.clearSelection&&u.clearSelection(...o))},[(kr(),os(w_(u.childComponents.Deselect)))],8,_J),[[Z_,u.showClearButton]]),$s(t.$slots,"open-indicator",js(Vs(u.scope.openIndicator)),()=>[r.noDrop?Jc("",!0):(kr(),os(w_(u.childComponents.OpenIndicator),js(G_({key:0},u.scope.openIndicator.attributes)),null,16))]),$s(t.$slots,"spinner",js(Vs(u.scope.spinner)),()=>[b_(Nr("div",yJ,"Loading...",512),[[Z_,t.mutableLoading]])])],512)],40,fJ),ri(Ky,{name:r.transition},{default:Fo(()=>[u.dropdownOpen?b_((kr(),xi("ul",{id:`vs${r.uid}__listbox`,ref:"dropdownMenu",key:`vs${r.uid}__listbox`,class:"vs__dropdown-menu",role:"listbox",tabindex:"-1",onMousedown:e[2]||(e[2]=ib((...o)=>u.onMousedown&&u.onMousedown(...o),["prevent"])),onMouseup:e[3]||(e[3]=(...o)=>u.onMouseUp&&u.onMouseUp(...o))},[$s(t.$slots,"list-header",js(Vs(u.scope.listHeader))),(kr(!0),xi(Ri,null,Gc(u.filteredOptions,(o,g)=>(kr(),xi("li",{id:`vs${r.uid}__option-${g}`,key:r.getOptionKey(o),role:"option",class:iu(["vs__dropdown-option",{"vs__dropdown-option--deselect":u.isOptionDeselectable(o)&&g===t.typeAheadPointer,"vs__dropdown-option--selected":u.isOptionSelected(o),"vs__dropdown-option--highlight":g===t.typeAheadPointer,"vs__dropdown-option--disabled":!r.selectable(o)}]),"aria-selected":g===t.typeAheadPointer?!0:null,onMouseover:x=>r.selectable(o)?t.typeAheadPointer=g:null,onClick:ib(x=>r.selectable(o)?u.select(o):null,["prevent","stop"])},[$s(t.$slots,"option",js(Vs(u.normalizeOptionForSlot(o))),()=>[qh(bl(r.getOptionLabel(o)),1)])],42,xJ))),128)),u.filteredOptions.length===0?(kr(),xi("li",bJ,[$s(t.$slots,"no-options",js(Vs(u.scope.noOptions)),()=>[wJ])])):Jc("",!0),$s(t.$slots,"list-footer",js(Vs(u.scope.listFooter)))],40,vJ)),[[d]]):(kr(),xi("ul",{key:1,id:`vs${r.uid}__listbox`,role:"listbox",style:{display:"none",visibility:"hidden"}},null,8,EJ))]),_:3},8,["name"]),$s(t.$slots,"footer",js(Vs(u.scope.footer)))],10,dJ)}const SJ=Tw(hJ,[["render",TJ]]);(async()=>{const t=vI(o4);t.use(tB()),t.use(B7),t.component("v-select",SJ),t.mount("#app")})();export{qJ as L,KJ as a};
